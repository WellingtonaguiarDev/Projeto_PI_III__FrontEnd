/*! For license information please see main.d66ca67b.js.LICENSE.txt */
(()=>{var e={740:e=>{"use strict";e.exports=function(e,t,r,n,i,o,a,s){if(!e){var l;if(void 0===t)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[r,n,i,o,a,s],u=0;(l=new Error(t.replace(/%s/g,(function(){return c[u++]})))).name="Invariant Violation"}throw l.framesToPop=1,l}}},497:(e,t,r)=>{"use strict";var n=r(218);function i(){}function o(){}o.resetWarningCache=i,e.exports=function(){function e(e,t,r,i,o,a){if(a!==n){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:i};return r.PropTypes=r,r}},173:(e,t,r)=>{e.exports=r(497)()},218:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},730:(e,t,r)=>{"use strict";var n=r(43),i=r(853);function o(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,s={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(s[e]=t,e=0;e<t.length;e++)a.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},f={};function m(e,t,r,n,i,o,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=a}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function _(e,t,r,n){var i=g.hasOwnProperty(t)?g[t]:null;(null!==i?0!==i.type:n||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,r,n){if(null===t||"undefined"===typeof t||function(e,t,r,n){if(null!==r&&0===r.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==r?!r.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,r,n))return!0;if(n)return!1;if(null!==r)switch(r.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,r,i,n)&&(r=null),n||null===i?function(e){return!!h.call(f,e)||!h.call(p,e)&&(d.test(e)?f[e]=!0:(p[e]=!0,!1))}(t)&&(null===r?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=null===r?3!==i.type&&"":r:(t=i.attributeName,n=i.attributeNamespace,null===r?e.removeAttribute(t):(r=3===(i=i.type)||4===i&&!0===r?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var b=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),x=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),I=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),P=Symbol.for("react.suspense_list"),M=Symbol.for("react.memo"),R=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var O=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var L=Symbol.iterator;function D(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=L&&e[L]||e["@@iterator"])?e:null}var N,z=Object.assign;function F(e){if(void 0===N)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);N=t&&t[1]||""}return"\n"+N+e}var B=!1;function U(e,t){if(!e||B)return"";B=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&"string"===typeof c.stack){for(var i=c.stack.split("\n"),o=n.stack.split("\n"),a=i.length-1,s=o.length-1;1<=a&&0<=s&&i[a]!==o[s];)s--;for(;1<=a&&0<=s;a--,s--)if(i[a]!==o[s]){if(1!==a||1!==s)do{if(a--,0>--s||i[a]!==o[s]){var l="\n"+i[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=a&&0<=s);break}}}finally{B=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?F(e):""}function j(e){switch(e.tag){case 5:return F(e.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return e=U(e.type,!1);case 11:return e=U(e.type.render,!1);case 1:return e=U(e.type,!0);default:return""}}function q(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case C:return"Fragment";case x:return"Portal";case E:return"Profiler";case S:return"StrictMode";case A:return"Suspense";case P:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case I:return(e.displayName||"Context")+".Consumer";case T:return(e._context.displayName||"Context")+".Provider";case k:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case M:return null!==(t=e.displayName||null)?t:q(e.type)||"Memo";case R:t=e._payload,e=e._init;try{return q(e(t))}catch(r){}}return null}function H(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return q(t);case 8:return t===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function V(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function G(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function K(e){e._valueTracker||(e._valueTracker=function(e){var t=G(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof r&&"function"===typeof r.get&&"function"===typeof r.set){var i=r.get,o=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){n=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function Z(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=G(e)?e.checked?"true":"false":e.value),(e=n)!==r&&(t.setValue(e),!0)}function W(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function $(e,t){var r=t.checked;return z({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=r?r:e._wrapperState.initialChecked})}function Y(e,t){var r=null==t.defaultValue?"":t.defaultValue,n=null!=t.checked?t.checked:t.defaultChecked;r=V(null!=t.value?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function X(e,t){null!=(t=t.checked)&&_(e,"checked",t,!1)}function Q(e,t){X(e,t);var r=V(t.value),n=t.type;if(null!=r)"number"===n?(0===r&&""===e.value||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if("submit"===n||"reset"===n)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,r):t.hasOwnProperty("defaultValue")&&ee(e,t.type,V(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function J(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!("submit"!==n&&"reset"!==n||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}""!==(r=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==r&&(e.name=r)}function ee(e,t,r){"number"===t&&W(e.ownerDocument)===e||(null==r?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var te=Array.isArray;function re(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+V(r),t=null,i=0;i<e.length;i++){if(e[i].value===r)return e[i].selected=!0,void(n&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function ne(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(o(91));return z({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var r=t.value;if(null==r){if(r=t.children,t=t.defaultValue,null!=r){if(null!=t)throw Error(o(92));if(te(r)){if(1<r.length)throw Error(o(93));r=r[0]}t=r}null==t&&(t=""),r=t}e._wrapperState={initialValue:V(r)}}function oe(e,t){var r=V(t.value),n=V(t.defaultValue);null!=r&&((r=""+r)!==e.value&&(e.value=r),null==t.defaultValue&&e.defaultValue!==r&&(e.defaultValue=r)),null!=n&&(e.defaultValue=""+n)}function ae(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,he=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,r,n){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function de(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&3===r.nodeType)return void(r.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function me(e,t,r){return null==t||"boolean"===typeof t||""===t?"":r||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var r in e=e.style,t)if(t.hasOwnProperty(r)){var n=0===r.indexOf("--"),i=me(r,t[r],n);"float"===r&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}Object.keys(pe).forEach((function(e){fe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]}))}));var ye=z({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(e,t){if(t){if(ye[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(o(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(o(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(o(62))}}function _e(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var be=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var xe=null,Ce=null,Se=null;function Ee(e){if(e=_i(e)){if("function"!==typeof xe)throw Error(o(280));var t=e.stateNode;t&&(t=wi(t),xe(e.stateNode,e.type,t))}}function Te(e){Ce?Se?Se.push(e):Se=[e]:Ce=e}function Ie(){if(Ce){var e=Ce,t=Se;if(Se=Ce=null,Ee(e),t)for(e=0;e<t.length;e++)Ee(t[e])}}function ke(e,t){return e(t)}function Ae(){}var Pe=!1;function Me(e,t,r){if(Pe)return e(t,r);Pe=!0;try{return ke(e,t,r)}finally{Pe=!1,(null!==Ce||null!==Se)&&(Ae(),Ie())}}function Re(e,t){var r=e.stateNode;if(null===r)return null;var n=wi(r);if(null===n)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(r&&"function"!==typeof r)throw Error(o(231,t,typeof r));return r}var Oe=!1;if(u)try{var Le={};Object.defineProperty(Le,"passive",{get:function(){Oe=!0}}),window.addEventListener("test",Le,Le),window.removeEventListener("test",Le,Le)}catch(ue){Oe=!1}function De(e,t,r,n,i,o,a,s,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(u){this.onError(u)}}var Ne=!1,ze=null,Fe=!1,Be=null,Ue={onError:function(e){Ne=!0,ze=e}};function je(e,t,r,n,i,o,a,s,l){Ne=!1,ze=null,De.apply(Ue,arguments)}function qe(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(r=t.return),e=t.return}while(e)}return 3===t.tag?r:null}function He(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ve(e){if(qe(e)!==e)throw Error(o(188))}function Ge(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=qe(e)))throw Error(o(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(null===i)break;var a=i.alternate;if(null===a){if(null!==(n=i.return)){r=n;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===r)return Ve(i),e;if(a===n)return Ve(i),t;a=a.sibling}throw Error(o(188))}if(r.return!==n.return)r=i,n=a;else{for(var s=!1,l=i.child;l;){if(l===r){s=!0,r=i,n=a;break}if(l===n){s=!0,n=i,r=a;break}l=l.sibling}if(!s){for(l=a.child;l;){if(l===r){s=!0,r=a,n=i;break}if(l===n){s=!0,n=a,r=i;break}l=l.sibling}if(!s)throw Error(o(189))}}if(r.alternate!==n)throw Error(o(190))}if(3!==r.tag)throw Error(o(188));return r.stateNode.current===r?e:t}(e))?Ke(e):null}function Ke(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ke(e);if(null!==t)return t;e=e.sibling}return null}var Ze=i.unstable_scheduleCallback,We=i.unstable_cancelCallback,$e=i.unstable_shouldYield,Ye=i.unstable_requestPaint,Xe=i.unstable_now,Qe=i.unstable_getCurrentPriorityLevel,Je=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,rt=i.unstable_LowPriority,nt=i.unstable_IdlePriority,it=null,ot=null;var at=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(st(e)/lt|0)|0},st=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dt(e,t){var r=e.pendingLanes;if(0===r)return 0;var n=0,i=e.suspendedLanes,o=e.pingedLanes,a=268435455&r;if(0!==a){var s=a&~i;0!==s?n=ht(s):0!==(o&=a)&&(n=ht(o))}else 0!==(a=r&~i)?n=ht(a):0!==o&&(n=ht(o));if(0===n)return 0;if(0!==t&&t!==n&&0===(t&i)&&((i=n&-n)>=(o=t&-t)||16===i&&0!==(4194240&o)))return t;if(0!==(4&n)&&(n|=16&r),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=n;0<t;)i=1<<(r=31-at(t)),n|=e[r],t&=~i;return n}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function yt(e,t,r){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-at(t)]=r}function vt(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-at(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var _t=0;function bt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,xt,Ct,St,Et,Tt=!1,It=[],kt=null,At=null,Pt=null,Mt=new Map,Rt=new Map,Ot=[],Lt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Dt(e,t){switch(e){case"focusin":case"focusout":kt=null;break;case"dragenter":case"dragleave":At=null;break;case"mouseover":case"mouseout":Pt=null;break;case"pointerover":case"pointerout":Mt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rt.delete(t.pointerId)}}function Nt(e,t,r,n,i,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:o,targetContainers:[i]},null!==t&&(null!==(t=_i(t))&&xt(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function zt(e){var t=vi(e.target);if(null!==t){var r=qe(t);if(null!==r)if(13===(t=r.tag)){if(null!==(t=He(r)))return e.blockedOn=t,void Et(e.priority,(function(){Ct(r)}))}else if(3===t&&r.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===r.tag?r.stateNode.containerInfo:null)}e.blockedOn=null}function Ft(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var r=$t(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==r)return null!==(t=_i(r))&&xt(t),e.blockedOn=r,!1;var n=new(r=e.nativeEvent).constructor(r.type,r);be=n,r.target.dispatchEvent(n),be=null,t.shift()}return!0}function Bt(e,t,r){Ft(e)&&r.delete(t)}function Ut(){Tt=!1,null!==kt&&Ft(kt)&&(kt=null),null!==At&&Ft(At)&&(At=null),null!==Pt&&Ft(Pt)&&(Pt=null),Mt.forEach(Bt),Rt.forEach(Bt)}function jt(e,t){e.blockedOn===t&&(e.blockedOn=null,Tt||(Tt=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Ut)))}function qt(e){function t(t){return jt(t,e)}if(0<It.length){jt(It[0],e);for(var r=1;r<It.length;r++){var n=It[r];n.blockedOn===e&&(n.blockedOn=null)}}for(null!==kt&&jt(kt,e),null!==At&&jt(At,e),null!==Pt&&jt(Pt,e),Mt.forEach(t),Rt.forEach(t),r=0;r<Ot.length;r++)(n=Ot[r]).blockedOn===e&&(n.blockedOn=null);for(;0<Ot.length&&null===(r=Ot[0]).blockedOn;)zt(r),null===r.blockedOn&&Ot.shift()}var Ht=b.ReactCurrentBatchConfig,Vt=!0;function Gt(e,t,r,n){var i=_t,o=Ht.transition;Ht.transition=null;try{_t=1,Zt(e,t,r,n)}finally{_t=i,Ht.transition=o}}function Kt(e,t,r,n){var i=_t,o=Ht.transition;Ht.transition=null;try{_t=4,Zt(e,t,r,n)}finally{_t=i,Ht.transition=o}}function Zt(e,t,r,n){if(Vt){var i=$t(e,t,r,n);if(null===i)Vn(e,t,n,Wt,r),Dt(e,n);else if(function(e,t,r,n,i){switch(t){case"focusin":return kt=Nt(kt,e,t,r,n,i),!0;case"dragenter":return At=Nt(At,e,t,r,n,i),!0;case"mouseover":return Pt=Nt(Pt,e,t,r,n,i),!0;case"pointerover":var o=i.pointerId;return Mt.set(o,Nt(Mt.get(o)||null,e,t,r,n,i)),!0;case"gotpointercapture":return o=i.pointerId,Rt.set(o,Nt(Rt.get(o)||null,e,t,r,n,i)),!0}return!1}(i,e,t,r,n))n.stopPropagation();else if(Dt(e,n),4&t&&-1<Lt.indexOf(e)){for(;null!==i;){var o=_i(i);if(null!==o&&wt(o),null===(o=$t(e,t,r,n))&&Vn(e,t,n,Wt,r),o===i)break;i=o}null!==i&&n.stopPropagation()}else Vn(e,t,n,null,r)}}var Wt=null;function $t(e,t,r,n){if(Wt=null,null!==(e=vi(e=we(n))))if(null===(t=qe(e)))e=null;else if(13===(r=t.tag)){if(null!==(e=He(t)))return e;e=null}else if(3===r){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Wt=e,null}function Yt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Qe()){case Je:return 1;case et:return 4;case tt:case rt:return 16;case nt:return 536870912;default:return 16}default:return 16}}var Xt=null,Qt=null,Jt=null;function er(){if(Jt)return Jt;var e,t,r=Qt,n=r.length,i="value"in Xt?Xt.value:Xt.textContent,o=i.length;for(e=0;e<n&&r[e]===i[e];e++);var a=n-e;for(t=1;t<=a&&r[n-t]===i[o-t];t++);return Jt=i.slice(e,1<t?1-t:void 0)}function tr(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function rr(){return!0}function nr(){return!1}function ir(e){function t(t,r,n,i,o){for(var a in this._reactName=t,this._targetInst=n,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(i):i[a]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?rr:nr,this.isPropagationStopped=nr,this}return z(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=rr)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=rr)},persist:function(){},isPersistent:rr}),t}var or,ar,sr,lr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cr=ir(lr),ur=z({},lr,{view:0,detail:0}),hr=ir(ur),dr=z({},ur,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sr,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==sr&&(sr&&"mousemove"===e.type?(or=e.screenX-sr.screenX,ar=e.screenY-sr.screenY):ar=or=0,sr=e),or)},movementY:function(e){return"movementY"in e?e.movementY:ar}}),pr=ir(dr),fr=ir(z({},dr,{dataTransfer:0})),mr=ir(z({},ur,{relatedTarget:0})),gr=ir(z({},lr,{animationName:0,elapsedTime:0,pseudoElement:0})),yr=z({},lr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),vr=ir(yr),_r=ir(z({},lr,{data:0})),br={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Cr(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=xr[e])&&!!t[e]}function Sr(){return Cr}var Er=z({},ur,{key:function(e){if(e.key){var t=br[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tr(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?wr[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sr,charCode:function(e){return"keypress"===e.type?tr(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tr(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Tr=ir(Er),Ir=ir(z({},dr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),kr=ir(z({},ur,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sr})),Ar=ir(z({},lr,{propertyName:0,elapsedTime:0,pseudoElement:0})),Pr=z({},dr,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Mr=ir(Pr),Rr=[9,13,27,32],Or=u&&"CompositionEvent"in window,Lr=null;u&&"documentMode"in document&&(Lr=document.documentMode);var Dr=u&&"TextEvent"in window&&!Lr,Nr=u&&(!Or||Lr&&8<Lr&&11>=Lr),zr=String.fromCharCode(32),Fr=!1;function Br(e,t){switch(e){case"keyup":return-1!==Rr.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ur(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var jr=!1;var qr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!qr[e.type]:"textarea"===t}function Vr(e,t,r,n){Te(n),0<(t=Kn(t,"onChange")).length&&(r=new cr("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Gr=null,Kr=null;function Zr(e){Fn(e,0)}function Wr(e){if(Z(bi(e)))return e}function $r(e,t){if("change"===e)return t}var Yr=!1;if(u){var Xr;if(u){var Qr="oninput"in document;if(!Qr){var Jr=document.createElement("div");Jr.setAttribute("oninput","return;"),Qr="function"===typeof Jr.oninput}Xr=Qr}else Xr=!1;Yr=Xr&&(!document.documentMode||9<document.documentMode)}function en(){Gr&&(Gr.detachEvent("onpropertychange",tn),Kr=Gr=null)}function tn(e){if("value"===e.propertyName&&Wr(Kr)){var t=[];Vr(t,Kr,e,we(e)),Me(Zr,t)}}function rn(e,t,r){"focusin"===e?(en(),Kr=r,(Gr=t).attachEvent("onpropertychange",tn)):"focusout"===e&&en()}function nn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Wr(Kr)}function on(e,t){if("click"===e)return Wr(t)}function an(e,t){if("input"===e||"change"===e)return Wr(t)}var sn="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function ln(e,t){if(sn(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!h.call(t,i)||!sn(e[i],t[i]))return!1}return!0}function cn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function un(e,t){var r,n=cn(e);for(e=0;n;){if(3===n.nodeType){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=cn(n)}}function hn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function dn(){for(var e=window,t=W();t instanceof e.HTMLIFrameElement;){try{var r="string"===typeof t.contentWindow.location.href}catch(n){r=!1}if(!r)break;t=W((e=t.contentWindow).document)}return t}function pn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function fn(e){var t=dn(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&hn(r.ownerDocument.documentElement,r)){if(null!==n&&pn(r))if(t=n.start,void 0===(e=n.end)&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if((e=(t=r.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=r.textContent.length,o=Math.min(n.start,i);n=void 0===n.end?o:Math.min(n.end,i),!e.extend&&o>n&&(i=n,n=o,o=i),i=un(r,o);var a=un(r,n);i&&a&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),o>n?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}for(t=[],e=r;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof r.focus&&r.focus(),r=0;r<t.length;r++)(e=t[r]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mn=u&&"documentMode"in document&&11>=document.documentMode,gn=null,yn=null,vn=null,_n=!1;function bn(e,t,r){var n=r.window===r?r.document:9===r.nodeType?r:r.ownerDocument;_n||null==gn||gn!==W(n)||("selectionStart"in(n=gn)&&pn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},vn&&ln(vn,n)||(vn=n,0<(n=Kn(yn,"onSelect")).length&&(t=new cr("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=gn)))}function wn(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var xn={animationend:wn("Animation","AnimationEnd"),animationiteration:wn("Animation","AnimationIteration"),animationstart:wn("Animation","AnimationStart"),transitionend:wn("Transition","TransitionEnd")},Cn={},Sn={};function En(e){if(Cn[e])return Cn[e];if(!xn[e])return e;var t,r=xn[e];for(t in r)if(r.hasOwnProperty(t)&&t in Sn)return Cn[e]=r[t];return e}u&&(Sn=document.createElement("div").style,"AnimationEvent"in window||(delete xn.animationend.animation,delete xn.animationiteration.animation,delete xn.animationstart.animation),"TransitionEvent"in window||delete xn.transitionend.transition);var Tn=En("animationend"),In=En("animationiteration"),kn=En("animationstart"),An=En("transitionend"),Pn=new Map,Mn="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Rn(e,t){Pn.set(e,t),l(t,[e])}for(var On=0;On<Mn.length;On++){var Ln=Mn[On];Rn(Ln.toLowerCase(),"on"+(Ln[0].toUpperCase()+Ln.slice(1)))}Rn(Tn,"onAnimationEnd"),Rn(In,"onAnimationIteration"),Rn(kn,"onAnimationStart"),Rn("dblclick","onDoubleClick"),Rn("focusin","onFocus"),Rn("focusout","onBlur"),Rn(An,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Dn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Nn=new Set("cancel close invalid load scroll toggle".split(" ").concat(Dn));function zn(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,function(e,t,r,n,i,a,s,l,c){if(je.apply(this,arguments),Ne){if(!Ne)throw Error(o(198));var u=ze;Ne=!1,ze=null,Fe||(Fe=!0,Be=u)}}(n,t,void 0,e),e.currentTarget=null}function Fn(e,t){t=0!==(4&t);for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var o=void 0;if(t)for(var a=n.length-1;0<=a;a--){var s=n[a],l=s.instance,c=s.currentTarget;if(s=s.listener,l!==o&&i.isPropagationStopped())break e;zn(i,s,c),o=l}else for(a=0;a<n.length;a++){if(l=(s=n[a]).instance,c=s.currentTarget,s=s.listener,l!==o&&i.isPropagationStopped())break e;zn(i,s,c),o=l}}}if(Fe)throw e=Be,Fe=!1,Be=null,e}function Bn(e,t){var r=t[mi];void 0===r&&(r=t[mi]=new Set);var n=e+"__bubble";r.has(n)||(Hn(t,e,2,!1),r.add(n))}function Un(e,t,r){var n=0;t&&(n|=4),Hn(r,e,n,t)}var jn="_reactListening"+Math.random().toString(36).slice(2);function qn(e){if(!e[jn]){e[jn]=!0,a.forEach((function(t){"selectionchange"!==t&&(Nn.has(t)||Un(t,!1,e),Un(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[jn]||(t[jn]=!0,Un("selectionchange",!1,t))}}function Hn(e,t,r,n){switch(Yt(t)){case 1:var i=Gt;break;case 4:i=Kt;break;default:i=Zt}r=i.bind(null,t,r,e),i=void 0,!Oe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),n?void 0!==i?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):void 0!==i?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function Vn(e,t,r,n,i){var o=n;if(0===(1&t)&&0===(2&t)&&null!==n)e:for(;;){if(null===n)return;var a=n.tag;if(3===a||4===a){var s=n.stateNode.containerInfo;if(s===i||8===s.nodeType&&s.parentNode===i)break;if(4===a)for(a=n.return;null!==a;){var l=a.tag;if((3===l||4===l)&&((l=a.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;a=a.return}for(;null!==s;){if(null===(a=vi(s)))return;if(5===(l=a.tag)||6===l){n=o=a;continue e}s=s.parentNode}}n=n.return}Me((function(){var n=o,i=we(r),a=[];e:{var s=Pn.get(e);if(void 0!==s){var l=cr,c=e;switch(e){case"keypress":if(0===tr(r))break e;case"keydown":case"keyup":l=Tr;break;case"focusin":c="focus",l=mr;break;case"focusout":c="blur",l=mr;break;case"beforeblur":case"afterblur":l=mr;break;case"click":if(2===r.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=fr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=kr;break;case Tn:case In:case kn:l=gr;break;case An:l=Ar;break;case"scroll":l=hr;break;case"wheel":l=Mr;break;case"copy":case"cut":case"paste":l=vr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Ir}var u=0!==(4&t),h=!u&&"scroll"===e,d=u?null!==s?s+"Capture":null:s;u=[];for(var p,f=n;null!==f;){var m=(p=f).stateNode;if(5===p.tag&&null!==m&&(p=m,null!==d&&(null!=(m=Re(f,d))&&u.push(Gn(f,m,p)))),h)break;f=f.return}0<u.length&&(s=new l(s,c,null,r,i),a.push({event:s,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||r===be||!(c=r.relatedTarget||r.fromElement)||!vi(c)&&!c[fi])&&(l||s)&&(s=i.window===i?i:(s=i.ownerDocument)?s.defaultView||s.parentWindow:window,l?(l=n,null!==(c=(c=r.relatedTarget||r.toElement)?vi(c):null)&&(c!==(h=qe(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=n),l!==c)){if(u=pr,m="onMouseLeave",d="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(u=Ir,m="onPointerLeave",d="onPointerEnter",f="pointer"),h=null==l?s:bi(l),p=null==c?s:bi(c),(s=new u(m,f+"leave",l,r,i)).target=h,s.relatedTarget=p,m=null,vi(i)===n&&((u=new u(d,f+"enter",c,r,i)).target=p,u.relatedTarget=h,m=u),h=m,l&&c)e:{for(d=c,f=0,p=u=l;p;p=Zn(p))f++;for(p=0,m=d;m;m=Zn(m))p++;for(;0<f-p;)u=Zn(u),f--;for(;0<p-f;)d=Zn(d),p--;for(;f--;){if(u===d||null!==d&&u===d.alternate)break e;u=Zn(u),d=Zn(d)}u=null}else u=null;null!==l&&Wn(a,s,l,u,!1),null!==c&&null!==h&&Wn(a,h,c,u,!0)}if("select"===(l=(s=n?bi(n):window).nodeName&&s.nodeName.toLowerCase())||"input"===l&&"file"===s.type)var g=$r;else if(Hr(s))if(Yr)g=an;else{g=nn;var y=rn}else(l=s.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(g=on);switch(g&&(g=g(e,n))?Vr(a,g,r,i):(y&&y(e,s,n),"focusout"===e&&(y=s._wrapperState)&&y.controlled&&"number"===s.type&&ee(s,"number",s.value)),y=n?bi(n):window,e){case"focusin":(Hr(y)||"true"===y.contentEditable)&&(gn=y,yn=n,vn=null);break;case"focusout":vn=yn=gn=null;break;case"mousedown":_n=!0;break;case"contextmenu":case"mouseup":case"dragend":_n=!1,bn(a,r,i);break;case"selectionchange":if(mn)break;case"keydown":case"keyup":bn(a,r,i)}var v;if(Or)e:{switch(e){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else jr?Br(e,r)&&(_="onCompositionEnd"):"keydown"===e&&229===r.keyCode&&(_="onCompositionStart");_&&(Nr&&"ko"!==r.locale&&(jr||"onCompositionStart"!==_?"onCompositionEnd"===_&&jr&&(v=er()):(Qt="value"in(Xt=i)?Xt.value:Xt.textContent,jr=!0)),0<(y=Kn(n,_)).length&&(_=new _r(_,e,null,r,i),a.push({event:_,listeners:y}),v?_.data=v:null!==(v=Ur(r))&&(_.data=v))),(v=Dr?function(e,t){switch(e){case"compositionend":return Ur(t);case"keypress":return 32!==t.which?null:(Fr=!0,zr);case"textInput":return(e=t.data)===zr&&Fr?null:e;default:return null}}(e,r):function(e,t){if(jr)return"compositionend"===e||!Or&&Br(e,t)?(e=er(),Jt=Qt=Xt=null,jr=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Nr&&"ko"!==t.locale?null:t.data}}(e,r))&&(0<(n=Kn(n,"onBeforeInput")).length&&(i=new _r("onBeforeInput","beforeinput",null,r,i),a.push({event:i,listeners:n}),i.data=v))}Fn(a,t)}))}function Gn(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Kn(e,t){for(var r=t+"Capture",n=[];null!==e;){var i=e,o=i.stateNode;5===i.tag&&null!==o&&(i=o,null!=(o=Re(e,r))&&n.unshift(Gn(e,o,i)),null!=(o=Re(e,t))&&n.push(Gn(e,o,i))),e=e.return}return n}function Zn(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Wn(e,t,r,n,i){for(var o=t._reactName,a=[];null!==r&&r!==n;){var s=r,l=s.alternate,c=s.stateNode;if(null!==l&&l===n)break;5===s.tag&&null!==c&&(s=c,i?null!=(l=Re(r,o))&&a.unshift(Gn(r,l,s)):i||null!=(l=Re(r,o))&&a.push(Gn(r,l,s))),r=r.return}0!==a.length&&e.push({event:t,listeners:a})}var $n=/\r\n?/g,Yn=/\u0000|\uFFFD/g;function Xn(e){return("string"===typeof e?e:""+e).replace($n,"\n").replace(Yn,"")}function Qn(e,t,r){if(t=Xn(t),Xn(e)!==t&&r)throw Error(o(425))}function Jn(){}var ei=null,ti=null;function ri(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ni="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,oi="function"===typeof Promise?Promise:void 0,ai="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof oi?function(e){return oi.resolve(null).then(e).catch(si)}:ni;function si(e){setTimeout((function(){throw e}))}function li(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&8===i.nodeType)if("/$"===(r=i.data)){if(0===n)return e.removeChild(i),void qt(t);n--}else"$"!==r&&"$?"!==r&&"$!"!==r||n++;r=i}while(r);qt(t)}function ci(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ui(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var r=e.data;if("$"===r||"$!"===r||"$?"===r){if(0===t)return e;t--}else"/$"===r&&t++}e=e.previousSibling}return null}var hi=Math.random().toString(36).slice(2),di="__reactFiber$"+hi,pi="__reactProps$"+hi,fi="__reactContainer$"+hi,mi="__reactEvents$"+hi,gi="__reactListeners$"+hi,yi="__reactHandles$"+hi;function vi(e){var t=e[di];if(t)return t;for(var r=e.parentNode;r;){if(t=r[fi]||r[di]){if(r=t.alternate,null!==t.child||null!==r&&null!==r.child)for(e=ui(e);null!==e;){if(r=e[di])return r;e=ui(e)}return t}r=(e=r).parentNode}return null}function _i(e){return!(e=e[di]||e[fi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function bi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(o(33))}function wi(e){return e[pi]||null}var xi=[],Ci=-1;function Si(e){return{current:e}}function Ei(e){0>Ci||(e.current=xi[Ci],xi[Ci]=null,Ci--)}function Ti(e,t){Ci++,xi[Ci]=e.current,e.current=t}var Ii={},ki=Si(Ii),Ai=Si(!1),Pi=Ii;function Mi(e,t){var r=e.type.contextTypes;if(!r)return Ii;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in r)o[i]=t[i];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Ri(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Oi(){Ei(Ai),Ei(ki)}function Li(e,t,r){if(ki.current!==Ii)throw Error(o(168));Ti(ki,t),Ti(Ai,r)}function Di(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,"function"!==typeof n.getChildContext)return r;for(var i in n=n.getChildContext())if(!(i in t))throw Error(o(108,H(e)||"Unknown",i));return z({},r,n)}function Ni(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ii,Pi=ki.current,Ti(ki,e),Ti(Ai,Ai.current),!0}function zi(e,t,r){var n=e.stateNode;if(!n)throw Error(o(169));r?(e=Di(e,t,Pi),n.__reactInternalMemoizedMergedChildContext=e,Ei(Ai),Ei(ki),Ti(ki,e)):Ei(Ai),Ti(Ai,r)}var Fi=null,Bi=!1,Ui=!1;function ji(e){null===Fi?Fi=[e]:Fi.push(e)}function qi(){if(!Ui&&null!==Fi){Ui=!0;var e=0,t=_t;try{var r=Fi;for(_t=1;e<r.length;e++){var n=r[e];do{n=n(!0)}while(null!==n)}Fi=null,Bi=!1}catch(i){throw null!==Fi&&(Fi=Fi.slice(e+1)),Ze(Je,qi),i}finally{_t=t,Ui=!1}}return null}var Hi=[],Vi=0,Gi=null,Ki=0,Zi=[],Wi=0,$i=null,Yi=1,Xi="";function Qi(e,t){Hi[Vi++]=Ki,Hi[Vi++]=Gi,Gi=e,Ki=t}function Ji(e,t,r){Zi[Wi++]=Yi,Zi[Wi++]=Xi,Zi[Wi++]=$i,$i=e;var n=Yi;e=Xi;var i=32-at(n)-1;n&=~(1<<i),r+=1;var o=32-at(t)+i;if(30<o){var a=i-i%5;o=(n&(1<<a)-1).toString(32),n>>=a,i-=a,Yi=1<<32-at(t)+i|r<<i|n,Xi=o+e}else Yi=1<<o|r<<i|n,Xi=e}function eo(e){null!==e.return&&(Qi(e,1),Ji(e,1,0))}function to(e){for(;e===Gi;)Gi=Hi[--Vi],Hi[Vi]=null,Ki=Hi[--Vi],Hi[Vi]=null;for(;e===$i;)$i=Zi[--Wi],Zi[Wi]=null,Xi=Zi[--Wi],Zi[Wi]=null,Yi=Zi[--Wi],Zi[Wi]=null}var ro=null,no=null,io=!1,oo=null;function ao(e,t){var r=Mc(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,null===(t=e.deletions)?(e.deletions=[r],e.flags|=16):t.push(r)}function so(e,t){switch(e.tag){case 5:var r=e.type;return null!==(t=1!==t.nodeType||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ro=e,no=ci(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ro=e,no=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(r=null!==$i?{id:Yi,overflow:Xi}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},(r=Mc(18,null,null,0)).stateNode=t,r.return=e,e.child=r,ro=e,no=null,!0);default:return!1}}function lo(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function co(e){if(io){var t=no;if(t){var r=t;if(!so(e,t)){if(lo(e))throw Error(o(418));t=ci(r.nextSibling);var n=ro;t&&so(e,t)?ao(n,r):(e.flags=-4097&e.flags|2,io=!1,ro=e)}}else{if(lo(e))throw Error(o(418));e.flags=-4097&e.flags|2,io=!1,ro=e}}}function uo(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ro=e}function ho(e){if(e!==ro)return!1;if(!io)return uo(e),io=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ri(e.type,e.memoizedProps)),t&&(t=no)){if(lo(e))throw po(),Error(o(418));for(;t;)ao(e,t),t=ci(t.nextSibling)}if(uo(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var r=e.data;if("/$"===r){if(0===t){no=ci(e.nextSibling);break e}t--}else"$"!==r&&"$!"!==r&&"$?"!==r||t++}e=e.nextSibling}no=null}}else no=ro?ci(e.stateNode.nextSibling):null;return!0}function po(){for(var e=no;e;)e=ci(e.nextSibling)}function fo(){no=ro=null,io=!1}function mo(e){null===oo?oo=[e]:oo.push(e)}var go=b.ReactCurrentBatchConfig;function yo(e,t,r){if(null!==(e=r.ref)&&"function"!==typeof e&&"object"!==typeof e){if(r._owner){if(r=r._owner){if(1!==r.tag)throw Error(o(309));var n=r.stateNode}if(!n)throw Error(o(147,e));var i=n,a=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===a?t.ref:(t=function(e){var t=i.refs;null===e?delete t[a]:t[a]=e},t._stringRef=a,t)}if("string"!==typeof e)throw Error(o(284));if(!r._owner)throw Error(o(290,e))}return e}function vo(e,t){throw e=Object.prototype.toString.call(t),Error(o(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function _o(e){return(0,e._init)(e._payload)}function bo(e){function t(t,r){if(e){var n=t.deletions;null===n?(t.deletions=[r],t.flags|=16):n.push(r)}}function r(r,n){if(!e)return null;for(;null!==n;)t(r,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Oc(e,t)).index=0,e.sibling=null,e}function a(t,r,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<r?(t.flags|=2,r):n:(t.flags|=2,r):(t.flags|=1048576,r)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,r,n){return null===t||6!==t.tag?((t=zc(r,e.mode,n)).return=e,t):((t=i(t,r)).return=e,t)}function c(e,t,r,n){var o=r.type;return o===C?h(e,t,r.props.children,n,r.key):null!==t&&(t.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===R&&_o(o)===t.type)?((n=i(t,r.props)).ref=yo(e,t,r),n.return=e,n):((n=Lc(r.type,r.key,r.props,null,e.mode,n)).ref=yo(e,t,r),n.return=e,n)}function u(e,t,r,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==r.containerInfo||t.stateNode.implementation!==r.implementation?((t=Fc(r,e.mode,n)).return=e,t):((t=i(t,r.children||[])).return=e,t)}function h(e,t,r,n,o){return null===t||7!==t.tag?((t=Dc(r,e.mode,n,o)).return=e,t):((t=i(t,r)).return=e,t)}function d(e,t,r){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=zc(""+t,e.mode,r)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(r=Lc(t.type,t.key,t.props,null,e.mode,r)).ref=yo(e,null,t),r.return=e,r;case x:return(t=Fc(t,e.mode,r)).return=e,t;case R:return d(e,(0,t._init)(t._payload),r)}if(te(t)||D(t))return(t=Dc(t,e.mode,r,null)).return=e,t;vo(e,t)}return null}function p(e,t,r,n){var i=null!==t?t.key:null;if("string"===typeof r&&""!==r||"number"===typeof r)return null!==i?null:l(e,t,""+r,n);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return r.key===i?c(e,t,r,n):null;case x:return r.key===i?u(e,t,r,n):null;case R:return p(e,t,(i=r._init)(r._payload),n)}if(te(r)||D(r))return null!==i?null:h(e,t,r,n,null);vo(e,r)}return null}function f(e,t,r,n,i){if("string"===typeof n&&""!==n||"number"===typeof n)return l(t,e=e.get(r)||null,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return c(t,e=e.get(null===n.key?r:n.key)||null,n,i);case x:return u(t,e=e.get(null===n.key?r:n.key)||null,n,i);case R:return f(e,t,r,(0,n._init)(n._payload),i)}if(te(n)||D(n))return h(t,e=e.get(r)||null,n,i,null);vo(t,n)}return null}function m(i,o,s,l){for(var c=null,u=null,h=o,m=o=0,g=null;null!==h&&m<s.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var y=p(i,h,s[m],l);if(null===y){null===h&&(h=g);break}e&&h&&null===y.alternate&&t(i,h),o=a(y,o,m),null===u?c=y:u.sibling=y,u=y,h=g}if(m===s.length)return r(i,h),io&&Qi(i,m),c;if(null===h){for(;m<s.length;m++)null!==(h=d(i,s[m],l))&&(o=a(h,o,m),null===u?c=h:u.sibling=h,u=h);return io&&Qi(i,m),c}for(h=n(i,h);m<s.length;m++)null!==(g=f(h,i,m,s[m],l))&&(e&&null!==g.alternate&&h.delete(null===g.key?m:g.key),o=a(g,o,m),null===u?c=g:u.sibling=g,u=g);return e&&h.forEach((function(e){return t(i,e)})),io&&Qi(i,m),c}function g(i,s,l,c){var u=D(l);if("function"!==typeof u)throw Error(o(150));if(null==(l=u.call(l)))throw Error(o(151));for(var h=u=null,m=s,g=s=0,y=null,v=l.next();null!==m&&!v.done;g++,v=l.next()){m.index>g?(y=m,m=null):y=m.sibling;var _=p(i,m,v.value,c);if(null===_){null===m&&(m=y);break}e&&m&&null===_.alternate&&t(i,m),s=a(_,s,g),null===h?u=_:h.sibling=_,h=_,m=y}if(v.done)return r(i,m),io&&Qi(i,g),u;if(null===m){for(;!v.done;g++,v=l.next())null!==(v=d(i,v.value,c))&&(s=a(v,s,g),null===h?u=v:h.sibling=v,h=v);return io&&Qi(i,g),u}for(m=n(i,m);!v.done;g++,v=l.next())null!==(v=f(m,i,g,v.value,c))&&(e&&null!==v.alternate&&m.delete(null===v.key?g:v.key),s=a(v,s,g),null===h?u=v:h.sibling=v,h=v);return e&&m.forEach((function(e){return t(i,e)})),io&&Qi(i,g),u}return function e(n,o,a,l){if("object"===typeof a&&null!==a&&a.type===C&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case w:e:{for(var c=a.key,u=o;null!==u;){if(u.key===c){if((c=a.type)===C){if(7===u.tag){r(n,u.sibling),(o=i(u,a.props.children)).return=n,n=o;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===R&&_o(c)===u.type){r(n,u.sibling),(o=i(u,a.props)).ref=yo(n,u,a),o.return=n,n=o;break e}r(n,u);break}t(n,u),u=u.sibling}a.type===C?((o=Dc(a.props.children,n.mode,l,a.key)).return=n,n=o):((l=Lc(a.type,a.key,a.props,null,n.mode,l)).ref=yo(n,o,a),l.return=n,n=l)}return s(n);case x:e:{for(u=a.key;null!==o;){if(o.key===u){if(4===o.tag&&o.stateNode.containerInfo===a.containerInfo&&o.stateNode.implementation===a.implementation){r(n,o.sibling),(o=i(o,a.children||[])).return=n,n=o;break e}r(n,o);break}t(n,o),o=o.sibling}(o=Fc(a,n.mode,l)).return=n,n=o}return s(n);case R:return e(n,o,(u=a._init)(a._payload),l)}if(te(a))return m(n,o,a,l);if(D(a))return g(n,o,a,l);vo(n,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==o&&6===o.tag?(r(n,o.sibling),(o=i(o,a)).return=n,n=o):(r(n,o),(o=zc(a,n.mode,l)).return=n,n=o),s(n)):r(n,o)}}var wo=bo(!0),xo=bo(!1),Co=Si(null),So=null,Eo=null,To=null;function Io(){To=Eo=So=null}function ko(e){var t=Co.current;Ei(Co),e._currentValue=t}function Ao(e,t,r){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Po(e,t){So=e,To=Eo=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(_s=!0),e.firstContext=null)}function Mo(e){var t=e._currentValue;if(To!==e)if(e={context:e,memoizedValue:t,next:null},null===Eo){if(null===So)throw Error(o(308));Eo=e,So.dependencies={lanes:0,firstContext:e}}else Eo=Eo.next=e;return t}var Ro=null;function Oo(e){null===Ro?Ro=[e]:Ro.push(e)}function Lo(e,t,r,n){var i=t.interleaved;return null===i?(r.next=r,Oo(t)):(r.next=i.next,i.next=r),t.interleaved=r,Do(e,n)}function Do(e,t){e.lanes|=t;var r=e.alternate;for(null!==r&&(r.lanes|=t),r=e,e=e.return;null!==e;)e.childLanes|=t,null!==(r=e.alternate)&&(r.childLanes|=t),r=e,e=e.return;return 3===r.tag?r.stateNode:null}var No=!1;function zo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Fo(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Bo(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Uo(e,t,r){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,0!==(2&kl)){var i=n.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),n.pending=t,Do(e,r)}return null===(i=n.interleaved)?(t.next=t,Oo(n)):(t.next=i.next,i.next=t),n.interleaved=t,Do(e,r)}function jo(e,t,r){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&r))){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,vt(e,r)}}function qo(e,t){var r=e.updateQueue,n=e.alternate;if(null!==n&&r===(n=n.updateQueue)){var i=null,o=null;if(null!==(r=r.firstBaseUpdate)){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};null===o?i=o=a:o=o.next=a,r=r.next}while(null!==r);null===o?i=o=t:o=o.next=t}else i=o=t;return r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:n.shared,effects:n.effects},void(e.updateQueue=r)}null===(e=r.lastBaseUpdate)?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Ho(e,t,r,n){var i=e.updateQueue;No=!1;var o=i.firstBaseUpdate,a=i.lastBaseUpdate,s=i.shared.pending;if(null!==s){i.shared.pending=null;var l=s,c=l.next;l.next=null,null===a?o=c:a.next=c,a=l;var u=e.alternate;null!==u&&((s=(u=u.updateQueue).lastBaseUpdate)!==a&&(null===s?u.firstBaseUpdate=c:s.next=c,u.lastBaseUpdate=l))}if(null!==o){var h=i.baseState;for(a=0,u=c=l=null,s=o;;){var d=s.lane,p=s.eventTime;if((n&d)===d){null!==u&&(u=u.next={eventTime:p,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var f=e,m=s;switch(d=t,p=r,m.tag){case 1:if("function"===typeof(f=m.payload)){h=f.call(p,h,d);break e}h=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(d="function"===typeof(f=m.payload)?f.call(p,h,d):f)||void 0===d)break e;h=z({},h,d);break e;case 2:No=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(d=i.effects)?i.effects=[s]:d.push(s))}else p={eventTime:p,lane:d,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===u?(c=u=p,l=h):u=u.next=p,a|=d;if(null===(s=s.next)){if(null===(s=i.shared.pending))break;s=(d=s).next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}if(null===u&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null!==(t=i.shared.interleaved)){i=t;do{a|=i.lane,i=i.next}while(i!==t)}else null===o&&(i.shared.lanes=0);Nl|=a,e.lanes=a,e.memoizedState=h}}function Vo(e,t,r){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(null!==i){if(n.callback=null,n=r,"function"!==typeof i)throw Error(o(191,i));i.call(n)}}}var Go={},Ko=Si(Go),Zo=Si(Go),Wo=Si(Go);function $o(e){if(e===Go)throw Error(o(174));return e}function Yo(e,t){switch(Ti(Wo,t),Ti(Zo,e),Ti(Ko,Go),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ei(Ko),Ti(Ko,t)}function Xo(){Ei(Ko),Ei(Zo),Ei(Wo)}function Qo(e){$o(Wo.current);var t=$o(Ko.current),r=le(t,e.type);t!==r&&(Ti(Zo,e),Ti(Ko,r))}function Jo(e){Zo.current===e&&(Ei(Ko),Ei(Zo))}var ea=Si(0);function ta(e){for(var t=e;null!==t;){if(13===t.tag){var r=t.memoizedState;if(null!==r&&(null===(r=r.dehydrated)||"$?"===r.data||"$!"===r.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ra=[];function na(){for(var e=0;e<ra.length;e++)ra[e]._workInProgressVersionPrimary=null;ra.length=0}var ia=b.ReactCurrentDispatcher,oa=b.ReactCurrentBatchConfig,aa=0,sa=null,la=null,ca=null,ua=!1,ha=!1,da=0,pa=0;function fa(){throw Error(o(321))}function ma(e,t){if(null===t)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!sn(e[r],t[r]))return!1;return!0}function ga(e,t,r,n,i,a){if(aa=a,sa=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ia.current=null===e||null===e.memoizedState?Ja:es,e=r(n,i),ha){a=0;do{if(ha=!1,da=0,25<=a)throw Error(o(301));a+=1,ca=la=null,t.updateQueue=null,ia.current=ts,e=r(n,i)}while(ha)}if(ia.current=Qa,t=null!==la&&null!==la.next,aa=0,ca=la=sa=null,ua=!1,t)throw Error(o(300));return e}function ya(){var e=0!==da;return da=0,e}function va(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ca?sa.memoizedState=ca=e:ca=ca.next=e,ca}function _a(){if(null===la){var e=sa.alternate;e=null!==e?e.memoizedState:null}else e=la.next;var t=null===ca?sa.memoizedState:ca.next;if(null!==t)ca=t,la=e;else{if(null===e)throw Error(o(310));e={memoizedState:(la=e).memoizedState,baseState:la.baseState,baseQueue:la.baseQueue,queue:la.queue,next:null},null===ca?sa.memoizedState=ca=e:ca=ca.next=e}return ca}function ba(e,t){return"function"===typeof t?t(e):t}function wa(e){var t=_a(),r=t.queue;if(null===r)throw Error(o(311));r.lastRenderedReducer=e;var n=la,i=n.baseQueue,a=r.pending;if(null!==a){if(null!==i){var s=i.next;i.next=a.next,a.next=s}n.baseQueue=i=a,r.pending=null}if(null!==i){a=i.next,n=n.baseState;var l=s=null,c=null,u=a;do{var h=u.lane;if((aa&h)===h)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=d,s=n):c=c.next=d,sa.lanes|=h,Nl|=h}u=u.next}while(null!==u&&u!==a);null===c?s=n:c.next=l,sn(n,t.memoizedState)||(_s=!0),t.memoizedState=n,t.baseState=s,t.baseQueue=c,r.lastRenderedState=n}if(null!==(e=r.interleaved)){i=e;do{a=i.lane,sa.lanes|=a,Nl|=a,i=i.next}while(i!==e)}else null===i&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function xa(e){var t=_a(),r=t.queue;if(null===r)throw Error(o(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,a=t.memoizedState;if(null!==i){r.pending=null;var s=i=i.next;do{a=e(a,s.action),s=s.next}while(s!==i);sn(a,t.memoizedState)||(_s=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function Ca(){}function Sa(e,t){var r=sa,n=_a(),i=t(),a=!sn(n.memoizedState,i);if(a&&(n.memoizedState=i,_s=!0),n=n.queue,Na(Ia.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||null!==ca&&1&ca.memoizedState.tag){if(r.flags|=2048,Ma(9,Ta.bind(null,r,n,i,t),void 0,null),null===Al)throw Error(o(349));0!==(30&aa)||Ea(r,t,i)}return i}function Ea(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},null===(t=sa.updateQueue)?(t={lastEffect:null,stores:null},sa.updateQueue=t,t.stores=[e]):null===(r=t.stores)?t.stores=[e]:r.push(e)}function Ta(e,t,r,n){t.value=r,t.getSnapshot=n,ka(t)&&Aa(e)}function Ia(e,t,r){return r((function(){ka(t)&&Aa(e)}))}function ka(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!sn(e,r)}catch(n){return!0}}function Aa(e){var t=Do(e,1);null!==t&&rc(t,e,1,-1)}function Pa(e){var t=va();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ba,lastRenderedState:e},t.queue=e,e=e.dispatch=Wa.bind(null,sa,e),[t.memoizedState,e]}function Ma(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},null===(t=sa.updateQueue)?(t={lastEffect:null,stores:null},sa.updateQueue=t,t.lastEffect=e.next=e):null===(r=t.lastEffect)?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e),e}function Ra(){return _a().memoizedState}function Oa(e,t,r,n){var i=va();sa.flags|=e,i.memoizedState=Ma(1|t,r,void 0,void 0===n?null:n)}function La(e,t,r,n){var i=_a();n=void 0===n?null:n;var o=void 0;if(null!==la){var a=la.memoizedState;if(o=a.destroy,null!==n&&ma(n,a.deps))return void(i.memoizedState=Ma(t,r,o,n))}sa.flags|=e,i.memoizedState=Ma(1|t,r,o,n)}function Da(e,t){return Oa(8390656,8,e,t)}function Na(e,t){return La(2048,8,e,t)}function za(e,t){return La(4,2,e,t)}function Fa(e,t){return La(4,4,e,t)}function Ba(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ua(e,t,r){return r=null!==r&&void 0!==r?r.concat([e]):null,La(4,4,Ba.bind(null,t,e),r)}function ja(){}function qa(e,t){var r=_a();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&ma(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Ha(e,t){var r=_a();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&ma(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Va(e,t,r){return 0===(21&aa)?(e.baseState&&(e.baseState=!1,_s=!0),e.memoizedState=r):(sn(r,t)||(r=mt(),sa.lanes|=r,Nl|=r,e.baseState=!0),t)}function Ga(e,t){var r=_t;_t=0!==r&&4>r?r:4,e(!0);var n=oa.transition;oa.transition={};try{e(!1),t()}finally{_t=r,oa.transition=n}}function Ka(){return _a().memoizedState}function Za(e,t,r){var n=tc(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},$a(e))Ya(t,r);else if(null!==(r=Lo(e,t,r,n))){rc(r,e,n,ec()),Xa(r,t,n)}}function Wa(e,t,r){var n=tc(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if($a(e))Ya(t,i);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var a=t.lastRenderedState,s=o(a,r);if(i.hasEagerState=!0,i.eagerState=s,sn(s,a)){var l=t.interleaved;return null===l?(i.next=i,Oo(t)):(i.next=l.next,l.next=i),void(t.interleaved=i)}}catch(c){}null!==(r=Lo(e,t,i,n))&&(rc(r,e,n,i=ec()),Xa(r,t,n))}}function $a(e){var t=e.alternate;return e===sa||null!==t&&t===sa}function Ya(e,t){ha=ua=!0;var r=e.pending;null===r?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Xa(e,t,r){if(0!==(4194240&r)){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,vt(e,r)}}var Qa={readContext:Mo,useCallback:fa,useContext:fa,useEffect:fa,useImperativeHandle:fa,useInsertionEffect:fa,useLayoutEffect:fa,useMemo:fa,useReducer:fa,useRef:fa,useState:fa,useDebugValue:fa,useDeferredValue:fa,useTransition:fa,useMutableSource:fa,useSyncExternalStore:fa,useId:fa,unstable_isNewReconciler:!1},Ja={readContext:Mo,useCallback:function(e,t){return va().memoizedState=[e,void 0===t?null:t],e},useContext:Mo,useEffect:Da,useImperativeHandle:function(e,t,r){return r=null!==r&&void 0!==r?r.concat([e]):null,Oa(4194308,4,Ba.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Oa(4194308,4,e,t)},useInsertionEffect:function(e,t){return Oa(4,2,e,t)},useMemo:function(e,t){var r=va();return t=void 0===t?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=va();return t=void 0!==r?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=Za.bind(null,sa,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},va().memoizedState=e},useState:Pa,useDebugValue:ja,useDeferredValue:function(e){return va().memoizedState=e},useTransition:function(){var e=Pa(!1),t=e[0];return e=Ga.bind(null,e[1]),va().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=sa,i=va();if(io){if(void 0===r)throw Error(o(407));r=r()}else{if(r=t(),null===Al)throw Error(o(349));0!==(30&aa)||Ea(n,t,r)}i.memoizedState=r;var a={value:r,getSnapshot:t};return i.queue=a,Da(Ia.bind(null,n,a,e),[e]),n.flags|=2048,Ma(9,Ta.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=va(),t=Al.identifierPrefix;if(io){var r=Xi;t=":"+t+"R"+(r=(Yi&~(1<<32-at(Yi)-1)).toString(32)+r),0<(r=da++)&&(t+="H"+r.toString(32)),t+=":"}else t=":"+t+"r"+(r=pa++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},es={readContext:Mo,useCallback:qa,useContext:Mo,useEffect:Na,useImperativeHandle:Ua,useInsertionEffect:za,useLayoutEffect:Fa,useMemo:Ha,useReducer:wa,useRef:Ra,useState:function(){return wa(ba)},useDebugValue:ja,useDeferredValue:function(e){return Va(_a(),la.memoizedState,e)},useTransition:function(){return[wa(ba)[0],_a().memoizedState]},useMutableSource:Ca,useSyncExternalStore:Sa,useId:Ka,unstable_isNewReconciler:!1},ts={readContext:Mo,useCallback:qa,useContext:Mo,useEffect:Na,useImperativeHandle:Ua,useInsertionEffect:za,useLayoutEffect:Fa,useMemo:Ha,useReducer:xa,useRef:Ra,useState:function(){return xa(ba)},useDebugValue:ja,useDeferredValue:function(e){var t=_a();return null===la?t.memoizedState=e:Va(t,la.memoizedState,e)},useTransition:function(){return[xa(ba)[0],_a().memoizedState]},useMutableSource:Ca,useSyncExternalStore:Sa,useId:Ka,unstable_isNewReconciler:!1};function rs(e,t){if(e&&e.defaultProps){for(var r in t=z({},t),e=e.defaultProps)void 0===t[r]&&(t[r]=e[r]);return t}return t}function ns(e,t,r,n){r=null===(r=r(n,t=e.memoizedState))||void 0===r?t:z({},t,r),e.memoizedState=r,0===e.lanes&&(e.updateQueue.baseState=r)}var is={isMounted:function(e){return!!(e=e._reactInternals)&&qe(e)===e},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=ec(),i=tc(e),o=Bo(n,i);o.payload=t,void 0!==r&&null!==r&&(o.callback=r),null!==(t=Uo(e,o,i))&&(rc(t,e,i,n),jo(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=ec(),i=tc(e),o=Bo(n,i);o.tag=1,o.payload=t,void 0!==r&&null!==r&&(o.callback=r),null!==(t=Uo(e,o,i))&&(rc(t,e,i,n),jo(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=ec(),n=tc(e),i=Bo(r,n);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=Uo(e,i,n))&&(rc(t,e,n,r),jo(t,e,n))}};function os(e,t,r,n,i,o,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,o,a):!t.prototype||!t.prototype.isPureReactComponent||(!ln(r,n)||!ln(i,o))}function as(e,t,r){var n=!1,i=Ii,o=t.contextType;return"object"===typeof o&&null!==o?o=Mo(o):(i=Ri(t)?Pi:ki.current,o=(n=null!==(n=t.contextTypes)&&void 0!==n)?Mi(e,i):Ii),t=new t(r,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=is,e.stateNode=t,t._reactInternals=e,n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function ss(e,t,r,n){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(r,n),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&is.enqueueReplaceState(t,t.state,null)}function ls(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},zo(e);var o=t.contextType;"object"===typeof o&&null!==o?i.context=Mo(o):(o=Ri(t)?Pi:ki.current,i.context=Mi(e,o)),i.state=e.memoizedState,"function"===typeof(o=t.getDerivedStateFromProps)&&(ns(e,t,o,r),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&is.enqueueReplaceState(i,i.state,null),Ho(e,r,i,n),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function cs(e,t){try{var r="",n=t;do{r+=j(n),n=n.return}while(n);var i=r}catch(o){i="\nError generating stack: "+o.message+"\n"+o.stack}return{value:e,source:t,stack:i,digest:null}}function us(e,t,r){return{value:e,source:null,stack:null!=r?r:null,digest:null!=t?t:null}}function hs(e,t){try{console.error(t.value)}catch(r){setTimeout((function(){throw r}))}}var ds="function"===typeof WeakMap?WeakMap:Map;function ps(e,t,r){(r=Bo(-1,r)).tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Vl||(Vl=!0,Gl=n),hs(0,t)},r}function fs(e,t,r){(r=Bo(-1,r)).tag=3;var n=e.type.getDerivedStateFromError;if("function"===typeof n){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){hs(0,t)}}var o=e.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(r.callback=function(){hs(0,t),"function"!==typeof n&&(null===Kl?Kl=new Set([this]):Kl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),r}function ms(e,t,r){var n=e.pingCache;if(null===n){n=e.pingCache=new ds;var i=new Set;n.set(t,i)}else void 0===(i=n.get(t))&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=Ec.bind(null,e,t,r),t.then(e,e))}function gs(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function ys(e,t,r,n,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,1===r.tag&&(null===r.alternate?r.tag=17:((t=Bo(-1,1)).tag=2,Uo(r,t,1))),r.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var vs=b.ReactCurrentOwner,_s=!1;function bs(e,t,r,n){t.child=null===e?xo(t,null,r,n):wo(t,e.child,r,n)}function ws(e,t,r,n,i){r=r.render;var o=t.ref;return Po(t,i),n=ga(e,t,r,n,o,i),r=ya(),null===e||_s?(io&&r&&eo(t),t.flags|=1,bs(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Vs(e,t,i))}function xs(e,t,r,n,i){if(null===e){var o=r.type;return"function"!==typeof o||Rc(o)||void 0!==o.defaultProps||null!==r.compare||void 0!==r.defaultProps?((e=Lc(r.type,null,n,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,Cs(e,t,o,n,i))}if(o=e.child,0===(e.lanes&i)){var a=o.memoizedProps;if((r=null!==(r=r.compare)?r:ln)(a,n)&&e.ref===t.ref)return Vs(e,t,i)}return t.flags|=1,(e=Oc(o,n)).ref=t.ref,e.return=t,t.child=e}function Cs(e,t,r,n,i){if(null!==e){var o=e.memoizedProps;if(ln(o,n)&&e.ref===t.ref){if(_s=!1,t.pendingProps=n=o,0===(e.lanes&i))return t.lanes=e.lanes,Vs(e,t,i);0!==(131072&e.flags)&&(_s=!0)}}return Ts(e,t,r,n,i)}function Ss(e,t,r){var n=t.pendingProps,i=n.children,o=null!==e?e.memoizedState:null;if("hidden"===n.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ti(Ol,Rl),Rl|=r;else{if(0===(1073741824&r))return e=null!==o?o.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ti(Ol,Rl),Rl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=null!==o?o.baseLanes:r,Ti(Ol,Rl),Rl|=n}else null!==o?(n=o.baseLanes|r,t.memoizedState=null):n=r,Ti(Ol,Rl),Rl|=n;return bs(e,t,i,r),t.child}function Es(e,t){var r=t.ref;(null===e&&null!==r||null!==e&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Ts(e,t,r,n,i){var o=Ri(r)?Pi:ki.current;return o=Mi(t,o),Po(t,i),r=ga(e,t,r,n,o,i),n=ya(),null===e||_s?(io&&n&&eo(t),t.flags|=1,bs(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Vs(e,t,i))}function Is(e,t,r,n,i){if(Ri(r)){var o=!0;Ni(t)}else o=!1;if(Po(t,i),null===t.stateNode)Hs(e,t),as(t,r,n),ls(t,r,n,i),n=!0;else if(null===e){var a=t.stateNode,s=t.memoizedProps;a.props=s;var l=a.context,c=r.contextType;"object"===typeof c&&null!==c?c=Mo(c):c=Mi(t,c=Ri(r)?Pi:ki.current);var u=r.getDerivedStateFromProps,h="function"===typeof u||"function"===typeof a.getSnapshotBeforeUpdate;h||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==n||l!==c)&&ss(t,a,n,c),No=!1;var d=t.memoizedState;a.state=d,Ho(t,n,a,i),l=t.memoizedState,s!==n||d!==l||Ai.current||No?("function"===typeof u&&(ns(t,r,u,n),l=t.memoizedState),(s=No||os(t,r,s,n,d,l,c))?(h||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.flags|=4194308)):("function"===typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),a.props=n,a.state=l,a.context=c,n=s):("function"===typeof a.componentDidMount&&(t.flags|=4194308),n=!1)}else{a=t.stateNode,Fo(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:rs(t.type,s),a.props=c,h=t.pendingProps,d=a.context,"object"===typeof(l=r.contextType)&&null!==l?l=Mo(l):l=Mi(t,l=Ri(r)?Pi:ki.current);var p=r.getDerivedStateFromProps;(u="function"===typeof p||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==h||d!==l)&&ss(t,a,n,l),No=!1,d=t.memoizedState,a.state=d,Ho(t,n,a,i);var f=t.memoizedState;s!==h||d!==f||Ai.current||No?("function"===typeof p&&(ns(t,r,p,n),f=t.memoizedState),(c=No||os(t,r,c,n,d,f,l)||!1)?(u||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(n,f,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(n,f,l)),"function"===typeof a.componentDidUpdate&&(t.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=f),a.props=n,a.state=f,a.context=l,n=c):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),n=!1)}return ks(e,t,r,n,o,i)}function ks(e,t,r,n,i,o){Es(e,t);var a=0!==(128&t.flags);if(!n&&!a)return i&&zi(t,r,!1),Vs(e,t,o);n=t.stateNode,vs.current=t;var s=a&&"function"!==typeof r.getDerivedStateFromError?null:n.render();return t.flags|=1,null!==e&&a?(t.child=wo(t,e.child,null,o),t.child=wo(t,null,s,o)):bs(e,t,s,o),t.memoizedState=n.state,i&&zi(t,r,!0),t.child}function As(e){var t=e.stateNode;t.pendingContext?Li(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Li(0,t.context,!1),Yo(e,t.containerInfo)}function Ps(e,t,r,n,i){return fo(),mo(i),t.flags|=256,bs(e,t,r,n),t.child}var Ms,Rs,Os,Ls,Ds={dehydrated:null,treeContext:null,retryLane:0};function Ns(e){return{baseLanes:e,cachePool:null,transitions:null}}function zs(e,t,r){var n,i=t.pendingProps,a=ea.current,s=!1,l=0!==(128&t.flags);if((n=l)||(n=(null===e||null!==e.memoizedState)&&0!==(2&a)),n?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(a|=1),Ti(ea,1&a),null===e)return co(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=i.children,e=i.fallback,s?(i=t.mode,s=t.child,l={mode:"hidden",children:l},0===(1&i)&&null!==s?(s.childLanes=0,s.pendingProps=l):s=Nc(l,i,0,null),e=Dc(e,i,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Ns(r),t.memoizedState=Ds,e):Fs(t,l));if(null!==(a=e.memoizedState)&&null!==(n=a.dehydrated))return function(e,t,r,n,i,a,s){if(r)return 256&t.flags?(t.flags&=-257,Bs(e,t,s,n=us(Error(o(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(a=n.fallback,i=t.mode,n=Nc({mode:"visible",children:n.children},i,0,null),(a=Dc(a,i,s,null)).flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,0!==(1&t.mode)&&wo(t,e.child,null,s),t.child.memoizedState=Ns(s),t.memoizedState=Ds,a);if(0===(1&t.mode))return Bs(e,t,s,null);if("$!"===i.data){if(n=i.nextSibling&&i.nextSibling.dataset)var l=n.dgst;return n=l,Bs(e,t,s,n=us(a=Error(o(419)),n,void 0))}if(l=0!==(s&e.childLanes),_s||l){if(null!==(n=Al)){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(n.suspendedLanes|s))?0:i)&&i!==a.retryLane&&(a.retryLane=i,Do(e,i),rc(n,e,i,-1))}return mc(),Bs(e,t,s,n=us(Error(o(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=Ic.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,no=ci(i.nextSibling),ro=t,io=!0,oo=null,null!==e&&(Zi[Wi++]=Yi,Zi[Wi++]=Xi,Zi[Wi++]=$i,Yi=e.id,Xi=e.overflow,$i=t),t=Fs(t,n.children),t.flags|=4096,t)}(e,t,l,i,n,a,r);if(s){s=i.fallback,l=t.mode,n=(a=e.child).sibling;var c={mode:"hidden",children:i.children};return 0===(1&l)&&t.child!==a?((i=t.child).childLanes=0,i.pendingProps=c,t.deletions=null):(i=Oc(a,c)).subtreeFlags=14680064&a.subtreeFlags,null!==n?s=Oc(n,s):(s=Dc(s,l,r,null)).flags|=2,s.return=t,i.return=t,i.sibling=s,t.child=i,i=s,s=t.child,l=null===(l=e.child.memoizedState)?Ns(r):{baseLanes:l.baseLanes|r,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=e.childLanes&~r,t.memoizedState=Ds,i}return e=(s=e.child).sibling,i=Oc(s,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=r),i.return=t,i.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=i,t.memoizedState=null,i}function Fs(e,t){return(t=Nc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Bs(e,t,r,n){return null!==n&&mo(n),wo(t,e.child,null,r),(e=Fs(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Us(e,t,r){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),Ao(e.return,t,r)}function js(e,t,r,n,i){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=n,o.tail=r,o.tailMode=i)}function qs(e,t,r){var n=t.pendingProps,i=n.revealOrder,o=n.tail;if(bs(e,t,n.children,r),0!==(2&(n=ea.current)))n=1&n|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Us(e,r,t);else if(19===e.tag)Us(e,r,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Ti(ea,n),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;null!==r;)null!==(e=r.alternate)&&null===ta(e)&&(i=r),r=r.sibling;null===(r=i)?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),js(t,!1,i,r,o);break;case"backwards":for(r=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===ta(e)){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}js(t,!0,r,null,o);break;case"together":js(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Hs(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Vs(e,t,r){if(null!==e&&(t.dependencies=e.dependencies),Nl|=t.lanes,0===(r&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(r=Oc(e=t.child,e.pendingProps),t.child=r,r.return=t;null!==e.sibling;)e=e.sibling,(r=r.sibling=Oc(e,e.pendingProps)).return=t;r.sibling=null}return t.child}function Gs(e,t){if(!io)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;null!==t;)null!==t.alternate&&(r=t),t=t.sibling;null===r?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;null!==r;)null!==r.alternate&&(n=r),r=r.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Ks(e){var t=null!==e.alternate&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;null!==i;)r|=i.lanes|i.childLanes,n|=14680064&i.subtreeFlags,n|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Zs(e,t,r){var n=t.pendingProps;switch(to(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ks(t),null;case 1:case 17:return Ri(t.type)&&Oi(),Ks(t),null;case 3:return n=t.stateNode,Xo(),Ei(Ai),Ei(ki),na(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(ho(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==oo&&(ac(oo),oo=null))),Rs(e,t),Ks(t),null;case 5:Jo(t);var i=$o(Wo.current);if(r=t.type,null!==e&&null!=t.stateNode)Os(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(null===t.stateNode)throw Error(o(166));return Ks(t),null}if(e=$o(Ko.current),ho(t)){n=t.stateNode,r=t.type;var a=t.memoizedProps;switch(n[di]=t,n[pi]=a,e=0!==(1&t.mode),r){case"dialog":Bn("cancel",n),Bn("close",n);break;case"iframe":case"object":case"embed":Bn("load",n);break;case"video":case"audio":for(i=0;i<Dn.length;i++)Bn(Dn[i],n);break;case"source":Bn("error",n);break;case"img":case"image":case"link":Bn("error",n),Bn("load",n);break;case"details":Bn("toggle",n);break;case"input":Y(n,a),Bn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},Bn("invalid",n);break;case"textarea":ie(n,a),Bn("invalid",n)}for(var l in ve(r,a),i=null,a)if(a.hasOwnProperty(l)){var c=a[l];"children"===l?"string"===typeof c?n.textContent!==c&&(!0!==a.suppressHydrationWarning&&Qn(n.textContent,c,e),i=["children",c]):"number"===typeof c&&n.textContent!==""+c&&(!0!==a.suppressHydrationWarning&&Qn(n.textContent,c,e),i=["children",""+c]):s.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Bn("scroll",n)}switch(r){case"input":K(n),J(n,a,!0);break;case"textarea":K(n),ae(n);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(n.onclick=Jn)}n=i,t.updateQueue=n,null!==n&&(t.flags|=4)}else{l=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(r)),"http://www.w3.org/1999/xhtml"===e?"script"===r?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof n.is?e=l.createElement(r,{is:n.is}):(e=l.createElement(r),"select"===r&&(l=e,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):e=l.createElementNS(e,r),e[di]=t,e[pi]=n,Ms(e,t,!1,!1),t.stateNode=e;e:{switch(l=_e(r,n),r){case"dialog":Bn("cancel",e),Bn("close",e),i=n;break;case"iframe":case"object":case"embed":Bn("load",e),i=n;break;case"video":case"audio":for(i=0;i<Dn.length;i++)Bn(Dn[i],e);i=n;break;case"source":Bn("error",e),i=n;break;case"img":case"image":case"link":Bn("error",e),Bn("load",e),i=n;break;case"details":Bn("toggle",e),i=n;break;case"input":Y(e,n),i=$(e,n),Bn("invalid",e);break;case"option":default:i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=z({},n,{value:void 0}),Bn("invalid",e);break;case"textarea":ie(e,n),i=ne(e,n),Bn("invalid",e)}for(a in ve(r,i),c=i)if(c.hasOwnProperty(a)){var u=c[a];"style"===a?ge(e,u):"dangerouslySetInnerHTML"===a?null!=(u=u?u.__html:void 0)&&he(e,u):"children"===a?"string"===typeof u?("textarea"!==r||""!==u)&&de(e,u):"number"===typeof u&&de(e,""+u):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(s.hasOwnProperty(a)?null!=u&&"onScroll"===a&&Bn("scroll",e):null!=u&&_(e,a,u,l))}switch(r){case"input":K(e),J(e,n,!1);break;case"textarea":K(e),ae(e);break;case"option":null!=n.value&&e.setAttribute("value",""+V(n.value));break;case"select":e.multiple=!!n.multiple,null!=(a=n.value)?re(e,!!n.multiple,a,!1):null!=n.defaultValue&&re(e,!!n.multiple,n.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=Jn)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ks(t),null;case 6:if(e&&null!=t.stateNode)Ls(e,t,e.memoizedProps,n);else{if("string"!==typeof n&&null===t.stateNode)throw Error(o(166));if(r=$o(Wo.current),$o(Ko.current),ho(t)){if(n=t.stateNode,r=t.memoizedProps,n[di]=t,(a=n.nodeValue!==r)&&null!==(e=ro))switch(e.tag){case 3:Qn(n.nodeValue,r,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Qn(n.nodeValue,r,0!==(1&e.mode))}a&&(t.flags|=4)}else(n=(9===r.nodeType?r:r.ownerDocument).createTextNode(n))[di]=t,t.stateNode=n}return Ks(t),null;case 13:if(Ei(ea),n=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(io&&null!==no&&0!==(1&t.mode)&&0===(128&t.flags))po(),fo(),t.flags|=98560,a=!1;else if(a=ho(t),null!==n&&null!==n.dehydrated){if(null===e){if(!a)throw Error(o(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(o(317));a[di]=t}else fo(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ks(t),a=!1}else null!==oo&&(ac(oo),oo=null),a=!0;if(!a)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=r,t):((n=null!==n)!==(null!==e&&null!==e.memoizedState)&&n&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&ea.current)?0===Ll&&(Ll=3):mc())),null!==t.updateQueue&&(t.flags|=4),Ks(t),null);case 4:return Xo(),Rs(e,t),null===e&&qn(t.stateNode.containerInfo),Ks(t),null;case 10:return ko(t.type._context),Ks(t),null;case 19:if(Ei(ea),null===(a=t.memoizedState))return Ks(t),null;if(n=0!==(128&t.flags),null===(l=a.rendering))if(n)Gs(a,!1);else{if(0!==Ll||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ta(e))){for(t.flags|=128,Gs(a,!1),null!==(n=l.updateQueue)&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;null!==r;)e=n,(a=r).flags&=14680066,null===(l=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,e=l.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Ti(ea,1&ea.current|2),t.child}e=e.sibling}null!==a.tail&&Xe()>ql&&(t.flags|=128,n=!0,Gs(a,!1),t.lanes=4194304)}else{if(!n)if(null!==(e=ta(l))){if(t.flags|=128,n=!0,null!==(r=e.updateQueue)&&(t.updateQueue=r,t.flags|=4),Gs(a,!0),null===a.tail&&"hidden"===a.tailMode&&!l.alternate&&!io)return Ks(t),null}else 2*Xe()-a.renderingStartTime>ql&&1073741824!==r&&(t.flags|=128,n=!0,Gs(a,!1),t.lanes=4194304);a.isBackwards?(l.sibling=t.child,t.child=l):(null!==(r=a.last)?r.sibling=l:t.child=l,a.last=l)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Xe(),t.sibling=null,r=ea.current,Ti(ea,n?1&r|2:1&r),t):(Ks(t),null);case 22:case 23:return hc(),n=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==n&&(t.flags|=8192),n&&0!==(1&t.mode)?0!==(1073741824&Rl)&&(Ks(t),6&t.subtreeFlags&&(t.flags|=8192)):Ks(t),null;case 24:case 25:return null}throw Error(o(156,t.tag))}function Ws(e,t){switch(to(t),t.tag){case 1:return Ri(t.type)&&Oi(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Xo(),Ei(Ai),Ei(ki),na(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Jo(t),null;case 13:if(Ei(ea),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(o(340));fo()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ei(ea),null;case 4:return Xo(),null;case 10:return ko(t.type._context),null;case 22:case 23:return hc(),null;default:return null}}Ms=function(e,t){for(var r=t.child;null!==r;){if(5===r.tag||6===r.tag)e.appendChild(r.stateNode);else if(4!==r.tag&&null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}},Rs=function(){},Os=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,$o(Ko.current);var o,a=null;switch(r){case"input":i=$(e,i),n=$(e,n),a=[];break;case"select":i=z({},i,{value:void 0}),n=z({},n,{value:void 0}),a=[];break;case"textarea":i=ne(e,i),n=ne(e,n),a=[];break;default:"function"!==typeof i.onClick&&"function"===typeof n.onClick&&(e.onclick=Jn)}for(u in ve(r,n),r=null,i)if(!n.hasOwnProperty(u)&&i.hasOwnProperty(u)&&null!=i[u])if("style"===u){var l=i[u];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(s.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in n){var c=n[u];if(l=null!=i?i[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(a||(a=[]),a.push(u,r)),r=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(a=a||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(a=a||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(s.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Bn("scroll",e),a||l===c||(a=[])):(a=a||[]).push(u,c))}r&&(a=a||[]).push("style",r);var u=a;(t.updateQueue=u)&&(t.flags|=4)}},Ls=function(e,t,r,n){r!==n&&(t.flags|=4)};var $s=!1,Ys=!1,Xs="function"===typeof WeakSet?WeakSet:Set,Qs=null;function Js(e,t){var r=e.ref;if(null!==r)if("function"===typeof r)try{r(null)}catch(n){Sc(e,t,n)}else r.current=null}function el(e,t,r){try{r()}catch(n){Sc(e,t,n)}}var tl=!1;function rl(e,t,r){var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var i=n=n.next;do{if((i.tag&e)===e){var o=i.destroy;i.destroy=void 0,void 0!==o&&el(t,r,o)}i=i.next}while(i!==n)}}function nl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function il(e){var t=e.ref;if(null!==t){var r=e.stateNode;e.tag,e=r,"function"===typeof t?t(e):t.current=e}}function ol(e){var t=e.alternate;null!==t&&(e.alternate=null,ol(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[di],delete t[pi],delete t[mi],delete t[gi],delete t[yi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function al(e){return 5===e.tag||3===e.tag||4===e.tag}function sl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||al(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?8===r.nodeType?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(8===r.nodeType?(t=r.parentNode).insertBefore(e,r):(t=r).appendChild(e),null!==(r=r._reactRootContainer)&&void 0!==r||null!==t.onclick||(t.onclick=Jn));else if(4!==n&&null!==(e=e.child))for(ll(e,t,r),e=e.sibling;null!==e;)ll(e,t,r),e=e.sibling}function cl(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(4!==n&&null!==(e=e.child))for(cl(e,t,r),e=e.sibling;null!==e;)cl(e,t,r),e=e.sibling}var ul=null,hl=!1;function dl(e,t,r){for(r=r.child;null!==r;)pl(e,t,r),r=r.sibling}function pl(e,t,r){if(ot&&"function"===typeof ot.onCommitFiberUnmount)try{ot.onCommitFiberUnmount(it,r)}catch(s){}switch(r.tag){case 5:Ys||Js(r,t);case 6:var n=ul,i=hl;ul=null,dl(e,t,r),hl=i,null!==(ul=n)&&(hl?(e=ul,r=r.stateNode,8===e.nodeType?e.parentNode.removeChild(r):e.removeChild(r)):ul.removeChild(r.stateNode));break;case 18:null!==ul&&(hl?(e=ul,r=r.stateNode,8===e.nodeType?li(e.parentNode,r):1===e.nodeType&&li(e,r),qt(e)):li(ul,r.stateNode));break;case 4:n=ul,i=hl,ul=r.stateNode.containerInfo,hl=!0,dl(e,t,r),ul=n,hl=i;break;case 0:case 11:case 14:case 15:if(!Ys&&(null!==(n=r.updateQueue)&&null!==(n=n.lastEffect))){i=n=n.next;do{var o=i,a=o.destroy;o=o.tag,void 0!==a&&(0!==(2&o)||0!==(4&o))&&el(r,t,a),i=i.next}while(i!==n)}dl(e,t,r);break;case 1:if(!Ys&&(Js(r,t),"function"===typeof(n=r.stateNode).componentWillUnmount))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(s){Sc(r,t,s)}dl(e,t,r);break;case 21:dl(e,t,r);break;case 22:1&r.mode?(Ys=(n=Ys)||null!==r.memoizedState,dl(e,t,r),Ys=n):dl(e,t,r);break;default:dl(e,t,r)}}function fl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var r=e.stateNode;null===r&&(r=e.stateNode=new Xs),t.forEach((function(t){var n=kc.bind(null,e,t);r.has(t)||(r.add(t),t.then(n,n))}))}}function ml(e,t){var r=t.deletions;if(null!==r)for(var n=0;n<r.length;n++){var i=r[n];try{var a=e,s=t,l=s;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,hl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,hl=!0;break e}l=l.return}if(null===ul)throw Error(o(160));pl(a,s,i),ul=null,hl=!1;var c=i.alternate;null!==c&&(c.return=null),i.return=null}catch(u){Sc(i,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),yl(e),4&n){try{rl(3,e,e.return),nl(3,e)}catch(g){Sc(e,e.return,g)}try{rl(5,e,e.return)}catch(g){Sc(e,e.return,g)}}break;case 1:ml(t,e),yl(e),512&n&&null!==r&&Js(r,r.return);break;case 5:if(ml(t,e),yl(e),512&n&&null!==r&&Js(r,r.return),32&e.flags){var i=e.stateNode;try{de(i,"")}catch(g){Sc(e,e.return,g)}}if(4&n&&null!=(i=e.stateNode)){var a=e.memoizedProps,s=null!==r?r.memoizedProps:a,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===a.type&&null!=a.name&&X(i,a),_e(l,s);var u=_e(l,a);for(s=0;s<c.length;s+=2){var h=c[s],d=c[s+1];"style"===h?ge(i,d):"dangerouslySetInnerHTML"===h?he(i,d):"children"===h?de(i,d):_(i,h,d,u)}switch(l){case"input":Q(i,a);break;case"textarea":oe(i,a);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var f=a.value;null!=f?re(i,!!a.multiple,f,!1):p!==!!a.multiple&&(null!=a.defaultValue?re(i,!!a.multiple,a.defaultValue,!0):re(i,!!a.multiple,a.multiple?[]:"",!1))}i[pi]=a}catch(g){Sc(e,e.return,g)}}break;case 6:if(ml(t,e),yl(e),4&n){if(null===e.stateNode)throw Error(o(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(g){Sc(e,e.return,g)}}break;case 3:if(ml(t,e),yl(e),4&n&&null!==r&&r.memoizedState.isDehydrated)try{qt(t.containerInfo)}catch(g){Sc(e,e.return,g)}break;case 4:default:ml(t,e),yl(e);break;case 13:ml(t,e),yl(e),8192&(i=e.child).flags&&(a=null!==i.memoizedState,i.stateNode.isHidden=a,!a||null!==i.alternate&&null!==i.alternate.memoizedState||(jl=Xe())),4&n&&fl(e);break;case 22:if(h=null!==r&&null!==r.memoizedState,1&e.mode?(Ys=(u=Ys)||h,ml(t,e),Ys=u):ml(t,e),yl(e),8192&n){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!h&&0!==(1&e.mode))for(Qs=e,h=e.child;null!==h;){for(d=Qs=h;null!==Qs;){switch(f=(p=Qs).child,p.tag){case 0:case 11:case 14:case 15:rl(4,p,p.return);break;case 1:Js(p,p.return);var m=p.stateNode;if("function"===typeof m.componentWillUnmount){n=p,r=p.return;try{t=n,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Sc(n,r,g)}}break;case 5:Js(p,p.return);break;case 22:if(null!==p.memoizedState){wl(d);continue}}null!==f?(f.return=p,Qs=f):wl(d)}h=h.sibling}e:for(h=null,d=e;;){if(5===d.tag){if(null===h){h=d;try{i=d.stateNode,u?"function"===typeof(a=i.style).setProperty?a.setProperty("display","none","important"):a.display="none":(l=d.stateNode,s=void 0!==(c=d.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=me("display",s))}catch(g){Sc(e,e.return,g)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(g){Sc(e,e.return,g)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:ml(t,e),yl(e),4&n&&fl(e);case 21:}}function yl(e){var t=e.flags;if(2&t){try{e:{for(var r=e.return;null!==r;){if(al(r)){var n=r;break e}r=r.return}throw Error(o(160))}switch(n.tag){case 5:var i=n.stateNode;32&n.flags&&(de(i,""),n.flags&=-33),cl(e,sl(e),i);break;case 3:case 4:var a=n.stateNode.containerInfo;ll(e,sl(e),a);break;default:throw Error(o(161))}}catch(s){Sc(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function vl(e,t,r){Qs=e,_l(e,t,r)}function _l(e,t,r){for(var n=0!==(1&e.mode);null!==Qs;){var i=Qs,o=i.child;if(22===i.tag&&n){var a=null!==i.memoizedState||$s;if(!a){var s=i.alternate,l=null!==s&&null!==s.memoizedState||Ys;s=$s;var c=Ys;if($s=a,(Ys=l)&&!c)for(Qs=i;null!==Qs;)l=(a=Qs).child,22===a.tag&&null!==a.memoizedState?xl(i):null!==l?(l.return=a,Qs=l):xl(i);for(;null!==o;)Qs=o,_l(o,t,r),o=o.sibling;Qs=i,$s=s,Ys=c}bl(e)}else 0!==(8772&i.subtreeFlags)&&null!==o?(o.return=i,Qs=o):bl(e)}}function bl(e){for(;null!==Qs;){var t=Qs;if(0!==(8772&t.flags)){var r=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Ys||nl(5,t);break;case 1:var n=t.stateNode;if(4&t.flags&&!Ys)if(null===r)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:rs(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;null!==a&&Vo(t,a,n);break;case 3:var s=t.updateQueue;if(null!==s){if(r=null,null!==t.child)switch(t.child.tag){case 5:case 1:r=t.child.stateNode}Vo(t,s,r)}break;case 5:var l=t.stateNode;if(null===r&&4&t.flags){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var h=u.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&qt(d)}}}break;default:throw Error(o(163))}Ys||512&t.flags&&il(t)}catch(p){Sc(t,t.return,p)}}if(t===e){Qs=null;break}if(null!==(r=t.sibling)){r.return=t.return,Qs=r;break}Qs=t.return}}function wl(e){for(;null!==Qs;){var t=Qs;if(t===e){Qs=null;break}var r=t.sibling;if(null!==r){r.return=t.return,Qs=r;break}Qs=t.return}}function xl(e){for(;null!==Qs;){var t=Qs;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{nl(4,t)}catch(l){Sc(t,r,l)}break;case 1:var n=t.stateNode;if("function"===typeof n.componentDidMount){var i=t.return;try{n.componentDidMount()}catch(l){Sc(t,i,l)}}var o=t.return;try{il(t)}catch(l){Sc(t,o,l)}break;case 5:var a=t.return;try{il(t)}catch(l){Sc(t,a,l)}}}catch(l){Sc(t,t.return,l)}if(t===e){Qs=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Qs=s;break}Qs=t.return}}var Cl,Sl=Math.ceil,El=b.ReactCurrentDispatcher,Tl=b.ReactCurrentOwner,Il=b.ReactCurrentBatchConfig,kl=0,Al=null,Pl=null,Ml=0,Rl=0,Ol=Si(0),Ll=0,Dl=null,Nl=0,zl=0,Fl=0,Bl=null,Ul=null,jl=0,ql=1/0,Hl=null,Vl=!1,Gl=null,Kl=null,Zl=!1,Wl=null,$l=0,Yl=0,Xl=null,Ql=-1,Jl=0;function ec(){return 0!==(6&kl)?Xe():-1!==Ql?Ql:Ql=Xe()}function tc(e){return 0===(1&e.mode)?1:0!==(2&kl)&&0!==Ml?Ml&-Ml:null!==go.transition?(0===Jl&&(Jl=mt()),Jl):0!==(e=_t)?e:e=void 0===(e=window.event)?16:Yt(e.type)}function rc(e,t,r,n){if(50<Yl)throw Yl=0,Xl=null,Error(o(185));yt(e,r,n),0!==(2&kl)&&e===Al||(e===Al&&(0===(2&kl)&&(zl|=r),4===Ll&&sc(e,Ml)),nc(e,n),1===r&&0===kl&&0===(1&t.mode)&&(ql=Xe()+500,Bi&&qi()))}function nc(e,t){var r=e.callbackNode;!function(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,o=e.pendingLanes;0<o;){var a=31-at(o),s=1<<a,l=i[a];-1===l?0!==(s&r)&&0===(s&n)||(i[a]=pt(s,t)):l<=t&&(e.expiredLanes|=s),o&=~s}}(e,t);var n=dt(e,e===Al?Ml:0);if(0===n)null!==r&&We(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(null!=r&&We(r),1===t)0===e.tag?function(e){Bi=!0,ji(e)}(lc.bind(null,e)):ji(lc.bind(null,e)),ai((function(){0===(6&kl)&&qi()})),r=null;else{switch(bt(n)){case 1:r=Je;break;case 4:r=et;break;case 16:default:r=tt;break;case 536870912:r=nt}r=Ac(r,ic.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function ic(e,t){if(Ql=-1,Jl=0,0!==(6&kl))throw Error(o(327));var r=e.callbackNode;if(xc()&&e.callbackNode!==r)return null;var n=dt(e,e===Al?Ml:0);if(0===n)return null;if(0!==(30&n)||0!==(n&e.expiredLanes)||t)t=gc(e,n);else{t=n;var i=kl;kl|=2;var a=fc();for(Al===e&&Ml===t||(Hl=null,ql=Xe()+500,dc(e,t));;)try{vc();break}catch(l){pc(e,l)}Io(),El.current=a,kl=i,null!==Pl?t=0:(Al=null,Ml=0,t=Ll)}if(0!==t){if(2===t&&(0!==(i=ft(e))&&(n=i,t=oc(e,i))),1===t)throw r=Dl,dc(e,0),sc(e,n),nc(e,Xe()),r;if(6===t)sc(e,n);else{if(i=e.current.alternate,0===(30&n)&&!function(e){for(var t=e;;){if(16384&t.flags){var r=t.updateQueue;if(null!==r&&null!==(r=r.stores))for(var n=0;n<r.length;n++){var i=r[n],o=i.getSnapshot;i=i.value;try{if(!sn(o(),i))return!1}catch(s){return!1}}}if(r=t.child,16384&t.subtreeFlags&&null!==r)r.return=t,t=r;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=gc(e,n))&&(0!==(a=ft(e))&&(n=a,t=oc(e,a))),1===t))throw r=Dl,dc(e,0),sc(e,n),nc(e,Xe()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(o(345));case 2:case 5:wc(e,Ul,Hl);break;case 3:if(sc(e,n),(130023424&n)===n&&10<(t=jl+500-Xe())){if(0!==dt(e,0))break;if(((i=e.suspendedLanes)&n)!==n){ec(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ni(wc.bind(null,e,Ul,Hl),t);break}wc(e,Ul,Hl);break;case 4:if(sc(e,n),(4194240&n)===n)break;for(t=e.eventTimes,i=-1;0<n;){var s=31-at(n);a=1<<s,(s=t[s])>i&&(i=s),n&=~a}if(n=i,10<(n=(120>(n=Xe()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Sl(n/1960))-n)){e.timeoutHandle=ni(wc.bind(null,e,Ul,Hl),n);break}wc(e,Ul,Hl);break;default:throw Error(o(329))}}}return nc(e,Xe()),e.callbackNode===r?ic.bind(null,e):null}function oc(e,t){var r=Bl;return e.current.memoizedState.isDehydrated&&(dc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=Ul,Ul=r,null!==t&&ac(t)),e}function ac(e){null===Ul?Ul=e:Ul.push.apply(Ul,e)}function sc(e,t){for(t&=~Fl,t&=~zl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-at(t),n=1<<r;e[r]=-1,t&=~n}}function lc(e){if(0!==(6&kl))throw Error(o(327));xc();var t=dt(e,0);if(0===(1&t))return nc(e,Xe()),null;var r=gc(e,t);if(0!==e.tag&&2===r){var n=ft(e);0!==n&&(t=n,r=oc(e,n))}if(1===r)throw r=Dl,dc(e,0),sc(e,t),nc(e,Xe()),r;if(6===r)throw Error(o(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wc(e,Ul,Hl),nc(e,Xe()),null}function cc(e,t){var r=kl;kl|=1;try{return e(t)}finally{0===(kl=r)&&(ql=Xe()+500,Bi&&qi())}}function uc(e){null!==Wl&&0===Wl.tag&&0===(6&kl)&&xc();var t=kl;kl|=1;var r=Il.transition,n=_t;try{if(Il.transition=null,_t=1,e)return e()}finally{_t=n,Il.transition=r,0===(6&(kl=t))&&qi()}}function hc(){Rl=Ol.current,Ei(Ol)}function dc(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(-1!==r&&(e.timeoutHandle=-1,ii(r)),null!==Pl)for(r=Pl.return;null!==r;){var n=r;switch(to(n),n.tag){case 1:null!==(n=n.type.childContextTypes)&&void 0!==n&&Oi();break;case 3:Xo(),Ei(Ai),Ei(ki),na();break;case 5:Jo(n);break;case 4:Xo();break;case 13:case 19:Ei(ea);break;case 10:ko(n.type._context);break;case 22:case 23:hc()}r=r.return}if(Al=e,Pl=e=Oc(e.current,null),Ml=Rl=t,Ll=0,Dl=null,Fl=zl=Nl=0,Ul=Bl=null,null!==Ro){for(t=0;t<Ro.length;t++)if(null!==(n=(r=Ro[t]).interleaved)){r.interleaved=null;var i=n.next,o=r.pending;if(null!==o){var a=o.next;o.next=i,n.next=a}r.pending=n}Ro=null}return e}function pc(e,t){for(;;){var r=Pl;try{if(Io(),ia.current=Qa,ua){for(var n=sa.memoizedState;null!==n;){var i=n.queue;null!==i&&(i.pending=null),n=n.next}ua=!1}if(aa=0,ca=la=sa=null,ha=!1,da=0,Tl.current=null,null===r||null===r.return){Ll=1,Dl=t,Pl=null;break}e:{var a=e,s=r.return,l=r,c=t;if(t=Ml,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,h=l,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var f=gs(s);if(null!==f){f.flags&=-257,ys(f,s,l,0,t),1&f.mode&&ms(a,u,t),c=u;var m=(t=f).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(0===(1&t)){ms(a,u,t),mc();break e}c=Error(o(426))}else if(io&&1&l.mode){var y=gs(s);if(null!==y){0===(65536&y.flags)&&(y.flags|=256),ys(y,s,l,0,t),mo(cs(c,l));break e}}a=c=cs(c,l),4!==Ll&&(Ll=2),null===Bl?Bl=[a]:Bl.push(a),a=s;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t,qo(a,ps(0,c,t));break e;case 1:l=c;var v=a.type,_=a.stateNode;if(0===(128&a.flags)&&("function"===typeof v.getDerivedStateFromError||null!==_&&"function"===typeof _.componentDidCatch&&(null===Kl||!Kl.has(_)))){a.flags|=65536,t&=-t,a.lanes|=t,qo(a,fs(a,l,t));break e}}a=a.return}while(null!==a)}bc(r)}catch(b){t=b,Pl===r&&null!==r&&(Pl=r=r.return);continue}break}}function fc(){var e=El.current;return El.current=Qa,null===e?Qa:e}function mc(){0!==Ll&&3!==Ll&&2!==Ll||(Ll=4),null===Al||0===(268435455&Nl)&&0===(268435455&zl)||sc(Al,Ml)}function gc(e,t){var r=kl;kl|=2;var n=fc();for(Al===e&&Ml===t||(Hl=null,dc(e,t));;)try{yc();break}catch(i){pc(e,i)}if(Io(),kl=r,El.current=n,null!==Pl)throw Error(o(261));return Al=null,Ml=0,Ll}function yc(){for(;null!==Pl;)_c(Pl)}function vc(){for(;null!==Pl&&!$e();)_c(Pl)}function _c(e){var t=Cl(e.alternate,e,Rl);e.memoizedProps=e.pendingProps,null===t?bc(e):Pl=t,Tl.current=null}function bc(e){var t=e;do{var r=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(r=Zs(r,t,Rl)))return void(Pl=r)}else{if(null!==(r=Ws(r,t)))return r.flags&=32767,void(Pl=r);if(null===e)return Ll=6,void(Pl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Pl=t);Pl=t=e}while(null!==t);0===Ll&&(Ll=5)}function wc(e,t,r){var n=_t,i=Il.transition;try{Il.transition=null,_t=1,function(e,t,r,n){do{xc()}while(null!==Wl);if(0!==(6&kl))throw Error(o(327));r=e.finishedWork;var i=e.finishedLanes;if(null===r)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(o(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(function(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-at(r),o=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~o}}(e,a),e===Al&&(Pl=Al=null,Ml=0),0===(2064&r.subtreeFlags)&&0===(2064&r.flags)||Zl||(Zl=!0,Ac(tt,(function(){return xc(),null}))),a=0!==(15990&r.flags),0!==(15990&r.subtreeFlags)||a){a=Il.transition,Il.transition=null;var s=_t;_t=1;var l=kl;kl|=4,Tl.current=null,function(e,t){if(ei=Vt,pn(e=dn())){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(r=(r=e.ownerDocument)&&r.defaultView||window).getSelection&&r.getSelection();if(n&&0!==n.rangeCount){r=n.anchorNode;var i=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch(w){r=null;break e}var s=0,l=-1,c=-1,u=0,h=0,d=e,p=null;t:for(;;){for(var f;d!==r||0!==i&&3!==d.nodeType||(l=s+i),d!==a||0!==n&&3!==d.nodeType||(c=s+n),3===d.nodeType&&(s+=d.nodeValue.length),null!==(f=d.firstChild);)p=d,d=f;for(;;){if(d===e)break t;if(p===r&&++u===i&&(l=s),p===a&&++h===n&&(c=s),null!==(f=d.nextSibling))break;p=(d=p).parentNode}d=f}r=-1===l||-1===c?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(ti={focusedElem:e,selectionRange:r},Vt=!1,Qs=t;null!==Qs;)if(e=(t=Qs).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Qs=e;else for(;null!==Qs;){t=Qs;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,y=m.memoizedState,v=t.stateNode,_=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:rs(t.type,g),y);v.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var b=t.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(o(163))}}catch(w){Sc(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Qs=e;break}Qs=t.return}m=tl,tl=!1}(e,r),gl(r,e),fn(ti),Vt=!!ei,ti=ei=null,e.current=r,vl(r,e,i),Ye(),kl=l,_t=s,Il.transition=a}else e.current=r;if(Zl&&(Zl=!1,Wl=e,$l=i),a=e.pendingLanes,0===a&&(Kl=null),function(e){if(ot&&"function"===typeof ot.onCommitFiberRoot)try{ot.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(r.stateNode),nc(e,Xe()),null!==t)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Vl)throw Vl=!1,e=Gl,Gl=null,e;0!==(1&$l)&&0!==e.tag&&xc(),a=e.pendingLanes,0!==(1&a)?e===Xl?Yl++:(Yl=0,Xl=e):Yl=0,qi()}(e,t,r,n)}finally{Il.transition=i,_t=n}return null}function xc(){if(null!==Wl){var e=bt($l),t=Il.transition,r=_t;try{if(Il.transition=null,_t=16>e?16:e,null===Wl)var n=!1;else{if(e=Wl,Wl=null,$l=0,0!==(6&kl))throw Error(o(331));var i=kl;for(kl|=4,Qs=e.current;null!==Qs;){var a=Qs,s=a.child;if(0!==(16&Qs.flags)){var l=a.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Qs=u;null!==Qs;){var h=Qs;switch(h.tag){case 0:case 11:case 15:rl(8,h,a)}var d=h.child;if(null!==d)d.return=h,Qs=d;else for(;null!==Qs;){var p=(h=Qs).sibling,f=h.return;if(ol(h),h===u){Qs=null;break}if(null!==p){p.return=f,Qs=p;break}Qs=f}}}var m=a.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(null!==g)}}Qs=a}}if(0!==(2064&a.subtreeFlags)&&null!==s)s.return=a,Qs=s;else e:for(;null!==Qs;){if(0!==(2048&(a=Qs).flags))switch(a.tag){case 0:case 11:case 15:rl(9,a,a.return)}var v=a.sibling;if(null!==v){v.return=a.return,Qs=v;break e}Qs=a.return}}var _=e.current;for(Qs=_;null!==Qs;){var b=(s=Qs).child;if(0!==(2064&s.subtreeFlags)&&null!==b)b.return=s,Qs=b;else e:for(s=_;null!==Qs;){if(0!==(2048&(l=Qs).flags))try{switch(l.tag){case 0:case 11:case 15:nl(9,l)}}catch(x){Sc(l,l.return,x)}if(l===s){Qs=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,Qs=w;break e}Qs=l.return}}if(kl=i,qi(),ot&&"function"===typeof ot.onPostCommitFiberRoot)try{ot.onPostCommitFiberRoot(it,e)}catch(x){}n=!0}return n}finally{_t=r,Il.transition=t}}return!1}function Cc(e,t,r){e=Uo(e,t=ps(0,t=cs(r,t),1),1),t=ec(),null!==e&&(yt(e,1,t),nc(e,t))}function Sc(e,t,r){if(3===e.tag)Cc(e,e,r);else for(;null!==t;){if(3===t.tag){Cc(t,e,r);break}if(1===t.tag){var n=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof n.componentDidCatch&&(null===Kl||!Kl.has(n))){t=Uo(t,e=fs(t,e=cs(r,e),1),1),e=ec(),null!==t&&(yt(t,1,e),nc(t,e));break}}t=t.return}}function Ec(e,t,r){var n=e.pingCache;null!==n&&n.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&r,Al===e&&(Ml&r)===r&&(4===Ll||3===Ll&&(130023424&Ml)===Ml&&500>Xe()-jl?dc(e,0):Fl|=r),nc(e,t)}function Tc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var r=ec();null!==(e=Do(e,t))&&(yt(e,t,r),nc(e,r))}function Ic(e){var t=e.memoizedState,r=0;null!==t&&(r=t.retryLane),Tc(e,r)}function kc(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;null!==i&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(o(314))}null!==n&&n.delete(t),Tc(e,r)}function Ac(e,t){return Ze(e,t)}function Pc(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Mc(e,t,r,n){return new Pc(e,t,r,n)}function Rc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Oc(e,t){var r=e.alternate;return null===r?((r=Mc(e.tag,t,e.key,e.mode)).elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=14680064&e.flags,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Lc(e,t,r,n,i,a){var s=2;if(n=e,"function"===typeof e)Rc(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case C:return Dc(r.children,i,a,t);case S:s=8,i|=8;break;case E:return(e=Mc(12,r,t,2|i)).elementType=E,e.lanes=a,e;case A:return(e=Mc(13,r,t,i)).elementType=A,e.lanes=a,e;case P:return(e=Mc(19,r,t,i)).elementType=P,e.lanes=a,e;case O:return Nc(r,i,a,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case T:s=10;break e;case I:s=9;break e;case k:s=11;break e;case M:s=14;break e;case R:s=16,n=null;break e}throw Error(o(130,null==e?e:typeof e,""))}return(t=Mc(s,r,t,i)).elementType=e,t.type=n,t.lanes=a,t}function Dc(e,t,r,n){return(e=Mc(7,e,n,t)).lanes=r,e}function Nc(e,t,r,n){return(e=Mc(22,e,n,t)).elementType=O,e.lanes=r,e.stateNode={isHidden:!1},e}function zc(e,t,r){return(e=Mc(6,e,null,t)).lanes=r,e}function Fc(e,t,r){return(t=Mc(4,null!==e.children?e.children:[],e.key,t)).lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Bc(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Uc(e,t,r,n,i,o,a,s,l){return e=new Bc(e,t,r,s,l),1===t?(t=1,!0===o&&(t|=8)):t=0,o=Mc(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},zo(o),e}function jc(e){if(!e)return Ii;e:{if(qe(e=e._reactInternals)!==e||1!==e.tag)throw Error(o(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ri(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(o(171))}if(1===e.tag){var r=e.type;if(Ri(r))return Di(e,r,t)}return t}function qc(e,t,r,n,i,o,a,s,l){return(e=Uc(r,n,!0,e,0,o,0,s,l)).context=jc(null),r=e.current,(o=Bo(n=ec(),i=tc(r))).callback=void 0!==t&&null!==t?t:null,Uo(r,o,i),e.current.lanes=i,yt(e,i,n),nc(e,n),e}function Hc(e,t,r,n){var i=t.current,o=ec(),a=tc(i);return r=jc(r),null===t.context?t.context=r:t.pendingContext=r,(t=Bo(o,a)).payload={element:e},null!==(n=void 0===n?null:n)&&(t.callback=n),null!==(e=Uo(i,t,a))&&(rc(e,i,a,o),jo(e,i,a)),a}function Vc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Gc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var r=e.retryLane;e.retryLane=0!==r&&r<t?r:t}}function Kc(e,t){Gc(e,t),(e=e.alternate)&&Gc(e,t)}Cl=function(e,t,r){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ai.current)_s=!0;else{if(0===(e.lanes&r)&&0===(128&t.flags))return _s=!1,function(e,t,r){switch(t.tag){case 3:As(t),fo();break;case 5:Qo(t);break;case 1:Ri(t.type)&&Ni(t);break;case 4:Yo(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;Ti(Co,n._currentValue),n._currentValue=i;break;case 13:if(null!==(n=t.memoizedState))return null!==n.dehydrated?(Ti(ea,1&ea.current),t.flags|=128,null):0!==(r&t.child.childLanes)?zs(e,t,r):(Ti(ea,1&ea.current),null!==(e=Vs(e,t,r))?e.sibling:null);Ti(ea,1&ea.current);break;case 19:if(n=0!==(r&t.childLanes),0!==(128&e.flags)){if(n)return qs(e,t,r);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ti(ea,ea.current),n)break;return null;case 22:case 23:return t.lanes=0,Ss(e,t,r)}return Vs(e,t,r)}(e,t,r);_s=0!==(131072&e.flags)}else _s=!1,io&&0!==(1048576&t.flags)&&Ji(t,Ki,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Hs(e,t),e=t.pendingProps;var i=Mi(t,ki.current);Po(t,r),i=ga(null,t,n,e,i,r);var a=ya();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ri(n)?(a=!0,Ni(t)):a=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,zo(t),i.updater=is,t.stateNode=i,i._reactInternals=t,ls(t,n,e,r),t=ks(null,t,n,!0,a,r)):(t.tag=0,io&&a&&eo(t),bs(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Hs(e,t),e=t.pendingProps,n=(i=n._init)(n._payload),t.type=n,i=t.tag=function(e){if("function"===typeof e)return Rc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===k)return 11;if(e===M)return 14}return 2}(n),e=rs(n,e),i){case 0:t=Ts(null,t,n,e,r);break e;case 1:t=Is(null,t,n,e,r);break e;case 11:t=ws(null,t,n,e,r);break e;case 14:t=xs(null,t,n,rs(n.type,e),r);break e}throw Error(o(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,Ts(e,t,n,i=t.elementType===n?i:rs(n,i),r);case 1:return n=t.type,i=t.pendingProps,Is(e,t,n,i=t.elementType===n?i:rs(n,i),r);case 3:e:{if(As(t),null===e)throw Error(o(387));n=t.pendingProps,i=(a=t.memoizedState).element,Fo(e,t),Ho(t,n,null,r);var s=t.memoizedState;if(n=s.element,a.isDehydrated){if(a={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=Ps(e,t,n,r,i=cs(Error(o(423)),t));break e}if(n!==i){t=Ps(e,t,n,r,i=cs(Error(o(424)),t));break e}for(no=ci(t.stateNode.containerInfo.firstChild),ro=t,io=!0,oo=null,r=xo(t,null,n,r),t.child=r;r;)r.flags=-3&r.flags|4096,r=r.sibling}else{if(fo(),n===i){t=Vs(e,t,r);break e}bs(e,t,n,r)}t=t.child}return t;case 5:return Qo(t),null===e&&co(t),n=t.type,i=t.pendingProps,a=null!==e?e.memoizedProps:null,s=i.children,ri(n,i)?s=null:null!==a&&ri(n,a)&&(t.flags|=32),Es(e,t),bs(e,t,s,r),t.child;case 6:return null===e&&co(t),null;case 13:return zs(e,t,r);case 4:return Yo(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=wo(t,null,n,r):bs(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,ws(e,t,n,i=t.elementType===n?i:rs(n,i),r);case 7:return bs(e,t,t.pendingProps,r),t.child;case 8:case 12:return bs(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,a=t.memoizedProps,s=i.value,Ti(Co,n._currentValue),n._currentValue=s,null!==a)if(sn(a.value,s)){if(a.children===i.children&&!Ai.current){t=Vs(e,t,r);break e}}else for(null!==(a=t.child)&&(a.return=t);null!==a;){var l=a.dependencies;if(null!==l){s=a.child;for(var c=l.firstContext;null!==c;){if(c.context===n){if(1===a.tag){(c=Bo(-1,r&-r)).tag=2;var u=a.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}a.lanes|=r,null!==(c=a.alternate)&&(c.lanes|=r),Ao(a.return,r,t),l.lanes|=r;break}c=c.next}}else if(10===a.tag)s=a.type===t.type?null:a.child;else if(18===a.tag){if(null===(s=a.return))throw Error(o(341));s.lanes|=r,null!==(l=s.alternate)&&(l.lanes|=r),Ao(s,r,t),s=a.sibling}else s=a.child;if(null!==s)s.return=a;else for(s=a;null!==s;){if(s===t){s=null;break}if(null!==(a=s.sibling)){a.return=s.return,s=a;break}s=s.return}a=s}bs(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,Po(t,r),n=n(i=Mo(i)),t.flags|=1,bs(e,t,n,r),t.child;case 14:return i=rs(n=t.type,t.pendingProps),xs(e,t,n,i=rs(n.type,i),r);case 15:return Cs(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:rs(n,i),Hs(e,t),t.tag=1,Ri(n)?(e=!0,Ni(t)):e=!1,Po(t,r),as(t,n,i),ls(t,n,i,r),ks(null,t,n,!0,e,r);case 19:return qs(e,t,r);case 22:return Ss(e,t,r)}throw Error(o(156,t.tag))};var Zc="function"===typeof reportError?reportError:function(e){console.error(e)};function Wc(e){this._internalRoot=e}function $c(e){this._internalRoot=e}function Yc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Xc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Qc(){}function Jc(e,t,r,n,i){var o=r._reactRootContainer;if(o){var a=o;if("function"===typeof i){var s=i;i=function(){var e=Vc(a);s.call(e)}}Hc(t,a,e,i)}else a=function(e,t,r,n,i){if(i){if("function"===typeof n){var o=n;n=function(){var e=Vc(a);o.call(e)}}var a=qc(t,n,e,0,null,!1,0,"",Qc);return e._reactRootContainer=a,e[fi]=a.current,qn(8===e.nodeType?e.parentNode:e),uc(),a}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof n){var s=n;n=function(){var e=Vc(l);s.call(e)}}var l=Uc(e,0,!1,null,0,!1,0,"",Qc);return e._reactRootContainer=l,e[fi]=l.current,qn(8===e.nodeType?e.parentNode:e),uc((function(){Hc(t,l,r,n)})),l}(r,t,e,i,n);return Vc(a)}$c.prototype.render=Wc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(o(409));Hc(e,t,null,null)},$c.prototype.unmount=Wc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc((function(){Hc(null,e,null,null)})),t[fi]=null}},$c.prototype.unstable_scheduleHydration=function(e){if(e){var t=St();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Ot.length&&0!==t&&t<Ot[r].priority;r++);Ot.splice(r,0,e),0===r&&zt(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=ht(t.pendingLanes);0!==r&&(vt(t,1|r),nc(t,Xe()),0===(6&kl)&&(ql=Xe()+500,qi()))}break;case 13:uc((function(){var t=Do(e,1);if(null!==t){var r=ec();rc(t,e,1,r)}})),Kc(e,1)}},xt=function(e){if(13===e.tag){var t=Do(e,134217728);if(null!==t)rc(t,e,134217728,ec());Kc(e,134217728)}},Ct=function(e){if(13===e.tag){var t=tc(e),r=Do(e,t);if(null!==r)rc(r,e,t,ec());Kc(e,t)}},St=function(){return _t},Et=function(e,t){var r=_t;try{return _t=e,t()}finally{_t=r}},xe=function(e,t,r){switch(t){case"input":if(Q(e,r),t=r.name,"radio"===r.type&&null!=t){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=wi(n);if(!i)throw Error(o(90));Z(n),Q(n,i)}}}break;case"textarea":oe(e,r);break;case"select":null!=(t=r.value)&&re(e,!!r.multiple,t,!1)}},ke=cc,Ae=uc;var eu={usingClientEntryPoint:!1,Events:[_i,bi,wi,Te,Ie,cc]},tu={findFiberByHostInstance:vi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ru={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ge(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var nu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nu.isDisabled&&nu.supportsFiber)try{it=nu.inject(ru),ot=nu}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Yc(t))throw Error(o(200));return function(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:x,key:null==n?null:""+n,children:e,containerInfo:t,implementation:r}}(e,t,null,r)},t.createRoot=function(e,t){if(!Yc(e))throw Error(o(299));var r=!1,n="",i=Zc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(r=!0),void 0!==t.identifierPrefix&&(n=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=Uc(e,1,!1,null,0,r,0,n,i),e[fi]=t.current,qn(8===e.nodeType?e.parentNode:e),new Wc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(o(188));throw e=Object.keys(e).join(","),Error(o(268,e))}return e=null===(e=Ge(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,r){if(!Xc(t))throw Error(o(200));return Jc(null,e,t,!0,r)},t.hydrateRoot=function(e,t,r){if(!Yc(e))throw Error(o(405));var n=null!=r&&r.hydratedSources||null,i=!1,a="",s=Zc;if(null!==r&&void 0!==r&&(!0===r.unstable_strictMode&&(i=!0),void 0!==r.identifierPrefix&&(a=r.identifierPrefix),void 0!==r.onRecoverableError&&(s=r.onRecoverableError)),t=qc(t,null,e,1,null!=r?r:null,i,0,a,s),e[fi]=t.current,qn(e),n)for(e=0;e<n.length;e++)i=(i=(r=n[e])._getVersion)(r._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new $c(t)},t.render=function(e,t,r){if(!Xc(t))throw Error(o(200));return Jc(null,e,t,!1,r)},t.unmountComponentAtNode=function(e){if(!Xc(e))throw Error(o(40));return!!e._reactRootContainer&&(uc((function(){Jc(null,null,e,!1,(function(){e._reactRootContainer=null,e[fi]=null}))})),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Xc(r))throw Error(o(200));if(null==e||void 0===e._reactInternals)throw Error(o(38));return Jc(e,t,r,!1,n)},t.version="18.3.1-next-f1338f8080-20240426"},391:(e,t,r)=>{"use strict";var n=r(950);t.H=n.createRoot,n.hydrateRoot},950:(e,t,r)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=r(730)},358:(e,t)=>{"use strict";const r=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,n=/^[\u0021-\u003A\u003C-\u007E]*$/,i=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,o=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,s=(()=>{const e=function(){};return e.prototype=Object.create(null),e})();function l(e,t,r){do{const r=e.charCodeAt(t);if(32!==r&&9!==r)return t}while(++t<r);return r}function c(e,t,r){for(;t>r;){const r=e.charCodeAt(--t);if(32!==r&&9!==r)return t+1}return r}function u(e){if(-1===e.indexOf("%"))return e;try{return decodeURIComponent(e)}catch(t){return e}}},153:(e,t,r)=>{"use strict";var n=r(43),i=Symbol.for("react.element"),o=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,r){var n,o={},c=null,u=null;for(n in void 0!==r&&(c=""+r),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)a.call(t,n)&&!l.hasOwnProperty(n)&&(o[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===o[n]&&(o[n]=t[n]);return{$$typeof:i,type:e,key:c,ref:u,props:o,_owner:s.current}}t.Fragment=o,t.jsx=c,t.jsxs=c},202:(e,t)=>{"use strict";var r=Symbol.for("react.element"),n=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),p=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function y(e,t,r){this.props=e,this.context=t,this.refs=g,this.updater=r||f}function v(){}function _(e,t,r){this.props=e,this.context=t,this.refs=g,this.updater=r||f}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=y.prototype;var b=_.prototype=new v;b.constructor=_,m(b,y.prototype),b.isPureReactComponent=!0;var w=Array.isArray,x=Object.prototype.hasOwnProperty,C={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function E(e,t,n){var i,o={},a=null,s=null;if(null!=t)for(i in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(a=""+t.key),t)x.call(t,i)&&!S.hasOwnProperty(i)&&(o[i]=t[i]);var l=arguments.length-2;if(1===l)o.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];o.children=c}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===o[i]&&(o[i]=l[i]);return{$$typeof:r,type:e,key:a,ref:s,props:o,_owner:C.current}}function T(e){return"object"===typeof e&&null!==e&&e.$$typeof===r}var I=/\/+/g;function k(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function A(e,t,i,o,a){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var l=!1;if(null===e)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case r:case n:l=!0}}if(l)return a=a(l=e),e=""===o?"."+k(l,0):o,w(a)?(i="",null!=e&&(i=e.replace(I,"$&/")+"/"),A(a,t,i,"",(function(e){return e}))):null!=a&&(T(a)&&(a=function(e,t){return{$$typeof:r,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,i+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(I,"$&/")+"/")+e)),t.push(a)),1;if(l=0,o=""===o?".":o+":",w(e))for(var c=0;c<e.length;c++){var u=o+k(s=e[c],c);l+=A(s,t,i,u,a)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(s=e.next()).done;)l+=A(s=s.value,t,i,u=o+k(s,c++),a);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function P(e,t,r){if(null==e)return e;var n=[],i=0;return A(e,n,"","",(function(e){return t.call(r,e,i++)})),n}function M(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var R={current:null},O={transition:null},L={ReactCurrentDispatcher:R,ReactCurrentBatchConfig:O,ReactCurrentOwner:C};function D(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:P,forEach:function(e,t,r){P(e,(function(){t.apply(this,arguments)}),r)},count:function(e){var t=0;return P(e,(function(){t++})),t},toArray:function(e){return P(e,(function(e){return e}))||[]},only:function(e){if(!T(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=y,t.Fragment=i,t.Profiler=a,t.PureComponent=_,t.StrictMode=o,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=L,t.act=D,t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=m({},e.props),o=e.key,a=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,s=C.current),void 0!==t.key&&(o=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)x.call(t,c)&&!S.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}return{$$typeof:r,type:e.type,key:o,ref:a,props:i,_owner:s}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=E,t.createFactory=function(e){var t=E.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=T,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:M}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=O.transition;O.transition={};try{e()}finally{O.transition=t}},t.unstable_act=D,t.useCallback=function(e,t){return R.current.useCallback(e,t)},t.useContext=function(e){return R.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return R.current.useDeferredValue(e)},t.useEffect=function(e,t){return R.current.useEffect(e,t)},t.useId=function(){return R.current.useId()},t.useImperativeHandle=function(e,t,r){return R.current.useImperativeHandle(e,t,r)},t.useInsertionEffect=function(e,t){return R.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return R.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return R.current.useMemo(e,t)},t.useReducer=function(e,t,r){return R.current.useReducer(e,t,r)},t.useRef=function(e){return R.current.useRef(e)},t.useState=function(e){return R.current.useState(e)},t.useSyncExternalStore=function(e,t,r){return R.current.useSyncExternalStore(e,t,r)},t.useTransition=function(){return R.current.useTransition()},t.version="18.3.1"},43:(e,t,r)=>{"use strict";e.exports=r(202)},579:(e,t,r)=>{"use strict";e.exports=r(153)},234:(e,t)=>{"use strict";function r(e,t){var r=e.length;e.push(t);e:for(;0<r;){var n=r-1>>>1,i=e[n];if(!(0<o(i,t)))break e;e[n]=t,e[r]=i,r=n}}function n(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;e:for(var n=0,i=e.length,a=i>>>1;n<a;){var s=2*(n+1)-1,l=e[s],c=s+1,u=e[c];if(0>o(l,r))c<i&&0>o(u,l)?(e[n]=u,e[c]=r,n=c):(e[n]=l,e[s]=r,n=s);else{if(!(c<i&&0>o(u,r)))break e;e[n]=u,e[c]=r,n=c}}}return t}function o(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var s=Date,l=s.now();t.unstable_now=function(){return s.now()-l}}var c=[],u=[],h=1,d=null,p=3,f=!1,m=!1,g=!1,y="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,_="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=n(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,r(c,t)}t=n(u)}}function w(e){if(g=!1,b(e),!m)if(null!==n(c))m=!0,O(x);else{var t=n(u);null!==t&&L(w,t.startTime-e)}}function x(e,r){m=!1,g&&(g=!1,v(T),T=-1),f=!0;var o=p;try{for(b(r),d=n(c);null!==d&&(!(d.expirationTime>r)||e&&!A());){var a=d.callback;if("function"===typeof a){d.callback=null,p=d.priorityLevel;var s=a(d.expirationTime<=r);r=t.unstable_now(),"function"===typeof s?d.callback=s:d===n(c)&&i(c),b(r)}else i(c);d=n(c)}if(null!==d)var l=!0;else{var h=n(u);null!==h&&L(w,h.startTime-r),l=!1}return l}finally{d=null,p=o,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var C,S=!1,E=null,T=-1,I=5,k=-1;function A(){return!(t.unstable_now()-k<I)}function P(){if(null!==E){var e=t.unstable_now();k=e;var r=!0;try{r=E(!0,e)}finally{r?C():(S=!1,E=null)}}else S=!1}if("function"===typeof _)C=function(){_(P)};else if("undefined"!==typeof MessageChannel){var M=new MessageChannel,R=M.port2;M.port1.onmessage=P,C=function(){R.postMessage(null)}}else C=function(){y(P,0)};function O(e){E=e,S||(S=!0,C())}function L(e,r){T=y((function(){e(t.unstable_now())}),r)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,O(x))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var r=p;p=t;try{return e()}finally{p=r}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=p;p=e;try{return t()}finally{p=r}},t.unstable_scheduleCallback=function(e,i,o){var a=t.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?a+o:a:o=a,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:h++,callback:i,priorityLevel:e,startTime:o,expirationTime:s=o+s,sortIndex:-1},o>a?(e.sortIndex=o,r(u,e),null===n(c)&&e===n(u)&&(g?(v(T),T=-1):g=!0,L(w,o-a))):(e.sortIndex=s,r(c,e),m||f||(m=!0,O(x))),e},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(e){var t=p;return function(){var r=p;p=t;try{return e.apply(this,arguments)}finally{p=r}}}},853:(e,t,r)=>{"use strict";e.exports=r(234)},440:e=>{"use strict";var t=function(){};e.exports=t},700:(e,t,r)=>{var n={"./hermit-crab.svg":390,"./jellyfish.svg":420,"./shark.svg":157};function i(e){var t=o(e);return r(t)}function o(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}i.keys=function(){return Object.keys(n)},i.resolve=o,e.exports=i,i.id=700},390:(e,t,r)=>{"use strict";e.exports=r.p+"static/media/hermit-crab.8ae810289a858afbfa08.svg"},420:(e,t,r)=>{"use strict";e.exports=r.p+"static/media/jellyfish.eb6d2e50f58aef9edfc4.svg"},157:(e,t,r)=>{"use strict";e.exports=r.p+"static/media/shark.f2a937ebe8e7010ada0d.svg"},139:(e,t)=>{var r;!function(){"use strict";var n={}.hasOwnProperty;function i(){for(var e="",t=0;t<arguments.length;t++){var r=arguments[t];r&&(e=a(e,o(r)))}return e}function o(e){if("string"===typeof e||"number"===typeof e)return e;if("object"!==typeof e)return"";if(Array.isArray(e))return i.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var r in e)n.call(e,r)&&e[r]&&(t=a(t,r));return t}function a(e,t){return t?e?e+" "+t:e+t:e}e.exports?(i.default=i,e.exports=i):void 0===(r=function(){return i}.apply(t,[]))||(e.exports=r)}()}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={exports:{}};return e[n](o,o.exports,r),o.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.p="/",(()=>{"use strict";var e=r(391),t=r(43),n=(r(358),"popstate");function i(){return h((function(e,t){let{pathname:r,search:n,hash:i}=e.location;return l("",{pathname:r,search:n,hash:i},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"===typeof t?t:c(t)}),null,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function o(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function a(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(Hj){}}}function s(e,t){return{usr:e.state,key:e.key,idx:t}}function l(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3?arguments[3]:void 0;return{pathname:"string"===typeof e?e:e.pathname,search:"",hash:"",..."string"===typeof t?u(t):t,state:r,key:t&&t.key||n||Math.random().toString(36).substring(2,10)}}function c(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&"?"!==r&&(t+="?"===r.charAt(0)?r:"?"+r),n&&"#"!==n&&(t+="#"===n.charAt(0)?n:"#"+n),t}function u(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substring(n),e=e.substring(0,n)),e&&(t.pathname=e)}return t}function h(e,t,r){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{window:a=document.defaultView,v5Compat:u=!1}=i,h=a.history,d="POP",p=null,f=m();function m(){return(h.state||{idx:null}).idx}function g(){d="POP";let e=m(),t=null==e?null:e-f;f=e,p&&p({action:d,location:v.location,delta:t})}function y(e){let t="null"!==a.location.origin?a.location.origin:a.location.href,r="string"===typeof e?e:c(e);return r=r.replace(/ $/,"%20"),o(t,`No window.location.(origin|href) available to create URL for href: ${r}`),new URL(r,t)}null==f&&(f=0,h.replaceState({...h.state,idx:f},""));let v={get action(){return d},get location(){return e(a,h)},listen(e){if(p)throw new Error("A history only accepts one active listener");return a.addEventListener(n,g),p=e,()=>{a.removeEventListener(n,g),p=null}},createHref:e=>t(a,e),createURL:y,encodeLocation(e){let t=y(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){d="PUSH";let n=l(v.location,e,t);r&&r(n,e),f=m()+1;let i=s(n,f),o=v.createHref(n);try{h.pushState(i,"",o)}catch(c){if(c instanceof DOMException&&"DataCloneError"===c.name)throw c;a.location.assign(o)}u&&p&&p({action:d,location:v.location,delta:1})},replace:function(e,t){d="REPLACE";let n=l(v.location,e,t);r&&r(n,e),f=m();let i=s(n,f),o=v.createHref(n);h.replaceState(i,"",o),u&&p&&p({action:d,location:v.location,delta:0})},go:e=>h.go(e)};return v}function d(e,t){return p(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",!1)}function p(e,t,r,n){let i=I(("string"===typeof t?u(t):t).pathname||"/",r);if(null==i)return null;let o=f(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let r=e.length===t.length&&e.slice(0,-1).every(((e,r)=>e===t[r]));return r?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(o);let a=null;for(let s=0;null==a&&s<o.length;++s){let e=T(i);a=S(o[s],e,n)}return a}function f(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=(e,i,a)=>{let s={relativePath:void 0===a?e.path||"":a,caseSensitive:!0===e.caseSensitive,childrenIndex:i,route:e};s.relativePath.startsWith("/")&&(o(s.relativePath.startsWith(n),`Absolute route path "${s.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),s.relativePath=s.relativePath.slice(n.length));let l=R([n,s.relativePath]),c=r.concat(s);e.children&&e.children.length>0&&(o(!0!==e.index,`Index routes must not have child routes. Please remove all child routes from route path "${l}".`),f(e.children,t,c,l)),(null!=e.path||e.index)&&t.push({path:l,score:C(l,e.index),routesMeta:c})};return e.forEach(((e,t)=>{if(""!==e.path&&e.path?.includes("?"))for(let r of m(e.path))i(e,t,r);else i(e,t)})),t}function m(e){let t=e.split("/");if(0===t.length)return[];let[r,...n]=t,i=r.endsWith("?"),o=r.replace(/\?$/,"");if(0===n.length)return i?[o,""]:[o];let a=m(n.join("/")),s=[];return s.push(...a.map((e=>""===e?o:[o,e].join("/")))),i&&s.push(...a),s.map((t=>e.startsWith("/")&&""===t?"/":t))}var g=/^:[\w-]+$/,y=3,v=2,_=1,b=10,w=-2,x=e=>"*"===e;function C(e,t){let r=e.split("/"),n=r.length;return r.some(x)&&(n+=w),t&&(n+=v),r.filter((e=>!x(e))).reduce(((e,t)=>e+(g.test(t)?y:""===t?_:b)),n)}function S(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{routesMeta:n}=e,i={},o="/",a=[];for(let s=0;s<n.length;++s){let e=n[s],l=s===n.length-1,c="/"===o?t:t.slice(o.length)||"/",u=E({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),h=e.route;if(!u&&l&&r&&!n[n.length-1].route.index&&(u=E({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!u)return null;Object.assign(i,u.params),a.push({params:i,pathname:R([o,u.pathname]),pathnameBase:O(R([o,u.pathnameBase])),route:h}),"/"!==u.pathnameBase&&(o=R([o,u.pathnameBase]))}return a}function E(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];a("*"===e||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let n=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((e,t,r)=>(n.push({paramName:t,isOptional:null!=r}),r?"/?([^\\/]+)?":"/([^\\/]+)")));e.endsWith("*")?(n.push({paramName:"*"}),i+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":""!==e&&"/"!==e&&(i+="(?:(?=\\/|$))");let o=new RegExp(i,t?void 0:"i");return[o,n]}(e.path,e.caseSensitive,e.end),i=t.match(r);if(!i)return null;let o=i[0],s=o.replace(/(.)\/+$/,"$1"),l=i.slice(1),c=n.reduce(((e,t,r)=>{let{paramName:n,isOptional:i}=t;if("*"===n){let e=l[r]||"";s=o.slice(0,o.length-e.length).replace(/(.)\/+$/,"$1")}const a=l[r];return e[n]=i&&!a?void 0:(a||"").replace(/%2F/g,"/"),e}),{});return{params:c,pathname:o,pathnameBase:s,pattern:e}}function T(e){try{return e.split("/").map((e=>decodeURIComponent(e).replace(/\//g,"%2F"))).join("/")}catch(t){return a(!1,`The URL path "${e}" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function I(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&"/"!==n?null:e.slice(r)||"/"}function k(e,t,r,n){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function A(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}function P(e){let t=A(e);return t.map(((e,r)=>r===t.length-1?e.pathname:e.pathnameBase))}function M(e,t,r){let n,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];"string"===typeof e?n=u(e):(n={...e},o(!n.pathname||!n.pathname.includes("?"),k("?","pathname","search",n)),o(!n.pathname||!n.pathname.includes("#"),k("#","pathname","hash",n)),o(!n.search||!n.search.includes("#"),k("#","search","hash",n)));let a,s=""===e||""===n.pathname,l=s?"/":n.pathname;if(null==l)a=r;else{let e=t.length-1;if(!i&&l.startsWith("..")){let t=l.split("/");for(;".."===t[0];)t.shift(),e-=1;n.pathname=t.join("/")}a=e>=0?t[e]:"/"}let c=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",{pathname:r,search:n="",hash:i=""}="string"===typeof e?u(e):e,o=r?r.startsWith("/")?r:function(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?r.length>1&&r.pop():"."!==e&&r.push(e)})),r.length>1?r.join("/"):"/"}(r,t):t;return{pathname:o,search:L(n),hash:D(i)}}(n,a),h=l&&"/"!==l&&l.endsWith("/"),d=(s||"."===l)&&r.endsWith("/");return c.pathname.endsWith("/")||!h&&!d||(c.pathname+="/"),c}var R=e=>e.join("/").replace(/\/\/+/g,"/"),O=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),L=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",D=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";function N(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}var z=["POST","PUT","PATCH","DELETE"],F=(new Set(z),["GET",...z]);new Set(F),Symbol("ResetLoaderData");var B=t.createContext(null);B.displayName="DataRouter";var U=t.createContext(null);U.displayName="DataRouterState";var j=t.createContext({isTransitioning:!1});j.displayName="ViewTransition";var q=t.createContext(new Map);q.displayName="Fetchers";var H=t.createContext(null);H.displayName="Await";var V=t.createContext(null);V.displayName="Navigation";var G=t.createContext(null);G.displayName="Location";var K=t.createContext({outlet:null,matches:[],isDataRoute:!1});K.displayName="Route";var Z=t.createContext(null);Z.displayName="RouteError";function W(){return null!=t.useContext(G)}function $(){return o(W(),"useLocation() may be used only in the context of a <Router> component."),t.useContext(G).location}var Y="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function X(e){t.useContext(V).static||t.useLayoutEffect(e)}function Q(){let{isDataRoute:e}=t.useContext(K);return e?function(){let{router:e}=se("useNavigate"),r=ce("useNavigate"),n=t.useRef(!1);X((()=>{n.current=!0}));let i=t.useCallback((async function(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};a(n.current,Y),n.current&&("number"===typeof t?e.navigate(t):await e.navigate(t,{fromRouteId:r,...i}))}),[e,r]);return i}():function(){o(W(),"useNavigate() may be used only in the context of a <Router> component.");let e=t.useContext(B),{basename:r,navigator:n}=t.useContext(V),{matches:i}=t.useContext(K),{pathname:s}=$(),l=JSON.stringify(P(i)),c=t.useRef(!1);X((()=>{c.current=!0}));let u=t.useCallback((function(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(a(c.current,Y),!c.current)return;if("number"===typeof t)return void n.go(t);let o=M(t,JSON.parse(l),s,"path"===i.relative);null==e&&"/"!==r&&(o.pathname="/"===o.pathname?r:R([r,o.pathname])),(i.replace?n.replace:n.push)(o,i.state,i)}),[r,n,l,s,e]);return u}()}t.createContext(null);function J(e){let{relative:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{matches:n}=t.useContext(K),{pathname:i}=$(),o=JSON.stringify(P(n));return t.useMemo((()=>M(e,JSON.parse(o),i,"path"===r)),[e,o,i,r])}function ee(e,r,n,i){o(W(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=t.useContext(V),{matches:l}=t.useContext(K),c=l[l.length-1],h=c?c.params:{},p=c?c.pathname:"/",f=c?c.pathnameBase:"/",m=c&&c.route;{let e=m&&m.path||"";de(p,!m||e.endsWith("*")||e.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${p}" (under <Route path="${e}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="${e}"> to <Route path="${"/"===e?"*":`${e}/*`}">.`)}let g,y=$();if(r){let e="string"===typeof r?u(r):r;o("/"===f||e.pathname?.startsWith(f),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${f}" but pathname "${e.pathname}" was given in the \`location\` prop.`),g=e}else g=y;let v=g.pathname||"/",_=v;if("/"!==f){let e=f.replace(/^\//,"").split("/");_="/"+v.replace(/^\//,"").split("/").slice(e.length).join("/")}let b=d(e,{pathname:_});a(m||null!=b,`No routes matched location "${g.pathname}${g.search}${g.hash}" `),a(null==b||void 0!==b[b.length-1].route.element||void 0!==b[b.length-1].route.Component||void 0!==b[b.length-1].route.lazy,`Matched leaf route at location "${g.pathname}${g.search}${g.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let w=oe(b&&b.map((e=>Object.assign({},e,{params:Object.assign({},h,e.params),pathname:R([f,s.encodeLocation?s.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?f:R([f,s.encodeLocation?s.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),l,n,i);return r&&w?t.createElement(G.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...g},navigationType:"POP"}},w):w}function te(){let e=ue(),r=N(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,i="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:i},a={padding:"2px 4px",backgroundColor:i},s=null;return console.error("Error handled by React Router default ErrorBoundary:",e),s=t.createElement(t.Fragment,null,t.createElement("p",null,"\ud83d\udcbf Hey developer \ud83d\udc4b"),t.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",t.createElement("code",{style:a},"ErrorBoundary")," or"," ",t.createElement("code",{style:a},"errorElement")," prop on your route.")),t.createElement(t.Fragment,null,t.createElement("h2",null,"Unexpected Application Error!"),t.createElement("h3",{style:{fontStyle:"italic"}},r),n?t.createElement("pre",{style:o},n):null,s)}var re=t.createElement(te,null),ne=class extends t.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?t.createElement(K.Provider,{value:this.props.routeContext},t.createElement(Z.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function ie(e){let{routeContext:r,match:n,children:i}=e,o=t.useContext(B);return o&&o.static&&o.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=n.route.id),t.createElement(K.Provider,{value:r},i)}function oe(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(null==e){if(!n)return null;if(n.errors)e=n.matches;else{if(0!==r.length||n.initialized||!(n.matches.length>0))return null;e=n.matches}}let i=e,a=n?.errors;if(null!=a){let e=i.findIndex((e=>e.route.id&&void 0!==a?.[e.route.id]));o(e>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(a).join(",")}`),i=i.slice(0,Math.min(i.length,e+1))}let s=!1,l=-1;if(n)for(let t=0;t<i.length;t++){let e=i[t];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(l=t),e.route.id){let{loaderData:t,errors:r}=n,o=e.route.loader&&!t.hasOwnProperty(e.route.id)&&(!r||void 0===r[e.route.id]);if(e.route.lazy||o){s=!0,i=l>=0?i.slice(0,l+1):[i[0]];break}}}return i.reduceRight(((e,o,c)=>{let u,h=!1,d=null,p=null;n&&(u=a&&o.route.id?a[o.route.id]:void 0,d=o.route.errorElement||re,s&&(l<0&&0===c?(de("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),h=!0,p=null):l===c&&(h=!0,p=o.route.hydrateFallbackElement||null)));let f=r.concat(i.slice(0,c+1)),m=()=>{let r;return r=u?d:h?p:o.route.Component?t.createElement(o.route.Component,null):o.route.element?o.route.element:e,t.createElement(ie,{match:o,routeContext:{outlet:e,matches:f,isDataRoute:null!=n},children:r})};return n&&(o.route.ErrorBoundary||o.route.errorElement||0===c)?t.createElement(ne,{location:n.location,revalidation:n.revalidation,component:d,error:u,children:m(),routeContext:{outlet:null,matches:f,isDataRoute:!0}}):m()}),null)}function ae(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function se(e){let r=t.useContext(B);return o(r,ae(e)),r}function le(e){let r=t.useContext(U);return o(r,ae(e)),r}function ce(e){let r=function(e){let r=t.useContext(K);return o(r,ae(e)),r}(e),n=r.matches[r.matches.length-1];return o(n.route.id,`${e} can only be used on routes that contain a unique "id"`),n.route.id}function ue(){let e=t.useContext(Z),r=le("useRouteError"),n=ce("useRouteError");return void 0!==e?e:r.errors?.[n]}var he={};function de(e,t,r){t||he[e]||(he[e]=!0,a(!1,r))}t.memo((function(e){let{routes:t,future:r,state:n}=e;return ee(t,void 0,n,r)}));function pe(e){o(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function fe(e){let{basename:r="/",children:n=null,location:i,navigationType:s="POP",navigator:l,static:c=!1}=e;o(!W(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let h=r.replace(/^\/*/,"/"),d=t.useMemo((()=>({basename:h,navigator:l,static:c,future:{}})),[h,l,c]);"string"===typeof i&&(i=u(i));let{pathname:p="/",search:f="",hash:m="",state:g=null,key:y="default"}=i,v=t.useMemo((()=>{let e=I(p,h);return null==e?null:{location:{pathname:e,search:f,hash:m,state:g,key:y},navigationType:s}}),[h,p,f,m,g,y,s]);return a(null!=v,`<Router basename="${h}"> is not able to match the URL "${p}${f}${m}" because it does not start with the basename, so the <Router> won't render anything.`),null==v?null:t.createElement(V.Provider,{value:d},t.createElement(G.Provider,{children:n,value:v}))}function me(e){let{children:t,location:r}=e;return ee(ge(t),r)}t.Component;function ge(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[];return t.Children.forEach(e,((e,i)=>{if(!t.isValidElement(e))return;let a=[...r,i];if(e.type===t.Fragment)return void n.push.apply(n,ge(e.props.children,a));o(e.type===pe,`[${"string"===typeof e.type?e.type:e.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),o(!e.props.index||!e.props.children,"An index route cannot have child routes.");let s={id:e.props.id||a.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,hydrateFallbackElement:e.props.hydrateFallbackElement,HydrateFallback:e.props.HydrateFallback,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:!0===e.props.hasErrorBoundary||null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(s.children=ge(e.props.children,a)),n.push(s)})),n}var ye="get",ve="application/x-www-form-urlencoded";function _e(e){return null!=e&&"string"===typeof e.tagName}var be=null;var we=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function xe(e){return null==e||we.has(e)?e:(a(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${ve}"`),null)}function Ce(e,t){let r,n,i,o,a;if(_e(s=e)&&"form"===s.tagName.toLowerCase()){let a=e.getAttribute("action");n=a?I(a,t):null,r=e.getAttribute("method")||ye,i=xe(e.getAttribute("enctype"))||ve,o=new FormData(e)}else if(function(e){return _e(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return _e(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let a=e.form;if(null==a)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let s=e.getAttribute("formaction")||a.getAttribute("action");if(n=s?I(s,t):null,r=e.getAttribute("formmethod")||a.getAttribute("method")||ye,i=xe(e.getAttribute("formenctype"))||xe(a.getAttribute("enctype"))||ve,o=new FormData(a,e),!function(){if(null===be)try{new FormData(document.createElement("form"),0),be=!1}catch(Hj){be=!0}return be}()){let{name:t,type:r,value:n}=e;if("image"===r){let e=t?`${t}.`:"";o.append(`${e}x`,"0"),o.append(`${e}y`,"0")}else t&&o.append(t,n)}}else{if(_e(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=ye,n=null,i=ve,a=e}var s;return o&&"text/plain"===i&&(a=o,o=void 0),{action:n,method:r.toLowerCase(),encType:i,formData:o,body:a}}function Se(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}async function Ee(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise((()=>{}))}}function Te(e){return null!=e&&"string"===typeof e.page}function Ie(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"===typeof e.imageSrcSet&&"string"===typeof e.imageSizes:"string"===typeof e.rel&&"string"===typeof e.href)}function ke(e,t,r,n,i,o){let a=(e,t)=>!r[t]||e.route.id!==r[t].route.id,s=(e,t)=>r[t].pathname!==e.pathname||r[t].route.path?.endsWith("*")&&r[t].params["*"]!==e.params["*"];return"assets"===o?t.filter(((e,t)=>a(e,t)||s(e,t))):"data"===o?t.filter(((t,o)=>{let l=n.routes[t.route.id];if(!l||!l.hasLoader)return!1;if(a(t,o)||s(t,o))return!0;if(t.route.shouldRevalidate){let n=t.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:r[0]?.params||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"===typeof n)return n}return!0})):[]}function Ae(e){return[...new Set(e)]}function Pe(e,t){let r=new Set,n=new Set(t);return e.reduce(((e,i)=>{if(t&&!Te(i)&&"script"===i.as&&i.href&&n.has(i.href))return e;let o=JSON.stringify(function(e){let t={},r=Object.keys(e).sort();for(let n of r)t[n]=e[n];return t}(i));return r.has(o)||(r.add(o),e.push({key:o,link:i})),e}),[])}function Me(e){return{__html:e}}Symbol("SingleFetchRedirect");function Re(e){let t="string"===typeof e?new URL(e,"undefined"===typeof window?"server://singlefetch/":window.location.origin):e;return"/"===t.pathname?t.pathname="_root.data":t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}t.Component;function Oe(e){let{error:r,isOutsideRemixApp:n}=e;console.error(r);let i,o=t.createElement("script",{dangerouslySetInnerHTML:{__html:'\n        console.log(\n          "\ud83d\udcbf Hey developer \ud83d\udc4b. You can provide a way better UX than this when your app throws errors. Check out https://remix.run/guides/errors for more information."\n        );\n      '}});if(N(r))return t.createElement(Le,{title:"Unhandled Thrown Response!"},t.createElement("h1",{style:{fontSize:"24px"}},r.status," ",r.statusText),o);if(r instanceof Error)0;else{let e=null==r?"Unknown Error":"object"===typeof r&&"toString"in r?r.toString():JSON.stringify(r);new Error(e)}return t.createElement(Le,{title:"Application Error!",isOutsideRemixApp:n},t.createElement("h1",{style:{fontSize:"24px"}},"Application Error"),t.createElement("pre",{style:{padding:"2rem",background:"hsla(10, 50%, 50%, 0.1)",color:"red",overflow:"auto"}},i.stack),o)}function Le(e){let{title:r,renderScripts:n,isOutsideRemixApp:i,children:o}=e,{routeModules:a}=Be();return a.root?.Layout&&!i?o:t.createElement("html",{lang:"en"},t.createElement("head",null,t.createElement("meta",{charSet:"utf-8"}),t.createElement("meta",{name:"viewport",content:"width=device-width,initial-scale=1,viewport-fit=cover"}),t.createElement("title",null,r)),t.createElement("body",null,t.createElement("main",{style:{fontFamily:"system-ui, sans-serif",padding:"2rem"}},o,n?t.createElement(Ke,null):null)))}function De(e){return!e}function Ne(){let e=t.useContext(B);return Se(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function ze(){let e=t.useContext(U);return Se(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var Fe=t.createContext(void 0);function Be(){let e=t.useContext(Fe);return Se(e,"You must render this element inside a <HydratedRouter> element"),e}function Ue(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function je(e,t,r){if(r&&!Ge)return[e[0]];if(t){let r=e.findIndex((e=>void 0!==t[e.route.id]));return e.slice(0,r+1)}return e}function qe(e){let{page:r,...n}=e,{router:i}=Ne(),o=t.useMemo((()=>d(i.routes,r,i.basename)),[i.routes,r,i.basename]);return o?t.createElement(Ve,{page:r,matches:o,...n}):(console.warn(`Tried to prefetch ${r} but no routes matched.`),null)}function He(e){let{manifest:r,routeModules:n}=Be(),[i,o]=t.useState([]);return t.useEffect((()=>{let t=!1;return async function(e,t,r){return Pe((await Promise.all(e.map((async e=>{let n=t.routes[e.route.id];if(n){let e=await Ee(n,r);return e.links?e.links():[]}return[]})))).flat(1).filter(Ie).filter((e=>"stylesheet"===e.rel||"preload"===e.rel)).map((e=>"stylesheet"===e.rel?{...e,rel:"prefetch",as:"style"}:{...e,rel:"prefetch"})))}(e,r,n).then((e=>{t||o(e)})),()=>{t=!0}}),[e,r,n]),i}function Ve(e){let{page:r,matches:n,...i}=e,o=$(),{manifest:a,routeModules:s}=Be(),{loaderData:l,matches:c}=ze(),u=t.useMemo((()=>ke(r,n,c,a,o,"data")),[r,n,c,a,o]),h=t.useMemo((()=>ke(r,n,c,a,o,"assets")),[r,n,c,a,o]),d=t.useMemo((()=>{if(r===o.pathname+o.search+o.hash)return[];let e=new Set,t=!1;if(n.forEach((r=>{let n=a.routes[r.route.id];n&&n.hasLoader&&(!u.some((e=>e.route.id===r.route.id))&&r.route.id in l&&s[r.route.id]?.shouldRevalidate||n.hasClientLoader?t=!0:e.add(r.route.id))})),0===e.size)return[];let i=Re(r);return t&&e.size>0&&i.searchParams.set("_routes",n.filter((t=>e.has(t.route.id))).map((e=>e.route.id)).join(",")),[i.pathname+i.search]}),[l,o,a,u,n,r,s]),p=t.useMemo((()=>function(e,t){return Ae(e.map((e=>{let r=t.routes[e.route.id];if(!r)return[];let n=[r.module];return r.imports&&(n=n.concat(r.imports)),n})).flat(1))}(h,a)),[h,a]),f=He(h);return t.createElement(t.Fragment,null,d.map((e=>t.createElement("link",{key:e,rel:"prefetch",as:"fetch",href:e,...i}))),p.map((e=>t.createElement("link",{key:e,rel:"modulepreload",href:e,...i}))),f.map((e=>{let{key:r,link:n}=e;return t.createElement("link",{key:r,...n})})))}Fe.displayName="FrameworkContext";var Ge=!1;function Ke(e){let{manifest:r,serverHandoffString:n,isSpaMode:i,renderMeta:o}=Be(),{router:a,static:s,staticContext:l}=Ne(),{matches:c}=ze(),u=De(i);o&&(o.didRenderScripts=!0);let h=je(c,null,i);t.useEffect((()=>{0}),[]);let p=t.useMemo((()=>{let i=l?`window.__reactRouterContext = ${n};window.__reactRouterContext.stream = new ReadableStream({start(controller){window.__reactRouterContext.streamController = controller;}}).pipeThrough(new TextEncoderStream());`:" ",o=s?`${r.hmr?.runtime?`import ${JSON.stringify(r.hmr.runtime)};`:""}${u?"":`import ${JSON.stringify(r.url)}`};\n${h.map(((e,t)=>`import * as route${t} from ${JSON.stringify(r.routes[e.route.id].module)};`)).join("\n")}\n  ${u?`window.__reactRouterManifest = ${JSON.stringify(function(e,t){let r=new Set(t.state.matches.map((e=>e.route.id))),n=t.state.location.pathname.split("/").filter(Boolean),i=["/"];for(n.pop();n.length>0;)i.push(`/${n.join("/")}`),n.pop();i.forEach((e=>{let n=d(t.routes,e,t.basename);n&&n.forEach((e=>r.add(e.route.id)))}));let o=[...r].reduce(((t,r)=>Object.assign(t,{[r]:e.routes[r]})),{});return{...e,routes:o}}(r,a),null,2)};`:""}\n  window.__reactRouterRouteModules = {${h.map(((e,t)=>`${JSON.stringify(e.route.id)}:route${t}`)).join(",")}};\n\nimport(${JSON.stringify(r.entry.module)});`:" ";return t.createElement(t.Fragment,null,t.createElement("script",{...e,suppressHydrationWarning:!0,dangerouslySetInnerHTML:Me(i),type:void 0}),t.createElement("script",{...e,suppressHydrationWarning:!0,dangerouslySetInnerHTML:Me(o),type:"module",async:!0}))}),[]),f=h.map((e=>{let t=r.routes[e.route.id];return t?(t.imports||[]).concat([t.module]):[]})).flat(1),m=Ge?[]:r.entry.imports.concat(f);return Ge?null:t.createElement(t.Fragment,null,u?null:t.createElement("link",{rel:"modulepreload",href:r.url,crossOrigin:e.crossOrigin}),t.createElement("link",{rel:"modulepreload",href:r.entry.module,crossOrigin:e.crossOrigin}),[...new Set(g)].map((r=>t.createElement("link",{key:r,rel:"modulepreload",href:r,crossOrigin:e.crossOrigin}))),p);var g}function Ze(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return e=>{t.forEach((t=>{"function"===typeof t?t(e):null!=t&&(t.current=e)}))}}var We="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement;try{We&&(window.__reactRouterVersion="7.0.2")}catch(Hj){}function $e(e){let{basename:r,children:n,window:o}=e,a=t.useRef();null==a.current&&(a.current=i({window:o,v5Compat:!0}));let s=a.current,[l,c]=t.useState({action:s.action,location:s.location}),u=t.useCallback((e=>{t.startTransition((()=>c(e)))}),[c]);return t.useLayoutEffect((()=>s.listen(u)),[s,u]),t.createElement(fe,{basename:r,children:n,location:l.location,navigationType:l.action,navigator:s})}var Ye=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Xe=t.forwardRef((function(e,r){let n,{onClick:i,discover:s="render",prefetch:l="none",relative:u,reloadDocument:h,replace:d,state:p,target:f,to:m,preventScrollReset:g,viewTransition:y,...v}=e,{basename:_}=t.useContext(V),b="string"===typeof m&&Ye.test(m),w=!1;if("string"===typeof m&&b&&(n=m,We))try{let e=new URL(window.location.href),t=m.startsWith("//")?new URL(e.protocol+m):new URL(m),r=I(t.pathname,_);t.origin===e.origin&&null!=r?m=r+t.search+t.hash:w=!0}catch(Hj){a(!1,`<Link to="${m}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let x=function(e){let{relative:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(W(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:i}=t.useContext(V),{hash:a,pathname:s,search:l}=J(e,{relative:r}),c=s;return"/"!==n&&(c="/"===s?n:R([n,s])),i.createHref({pathname:c,search:l,hash:a})}(m,{relative:u}),[C,S,E]=function(e,r){let n=t.useContext(Fe),[i,o]=t.useState(!1),[a,s]=t.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:u,onMouseLeave:h,onTouchStart:d}=r,p=t.useRef(null);t.useEffect((()=>{if("render"===e&&s(!0),"viewport"===e){let e=new IntersectionObserver((e=>{e.forEach((e=>{s(e.isIntersecting)}))}),{threshold:.5});return p.current&&e.observe(p.current),()=>{e.disconnect()}}}),[e]),t.useEffect((()=>{if(i){let e=setTimeout((()=>{s(!0)}),100);return()=>{clearTimeout(e)}}}),[i]);let f=()=>{o(!0)},m=()=>{o(!1),s(!1)};return n?"intent"!==e?[a,p,{}]:[a,p,{onFocus:Ue(l,f),onBlur:Ue(c,m),onMouseEnter:Ue(u,f),onMouseLeave:Ue(h,m),onTouchStart:Ue(d,f)}]:[!1,p,{}]}(l,v),T=function(e){let{target:r,replace:n,state:i,preventScrollReset:o,relative:a,viewTransition:s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=Q(),u=$(),h=J(e,{relative:a});return t.useCallback((t=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,r)){t.preventDefault();let r=void 0!==n?n:c(u)===c(h);l(e,{replace:r,state:i,preventScrollReset:o,relative:a,viewTransition:s})}}),[u,l,h,n,i,r,e,o,a,s])}(m,{replace:d,state:p,target:f,preventScrollReset:g,relative:u,viewTransition:y});let k=t.createElement("a",{...v,...E,href:n||x,onClick:w||h?i:function(e){i&&i(e),e.defaultPrevented||T(e)},ref:Ze(r,S),target:f,"data-discover":b||"render"!==s?void 0:"true"});return C&&!b?t.createElement(t.Fragment,null,k,t.createElement(qe,{page:x})):k}));Xe.displayName="Link";var Qe=t.forwardRef((function(e,r){let{"aria-current":n="page",caseSensitive:i=!1,className:a="",end:s=!1,style:l,to:c,viewTransition:u,children:h,...d}=e,p=J(c,{relative:d.relative}),f=$(),m=t.useContext(U),{navigator:g,basename:y}=t.useContext(V),v=null!=m&&function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.useContext(j);o(null!=n,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=tt("useViewTransitionState"),a=J(e,{relative:r.relative});if(!n.isTransitioning)return!1;let s=I(n.currentLocation.pathname,i)||n.currentLocation.pathname,l=I(n.nextLocation.pathname,i)||n.nextLocation.pathname;return null!=E(a.pathname,l)||null!=E(a.pathname,s)}(p)&&!0===u,_=g.encodeLocation?g.encodeLocation(p).pathname:p.pathname,b=f.pathname,w=m&&m.navigation&&m.navigation.location?m.navigation.location.pathname:null;i||(b=b.toLowerCase(),w=w?w.toLowerCase():null,_=_.toLowerCase()),w&&y&&(w=I(w,y)||w);const x="/"!==_&&_.endsWith("/")?_.length-1:_.length;let C,S=b===_||!s&&b.startsWith(_)&&"/"===b.charAt(x),T=null!=w&&(w===_||!s&&w.startsWith(_)&&"/"===w.charAt(_.length)),k={isActive:S,isPending:T,isTransitioning:v},A=S?n:void 0;C="function"===typeof a?a(k):[a,S?"active":null,T?"pending":null,v?"transitioning":null].filter(Boolean).join(" ");let P="function"===typeof l?l(k):l;return t.createElement(Xe,{...d,"aria-current":A,className:C,ref:r,style:P,to:c,viewTransition:u},"function"===typeof h?h(k):h)}));Qe.displayName="NavLink";var Je=t.forwardRef(((e,r)=>{let{discover:n="render",fetcherKey:i,navigate:a,reloadDocument:s,replace:l,state:u,method:h=ye,action:d,onSubmit:p,relative:f,preventScrollReset:m,viewTransition:g,...y}=e,v=it(),_=function(e){let{relative:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{basename:n}=t.useContext(V),i=t.useContext(K);o(i,"useFormAction must be used inside a RouteContext");let[a]=i.matches.slice(-1),s={...J(e||".",{relative:r})},l=$();if(null==e){s.search=l.search;let e=new URLSearchParams(s.search),t=e.getAll("index");if(t.some((e=>""===e))){e.delete("index"),t.filter((e=>e)).forEach((t=>e.append("index",t)));let r=e.toString();s.search=r?`?${r}`:""}}e&&"."!==e||!a.route.index||(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index");"/"!==n&&(s.pathname="/"===s.pathname?n:R([n,s.pathname]));return c(s)}(d,{relative:f}),b="get"===h.toLowerCase()?"get":"post",w="string"===typeof d&&Ye.test(d);return t.createElement("form",{ref:r,method:b,action:_,onSubmit:s?p:e=>{if(p&&p(e),e.defaultPrevented)return;e.preventDefault();let t=e.nativeEvent.submitter,r=t?.getAttribute("formmethod")||h;v(t||e.currentTarget,{fetcherKey:i,method:r,navigate:a,replace:l,state:u,relative:f,preventScrollReset:m,viewTransition:g})},...y,"data-discover":w||"render"!==n?void 0:"true"})}));function et(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function tt(e){let r=t.useContext(B);return o(r,et(e)),r}Je.displayName="Form";var rt=0,nt=()=>`__${String(++rt)}__`;function it(){let{router:e}=tt("useSubmit"),{basename:r}=t.useContext(V),n=ce("useRouteId");return t.useCallback((async function(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{action:o,method:a,encType:s,formData:l,body:c}=Ce(t,r);if(!1===i.navigate){let t=i.fetcherKey||nt();await e.fetch(t,n,i.action||o,{preventScrollReset:i.preventScrollReset,formData:l,body:c,formMethod:i.method||a,formEncType:i.encType||s,flushSync:i.flushSync})}else await e.navigate(i.action||o,{preventScrollReset:i.preventScrollReset,formData:l,body:c,formMethod:i.method||a,formEncType:i.encType||s,replace:i.replace,state:i.state,fromRouteId:n,flushSync:i.flushSync,viewTransition:i.viewTransition})}),[e,r,n])}new TextEncoder;var ot=r(139),at=r.n(ot),st=r(579);const lt=["xxl","xl","lg","md","sm","xs"],ct="xs",ut=t.createContext({prefixes:{},breakpoints:lt,minBreakpoint:ct}),{Consumer:ht,Provider:dt}=ut;function pt(e,r){const{prefixes:n}=(0,t.useContext)(ut);return e||n[r]||r}function ft(){const{breakpoints:e}=(0,t.useContext)(ut);return e}function mt(){const{minBreakpoint:e}=(0,t.useContext)(ut);return e}const gt=t.forwardRef(((e,t)=>{let{bsPrefix:r,fluid:n=!1,as:i="div",className:o,...a}=e;const s=pt(r,"container"),l="string"===typeof n?`-${n}`:"-fluid";return(0,st.jsx)(i,{ref:t,...a,className:at()(o,n?`${s}${l}`:s)})}));gt.displayName="Container";const yt=gt;function vt(e){let{as:t,bsPrefix:r,className:n,...i}=e;r=pt(r,"col");const o=ft(),a=mt(),s=[],l=[];return o.forEach((e=>{const t=i[e];let n,o,c;delete i[e],"object"===typeof t&&null!=t?({span:n,offset:o,order:c}=t):n=t;const u=e!==a?`-${e}`:"";n&&s.push(!0===n?`${r}${u}`:`${r}${u}-${n}`),null!=c&&l.push(`order${u}-${c}`),null!=o&&l.push(`offset${u}-${o}`)})),[{...i,className:at()(n,...s,...l)},{as:t,bsPrefix:r,spans:s}]}const _t=t.forwardRef(((e,t)=>{const[{className:r,...n},{as:i="div",bsPrefix:o,spans:a}]=vt(e);return(0,st.jsx)(i,{...n,ref:t,className:at()(r,!a.length&&o)})}));_t.displayName="Col";const bt=_t,wt=t.createContext({}),xt=t.forwardRef(((e,r)=>{let{id:n,bsPrefix:i,className:o,type:a="checkbox",isValid:s=!1,isInvalid:l=!1,as:c="input",...u}=e;const{controlId:h}=(0,t.useContext)(wt);return i=pt(i,"form-check-input"),(0,st.jsx)(c,{...u,ref:r,type:a,id:n||h,className:at()(o,i,s&&"is-valid",l&&"is-invalid")})}));xt.displayName="FormCheckInput";const Ct=xt,St=t.createContext(null);St.displayName="InputGroupContext";const Et=St,Tt=t.forwardRef(((e,t)=>{let{className:r,bsPrefix:n,as:i="span",...o}=e;return n=pt(n,"input-group-text"),(0,st.jsx)(i,{ref:t,className:at()(r,n),...o})}));Tt.displayName="InputGroupText";const It=Tt,kt=t.forwardRef(((e,r)=>{let{bsPrefix:n,size:i,hasValidation:o,className:a,as:s="div",...l}=e;n=pt(n,"input-group");const c=(0,t.useMemo)((()=>({})),[]);return(0,st.jsx)(Et.Provider,{value:c,children:(0,st.jsx)(s,{ref:r,...l,className:at()(a,n,i&&`${n}-${i}`,o&&"has-validation")})})}));kt.displayName="InputGroup";const At=Object.assign(kt,{Text:It,Radio:e=>(0,st.jsx)(It,{children:(0,st.jsx)(Ct,{type:"radio",...e})}),Checkbox:e=>(0,st.jsx)(It,{children:(0,st.jsx)(Ct,{type:"checkbox",...e})})});r(440);var Pt=r(173),Mt=r.n(Pt);const Rt={type:Mt().string,tooltip:Mt().bool,as:Mt().elementType},Ot=t.forwardRef(((e,t)=>{let{as:r="div",className:n,type:i="valid",tooltip:o=!1,...a}=e;return(0,st.jsx)(r,{...a,ref:t,className:at()(n,`${i}-${o?"tooltip":"feedback"}`)})}));Ot.displayName="Feedback",Ot.propTypes=Rt;const Lt=Ot,Dt=t.forwardRef(((e,r)=>{let{bsPrefix:n,type:i,size:o,htmlSize:a,id:s,className:l,isValid:c=!1,isInvalid:u=!1,plaintext:h,readOnly:d,as:p="input",...f}=e;const{controlId:m}=(0,t.useContext)(wt);return n=pt(n,"form-control"),(0,st.jsx)(p,{...f,type:i,size:a,ref:r,readOnly:d,id:s||m,className:at()(l,h?`${n}-plaintext`:n,o&&`${n}-${o}`,"color"===i&&`${n}-color`,c&&"is-valid",u&&"is-invalid")})}));Dt.displayName="FormControl";const Nt=Object.assign(Dt,{Feedback:Lt}),zt=["as","disabled"];function Ft(e){let{tagName:t,disabled:r,href:n,target:i,rel:o,role:a,onClick:s,tabIndex:l=0,type:c}=e;t||(t=null!=n||null!=i||null!=o?"a":"button");const u={tagName:t};if("button"===t)return[{type:c||"button",disabled:r},u];const h=e=>{(r||"a"===t&&function(e){return!e||"#"===e.trim()}(n))&&e.preventDefault(),r?e.stopPropagation():null==s||s(e)};return"a"===t&&(n||(n="#"),r&&(n=void 0)),[{role:null!=a?a:"button",disabled:void 0,tabIndex:r?void 0:l,href:n,target:"a"===t?i:void 0,"aria-disabled":r||void 0,rel:"a"===t?o:void 0,onClick:h,onKeyDown:e=>{" "===e.key&&(e.preventDefault(),h(e))}},u]}const Bt=t.forwardRef(((e,t)=>{let{as:r,disabled:n}=e,i=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}(e,zt);const[o,{tagName:a}]=Ft(Object.assign({tagName:r,disabled:n},i));return(0,st.jsx)(a,Object.assign({},i,o,{ref:t}))}));Bt.displayName="Button";const Ut=t.forwardRef(((e,t)=>{let{as:r,bsPrefix:n,variant:i="primary",size:o,active:a=!1,disabled:s=!1,className:l,...c}=e;const u=pt(n,"btn"),[h,{tagName:d}]=Ft({tagName:r,disabled:s,...c}),p=d;return(0,st.jsx)(p,{...h,...c,ref:t,disabled:s,className:at()(l,u,a&&"active",i&&`${u}-${i}`,o&&`${u}-${o}`,c.href&&s&&"disabled")})}));Ut.displayName="Button";const jt=Ut,qt=r.p+"static/media/callmar.178c72b086f184322c5d.mp4";async function Ht(e){const t=`https://backbechmap.onrender.com/api/geocode?address=${e}`;try{const e=await fetch(t,{method:"GET"});if(!e.ok)throw new Error(`Response status: ${e.status}`);const r=await e.json(),n=r.features.find((e=>"Beach"==e.properties.type&&"High"==e.properties.confidence||"Medium"==e.properties.confidence));return n||null}catch(r){return console.error(r.message),null}}async function Vt(e){const t=`https://backbechmap.onrender.com/api/weather?address=${e}`;try{const e=await fetch(t,{method:"GET"});if(!e.ok)throw new Error(`Response status: ${e.status}`);return await e.json()}catch(r){return console.error(r.message),null}}var Gt=["color","size","title","className"];function Kt(){return Kt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Kt.apply(null,arguments)}var Zt=(0,t.forwardRef)((function(e,r){var n=e.color,i=void 0===n?"currentColor":n,o=e.size,a=void 0===o?"1em":o,s=e.title,l=void 0===s?null:s,c=e.className,u=void 0===c?"":c,h=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.includes(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.includes(r)||{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,Gt);return t.createElement("svg",Kt({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:a,height:a,fill:i,className:["bi","bi-search",u].filter(Boolean).join(" ")},h),l?t.createElement("title",null,l):null,t.createElement("path",{d:"M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0"}))}));Zt.propTypes={color:Mt().string,size:Mt().oneOfType([Mt().string,Mt().number]),title:Mt().string,className:Mt().string};const Wt=Zt,$t=()=>{const e=Q(),[r,n]=(0,t.useState)(""),[i,o]=(0,t.useState)(!1);return(0,st.jsxs)(st.Fragment,{children:[(0,st.jsxs)("video",{className:"video-bg",autoPlay:!0,loop:!0,muted:!0,children:[(0,st.jsx)("source",{src:qt,type:"video/mp4"}),"Seu navegador n\xe3o suporta a tag de v\xeddeo."]}),(0,st.jsxs)("section",{className:"centro",children:[(0,st.jsx)("h1",{children:"Simplifique sua procura"}),(0,st.jsx)("p",{children:"Com o CallMar voc\xea encontrar\xe1 um novo jeito de curtir as praias do litoral pernambucano com seguran\xe7a e tranquilidade"}),(0,st.jsx)(yt,{children:(0,st.jsx)(bt,{lg:5,id:"searchBar",children:(0,st.jsxs)(At,{id:"inputGroup",children:[(0,st.jsx)(Nt,{id:"inputCustom",placeholder:"Para onde vamos?","aria-label":"Pesquisar",value:r,onChange:e=>n(e.target.value)}),(0,st.jsx)(jt,{id:"buttonCustom",onClick:()=>{r.trim()?(async()=>{o(!0);try{const[t,n]=await Promise.all([Ht(r),Vt(r)]);if(!t)throw new Error("N\xe3o foi poss\xedvel encontrar as coordenadas da praia");if(!n)throw new Error("N\xe3o foi poss\xedvel obter os dados meteorol\xf3gicos");e("/mapa",{state:{target:t.properties.address.formattedAddress,geocodeData:t,weatherData:n}})}catch(t){console.error("Erro ao obter os dados:",t)}finally{o(!1)}})():console.error("Por favor, digite o nome de uma praia.")},disabled:i,children:(0,st.jsx)(Wt,{className:"search-icon",id:"iconCustom"})})]})})})]})]})},Yt=r.p+"static/media/image1.d8e219e30620d7ced5e7.png",Xt=()=>(0,st.jsx)(st.Fragment,{children:(0,st.jsxs)("section",{className:"sobre-nos",children:[(0,st.jsxs)("div",{className:"container",children:[(0,st.jsx)("h1",{children:"Sobre N\xf3s"}),(0,st.jsx)("p",{children:"Na Callmar, nossa miss\xe3o \xe9 agilizar o processo de localiza\xe7\xe3o das \xe1reas de risco nas praias do litoral do nordeste de Pernambuco. Nosso objetivo \xe9 fornecer uma plataforma amig\xe1vel que torne toda experi\xeancia de lazer mais suave e segura."}),(0,st.jsx)("button",{className:"saiba-mais",children:"Saiba mais"})]}),(0,st.jsx)("div",{className:"image-container",children:(0,st.jsx)("img",{src:Yt,alt:"Imagem de um celular com a logo da Callmar",className:"image-responsiva"})})]})}),Qt=()=>(0,st.jsx)(st.Fragment,{children:(0,st.jsx)("main",{children:(0,st.jsx)("section",{className:"login-area",children:(0,st.jsxs)("div",{className:"login-container",children:[(0,st.jsxs)("form",{className:"login-form",action:"login_action.php",method:"POST",children:[(0,st.jsx)("div",{className:"input-group",children:(0,st.jsx)("input",{type:"text",id:"username",name:"username",placeholder:"Usu\xe1rio",required:!0})}),(0,st.jsx)("div",{className:"input-group password-group",children:(0,st.jsx)("input",{type:"password",id:"password",name:"password",placeholder:"Senha",required:!0})}),(0,st.jsx)("button",{type:"submit",className:"btn-submit",children:"Entrar"}),(0,st.jsxs)("div",{className:"options",children:[(0,st.jsxs)("label",{children:[(0,st.jsx)("input",{type:"checkbox",name:"remember"})," Lembrar"]}),(0,st.jsx)("a",{href:"#",className:"forgot-password",children:"Esqueci a senha"})]}),(0,st.jsx)("p",{children:"Entrar com"}),(0,st.jsxs)("div",{className:"social-login",children:[(0,st.jsx)("button",{type:"button",className:"btn-social gmail",children:"Gmail"}),(0,st.jsx)("button",{type:"button",className:"btn-social facebook",children:"Facebook"})]})]}),(0,st.jsx)("button",{type:"button",className:"btn-register",onClick:()=>window.location.href="/cadastro",children:"Cadastrar"})]})})})}),Jt=r.p+"static/media/logo.d25bf40279d22518f06a.jpeg",er=()=>(0,st.jsxs)("nav",{className:"navbar",children:[(0,st.jsx)("div",{className:"logo",children:(0,st.jsx)("img",{src:Jt,alt:"Logo CallMar",className:"logo-img"})}),(0,st.jsxs)("div",{className:"menu",children:[(0,st.jsx)(Xe,{to:"/",children:"Inicio"}),(0,st.jsx)(Xe,{to:"/mapa",children:"Mapa"}),(0,st.jsx)(Xe,{to:"/sobre-nos",children:"Sobre N\xf3s"}),(0,st.jsx)(Xe,{to:"/contato",children:"Contato"}),(0,st.jsx)(Xe,{to:"/login",children:"Login"})]})]}),tr=()=>{const[e,r]=(0,t.useState)({fullname:"",email:"",password:"",confirmPassword:""}),n=t=>{const{name:n,value:i}=t.target;r({...e,[n]:i})};return(0,st.jsx)(st.Fragment,{children:(0,st.jsxs)("main",{className:"content",children:[(0,st.jsx)("h1",{children:"Crie sua conta"}),(0,st.jsxs)("form",{className:"register-form",onSubmit:t=>{t.preventDefault(),console.log(e)},children:[(0,st.jsx)("label",{htmlFor:"fullname",children:"Nome Completo"}),(0,st.jsx)("input",{type:"text",id:"fullname",name:"fullname",placeholder:"Digite seu nome completo",value:e.fullname,onChange:n,required:!0}),(0,st.jsx)("label",{htmlFor:"email",children:"Email"}),(0,st.jsx)("input",{type:"email",id:"email",name:"email",placeholder:"Digite seu email",value:e.email,onChange:n,required:!0}),(0,st.jsx)("label",{htmlFor:"password",children:"Senha"}),(0,st.jsx)("input",{type:"password",id:"password",name:"password",placeholder:"Digite sua senha",value:e.password,onChange:n,required:!0}),(0,st.jsx)("label",{htmlFor:"confirm-password",children:"Confirmar Senha"}),(0,st.jsx)("input",{type:"password",id:"confirm-password",name:"confirmPassword",placeholder:"Confirme sua senha",value:e.confirmPassword,onChange:n,required:!0}),(0,st.jsx)("button",{type:"submit",children:"Cadastrar"})]}),(0,st.jsxs)("p",{className:"redirect",children:["J\xe1 possui uma conta? ",(0,st.jsx)(Xe,{to:"/login",children:"Fa\xe7a login"}),"."]})]})})},rr=()=>(0,st.jsx)(st.Fragment,{children:(0,st.jsxs)("div",{className:"content",children:[(0,st.jsx)("h1",{children:"Como podemos ajudar?"}),(0,st.jsxs)("form",{className:"contact-form",children:[(0,st.jsx)("label",{htmlFor:"name",children:"Nome"}),(0,st.jsx)("input",{type:"text",id:"name",name:"name",placeholder:"Nome completo",required:!0}),(0,st.jsx)("label",{htmlFor:"email",children:"Email"}),(0,st.jsx)("input",{type:"email",id:"email",name:"email",placeholder:"exemplo@gmail.com",required:!0}),(0,st.jsx)("label",{htmlFor:"message",children:"Sua Mensagem"}),(0,st.jsx)("textarea",{id:"message",name:"message",rows:"5",placeholder:"Digite sua mensagem aqui...",required:!0}),(0,st.jsx)("button",{type:"submit",children:"Enviar"})]})]})});var nr="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof r.g?r.g:"undefined"!=typeof self?self:{};function ir(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var or={exports:{}},ar=(function(){var e;e=function(){var e={},t={};function r(r,n,i){t[r]=i,"index"===r&&(i="var sharedModule = {}; ("+t.shared+")(sharedModule); ("+t.worker+")(sharedModule);",t.shared(r={}),t.index(e,r),"undefined"!=typeof window)&&e.setWorkerUrl(window.URL.createObjectURL(new Blob([i],{type:"text/javascript"})))}return r("shared",0,(function(e){function t(e,t,r,n){return new(r=r||Promise)((function(i,o){function a(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))}function r(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var n=i;function i(e,t){this.x=e,this.y=t}i.prototype={clone:function(){return new i(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x;return t*t+(e=e.y-this.y)*e},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[0]*this.x+e[1]*this.y;e=e[2]*this.x+e[3]*this.y;return this.x=t,this.y=e,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),r=(e=Math.sin(e),t*this.x-e*this.y);e=e*this.x+t*this.y;return this.x=r,this.y=e,this},_rotateAround:function(e,t){var r=Math.cos(e),n=(e=Math.sin(e),t.x+r*(this.x-t.x)-e*(this.y-t.y));e=t.y+e*(this.x-t.x)+r*(this.y-t.y);return this.x=n,this.y=e,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},i.convert=function(e){return e instanceof i||!Array.isArray(e)?e:new i(e[0],e[1])};var o=r(n),a=s;function s(e,t,r,n){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(n-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=t,this.p2x=r,this.p2y=n}s.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,t){if(void 0===t&&(t=1e-6),e<0)return 0;if(1<e)return 1;for(var r=e,n=0;n<8;n++){var i=this.sampleCurveX(r)-e;if(Math.abs(i)<t)return r;var o=this.sampleCurveDerivativeX(r);if(Math.abs(o)<1e-6)break;r-=i/o}var a=0,s=1;for(r=e,n=0;n<20&&(i=this.sampleCurveX(r),!(Math.abs(i-e)<t));n++)i<e?a=r:s=r,r=.5*(s-a)+a;return r},solve:function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))}};var l=r(a);let c,u;function h(){return c=null==c?"undefined"!=typeof OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof createImageBitmap:c}function d(){if(null==u&&(u=!1,h())){var e=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(e){for(let r=0;r<25;r++){var t=4*r;e.fillStyle=`rgb(${t},${1+t},${2+t})`,e.fillRect(r%5,Math.floor(r/5),1,1)}var r=e.getImageData(0,0,5,5).data;for(let e=0;e<100;e++)if(e%4!=3&&r[e]!==e){u=!0;break}}}return u||!1}function p(e,t,r,n){const i=new l(e,t,r,n);return function(e){return i.solve(e)}}function f(e,t,r){return Math.min(r,Math.max(t,e))}function m(e,t,r){var n=r-t;return(e=((e-t)%n+n)%n+t)===t?r:e}function g(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];for(const i of r)for(const t in i)e[t]=i[t];return e}a=p(.25,.1,.25,1);let y=1;function v(e,t,r){var n={};for(const i in e)n[i]=t.call(r||this,e[i],i,e);return n}function _(e,t,r){var n={};for(const i in e)t.call(r||this,e[i],i,e)&&(n[i]=e[i]);return n}function b(e){return Array.isArray(e)?e.map(b):"object"==typeof e&&e?v(e,b):e}const w={};function x(e){w[e]||("undefined"!=typeof console&&console.warn(e),w[e]=!0)}function C(e,t,r){return(r.y-e.y)*(t.x-e.x)>(t.y-e.y)*(r.x-e.x)}function S(e){return"undefined"!=typeof WorkerGlobalScope&&void 0!==e&&e instanceof WorkerGlobalScope}let E=null;function T(e){return"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap}const I="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function k(e,r,n,i,o){return t(this,void 0,void 0,(function*(){if("undefined"==typeof VideoFrame)throw new Error("VideoFrame not supported");var t,a,s,l,c,u,h,d,p,f=new VideoFrame(e,{timestamp:0});try{var m=null==f?void 0:f.format;if(!m||!m.startsWith("BGR")&&!m.startsWith("RGB"))throw new Error("Unrecognized format "+m);var g=m.startsWith("BGR"),y=new Uint8ClampedArray(i*o*4);if(yield f.copyTo(y,(t=e,a=r,s=n,l=i,c=o,u=4*Math.max(-a,0),u=(Math.max(0,s)-s)*l*4+u,h=4*l,d=Math.max(0,a),p=Math.max(0,s),{rect:{x:d,y:p,width:Math.min(t.width,a+l)-d,height:Math.min(t.height,s+c)-p},layout:[{offset:u,stride:h}]})),g)for(let e=0;e<y.length;e+=4){var v=y[e];y[e]=y[e+2],y[e+2]=v}return y}finally{f.close()}}))}let A,P;const M="AbortError";function R(){return new Error(M)}const O={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function L(e){return O.REGISTERED_PROTOCOLS[e.substring(0,e.indexOf("://"))]}const D="global-dispatcher";class N extends Error{constructor(e,t,r,n){super(`AJAXError: ${t} (${e}): `+r),this.status=e,this.statusText=t,this.url=r,this.body=n}}const z=()=>S(self)?self.worker&&self.worker.referrer:("blob:"===window.location.protocol?window.parent:window).location.href;function F(e,r){if(/:\/\//.test(e.url)&&!/^https?:|^file:/.test(e.url)){var n=L(e.url);if(n)return n(e,r);if(S(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:e,targetMapId:D},r)}if(!(e=>/^file:/.test(e)||/^file:/.test(z())&&!/^\w+:/.test(e))(e.url)){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(e,r){return t(this,void 0,void 0,(function*(){var t=new Request(e.url,{method:e.method||"GET",body:e.body,credentials:e.credentials,headers:e.headers,cache:e.cache,referrer:z(),signal:r.signal});if(!(t=("json"===e.type&&t.headers.set("Accept","application/json"),yield fetch(t))).ok)throw i=yield t.blob(),new N(t.status,t.statusText,e.url,i);let n;var i=yield n="arrayBuffer"===e.type||"image"===e.type?t.arrayBuffer():"json"===e.type?t.json():t.text();if(r.signal.aborted)throw R();return{data:i,cacheControl:t.headers.get("Cache-Control"),expires:t.headers.get("Expires")}}))}(e,r);if(S(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:e,mustQueue:!0,targetMapId:D},r)}return i=e,o=r,new Promise(((e,t)=>{const r=new XMLHttpRequest;r.open(i.method||"GET",i.url,!0),"arrayBuffer"!==i.type&&"image"!==i.type||(r.responseType="arraybuffer");for(const n in i.headers)r.setRequestHeader(n,i.headers[n]);"json"===i.type&&(r.responseType="text",r.setRequestHeader("Accept","application/json")),r.withCredentials="include"===i.credentials,r.onerror=()=>{t(new Error(r.statusText))},r.onload=()=>{if(!o.signal.aborted)if((200<=r.status&&r.status<300||0===r.status)&&null!==r.response){let o=r.response;if("json"===i.type)try{o=JSON.parse(r.response)}catch(n){return void t(n)}e({data:o,cacheControl:r.getResponseHeader("Cache-Control"),expires:r.getResponseHeader("Expires")})}else{var n=new Blob([r.response],{type:r.getResponseHeader("Content-Type")});t(new N(r.status,r.statusText,i.url,n))}},o.signal.addEventListener("abort",(()=>{r.abort(),t(R())})),r.send(i.body)}));var i,o}function B(e){var t;return!e||e.indexOf("://")<=0||0===e.indexOf("data:image/")||0===e.indexOf("blob:")||(e=new URL(e),t=window.location,e.protocol===t.protocol&&e.host===t.host)}function U(e,t,r){r[e]&&-1!==r[e].indexOf(t)||(r[e]=r[e]||[],r[e].push(t))}function j(e,t,r){r&&r[e]&&-1!==(t=r[e].indexOf(t))&&r[e].splice(t,1)}class q{constructor(e){g(this,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),this.type=e}}class H extends q{constructor(e){super("error",g({error:e},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}}class V{on(e,t){return this._listeners=this._listeners||{},U(e,t,this._listeners),this}off(e,t){return j(e,t,this._listeners),j(e,t,this._oneTimeListeners),this}once(e,t){return t?(this._oneTimeListeners=this._oneTimeListeners||{},U(e,t,this._oneTimeListeners),this):new Promise((t=>this.once(e,t)))}fire(e,t){var r=(e="string"==typeof e?new q(e,t||{}):e).type;if(this.listens(r)){for(const t of(e.target=this)._listeners&&this._listeners[r]?this._listeners[r].slice():[])t.call(this,e);for(const t of this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[])j(r,t,this._oneTimeListeners),t.call(this,e);(t=this._eventedParent)&&(g(e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),t.fire(e))}else e instanceof H&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&0<this._listeners[e].length||this._oneTimeListeners&&this._oneTimeListeners[e]&&0<this._oneTimeListeners[e].length||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,t){return this._eventedParent=e,this._eventedParentData=t,this}}var G={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const K=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Z(e,t){if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return;for(let r=0;r<e.length;r++)if(!Z(e[r],t[r]))return;return 1}if("object"!=typeof e||null===e||null===t)return e===t;if("object"==typeof t&&Object.keys(e).length===Object.keys(t).length){for(const r in e)if(!Z(e[r],t[r]))return;return 1}}function W(e,t){e.push(t)}function $(e,t,r){W(r,{command:"addSource",args:[e,t[e]]})}function Y(e,t,r){W(t,{command:"removeSource",args:[e]}),r[e]=!0}function X(e,t,r,n,i,o){t=t||{};for(const a in e=e||{})!Object.prototype.hasOwnProperty.call(e,a)||Z(e[a],t[a])||r.push({command:o,args:[n,a,t[a],i]});for(const a in t)!Object.prototype.hasOwnProperty.call(t,a)||Object.prototype.hasOwnProperty.call(e,a)||Z(e[a],t[a])||r.push({command:o,args:[n,a,t[a],i]})}function Q(e){return e.id}function J(e,t){return e[t.id]=t,e}class ee{constructor(e,t,r,n){this.message=(e?e+": ":"")+r,n&&(this.identifier=n),null!=t&&t.__line__&&(this.line=t.__line__)}}function te(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];for(const i of r)for(const t in i)e[t]=i[t];return e}class re extends Error{constructor(e,t){super(t),this.message=t,this.key=e}}class ne{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];for(var[r,n]of(this.parent=e,this.bindings={},t))this.bindings[r]=n}concat(e){return new ne(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const ie={kind:"null"},oe={kind:"number"},ae={kind:"string"},se={kind:"boolean"},le={kind:"color"},ce={kind:"object"},ue={kind:"value"},he={kind:"collator"},de={kind:"formatted"},pe={kind:"padding"},fe={kind:"resolvedImage"},me={kind:"variableAnchorOffsetCollection"};function ge(e,t){return{kind:"array",itemType:e,N:t}}function ye(e){var t;return"array"===e.kind?(t=ye(e.itemType),"number"==typeof e.N?`array<${t}, ${e.N}>`:"value"===e.itemType.kind?"array":`array<${t}>`):e.kind}const ve=[ie,oe,ae,se,le,de,ce,ge(ue),pe,fe,me];function _e(e,t){if("error"===t.kind)return null;if("array"===e.kind){if("array"===t.kind&&(0===t.N&&"value"===t.itemType.kind||!_e(e.itemType,t.itemType))&&("number"!=typeof e.N||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if("value"===e.kind)for(const e of ve)if(!_e(e,t))return null}return`Expected ${ye(e)} but found ${ye(t)} instead.`}function be(e,t){return t.some((t=>t.kind===e.kind))}function we(e,t){return t.some((t=>"null"===t?null===e:"array"===t?Array.isArray(e):"object"===t?e&&!Array.isArray(e)&&"object"==typeof e:t===typeof e))}function xe(e,t){return"array"===e.kind&&"array"===t.kind?e.itemType.kind===t.itemType.kind&&"number"==typeof e.N:e.kind===t.kind}const Ce=.96422,Se=.82521,Ee=4/29,Te=6/29,Ie=3*Te*Te,ke=Te*Te*Te,Ae=Math.PI/180,Pe=180/Math.PI;function Me(e){return(e%=360)<0&&(e+=360),e}function Re(e){let[t,r,n,i]=e;return function(e){let t,o;var a=Le((.2225045*(e=Oe(e))+.7168786*(r=Oe(r))+.0606169*(n=Oe(n)))/1);return[(e=(e===r&&r===n?t=o=a:(t=Le((.4360747*e+.3850649*r+.1430804*n)/Ce),o=Le((.0139322*e+.0971045*r+.7141733*n)/Se)),116*a-16))<0?0:e,500*(t-a),200*(a-o),i]}(t)}function Oe(e){return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Le(e){return e>ke?Math.pow(e,1/3):e/Ie+Ee}function De(e){let[t,r,n,i]=e;return t=(t+16)/116,r=isNaN(r)?t:t+r/500,n=isNaN(n)?t:t-n/200,t=1*ze(t),[Ne(3.1338561*(r=Ce*ze(r))-1.6168667*t-.4906146*(n=Se*ze(n))),Ne(-.9787684*r+1.9161415*t+.033454*n),Ne(.0719453*r-.2289914*t+1.4052427*n),i]}function Ne(e){return(e=e<=.00304?12.92*e:1.055*Math.pow(e,1/2.4)-.055)<0?0:1<e?1:e}function ze(e){return e>Te?e*e*e:Ie*(e-Ee)}function Fe(e){return parseInt(e.padEnd(2,e),16)/255}function Be(e,t){return Ue(t?e/100:e,0,1)}function Ue(e,t,r){return Math.min(Math.max(t,e),r)}function je(e){return!e.some(Number.isNaN)}const qe={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class He{constructor(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];this.r=e,this.g=t,this.b=r,this.a=n,i||(this.r*=n,this.g*=n,this.b*=n,n)||this.overwriteGetter("rgb",[e,t,r,n])}static parse(e){return e instanceof He?e:"string"==typeof e&&(e=function(e){if("transparent"===(e=e.toLowerCase().trim()))return[0,0,0,0];var t,r,n,i;if(i=qe[e])return[i,a,o]=i,[i/255,a/255,o/255,1];if(e.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(e))return i=e.length<6?1:2,[Fe(e.slice(a=1,a+=i)),Fe(e.slice(a,a+=i)),Fe(e.slice(a,a+=i)),Fe(e.slice(a,a+i)||"ff")];if(e.startsWith("rgb")&&(o=e.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/))){var o,[,a,i,o,s,l,c,u,h,d,p,f]=o;return("  "===(o=[o||" ",c||" ",d].join(""))||"  /"===o||",,"===o||",,,"===o)&&(d="%%%"===(c=[i,l,h].join(""))?100:""===c?255:0)&&je(o=[Ue(+a/d,0,1),Ue(+s/d,0,1),Ue(+u/d,0,1),p?Be(+p,f):1])?o:void 0}if(i=e.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/)){var f,[,l,h,c,a,s,u,d,p]=i;if(("  "===(f=[h||" ",a||" ",u].join(""))||"  /"===f||",,"===f||",,,"===f)&&je(o=[+l,Ue(+c,0,100),Ue(+s,0,100),d?Be(+d,p):1]))return[t,r,n,e]=[o][0],t=Me(t),r/=100,n/=100,[m(0),m(8),m(4),e]}function m(e){e=(e+t/30)%12;var i=r*Math.min(n,1-n);return n-i*Math.max(-1,Math.min(e-3,9-e,1))}}(e))?new He(...e,!1):void 0}get rgb(){var{r:e,g:t,b:r,a:n}=this,i=n||1/0;return this.overwriteGetter("rgb",[e/i,t/i,r/i,n])}get hcl(){return this.overwriteGetter("hcl",function(e){var[e,t,r,n]=Re(e),i=Math.sqrt(t*t+r*r);return[Math.round(1e4*i)?Me(Math.atan2(r,t)*Pe):NaN,i,e,n]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Re(this.rgb))}overwriteGetter(e,t){return Object.defineProperty(this,e,{value:t}),t}toString(){var[e,t,r,n]=this.rgb;return`rgba(${[e,t,r].map((e=>Math.round(255*e))).join(",")},${n})`}}He.black=new He(0,0,0,1),He.white=new He(1,1,1,1),He.transparent=new He(0,0,0,0),He.red=new He(1,0,0,1);class Ve{constructor(e,t,r){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale||[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,t){return this.collator.compare(e,t)}resolvedLocale(){return new Intl.Collator(this.locale||[]).resolvedOptions().locale}}class Ge{constructor(e,t,r,n,i){this.text=e,this.image=t,this.scale=r,this.fontStack=n,this.textColor=i}}class Ke{constructor(e){this.sections=e}static fromString(e){return new Ke([new Ge(e,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some((e=>0!==e.text.length||e.image&&0!==e.image.name.length))}static factory(e){return e instanceof Ke?e:Ke.fromString(e)}toString(){return 0===this.sections.length?"":this.sections.map((e=>e.text)).join("")}}class Ze{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Ze)return e;if("number"==typeof e)return new Ze([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||4<e.length)){for(const t of e)if("number"!=typeof t)return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]]}return new Ze(e)}}toString(){return JSON.stringify(this.values)}}const We=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class $e{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof $e)return e;if(Array.isArray(e)&&!(e.length<1)&&e.length%2==0){for(let n=0;n<e.length;n+=2){var t=e[n],r=e[n+1];if("string"!=typeof t||!We.has(t))return;if(!Array.isArray(r)||2!==r.length||"number"!=typeof r[0]||"number"!=typeof r[1])return}return new $e(e)}}toString(){return JSON.stringify(this.values)}}class Ye{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new Ye({name:e,available:!1}):null}}function Xe(e,t,r,n){return"number"==typeof e&&0<=e&&e<=255&&"number"==typeof t&&0<=t&&t<=255&&"number"==typeof r&&0<=r&&r<=255?void 0===n||"number"==typeof n&&0<=n&&n<=1?null:`Invalid rgba value [${[e,t,r,n].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof n?[e,t,r,n]:[e,t,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Qe(e){if(null===e||"string"==typeof e||"boolean"==typeof e||"number"==typeof e||e instanceof He||e instanceof Ve||e instanceof Ke||e instanceof Ze||e instanceof $e||e instanceof Ye)return 1;if(Array.isArray(e)){for(const t of e)if(!Qe(t))return;return 1}if("object"==typeof e){for(const t in e)if(!Qe(e[t]))return;return 1}}function Je(e){if(null===e)return ie;if("string"==typeof e)return ae;if("boolean"==typeof e)return se;if("number"==typeof e)return oe;if(e instanceof He)return le;if(e instanceof Ve)return he;if(e instanceof Ke)return de;if(e instanceof Ze)return pe;if(e instanceof $e)return me;if(e instanceof Ye)return fe;if(Array.isArray(e)){var t=e.length;let n;for(const t of e){var r=Je(t);if(n){if(n!==r){n=ue;break}}else n=r}return ge(n||ue,t)}return ce}function et(e){var t=typeof e;return null===e?"":"string"==t||"number"==t||"boolean"==t?String(e):e instanceof He||e instanceof Ke||e instanceof Ze||e instanceof $e||e instanceof Ye?e.toString():JSON.stringify(e)}class tt{constructor(e,t){this.type=e,this.value=t}static parse(e,t){if(2!==e.length)return t.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Qe(e[1]))return t.error("invalid value");let r=Je(e=e[1]);return t=t.expectedType,"array"!==r.kind||0!==r.N||!t||"array"!==t.kind||"number"==typeof t.N&&0!==t.N||(r=t),new tt(r,e)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class rt{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}const nt={string:ae,number:oe,boolean:se,object:ce};class it{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let r,n=1;var i=e[0];if("array"===i){let i,o;if(2<e.length){const r=e[1];if("string"!=typeof r||!(r in nt)||"object"===r)return t.error('The item type argument of "array" must be one of string, number, boolean',1);i=nt[r],n++}else i=ue;if(3<e.length){if(null!==e[2]&&("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);o=e[2],n++}r=ge(i,o)}else{if(!nt[i])throw new Error("Types doesn't contain name = "+i);r=nt[i]}for(var o=[];n<e.length;n++){var a=t.parse(e[n],n,ue);if(!a)return null;o.push(a)}return new it(r,o)}evaluate(e){for(let r=0;r<this.args.length;r++){var t=this.args[r].evaluate(e);if(!_e(this.type,Je(t)))return t;if(r===this.args.length-1)throw new rt(`Expected value to be of type ${ye(this.type)}, but found ${ye(Je(t))} instead.`)}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}const ot={"to-boolean":se,"to-color":le,"to-number":oe,"to-string":ae};class at{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[0];if(!ot[r])throw new Error(`Can't parse ${r} as it is not part of the known types`);if(("to-boolean"===r||"to-string"===r)&&2!==e.length)return t.error("Expected one argument.");r=ot[r];var n=[];for(let o=1;o<e.length;o++){var i=t.parse(e[o],o,ue);if(!i)return null;n.push(i)}return new at(r,n)}evaluate(e){switch(this.type.kind){case"boolean":return Boolean(this.args[0].evaluate(e));case"color":{let r,n;for(const i of this.args){if(r=i.evaluate(e),n=null,r instanceof He)return r;if("string"==typeof r){var t=e.parseColor(r);if(t)return t}else if(Array.isArray(r)&&!(n=r.length<3||4<r.length?`Invalid rbga value ${JSON.stringify(r)}: expected an array containing either three or four numeric values.`:Xe(r[0],r[1],r[2],r[3])))return new He(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new rt(n||`Could not parse color from value '${"string"==typeof r?r:JSON.stringify(r)}'`)}case"padding":{let t;for(const n of this.args){t=n.evaluate(e);var r=Ze.parse(t);if(r)return r}throw new rt(`Could not parse padding from value '${"string"==typeof t?t:JSON.stringify(t)}'`)}case"variableAnchorOffsetCollection":{let t;for(const r of this.args){t=r.evaluate(e);var n=$e.parse(t);if(n)return n}throw new rt(`Could not parse variableAnchorOffsetCollection from value '${"string"==typeof t?t:JSON.stringify(t)}'`)}case"number":{let t=null;for(const r of this.args){if(null===(t=r.evaluate(e)))return 0;var i=Number(t);if(!isNaN(i))return i}throw new rt(`Could not convert ${JSON.stringify(t)} to number.`)}case"formatted":return Ke.fromString(et(this.args[0].evaluate(e)));case"resolvedImage":return Ye.fromString(et(this.args[0].evaluate(e)));default:return et(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}const st=["Unknown","Point","LineString","Polygon"];class lt{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?st[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let t=this._parseColorCache[e];return t||(this._parseColorCache[e]=He.parse(e))}}class ct{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new ne,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[];this.registry=e,this.path=r,this.key=r.map((e=>`[${e}]`)).join(""),this.scope=i,this.errors=o,this.expectedType=n,this._isConstant=t}parse(e,t,r,n){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return(t?this.concat(t,r,n):this)._parse(e,i)}_parse(e,t){function r(e,t,r){return"assert"===r?new it(t,[e]):"coerce"===r?new at(t,[e]):e}if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var n=e[0];if("string"!=typeof n)return this.error(`Expression name must be a string, but found ${typeof n} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;if(i=this.registry[n]){let a=i.parse(e,this);if(!a)return null;if(this.expectedType){var i=this.expectedType,o=a.type;if("string"!==i.kind&&"number"!==i.kind&&"boolean"!==i.kind&&"object"!==i.kind&&"array"!==i.kind||"value"!==o.kind)if("color"!==i.kind&&"formatted"!==i.kind&&"resolvedImage"!==i.kind||"value"!==o.kind&&"string"!==o.kind)if("padding"!==i.kind||"value"!==o.kind&&"number"!==o.kind&&"array"!==o.kind)if("variableAnchorOffsetCollection"!==i.kind||"value"!==o.kind&&"array"!==o.kind){if(this.checkSubtype(i,o))return null}else a=r(a,i,t.typeAnnotation||"coerce");else a=r(a,i,t.typeAnnotation||"coerce");else a=r(a,i,t.typeAnnotation||"coerce");else a=r(a,i,t.typeAnnotation||"assert")}if(!(a instanceof tt)&&"resolvedImage"!==a.type.kind&&this._isConstant(a)){o=new lt;try{a=new tt(a.type,a.evaluate(o))}catch(n){return this.error(n.message),null}}return a}return this.error(`Unknown expression "${n}". If you wanted a literal array, use ["literal", [...]].`,0)}return void 0===e?this.error("'undefined' value invalid. Use null instead."):"object"==typeof e?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error(`Expected an array, but found ${typeof e} instead.`)}concat(e,t,r){return e="number"==typeof e?this.path.concat(e):this.path,r=r?this.scope.concat(r):this.scope,new ct(this.registry,this._isConstant,e,t||null,r,this.errors)}error(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];r=""+this.key+r.map((e=>`[${e}]`)).join(""),this.errors.push(new re(r,e))}checkSubtype(e,t){return(e=_e(e,t))&&this.error(e),e}}class ut{constructor(e,t,r){this.type=he,this.locale=r,this.caseSensitive=e,this.diacriticSensitive=t}static parse(e,t){if(2!==e.length)return t.error("Expected one argument.");if("object"!=typeof(e=e[1])||Array.isArray(e))return t.error("Collator options argument must be an object.");var r=t.parse(void 0!==e["case-sensitive"]&&e["case-sensitive"],1,se);if(!r)return null;var n=t.parse(void 0!==e["diacritic-sensitive"]&&e["diacritic-sensitive"],1,se);if(!n)return null;let i=null;return e.locale&&!(i=t.parse(e.locale,1,ae))?null:new ut(r,n,i)}evaluate(e){return new Ve(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}const ht=8192;function dt(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function pt(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function ft(e,t){var r=(180+e[0])/360;e=e[1],e=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360,t=Math.pow(2,t.z);return[Math.round(r*t*ht),Math.round(e*t*ht)]}function mt(e,t){let r=!1;for(let c=0,u=t.length;c<u;c++){var n=t[c];for(let t=0,c=n.length;t<c-1;t++){if(i=e,o=n[t],a=n[t+1],l=s=void 0,s=i[0]-o[0],o=i[1]-o[1],l=i[0]-a[0],s*(i=i[1]-a[1])-l*o==0&&s*l<=0&&o*i<=0)return;a=e,s=n[t],l=n[t+1],s[1]>a[1]!=l[1]>a[1]&&a[0]<(l[0]-s[0])*(a[1]-s[1])/(l[1]-s[1])+s[0]&&(r=!r)}}var i,o,a,s,l;return r}function gt(e,t,r,n){var i=e[0]-r[0],o=(e=e[1]-r[1],t[0]-r[0]),a=(t=t[1]-r[1],n[0]-r[0]);r=i*(n=n[1]-r[1])-a*e,i=o*n-a*t;return 0<r&&i<0||r<0&&0<i}function yt(e,t,r){for(const c of r)for(let r=0;r<c.length-1;++r)if(n=e,i=t,o=c[r],a=c[r+1],void 0,s=[i[0]-n[0],i[1]-n[1]],0!=(l=[a[0]-o[0],a[1]-o[1]])[0]*s[1]-l[1]*s[0]&&gt(n,i,o,a)&&gt(o,a,n,i))return 1;var n,i,o,a,s,l}function vt(e,t){for(let r=0;r<e.length;++r)if(!mt(e[r],t))return;for(let r=0;r<e.length-1;++r)if(yt(e[r],e[r+1],t))return;return 1}function _t(e,t,r){var n=[];for(let a=0;a<e.length;a++){var i=[];for(let n=0;n<e[a].length;n++){var o=ft(e[a][n],r);dt(t,o),i.push(o)}n.push(i)}return n}function bt(e,t,r){var n=[];for(let o=0;o<e.length;o++){var i=_t(e[o],t,r);n.push(i)}return n}function wt(e,t,r,n){if(e[0]<r[0]||e[0]>r[2]){var i=.5*n;let t=e[0]-r[0]>i?-n:r[0]-e[0]>i?n:0;0===t&&(t=e[0]-r[2]>i?-n:r[2]-e[0]>i?n:0),e[0]+=t}dt(t,e)}function xt(e,t,r,n){var i=Math.pow(2,n.z)*ht,o=[n.x*ht,n.y*ht],a=[];for(const l of e)for(const e of l){var s=[e.x+o[0],e.y+o[1]];wt(s,t,r,i),a.push(s)}return a}function Ct(e,t,r,n){var i=Math.pow(2,n.z)*ht,o=[n.x*ht,n.y*ht],a=[];for(const c of e){var s=[];for(const e of c){var l=[e.x+o[0],e.y+o[1]];dt(t,l),s.push(l)}a.push(s)}if(t[2]-t[0]<=i/2){(n=t)[0]=n[1]=1/0,n[2]=n[3]=-1/0;for(const e of a)for(const n of e)wt(n,t,r,i)}return a}class St{constructor(e,t){this.type=se,this.geojson=e,this.geometries=t}static parse(e,t){if(2!==e.length)return t.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Qe(e[1]))if("FeatureCollection"===(e=e[1]).type){var r=[];for(const t of e.features){var{type:n,coordinates:i}=t.geometry;"Polygon"===n&&r.push(i),"MultiPolygon"===n&&r.push(...i)}if(r.length)return new St(e,o={type:"MultiPolygon",coordinates:r})}else if("Feature"===e.type){var o=e.geometry.type;if("Polygon"===o||"MultiPolygon"===o)return new St(e,e.geometry)}else if("Polygon"===e.type||"MultiPolygon"===e.type)return new St(e,e);return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(e,t){var r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=e.canonicalID();if("Polygon"===t.type){var o=_t(t.coordinates,n,i),a=xt(e.geometry(),r,n,i);if(!pt(r,n))return!1;for(const e of a)if(!mt(e,o))return!1}if("MultiPolygon"===t.type){var s=bt(t.coordinates,n,i);if(a=xt(e.geometry(),r,n,i),!pt(r,n))return!1;for(const e of a)if(!function(e,t){for(let r=0;r<t.length;r++)if(mt(e,t[r]))return 1}(e,s))return!1}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(e,t){var r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=e.canonicalID();if("Polygon"===t.type){var o=_t(t.coordinates,n,i),a=Ct(e.geometry(),r,n,i);if(!pt(r,n))return!1;for(const e of a)if(!vt(e,o))return!1}if("MultiPolygon"===t.type){var s=bt(t.coordinates,n,i);if(a=Ct(e.geometry(),r,n,i),!pt(r,n))return!1;for(const e of a)if(!function(e,t){for(let r=0;r<t.length;r++)if(vt(e,t[r]))return 1}(e,s))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class Et{constructor(e,t){this.type=t.type,this.name=e,this.boundExpression=t}static parse(e,t){return 2!==e.length||"string"!=typeof e[1]?t.error("'var' expression requires exactly one string literal argument."):(e=e[1],t.scope.has(e)?new Et(e,t.scope.get(e)):t.error(`Unknown variable "${e}". Make sure "${e}" has been bound in an enclosing "let" expression before using it.`,1))}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class Tt{constructor(e,t,r,n){this.name=e,this.type=t,this._evaluate=r,this.args=n}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,t){var r=e[0];if(!(o=Tt.definitions[r]))return t.error(`Unknown expression "${r}". If you wanted a literal array, use ["literal", [...]].`,0);var n,i,o,a=Array.isArray(o)?o[0]:o.type,s=(o=Array.isArray(o)?[[o[1],o[2]]]:o.overloads).filter((t=>{let[r]=t;return!Array.isArray(r)||r.length===e.length-1}));let l=null;for([n,i]of s){l=new ct(t.registry,It,t.path,null,t.scope);var c=[];let o=!1;for(let t=1;t<e.length;t++){var u=e[t],h=Array.isArray(n)?n[t-1]:n.type;if(!(u=l.parse(u,1+c.length,h))){o=!0;break}c.push(u)}if(!o)if(Array.isArray(n)&&n.length!==c.length)l.error(`Expected ${n.length} arguments, but found ${c.length} instead.`);else{for(let e=0;e<c.length;e++){var d=Array.isArray(n)?n[e]:n.type,p=c[e];l.concat(e+1).checkSubtype(d,p.type)}if(0===l.errors.length)return new Tt(r,a,i,c)}}if(1===s.length)t.errors.push(...l.errors);else{s=(s.length?s:o).map((e=>{let[t]=e;return function(e){return Array.isArray(e)?`(${e.map(ye).join(", ")})`:`(${ye(e.type)}...)`}(t)})).join(" | ");var f=[];for(let r=1;r<e.length;r++){var m=t.parse(e[r],1+f.length);if(!m)return null;f.push(ye(m.type))}t.error(`Expected arguments of type ${s}, but found (${f.join(", ")}) instead.`)}return null}static register(e,t){for(const r in Tt.definitions=t)e[r]=Tt}}function It(e){if(e instanceof Et)return It(e.boundExpression);if(e instanceof Tt&&"error"===e.name)return!1;if(e instanceof ut)return!1;if(e instanceof St)return!1;const t=e instanceof at||e instanceof it;let r=!0;return e.eachChild((e=>{r=t?r&&It(e):r&&e instanceof tt})),!!r&&kt(e)&&Pt(e,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function kt(e){if(e instanceof Tt){if("get"===e.name&&1===e.args.length)return!1;if("feature-state"===e.name)return!1;if("has"===e.name&&1===e.args.length)return!1;if("properties"===e.name||"geometry-type"===e.name||"id"===e.name)return!1;if(/^filter-/.test(e.name))return!1}if(e instanceof St)return!1;let t=!0;return e.eachChild((e=>{t&&!kt(e)&&(t=!1)})),t}function At(e){if(!(e instanceof Tt&&"feature-state"===e.name)){let t=!0;return e.eachChild((e=>{t&&!At(e)&&(t=!1)})),t}}function Pt(e,t){if(e instanceof Tt&&0<=t.indexOf(e.name))return!1;let r=!0;return e.eachChild((e=>{r&&!Pt(e,t)&&(r=!1)})),r}function Mt(e,t){var r=e.length-1;let n=0,i=r;for(var o,a,s;n<=i;)if(a=e[o=Math.floor((n+i)/2)],s=e[o+1],a<=t){if(o===r||t<s)return o;n=o+1}else{if(!(t<a))throw new rt("Input is not a number.");i=o-1}return 0}class Rt{constructor(e,t,r){for(var[n,i]of(this.type=e,this.input=t,this.labels=[],this.outputs=[],r))this.labels.push(n),this.outputs.push(i)}static parse(e,t){if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");var r=t.parse(e[1],1,oe);if(!r)return null;var n=[];let i=null;t.expectedType&&"value"!==t.expectedType.kind&&(i=t.expectedType);for(let c=1;c<e.length;c+=2){var o=1===c?-1/0:e[c],a=e[c+1],s=c,l=c+1;if("number"!=typeof o)return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',s);if(n.length&&n[n.length-1][0]>=o)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',s);if(!(s=t.parse(a,l,i)))return null;i=i||s.type,n.push([o,s])}return new Rt(i,r,n)}evaluate(e){var t,r,n=this.labels,i=this.outputs;return(1===n.length||(t=this.input.evaluate(e))<=n[0]?i[0]:t>=n[(r=n.length)-1]?i[r-1]:i[Mt(n,t)]).evaluate(e)}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}}var Ot=Lt;function Lt(e,t,r,n){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(n-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=t,this.p2x=r,this.p2y=n}Lt.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,t){if(void 0===t&&(t=1e-6),e<0)return 0;if(1<e)return 1;for(var r=e,n=0;n<8;n++){var i=this.sampleCurveX(r)-e;if(Math.abs(i)<t)return r;var o=this.sampleCurveDerivativeX(r);if(Math.abs(o)<1e-6)break;r-=i/o}var a=0,s=1;for(r=e,n=0;n<20&&(i=this.sampleCurveX(r),!(Math.abs(i-e)<t));n++)i<e?a=r:s=r,r=.5*(s-a)+a;return r},solve:function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))}};var Dt=function(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}(Ot);function Nt(e,t,r){return e+r*(t-e)}function zt(e,t,r){return e.map(((e,n)=>Nt(e,t[n],r)))}const Ft={number:Nt,color:function(e,t,r){switch(arguments.length>3&&void 0!==arguments[3]?arguments[3]:"rgb"){case"rgb":var[n,i,o,a]=zt(e.rgb,t.rgb,r);return new He(n,i,o,a,!1);case"hcl":{var[n,i,o,a]=e.hcl,[s,l,c,u]=t.hcl;let h,d;if(isNaN(n)||isNaN(s))isNaN(n)?isNaN(s)?h=NaN:(h=s,1!==o&&0!==o||(d=l)):(h=n,1!==c&&0!==c||(d=i));else{let e=s-n;n<s&&180<e?e-=360:s<n&&180<n-s&&(e+=360),h=n+r*e}[s,n,i,l]=[h,null!==d&&void 0!==d?d:Nt(i,l,r),Nt(o,c,r),Nt(a,u,r)],s=isNaN(s)?0:s*Ae;var[o,c,a,u]=De([i,Math.cos(s)*n,Math.sin(s)*n,l]);return new He(o,c,a,u,!1)}case"lab":var[s,l,o,c]=De(zt(e.lab,t.lab,r));return new He(s,l,o,c,!1)}},array:zt,padding:function(e,t,r){return new Ze(zt(e.values,t.values,r))},variableAnchorOffsetCollection:function(e,t,r){var n=e.values,i=t.values;if(n.length!==i.length)throw new rt(`Cannot interpolate values of different length. from: ${e.toString()}, to: `+t.toString());var o=[];for(let u=0;u<n.length;u+=2){if(n[u]!==i[u])throw new rt(`Cannot interpolate values containing mismatched anchors. from[${u}]: ${n[u]}, to[${u}]: `+i[u]);o.push(n[u]);var[a,s]=n[u+1],[l,c]=i[u+1];o.push([Nt(a,l,r),Nt(s,c,r)])}return new $e(o)}};class Bt{constructor(e,t,r,n,i){for(var[o,a]of(this.type=e,this.operator=t,this.interpolation=r,this.input=n,this.labels=[],this.outputs=[],i))this.labels.push(o),this.outputs.push(a)}static interpolationFactor(e,t,r,n){let i=0;return"exponential"===e.name?i=Ut(t,e.base,r,n):"linear"===e.name?i=Ut(t,1,r,n):"cubic-bezier"===e.name&&(e=e.controlPoints,i=(e=new Dt(e[0],e[1],e[2],e[3])).solve(Ut(t,1,r,n))),i}static parse(e,t){let[r,n,i,...o]=e;if(!Array.isArray(n)||0===n.length)return t.error("Expected an interpolation type expression.",1);if("linear"===n[0])n={name:"linear"};else if("exponential"===n[0]){var a=n[1];if("number"!=typeof a)return t.error("Exponential interpolation requires a numeric base.",1,1);n={name:"exponential",base:a}}else{if("cubic-bezier"!==n[0])return t.error("Unknown interpolation type "+String(n[0]),1,0);if(4!==(a=n.slice(1)).length||a.some((e=>"number"!=typeof e||e<0||1<e)))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);n={name:"cubic-bezier",controlPoints:a}}if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(i=t.parse(i,2,oe)))return null;var s=[];let l=null;"interpolate-hcl"===r||"interpolate-lab"===r?l=le:t.expectedType&&"value"!==t.expectedType.kind&&(l=t.expectedType);for(let p=0;p<o.length;p+=2){var c=o[p],u=o[p+1],h=p+3,d=p+4;if("number"!=typeof c)return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',h);if(s.length&&s[s.length-1][0]>=c)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',h);if(!(h=t.parse(u,d,l)))return null;l=l||h.type,s.push([c,h])}return xe(l,oe)||xe(l,le)||xe(l,pe)||xe(l,me)||xe(l,ge(oe))?new Bt(l,r,n,i,s):t.error(`Type ${ye(l)} is not interpolatable.`)}evaluate(e){var t=this.labels,r=this.outputs;if(1===t.length)return r[0].evaluate(e);var n=this.input.evaluate(e);if(n<=t[0])return r[0].evaluate(e);if(n>=t[(i=t.length)-1])return r[i-1].evaluate(e);var i,o=t[i=Mt(t,n)],a=(t=t[i+1],Bt.interpolationFactor(this.interpolation,n,o,t)),s=r[i].evaluate(e),l=r[i+1].evaluate(e);switch(this.operator){case"interpolate":return Ft[this.type.kind](s,l,a);case"interpolate-hcl":return Ft.color(s,l,a,"hcl");case"interpolate-lab":return Ft.color(s,l,a,"lab")}}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}}function Ut(e,t,r,n){return e-=r,0==(n-=r)?0:1===t?e/n:(Math.pow(t,e)-1)/(Math.pow(t,n)-1)}class jt{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expectected at least one argument.");let r=null;const n=t.expectedType;n&&"value"!==n.kind&&(r=n);var i=[];for(const a of e.slice(1)){var o=t.parse(a,1+i.length,r,void 0,{typeAnnotation:"omit"});if(!o)return null;r=r||o.type,i.push(o)}if(r)return n&&i.some((e=>_e(n,e.type)))?new jt(ue,i):new jt(r,i);throw new Error("No output type")}evaluate(e){let t,r=null,n=0;for(const i of this.args)if(n++,null!==(r=(r=i.evaluate(e))&&r instanceof Ye&&!r.available&&(t=t||r.name,r=null,n===this.args.length)?t:r))break;return r}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}class qt{constructor(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const t of this.bindings)e(t[1]);e(this.result)}static parse(e,t){if(e.length<4)return t.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);var r=[];for(let a=1;a<e.length-1;a+=2){var n=e[a];if("string"!=typeof n)return t.error(`Expected string, but found ${typeof n} instead.`,a);if(/[^a-zA-Z0-9_]/.test(n))return t.error("Variable names must contain only alphanumeric characters or '_'.",a);var i=t.parse(e[a+1],a+1);if(!i)return null;r.push([n,i])}var o=t.parse(e[e.length-1],e.length-1,t.expectedType,r);return o?new qt(r,o):null}outputDefined(){return this.result.outputDefined()}}function Ht(e,t){return"=="===e||"!="===e?"boolean"===t.kind||"string"===t.kind||"number"===t.kind||"null"===t.kind||"value"===t.kind:"string"===t.kind||"number"===t.kind||"value"===t.kind}function Vt(e,t,r,n){return 0===n.compare(t,r)}function Gt(e,t,r){const n="=="!==e&&"!="!==e;return class i{constructor(e,t,r){this.type=se,this.lhs=e,this.rhs=t,this.collator=r,this.hasUntypedArgument="value"===e.type.kind||"value"===t.type.kind}static parse(e,t){if(3!==e.length&&4!==e.length)return t.error("Expected two or three arguments.");var r=e[0];let o=t.parse(e[1],1,ue);if(!o)return null;if(!Ht(r,o.type))return t.concat(1).error(`"${r}" comparisons are not supported for type '${ye(o.type)}'.`);let a=t.parse(e[2],2,ue);if(!a)return null;if(!Ht(r,a.type))return t.concat(2).error(`"${r}" comparisons are not supported for type '${ye(a.type)}'.`);if(o.type.kind!==a.type.kind&&"value"!==o.type.kind&&"value"!==a.type.kind)return t.error(`Cannot compare types '${ye(o.type)}' and '${ye(a.type)}'.`);n&&("value"===o.type.kind&&"value"!==a.type.kind?o=new it(a.type,[o]):"value"!==o.type.kind&&"value"===a.type.kind&&(a=new it(o.type,[a])));let s=null;if(4===e.length){if("string"!==o.type.kind&&"string"!==a.type.kind&&"value"!==o.type.kind&&"value"!==a.type.kind)return t.error("Cannot use collator to compare non-string types.");if(!(s=t.parse(e[3],3,he)))return null}return new i(o,a,s)}evaluate(i){var o=this.lhs.evaluate(i),a=this.rhs.evaluate(i);if(n&&this.hasUntypedArgument){var s=Je(o),l=Je(a);if(s.kind!==l.kind||"string"!==s.kind&&"number"!==s.kind)throw new rt(`Expected arguments for "${e}" to be (string, string) or (number, number), but found (${s.kind}, ${l.kind}) instead.`)}return this.collator&&!n&&this.hasUntypedArgument&&(s=Je(o),l=Je(a),"string"!==s.kind||"string"!==l.kind)?t(i,o,a):this.collator?r(i,o,a,this.collator.evaluate(i)):t(i,o,a)}eachChild(e){e(this.lhs),e(this.rhs),this.collator&&e(this.collator)}outputDefined(){return!0}}}Ot=Gt("==",(function(e,t,r){return t===r}),Vt);var Kt=Gt("!=",(function(e,t,r){return t!==r}),(function(e,t,r,n){return!Vt(0,t,r,n)})),Zt=Gt("<",(function(e,t,r){return t<r}),(function(e,t,r,n){return n.compare(t,r)<0})),Wt=Gt(">",(function(e,t,r){return r<t}),(function(e,t,r,n){return 0<n.compare(t,r)})),$t=Gt("<=",(function(e,t,r){return t<=r}),(function(e,t,r,n){return n.compare(t,r)<=0})),Yt=Gt(">=",(function(e,t,r){return r<=t}),(function(e,t,r,n){return 0<=n.compare(t,r)}));class Xt{constructor(e){this.type=de,this.sections=e}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[1];if(!Array.isArray(r)&&"object"==typeof r)return t.error("First argument must be an image or text section.");var n=[];let i=!1;for(let s=1;s<=e.length-1;++s){var o=e[s];if(i&&"object"==typeof o&&!Array.isArray(o)){i=!1;let e=null;if(o["font-scale"]&&!(e=t.parse(o["font-scale"],1,oe)))return null;let r=null;if(o["text-font"]&&!(r=t.parse(o["text-font"],1,ge(ae))))return null;let a=null;if(o["text-color"]&&!(a=t.parse(o["text-color"],1,le)))return null;(o=n[n.length-1]).scale=e,o.font=r,o.textColor=a}else{if(!(o=t.parse(e[s],1,ue)))return null;var a=o.type.kind;if("string"!==a&&"value"!==a&&"null"!==a&&"resolvedImage"!==a)return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");i=!0,n.push({content:o,scale:null,font:null,textColor:null})}}return new Xt(n)}evaluate(e){return new Ke(this.sections.map((t=>{var r=t.content.evaluate(e);return Je(r)===fe?new Ge("",r,null,null,null):new Ge(et(r),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)})))}eachChild(e){for(const t of this.sections)e(t.content),t.scale&&e(t.scale),t.font&&e(t.font),t.textColor&&e(t.textColor)}outputDefined(){return!1}}const Qt={"==":Ot,"!=":Kt,">":Wt,"<":Zt,">=":Yt,"<=":$t,array:it,at:class e{constructor(e,t,r){this.type=e,this.index=t,this.input=r}static parse(t,r){var n;return 3!==t.length?r.error(`Expected 2 arguments, but found ${t.length-1} instead.`):(n=r.parse(t[1],1,oe),t=r.parse(t[2],2,ge(r.expectedType||ue)),n&&t?(r=t.type,new e(r.itemType,n,t)):null)}evaluate(e){var t=this.index.evaluate(e);e=this.input.evaluate(e);if(t<0)throw new rt(`Array index out of bounds: ${t} < 0.`);if(t>=e.length)throw new rt(`Array index out of bounds: ${t} > ${e.length-1}.`);if(t!==Math.floor(t))throw new rt(`Array index must be an integer, but found ${t} instead.`);return e[t]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}},boolean:it,case:class e{constructor(e,t,r){this.type=e,this.branches=t,this.otherwise=r}static parse(t,r){if(t.length<4)return r.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return r.error("Expected an odd number of arguments.");let n;r.expectedType&&"value"!==r.expectedType.kind&&(n=r.expectedType);var i=[];for(let e=1;e<t.length-1;e+=2){var o=r.parse(t[e],e,se);if(!o)return null;var a=r.parse(t[e+1],e+1,n);if(!a)return null;i.push([o,a]),n=n||a.type}var s=r.parse(t[t.length-1],t.length-1,n);if(!s)return null;if(n)return new e(n,i,s);throw new Error("Can't infer output type")}evaluate(e){for(var[t,r]of this.branches)if(t.evaluate(e))return r.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(var[t,r]of this.branches)e(t),e(r);e(this.otherwise)}outputDefined(){return this.branches.every((e=>{let[,t]=e;return t.outputDefined()}))&&this.otherwise.outputDefined()}},coalesce:jt,collator:ut,format:Xt,image:class e{constructor(e){this.type=fe,this.input=e}static parse(t,r){return 2!==t.length?r.error("Expected two arguments."):(t=r.parse(t[1],1,ae))?new e(t):r.error("No image name provided.")}evaluate(e){var t=this.input.evaluate(e),r=Ye.fromString(t);return r&&e.availableImages&&(r.available=-1<e.availableImages.indexOf(t)),r}eachChild(e){e(this.input)}outputDefined(){return!1}},in:class e{constructor(e,t){this.type=se,this.needle=e,this.haystack=t}static parse(t,r){var n;return 3!==t.length?r.error(`Expected 2 arguments, but found ${t.length-1} instead.`):(n=r.parse(t[1],1,ue),t=r.parse(t[2],2,ue),n&&t?be(n.type,[se,ae,oe,ie,ue])?new e(n,t):r.error(`Expected first argument to be of type boolean, string, number or null, but found ${ye(n.type)} instead`):null)}evaluate(e){var t=this.needle.evaluate(e);if(!(e=this.haystack.evaluate(e)))return!1;if(!we(t,["boolean","string","number","null"]))throw new rt(`Expected first argument to be of type boolean, string, number or null, but found ${ye(Je(t))} instead.`);if(we(e,["string","array"]))return 0<=e.indexOf(t);throw new rt(`Expected second argument to be of type array or string, but found ${ye(Je(e))} instead.`)}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}},"index-of":class e{constructor(e,t,r){this.type=oe,this.needle=e,this.haystack=t,this.fromIndex=r}static parse(t,r){var n,i;return t.length<=2||5<=t.length?r.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`):(n=r.parse(t[1],1,ue),i=r.parse(t[2],2,ue),n&&i?be(n.type,[se,ae,oe,ie,ue])?4===t.length?(t=r.parse(t[3],3,oe))?new e(n,i,t):null:new e(n,i):r.error(`Expected first argument to be of type boolean, string, number or null, but found ${ye(n.type)} instead`):null)}evaluate(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!we(t,["boolean","string","number","null"]))throw new rt(`Expected first argument to be of type boolean, string, number or null, but found ${ye(Je(t))} instead.`);if(we(r,["string","array"]))return this.fromIndex?(e=this.fromIndex.evaluate(e),r.indexOf(t,e)):r.indexOf(t);throw new rt(`Expected second argument to be of type array or string, but found ${ye(Je(r))} instead.`)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}},interpolate:Bt,"interpolate-hcl":Bt,"interpolate-lab":Bt,length:class e{constructor(e){this.type=oe,this.input=e}static parse(t,r){return 2!==t.length?r.error(`Expected 1 argument, but found ${t.length-1} instead.`):(t=r.parse(t[1],1))?"array"!==t.type.kind&&"string"!==t.type.kind&&"value"!==t.type.kind?r.error(`Expected argument of type string or array, but found ${ye(t.type)} instead.`):new e(t):null}evaluate(e){if("string"==typeof(e=this.input.evaluate(e)))return e.length;if(Array.isArray(e))return e.length;throw new rt(`Expected value to be of type string or array, but found ${ye(Je(e))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}},let:qt,literal:tt,match:class e{constructor(e,t,r,n,i,o){this.inputType=e,this.type=t,this.input=r,this.cases=n,this.outputs=i,this.otherwise=o}static parse(t,r){if(t.length<5)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return r.error("Expected an even number of arguments.");let n,i;r.expectedType&&"value"!==r.expectedType.kind&&(i=r.expectedType);var o={},a=[];for(let e=2;e<t.length-1;e+=2){let c=t[e];var s=t[e+1],l=(Array.isArray(c)||(c=[c]),r.concat(e));if(0===c.length)return l.error("Expected at least one branch label.");for(const e of c){if("number"!=typeof e&&"string"!=typeof e)return l.error("Branch labels must be numbers or strings.");if("number"==typeof e&&Math.abs(e)>Number.MAX_SAFE_INTEGER)return l.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof e&&Math.floor(e)!==e)return l.error("Numeric branch labels must be integer values.");if(n){if(l.checkSubtype(n,Je(e)))return null}else n=Je(e);if(void 0!==o[String(e)])return l.error("Branch labels must be unique.");o[String(e)]=a.length}if(!(s=r.parse(s,e,i)))return null;i=i||s.type,a.push(s)}var c,u=r.parse(t[1],1,ue);return!u||!(c=r.parse(t[t.length-1],t.length-1,i))||"value"!==u.type.kind&&r.concat(1).checkSubtype(n,u.type)?null:new e(n,i,u,o,a,c)}evaluate(e){var t=this.input.evaluate(e);return(Je(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))&&this.otherwise.outputDefined()}},number:it,"number-format":class e{constructor(e,t,r,n,i){this.type=ae,this.number=e,this.locale=t,this.currency=r,this.minFractionDigits=n,this.maxFractionDigits=i}static parse(t,r){if(3!==t.length)return r.error("Expected two arguments.");var n=r.parse(t[1],1,oe);if(!n)return null;if("object"!=typeof(t=t[2])||Array.isArray(t))return r.error("NumberFormat options argument must be an object.");let i=null;if(t.locale&&!(i=r.parse(t.locale,1,ae)))return null;let o=null;if(t.currency&&!(o=r.parse(t.currency,1,ae)))return null;let a=null;if(t["min-fraction-digits"]&&!(a=r.parse(t["min-fraction-digits"],1,oe)))return null;let s=null;return t["max-fraction-digits"]&&!(s=r.parse(t["max-fraction-digits"],1,oe))?null:new e(n,i,o,a,s)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}},object:it,slice:class e{constructor(e,t,r,n){this.type=e,this.input=t,this.beginIndex=r,this.endIndex=n}static parse(t,r){var n,i;return t.length<=2||5<=t.length?r.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`):(n=r.parse(t[1],1,ue),i=r.parse(t[2],2,oe),n&&i?be(n.type,[ge(ue),ae,ue])?4===t.length?(t=r.parse(t[3],3,oe))?new e(n.type,n,i,t):null:new e(n.type,n,i):r.error(`Expected first argument to be of type array or string, but found ${ye(n.type)} instead`):null)}evaluate(e){var t=this.input.evaluate(e),r=this.beginIndex.evaluate(e);if(we(t,["string","array"]))return this.endIndex?(e=this.endIndex.evaluate(e),t.slice(r,e)):t.slice(r);throw new rt(`Expected first argument to be of type array or string, but found ${ye(Je(t))} instead.`)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}},step:Rt,string:it,"to-boolean":at,"to-color":at,"to-number":at,"to-string":at,var:Et,within:St};function Jt(e,t){let[r,n,i,o]=t;if(r=r.evaluate(e),n=n.evaluate(e),i=i.evaluate(e),o=o?o.evaluate(e):1,e=Xe(r,n,i,o))throw new rt(e);return new He(r/255,n/255,i/255,o,!1)}function er(e,t){return void 0===(t=t[e])?null:t}function tr(e){return{type:e}}function rr(e){return{result:"success",value:e}}function nr(e){return{result:"error",value:e}}function ir(e){return"data-driven"===e["property-type"]||"cross-faded-data-driven"===e["property-type"]}function or(e){return e.expression&&-1<e.expression.parameters.indexOf("zoom")}function ar(e){return e.expression&&e.expression.interpolated}function sr(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":null===e?"null":typeof e}function lr(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function cr(e){return e}function ur(e,t){var r="color"===t.type,n=e.stops&&"object"==typeof e.stops[0][0],i=n||void 0!==e.property,o=(i=n||!i,e.type||(ar(t)?"exponential":"interval"));if(r||"padding"===t.type){const n=(r?He:Ze).parse;(e=te({},e)).stops&&(e.stops=e.stops.map((e=>[e[0],n(e[1])]))),e.default?e.default=n(e.default):e.default=n(t.default)}if(e.colorSpace&&"rgb"!==(r=e.colorSpace)&&"hcl"!==r&&"lab"!==r)throw new Error(`Unknown color space: "${e.colorSpace}"`);let a,s,l;if("exponential"===o)a=fr;else if("interval"===o)a=pr;else if("categorical"===o){a=dr,s=Object.create(null);for(const t of e.stops)s[t[0]]=t[1];l=typeof e.stops[0][0]}else{if("identity"!==o)throw new Error(`Unknown function type "${o}"`);a=mr}if(n){var c={},u=[];for(let t=0;t<e.stops.length;t++){var h=e.stops[t],d=h[0].zoom;void 0===c[d]&&(c[d]={zoom:d,type:e.type,property:e.property,default:e.default,stops:[]},u.push(d)),c[d].stops.push([h[0].value,h[1]])}const n=[];for(const e of u)n.push([c[e].zoom,ur(c[e],t)]);return{kind:"composite",interpolationType:r={name:"linear"},interpolationFactor:Bt.interpolationFactor.bind(void 0,r),zoomStops:n.map((e=>e[0])),evaluate(r,i){let{zoom:o}=r;return fr({stops:n,base:e.base},t,o).evaluate(o,i)}}}return i?{kind:"camera",interpolationType:n="exponential"===o?{name:"exponential",base:void 0!==e.base?e.base:1}:null,interpolationFactor:Bt.interpolationFactor.bind(void 0,n),zoomStops:e.stops.map((e=>e[0])),evaluate:r=>{let{zoom:n}=r;return a(e,t,n,s,l)}}:{kind:"source",evaluate:(r,n)=>void 0===(n=n&&n.properties?n.properties[e.property]:void 0)?hr(e.default,t.default):a(e,t,n,s,l)}}function hr(e,t,r){return void 0!==e?e:void 0!==t?t:void 0!==r?r:void 0}function dr(e,t,r,n,i){return hr(typeof r===i?n[r]:void 0,e.default,t.default)}function pr(e,t,r){return"number"!==sr(r)?hr(e.default,t.default):(1===(t=e.stops.length)||r<=e.stops[0][0]?e.stops[0]:r>=e.stops[t-1][0]?e.stops[t-1]:(t=Mt(e.stops.map((e=>e[0])),r),e.stops[t]))[1]}function fr(e,t,r){var n=void 0!==e.base?e.base:1;if("number"!==sr(r))return hr(e.default,t.default);var i=e.stops.length;if(1===i)return e.stops[0][1];if(r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[i-1][0])return e.stops[i-1][1];i=Mt(e.stops.map((e=>e[0])),r);const o=function(e,t,r,n){return e-=r,0==(n-=r)?0:1===t?e/n:(Math.pow(t,e)-1)/(Math.pow(t,n)-1)}(r,n,e.stops[i][0],e.stops[i+1][0]),a=e.stops[i][1],s=e.stops[i+1][1],l=Ft[t.type]||cr;return"function"==typeof a.evaluate?{evaluate(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=a.evaluate.apply(void 0,r);r=s.evaluate.apply(void 0,r);if(void 0!==i&&void 0!==r)return l(i,r,o,e.colorSpace)}}:l(a,s,o,e.colorSpace)}function mr(e,t,r){switch(t.type){case"color":r=He.parse(r);break;case"formatted":r=Ke.fromString(r.toString());break;case"resolvedImage":r=Ye.fromString(r.toString());break;case"padding":r=Ze.parse(r);break;default:sr(r)===t.type||"enum"===t.type&&t.values[r]||(r=void 0)}return hr(r,e.default,t.default)}Tt.register(Qt,{error:[{kind:"error"},[ae],(e,t)=>{let[r]=t;throw new rt(r.evaluate(e))}],typeof:[ae,[ue],(e,t)=>{let[r]=t;return ye(Je(r.evaluate(e)))}],"to-rgba":[ge(oe,4),[le],(e,t)=>{let[r]=t;return function(e,t){var[t,e,r,n]=t.evaluate(e).rgb;return[255*t,255*e,255*r,n]}(e,r)}],rgb:[le,[oe,oe,oe],Jt],rgba:[le,[oe,oe,oe,oe],Jt],has:{type:se,overloads:[[[ae],(e,t)=>{let[r]=t;return r.evaluate(e)in e.properties()}],[[ae,ce],(e,t)=>{let[r,n]=t;return r.evaluate(e)in n.evaluate(e)}]]},get:{type:ue,overloads:[[[ae],(e,t)=>{let[r]=t;return er(r.evaluate(e),e.properties())}],[[ae,ce],(e,t)=>{let[r,n]=t;return er(r.evaluate(e),n.evaluate(e))}]]},"feature-state":[ue,[ae],(e,t)=>{let[r]=t;return er(r.evaluate(e),e.featureState||{})}],properties:[ce,[],e=>e.properties()],"geometry-type":[ae,[],e=>e.geometryType()],id:[ue,[],e=>e.id()],zoom:[oe,[],e=>e.globals.zoom],"heatmap-density":[oe,[],e=>e.globals.heatmapDensity||0],"line-progress":[oe,[],e=>e.globals.lineProgress||0],accumulated:[ue,[],e=>void 0===e.globals.accumulated?null:e.globals.accumulated],"+":[oe,tr(oe),(e,t)=>{let r=0;for(const n of t)r+=n.evaluate(e);return r}],"*":[oe,tr(oe),(e,t)=>{let r=1;for(const n of t)r*=n.evaluate(e);return r}],"-":{type:oe,overloads:[[[oe,oe],(e,t)=>{let[r,n]=t;return r.evaluate(e)-n.evaluate(e)}],[[oe],(e,t)=>{let[r]=t;return-r.evaluate(e)}]]},"/":[oe,[oe,oe],(e,t)=>{let[r,n]=t;return r.evaluate(e)/n.evaluate(e)}],"%":[oe,[oe,oe],(e,t)=>{let[r,n]=t;return r.evaluate(e)%n.evaluate(e)}],ln2:[oe,[],()=>Math.LN2],pi:[oe,[],()=>Math.PI],e:[oe,[],()=>Math.E],"^":[oe,[oe,oe],(e,t)=>{let[r,n]=t;return Math.pow(r.evaluate(e),n.evaluate(e))}],sqrt:[oe,[oe],(e,t)=>{let[r]=t;return Math.sqrt(r.evaluate(e))}],log10:[oe,[oe],(e,t)=>{let[r]=t;return Math.log(r.evaluate(e))/Math.LN10}],ln:[oe,[oe],(e,t)=>{let[r]=t;return Math.log(r.evaluate(e))}],log2:[oe,[oe],(e,t)=>{let[r]=t;return Math.log(r.evaluate(e))/Math.LN2}],sin:[oe,[oe],(e,t)=>{let[r]=t;return Math.sin(r.evaluate(e))}],cos:[oe,[oe],(e,t)=>{let[r]=t;return Math.cos(r.evaluate(e))}],tan:[oe,[oe],(e,t)=>{let[r]=t;return Math.tan(r.evaluate(e))}],asin:[oe,[oe],(e,t)=>{let[r]=t;return Math.asin(r.evaluate(e))}],acos:[oe,[oe],(e,t)=>{let[r]=t;return Math.acos(r.evaluate(e))}],atan:[oe,[oe],(e,t)=>{let[r]=t;return Math.atan(r.evaluate(e))}],min:[oe,tr(oe),(e,t)=>Math.min(...t.map((t=>t.evaluate(e))))],max:[oe,tr(oe),(e,t)=>Math.max(...t.map((t=>t.evaluate(e))))],abs:[oe,[oe],(e,t)=>{let[r]=t;return Math.abs(r.evaluate(e))}],round:[oe,[oe],(e,t)=>{let[r]=t;return r=r.evaluate(e),r<0?-Math.round(-r):Math.round(r)}],floor:[oe,[oe],(e,t)=>{let[r]=t;return Math.floor(r.evaluate(e))}],ceil:[oe,[oe],(e,t)=>{let[r]=t;return Math.ceil(r.evaluate(e))}],"filter-==":[se,[ae,ue],(e,t)=>{let[r,n]=t;return e.properties()[r.value]===n.value}],"filter-id-==":[se,[ue],(e,t)=>{let[r]=t;return e.id()===r.value}],"filter-type-==":[se,[ae],(e,t)=>{let[r]=t;return e.geometryType()===r.value}],"filter-<":[se,[ae,ue],(e,t)=>{let[r,n]=t;return e=e.properties()[r.value],r=n.value,typeof e==typeof r&&e<r}],"filter-id-<":[se,[ue],(e,t)=>{let[r]=t;return e=e.id(),r=r.value,typeof e==typeof r&&e<r}],"filter->":[se,[ae,ue],(e,t)=>{let[r,n]=t;return e=e.properties()[r.value],r=n.value,typeof e==typeof r&&r<e}],"filter-id->":[se,[ue],(e,t)=>{let[r]=t;return e=e.id(),r=r.value,typeof e==typeof r&&r<e}],"filter-<=":[se,[ae,ue],(e,t)=>{let[r,n]=t;return e=e.properties()[r.value],r=n.value,typeof e==typeof r&&e<=r}],"filter-id-<=":[se,[ue],(e,t)=>{let[r]=t;return e=e.id(),r=r.value,typeof e==typeof r&&e<=r}],"filter->=":[se,[ae,ue],(e,t)=>{let[r,n]=t;return e=e.properties()[r.value],r=n.value,typeof e==typeof r&&r<=e}],"filter-id->=":[se,[ue],(e,t)=>{let[r]=t;return e=e.id(),r=r.value,typeof e==typeof r&&r<=e}],"filter-has":[se,[ue],(e,t)=>{let[r]=t;return r.value in e.properties()}],"filter-has-id":[se,[],e=>null!==e.id()&&void 0!==e.id()],"filter-type-in":[se,[ge(ae)],(e,t)=>{let[r]=t;return 0<=r.value.indexOf(e.geometryType())}],"filter-id-in":[se,[ge(ue)],(e,t)=>{let[r]=t;return 0<=r.value.indexOf(e.id())}],"filter-in-small":[se,[ae,ge(ue)],(e,t)=>{let[r,n]=t;return 0<=n.value.indexOf(e.properties()[r.value])}],"filter-in-large":[se,[ae,ge(ue)],(e,t)=>{let[r,n]=t;for(var i=e.properties()[r.value],o=n.value,a=0,s=n.value.length-1;a<=s;){var l=a+s>>1;if(o[l]===i)return!0;o[l]>i?s=l-1:a=1+l}return!1}],all:{type:se,overloads:[[[se,se],(e,t)=>{let[r,n]=t;return r.evaluate(e)&&n.evaluate(e)}],[tr(se),(e,t)=>{for(const r of t)if(!r.evaluate(e))return!1;return!0}]]},any:{type:se,overloads:[[[se,se],(e,t)=>{let[r,n]=t;return r.evaluate(e)||n.evaluate(e)}],[tr(se),(e,t)=>{for(const r of t)if(r.evaluate(e))return!0;return!1}]]},"!":[se,[se],(e,t)=>{let[r]=t;return!r.evaluate(e)}],"is-supported-script":[se,[ae],(e,t)=>{let[r]=t;var n=e.globals&&e.globals.isSupportedScript;return!n||n(r.evaluate(e))}],upcase:[ae,[ae],(e,t)=>{let[r]=t;return r.evaluate(e).toUpperCase()}],downcase:[ae,[ae],(e,t)=>{let[r]=t;return r.evaluate(e).toLowerCase()}],concat:[ae,tr(ue),(e,t)=>t.map((t=>et(t.evaluate(e)))).join("")],"resolved-locale":[ae,[he],(e,t)=>{let[r]=t;return r.evaluate(e).resolvedLocale()}]});class gr{constructor(e,t){this.expression=e,this._warningHistory={},this._evaluator=new lt,this._defaultValue=t?function(e){return"color"===e.type&&lr(e.default)?new He(0,0,0,0):"color"===e.type?He.parse(e.default)||null:"padding"===e.type?Ze.parse(e.default)||null:"variableAnchorOffsetCollection"===e.type?$e.parse(e.default)||null:void 0===e.default?null:e.default}(t):null,this._enumValues=t&&"enum"===t.type?t.values:null}evaluateWithoutErrorHandling(e,t,r,n,i,o){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=r,this._evaluator.canonical=n,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=o,this.expression.evaluate(this._evaluator)}evaluate(e,t,r,n,i,o){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=r||null,this._evaluator.canonical=n,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=o||null;try{var a=this.expression.evaluate(this._evaluator);if(null==a||"number"==typeof a&&a!=a)return this._defaultValue;if(!this._enumValues||a in this._enumValues)return a;throw new rt(`Expected value to be one of ${Object.keys(this._enumValues).map((e=>JSON.stringify(e))).join(", ")}, but found ${JSON.stringify(a)} instead.`)}catch(e){return this._warningHistory[e.message]||(this._warningHistory[e.message]=!0,"undefined"!=typeof console&&console.warn(e.message)),this._defaultValue}}}function yr(e){return Array.isArray(e)&&0<e.length&&"string"==typeof e[0]&&e[0]in Qt}function vr(e,t){var r=new ct(Qt,It,[],t?(r={color:le,string:ae,number:oe,enum:ae,boolean:se,formatted:de,padding:pe,resolvedImage:fe,variableAnchorOffsetCollection:me},"array"!==(n=t).type?r[n.type]:ge(r[n.value]||ue,n.length)):void 0),n=r.parse(e,void 0,void 0,void 0,t&&"string"===t.type?{typeAnnotation:"coerce"}:void 0);return n?rr(new gr(n,t)):nr(r.errors)}class _r{constructor(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent="constant"!==e&&!At(t.expression)}evaluateWithoutErrorHandling(e,t,r,n,i,o){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,n,i,o)}evaluate(e,t,r,n,i,o){return this._styleExpression.evaluate(e,t,r,n,i,o)}}class br{constructor(e,t,r,n){this.kind=e,this.zoomStops=r,this._styleExpression=t,this.isStateDependent="camera"!==e&&!At(t.expression),this.interpolationType=n}evaluateWithoutErrorHandling(e,t,r,n,i,o){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,n,i,o)}evaluate(e,t,r,n,i,o){return this._styleExpression.evaluate(e,t,r,n,i,o)}interpolationFactor(e,t,r){return this.interpolationType?Bt.interpolationFactor(this.interpolationType,e,t,r):0}}function wr(e,t){var r,n,i;return"error"===(e=vr(e,t)).result?e:(r=kt(n=e.value.expression))||ir(t)?(i=Pt(n,["zoom"]))||or(t)?(n=function e(t){let r=null;if(t instanceof qt)r=e(t.result);else if(t instanceof jt){for(const n of t.args)if(r=e(n))break}else(t instanceof Rt||t instanceof Bt)&&t.input instanceof Tt&&"zoom"===t.input.name&&(r=t);return r instanceof re||t.eachChild((t=>{const n=e(t);n instanceof re?r=n:!r&&n?r=new re("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):r&&n&&r!==n&&(r=new re("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),r}(n))||i?n instanceof re?nr([n]):n instanceof Bt&&!ar(t)?nr([new re("",'"interpolate" expressions cannot be used with this property')]):n?(i=n instanceof Bt?n.interpolation:void 0,rr(new br(r?"camera":"composite",e.value,n.labels,i))):rr(new _r(r?"constant":"source",e.value)):nr([new re("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]):nr([new re("","zoom expressions not supported")]):nr([new re("","data expressions not supported")])}class xr{constructor(e,t){this._parameters=e,this._specification=t,te(this,ur(this._parameters,this._specification))}static deserialize(e){return new xr(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function Cr(e){if(!0===e||!1===e)return 1;if(Array.isArray(e)&&0!==e.length)switch(e[0]){case"has":return 2<=e.length&&"$id"!==e[1]&&"$type"!==e[1];case"in":return 3<=e.length&&("string"!=typeof e[1]||Array.isArray(e[2]));case"!in":case"!has":case"none":return;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==e.length||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(const t of e.slice(1))if(!Cr(t)&&"boolean"!=typeof t)return;return 1;default:return 1}}const Sr={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Er(e){if(null==e)return{filter:()=>!0,needGeometry:!1};const t=vr(e=Cr(e)?e:Ir(e),Sr);if("error"===t.result)throw new Error(t.value.map((e=>e.key+": "+e.message)).join(", "));return{filter:(e,r,n)=>t.value.evaluate(e,r,{},n),needGeometry:function e(t){if(!Array.isArray(t))return!1;if("within"===t[0])return!0;for(let r=1;r<t.length;r++)if(e(t[r]))return!0;return!1}(e)}}function Tr(e,t){return e<t?-1:t<e?1:0}function Ir(e){var t,r;return!e||(t=e[0],e.length<=1?"any"!==t:"=="===t?kr(e[1],e[2],"=="):"!="===t?Mr(kr(e[1],e[2],"==")):"<"===t||">"===t||"<="===t||">="===t?kr(e[1],e[2],t):"any"===t?(r=e.slice(1),["any"].concat(r.map(Ir))):"all"===t?["all"].concat(e.slice(1).map(Ir)):"none"===t?["all"].concat(e.slice(1).map(Ir).map(Mr)):"in"===t?Ar(e[1],e.slice(2)):"!in"===t?Mr(Ar(e[1],e.slice(2))):"has"===t?Pr(e[1]):"!has"===t?Mr(Pr(e[1])):"within"!==t||e)}function kr(e,t,r){switch(e){case"$type":return["filter-type-"+r,t];case"$id":return["filter-id-"+r,t];default:return["filter-"+r,e,t]}}function Ar(e,t){if(0===t.length)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return 200<t.length&&!t.some((e=>typeof e!=typeof t[0]))?["filter-in-large",e,["literal",t.sort(Tr)]]:["filter-in-small",e,["literal",t]]}}function Pr(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function Mr(e){return["!",e]}function Rr(e){let t="";for(const r of K)t+="/"+function e(t){var r=typeof t;if("number"==r||"boolean"==r||"string"==r||null==t)return JSON.stringify(t);if(Array.isArray(t)){let r="[";for(const n of t)r+=e(n)+",";return r+"]"}var n=Object.keys(t).sort();let i="{";for(let o=0;o<n.length;o++)i+=`${JSON.stringify(n[o])}:${e(t[n[o]])},`;return i+"}"}(e[r]);return t}function Or(e){var t=e.key;return(e=e.value)?[new ee(t,e,"constants have been deprecated as of v8")]:[]}function Lr(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function Dr(e){if(Array.isArray(e))return e.map(Dr);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var t={};for(const r in e)t[r]=Dr(e[r]);return t}return Lr(e)}function Nr(e){var t=e.key,r=e.value,n=e.valueSpec||{},i=e.objectElementValidators||{},o=e.style,a=e.styleSpec,s=e.validateSpec;let l=[];if("object"!==(e=sr(r)))return[new ee(t,r,`object expected, ${e} found`)];for(const h in r){var c=h.split(".")[0],u=n[c]||n["*"];let e;if(i[c])e=i[c];else if(n[c])e=s;else if(i["*"])e=i["*"];else{if(!n["*"]){l.push(new ee(t,r[h],`unknown property "${h}"`));continue}e=s}l=l.concat(e({key:(t&&t+".")+h,value:r[h],valueSpec:u,style:o,styleSpec:a,object:r,objectKey:h,validateSpec:s},r))}for(const h in n)i[h]||n[h].required&&void 0===n[h].default&&void 0===r[h]&&l.push(new ee(t,r,`missing required property "${h}"`));return l}function zr(e){var t=e.value,r=e.valueSpec,n=e.validateSpec,i=e.style,o=e.styleSpec,a=e.key,s=e.arrayElementValidator||n;if("array"!==sr(t))return[new ee(a,t,`array expected, ${sr(t)} found`)];if(r.length&&t.length!==r.length)return[new ee(a,t,`array length ${r.length} expected, length ${t.length} found`)];if(r["min-length"]&&t.length<r["min-length"])return[new ee(a,t,`array length at least ${r["min-length"]} expected, length ${t.length} found`)];let l={type:r.value,values:r.values},c=(o.$version<7&&(l.function=r.function),"object"===sr(r.value)&&(l=r.value),[]);for(let u=0;u<t.length;u++)c=c.concat(s({array:t,arrayIndex:u,value:t[u],valueSpec:l,validateSpec:e.validateSpec,style:i,styleSpec:o,key:`${a}[${u}]`}));return c}function Fr(e){var t=e.key,r=e.value;e=e.valueSpec;let n=sr(r);return"number"!==(n="number"===n&&r!=r?"NaN":n)?[new ee(t,r,`number expected, ${n} found`)]:"minimum"in e&&r<e.minimum?[new ee(t,r,r+" is less than the minimum value "+e.minimum)]:"maximum"in e&&r>e.maximum?[new ee(t,r,r+" is greater than the maximum value "+e.maximum)]:[]}function Br(e){const t=e.valueSpec,r=Lr(e.value.type);let n,i,o,a={};var s="categorical"!==r&&void 0===e.value.property,l=!s;const c="array"===sr(e.value.stops)&&"array"===sr(e.value.stops[0])&&"object"===sr(e.value.stops[0][0]);var u=Nr({key:e.key,value:e.value,valueSpec:e.styleSpec.function,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(e){if("identity"===r)return[new ee(e.key,e.value,'identity function may not have a "stops" property')];let t=[];var n=e.value;return t=t.concat(zr({key:e.key,value:n,valueSpec:e.valueSpec,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec,arrayElementValidator:h})),"array"===sr(n)&&0===n.length&&t.push(new ee(e.key,n,"array must have at least one stop")),t},default:function(e){return e.validateSpec({key:e.key,value:e.value,valueSpec:t,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec})}}});return"identity"===r&&s&&u.push(new ee(e.key,e.value,'missing required property "property"')),"identity"===r||e.value.stops||u.push(new ee(e.key,e.value,'missing required property "stops"')),"exponential"===r&&e.valueSpec.expression&&!ar(e.valueSpec)&&u.push(new ee(e.key,e.value,"exponential functions not supported")),8<=e.styleSpec.$version&&(l&&!ir(e.valueSpec)?u.push(new ee(e.key,e.value,"property functions not supported")):s&&!or(e.valueSpec)&&u.push(new ee(e.key,e.value,"zoom functions not supported"))),"categorical"!==r&&!c||void 0!==e.value.property||u.push(new ee(e.key,e.value,'"property" property is required')),u;function h(e){let r=[];var n=e.value,s=e.key;if("array"!==sr(n))return[new ee(s,n,`array expected, ${sr(n)} found`)];if(2!==n.length)return[new ee(s,n,`array length 2 expected, length ${n.length} found`)];if(c){if("object"!==sr(n[0]))return[new ee(s,n,`object expected, ${sr(n[0])} found`)];if(void 0===n[0].zoom)return[new ee(s,n,"object stop key must have zoom")];if(void 0===n[0].value)return[new ee(s,n,"object stop key must have value")];if(o&&o>Lr(n[0].zoom))return[new ee(s,n[0].zoom,"stop zoom values must appear in ascending order")];Lr(n[0].zoom)!==o&&(o=Lr(n[0].zoom),i=void 0,a={}),r=r.concat(Nr({key:s+"[0]",value:n[0],valueSpec:{zoom:{}},validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{zoom:Fr,value:d}}))}else r=r.concat(d({key:s+"[0]",value:n[0],valueSpec:{},validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec},n));return yr(Dr(n[1]))?r.concat([new ee(s+"[1]",n[1],"expressions are not allowed in function stops.")]):r.concat(e.validateSpec({key:s+"[1]",value:n[1],valueSpec:t,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec}))}function d(e,o){var s=sr(e.value),l=Lr(e.value);o=null!==e.value?e.value:o;if(n){if(s!==n)return[new ee(e.key,o,s+" stop domain type must match previous stop domain type "+n)]}else n=s;if("number"!==s&&"string"!==s&&"boolean"!==s)return[new ee(e.key,o,"stop domain value must be a number, string, or boolean")];if("number"===s||"categorical"===r)return"categorical"!==r||"number"!==s||isFinite(l)&&Math.floor(l)===l?"categorical"!==r&&"number"===s&&void 0!==i&&l<i?[new ee(e.key,o,"stop domain values must appear in ascending order")]:(i=l,"categorical"===r&&l in a?[new ee(e.key,o,"stop domain values must be unique")]:(a[l]=!0,[])):[new ee(e.key,o,"integer expected, found "+l)];{let n=`number expected, ${s} found`;return ir(t)&&void 0===r&&(n+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ee(e.key,o,n)]}}}function Ur(e){var t=("property"===e.expressionContext?wr:vr)(Dr(e.value),e.valueSpec);if("error"===t.result)return t.value.map((t=>new ee(""+e.key+t.key,e.value,t.message)));if(t=t.value.expression||t.value._styleExpression.expression,"property"===e.expressionContext&&"text-font"===e.propertyKey&&!t.outputDefined())return[new ee(e.key,e.value,`Invalid data expression for "${e.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===e.expressionContext&&"layout"===e.propertyType&&!At(t))return[new ee(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===e.expressionContext&&!At(t))return[new ee(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&0===e.expressionContext.indexOf("cluster")){if(!Pt(t,["zoom","feature-state"]))return[new ee(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===e.expressionContext&&!kt(t))return[new ee(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function jr(e){var t=e.key,r=e.value,n=(e=e.valueSpec,[]);return Array.isArray(e.values)?-1===e.values.indexOf(Lr(r))&&n.push(new ee(t,r,`expected one of [${e.values.join(", ")}], ${JSON.stringify(r)} found`)):-1===Object.keys(e.values).indexOf(Lr(r))&&n.push(new ee(t,r,`expected one of [${Object.keys(e.values).join(", ")}], ${JSON.stringify(r)} found`)),n}function qr(e){return Cr(Dr(e.value))?Ur(te({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function e(t){const r=t.value,n=t.key;if("array"!==sr(r))return[new ee(n,r,`array expected, ${sr(r)} found`)];const i=t.styleSpec;let o,a=[];if(r.length<1)return[new ee(n,r,"filter array must have at least 1 element")];switch(a=a.concat(jr({key:n+"[0]",value:r[0],valueSpec:i.filter_operator,style:t.style,styleSpec:t.styleSpec})),Lr(r[0])){case"<":case"<=":case">":case">=":2<=r.length&&"$type"===Lr(r[1])&&a.push(new ee(n,r,`"$type" cannot be use with operator "${r[0]}"`));case"==":case"!=":3!==r.length&&a.push(new ee(n,r,`filter array for operator "${r[0]}" must have 3 elements`));case"in":case"!in":2<=r.length&&"string"!==(o=sr(r[1]))&&a.push(new ee(n+"[1]",r[1],`string expected, ${o} found`));for(let e=2;e<r.length;e++)o=sr(r[e]),"$type"===Lr(r[1])?a=a.concat(jr({key:`${n}[${e}]`,value:r[e],valueSpec:i.geometry_type,style:t.style,styleSpec:t.styleSpec})):"string"!==o&&"number"!==o&&"boolean"!==o&&a.push(new ee(`${n}[${e}]`,r[e],`string, number, or boolean expected, ${o} found`));break;case"any":case"all":case"none":for(let i=1;i<r.length;i++)a=a.concat(e({key:`${n}[${i}]`,value:r[i],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":o=sr(r[1]),2!==r.length?a.push(new ee(n,r,`filter array for "${r[0]}" operator must have 2 elements`)):"string"!==o&&a.push(new ee(n+"[1]",r[1],`string expected, ${o} found`));break;case"within":o=sr(r[1]),2!==r.length?a.push(new ee(n,r,`filter array for "${r[0]}" operator must have 2 elements`)):"object"!==o&&a.push(new ee(n+"[1]",r[1],`object expected, ${o} found`))}return a}(e)}function Hr(e,t){var r=e.key,n=e.validateSpec,i=e.style,o=e.styleSpec,a=e.value,s=e.objectKey,l=o[t+"_"+e.layerType];if(!l)return[];var c=s.match(/^(.*)-transition$/);if("paint"===t&&c&&l[c[1]]&&l[c[1]].transition)return n({key:r,value:a,valueSpec:o.transition,style:i,styleSpec:o});if(!(c=e.valueSpec||l[s]))return[new ee(r,a,`unknown property "${s}"`)];let u;return"string"===sr(a)&&ir(c)&&!c.tokens&&(u=/^{([^}]+)}$/.exec(a))?[new ee(r,a,`"${s}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(u[1])} }\`.`)]:(l=[],"symbol"===e.layerType&&("text-field"===s&&i&&!i.glyphs&&l.push(new ee(r,a,'use of "text-field" requires a style "glyphs" property')),"text-font"===s)&&lr(Dr(a))&&"identity"===Lr(a.type)&&l.push(new ee(r,a,'"text-font" does not support identity functions')),l.concat(n({key:e.key,value:a,valueSpec:c,style:i,styleSpec:o,expressionContext:"property",propertyType:t,propertyKey:s})))}function Vr(e){return Hr(e,"paint")}function Gr(e){return Hr(e,"layout")}function Kr(e){let t=[];const r=e.value,n=e.key;var i,o,a=e.style;const s=e.styleSpec;r.type||r.ref||t.push(new ee(n,r,'either "type" or "ref" is required'));let l=Lr(r.type);const c=Lr(r.ref);if(r.id){var u=Lr(r.id);for(let i=0;i<e.arrayIndex;i++){var h=a.layers[i];Lr(h.id)===u&&t.push(new ee(n,r.id,`duplicate layer id "${r.id}", previously used at line `+h.id.__line__))}}if("ref"in r){let e;["type","source","source-layer","filter","layout"].forEach((e=>{e in r&&t.push(new ee(n,r[e],`"${e}" is prohibited for ref layers`))})),a.layers.forEach((t=>{Lr(t.id)===c&&(e=t)})),e?e.ref?t.push(new ee(n,r.ref,"ref cannot reference another ref layer")):l=Lr(e.type):t.push(new ee(n,r.ref,`ref layer "${c}" not found`))}else"background"!==l&&(r.source?(o=(i=a.sources&&a.sources[r.source])&&Lr(i.type),i?"vector"===o&&"raster"===l?t.push(new ee(n,r.source,`layer "${r.id}" requires a raster source`)):"raster-dem"!==o&&"hillshade"===l?t.push(new ee(n,r.source,`layer "${r.id}" requires a raster-dem source`)):"raster"===o&&"raster"!==l?t.push(new ee(n,r.source,`layer "${r.id}" requires a vector source`)):"vector"!==o||r["source-layer"]?"raster-dem"===o&&"hillshade"!==l?t.push(new ee(n,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==l||!r.paint||!r.paint["line-gradient"]||"geojson"===o&&i.lineMetrics||t.push(new ee(n,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new ee(n,r,`layer "${r.id}" must specify a "source-layer"`)):t.push(new ee(n,r.source,`source "${r.source}" not found`))):t.push(new ee(n,r,'missing required property "source"')));return t=t.concat(Nr({key:n,value:r,valueSpec:s.layer,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,objectElementValidators:{"*":()=>[],type:()=>e.validateSpec({key:n+".type",value:r.type,valueSpec:s.layer.type,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,object:r,objectKey:"type"}),filter:qr,layout:e=>Nr({layer:r,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,objectElementValidators:{"*":e=>Gr(te({layerType:l},e))}}),paint:e=>Nr({layer:r,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,objectElementValidators:{"*":e=>Vr(te({layerType:l},e))}})}}))}function Zr(e){var t=e.value,r=(e=e.key,sr(t));return"string"!==r?[new ee(e,t,`string expected, ${r} found`)]:[]}const Wr={promoteId:function(e){let{key:t,value:r}=e;if("string"===sr(r))return Zr({key:t,value:r});var n=[];for(const i in r)n.push(...Zr({key:t+"."+i,value:r[i]}));return n}};function $r(e){var t=e.value,r=e.key,n=e.styleSpec,i=e.style,o=e.validateSpec;if(!t.type)return[new ee(r,t,'"type" is required')];var a=Lr(t.type);let s;switch(a){case"vector":case"raster":return Nr({key:r,value:t,valueSpec:n["source_"+a.replace("-","_")],style:e.style,styleSpec:n,objectElementValidators:Wr,validateSpec:o});case"raster-dem":return function(e){var t=null!=(s=e.sourceName)?s:"",r=e.value,n=e.styleSpec,i=n.source_raster_dem,o=e.style;let a=[];var s=sr(r);if(void 0!==r)if("object"!==s)a.push(new ee("source_raster_dem",r,`object expected, ${s} found`));else{var l="custom"===Lr(r.encoding),c=["redFactor","greenFactor","blueFactor","baseShift"],u=e.value.encoding?`"${e.value.encoding}"`:"Default";for(const s in r)!l&&c.includes(s)?a.push(new ee(s,r[s],`In "${t}": "${s}" is only valid when "encoding" is set to "custom". ${u} encoding found`)):i[s]?a=a.concat(e.validateSpec({key:s,value:r[s],valueSpec:i[s],validateSpec:e.validateSpec,style:o,styleSpec:n})):a.push(new ee(s,r[s],`unknown property "${s}"`))}return a}({sourceName:r,value:t,style:e.style,styleSpec:n,validateSpec:o});case"geojson":if(s=Nr({key:r,value:t,valueSpec:n.source_geojson,style:i,styleSpec:n,validateSpec:o,objectElementValidators:Wr}),t.cluster)for(const e in t.clusterProperties){var[l,c]=t.clusterProperties[e],l="string"==typeof l?[l,["accumulated"],["get",e]]:l;s.push(...Ur({key:`${r}.${e}.map`,value:c,validateSpec:o,expressionContext:"cluster-map"})),s.push(...Ur({key:`${r}.${e}.reduce`,value:l,validateSpec:o,expressionContext:"cluster-reduce"}))}return s;case"video":return Nr({key:r,value:t,valueSpec:n.source_video,style:i,validateSpec:o,styleSpec:n});case"image":return Nr({key:r,value:t,valueSpec:n.source_image,style:i,validateSpec:o,styleSpec:n});case"canvas":return[new ee(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return jr({key:r+".type",value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:i,validateSpec:o,styleSpec:n})}}function Yr(e){var t=e.value,r=e.styleSpec,n=r.light,i=e.style;let o=[];var a=sr(t);if(void 0!==t){if("object"!==a)return o.concat([new ee("light",t,`object expected, ${a} found`)]);for(const a in t){var s=a.match(/^(.*)-transition$/);o=s&&n[s[1]]&&n[s[1]].transition?o.concat(e.validateSpec({key:a,value:t[a],valueSpec:r.transition,validateSpec:e.validateSpec,style:i,styleSpec:r})):n[a]?o.concat(e.validateSpec({key:a,value:t[a],valueSpec:n[a],validateSpec:e.validateSpec,style:i,styleSpec:r})):o.concat([new ee(a,t[a],`unknown property "${a}"`)])}}return o}function Xr(e){var t=e.value,r=e.styleSpec,n=r.sky,i=e.style;e=sr(t);if(void 0===t)return[];if("object"!==e)return[new ee("sky",t,`object expected, ${e} found`)];let o=[];for(const a in t)o=n[a]?o.concat(tn({key:a,value:t[a],valueSpec:n[a],style:i,styleSpec:r})):o.concat([new ee(a,t[a],`unknown property "${a}"`)]);return o}function Qr(e){var t=e.value,r=e.styleSpec,n=r.terrain,i=e.style;let o=[];var a=sr(t);if(void 0!==t){if("object"!==a)return o.concat([new ee("terrain",t,`object expected, ${a} found`)]);for(const a in t)o=n[a]?o.concat(e.validateSpec({key:a,value:t[a],valueSpec:n[a],validateSpec:e.validateSpec,style:i,styleSpec:r})):o.concat([new ee(a,t[a],`unknown property "${a}"`)])}return o}function Jr(e){let t=[];var r=e.value,n=e.key;if(Array.isArray(r)){var i=[],o=[];for(const a in r)r[a].id&&i.includes(r[a].id)&&t.push(new ee(n,r,`all the sprites' ids must be unique, but ${r[a].id} is duplicated`)),i.push(r[a].id),r[a].url&&o.includes(r[a].url)&&t.push(new ee(n,r,`all the sprites' URLs must be unique, but ${r[a].url} is duplicated`)),o.push(r[a].url),t=t.concat(Nr({key:`${n}[${a}]`,value:r[a],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:e.validateSpec}));return t}return Zr({key:n,value:r})}const en={"*":()=>[],array:zr,boolean:function(e){var t=e.value,r=(e=e.key,sr(t));return"boolean"!==r?[new ee(e,t,`boolean expected, ${r} found`)]:[]},number:Fr,color:function(e){var t=e.key,r=sr(e=e.value);return"string"!==r?[new ee(t,e,`color expected, ${r} found`)]:He.parse(String(e))?[]:[new ee(t,e,`color expected, "${e}" found`)]},constants:Or,enum:jr,filter:qr,function:Br,layer:Kr,object:Nr,source:$r,light:Yr,sky:Xr,terrain:Qr,string:Zr,formatted:function(e){return 0===Zr(e).length?[]:Ur(e)},resolvedImage:function(e){return 0===Zr(e).length?[]:Ur(e)},padding:function(e){var t=e.key,r=e.value;if("array"!==sr(r))return Fr({key:t,value:r,valueSpec:{}});{if(r.length<1||4<r.length)return[new ee(t,r,`padding requires 1 to 4 values; ${r.length} values found`)];var n={type:"number"};let i=[];for(let o=0;o<r.length;o++)i=i.concat(e.validateSpec({key:`${t}[${o}]`,value:r[o],validateSpec:e.validateSpec,valueSpec:n}));return i}},variableAnchorOffsetCollection:function(e){var t=e.key,r=e.value,n=sr(r),i=e.styleSpec;if("array"!==n||r.length<1||r.length%2!=0)return[new ee(t,r,"variableAnchorOffsetCollection requires a non-empty array of even length")];let o=[];for(let a=0;a<r.length;a+=2)o=(o=o.concat(jr({key:`${t}[${a}]`,value:r[a],valueSpec:i.layout_symbol["text-anchor"]}))).concat(zr({key:`${t}[${a+1}]`,value:r[a+1],valueSpec:{length:2,value:"number"},validateSpec:e.validateSpec,style:e.style,styleSpec:i}));return o},sprite:Jr};function tn(e){var t=e.value,r=e.valueSpec,n=e.styleSpec;return e.validateSpec=tn,r.expression&&lr(Lr(t))?Br(e):r.expression&&yr(Dr(t))?Ur(e):r.type&&en[r.type]?en[r.type](e):Nr(te({},e,{valueSpec:r.type?n[r.type]:r}))}function rn(e){var t=e.value,r=e.key;return(e=Zr(e)).length||(-1===t.indexOf("{fontstack}")&&e.push(new ee(r,t,'"glyphs" url must include a "{fontstack}" token')),-1===t.indexOf("{range}")&&e.push(new ee(r,t,'"glyphs" url must include a "{range}" token'))),e}function nn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:G,r=[];return r=r.concat(tn({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,validateSpec:tn,objectElementValidators:{glyphs:rn,"*":()=>[]}})),an(r=e.constants?r.concat(Or({key:"constants",value:e.constants,style:e,styleSpec:t,validateSpec:tn})):r)}function on(e){return function(t){return e({...t,validateSpec:tn})}}function an(e){return[].concat(e).sort(((e,t)=>e.line-t.line))}function sn(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return an(e.apply(this,r))}}nn.source=sn(on($r)),nn.sprite=sn(on(Jr)),nn.glyphs=sn(on(rn)),nn.light=sn(on(Yr)),nn.sky=sn(on(Xr)),nn.terrain=sn(on(Qr)),nn.layer=sn(on(Kr)),nn.filter=sn(on(qr)),nn.paintProperty=sn(on(Vr)),nn.layoutProperty=sn(on(Gr));const ln=nn;Ot=ln.light;const cn=ln.paintProperty,un=ln.layoutProperty;function hn(e,t){let r=!1;if(t&&t.length)for(const n of t)e.fire(new H(new Error(n.message))),r=!0;return r}class dn{constructor(e,t,r){var n=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var i=new Int32Array(this.arrayBuffer);e=i[0],t=i[1],r=i[2],this.d=t+2*r;for(let e=0;e<this.d*this.d;e++){var o=i[3+e],a=i[3+e+1];n.push(o===a?null:i.subarray(o,a))}var s=i[3+n.length],l=i[3+n.length+1];this.keys=i.subarray(s,l),this.bboxes=i.subarray(l),this.insert=this._insertReadonly}else{this.d=t+2*r;for(let e=0;e<this.d*this.d;e++)n.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=r,this.scale=t/e,this.uid=0,s=r/t*e,this.min=-s,this.max=e+s}insert(e,t,r,n,i){this._forEachCell(t,r,n,i,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(i)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,t,r,n,i,o){this.cells[i].push(o)}query(e,t,r,n,i){var o=this.min,a=this.max;return e<=o&&t<=o&&a<=r&&a<=n&&!i?Array.prototype.slice.call(this.keys):(this._forEachCell(e,t,r,n,this._queryCell,o=[],{},i),o)}_queryCell(e,t,r,n,i,o,a,s){var l=this.cells[i];if(null!==l){var c=this.keys,u=this.bboxes;for(let i=0;i<l.length;i++){var h,d=l[i];void 0===a[d]&&(h=4*d,(s?s(u[0+h],u[1+h],u[2+h],u[3+h]):e<=u[2+h]&&t<=u[3+h]&&r>=u[0+h]&&n>=u[1+h])?(a[d]=!0,o.push(c[d])):a[d]=!1)}}}_forEachCell(e,t,r,n,i,o,a,s){var l=this._convertToCellCoord(e),c=this._convertToCellCoord(t),u=this._convertToCellCoord(r),h=this._convertToCellCoord(n);for(let p=l;p<=u;p++)for(let l=c;l<=h;l++){var d=this.d*l+p;if((!s||s(this._convertFromCellCoord(p),this._convertFromCellCoord(l),this._convertFromCellCoord(p+1),this._convertFromCellCoord(l+1)))&&i.call(this,e,t,r,n,d,o,a,s))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;var e=this.cells,t=3+this.cells.length+1+1;let r=0;for(let a=0;a<this.cells.length;a++)r+=this.cells[a].length;var n=new Int32Array(t+r+this.keys.length+this.bboxes.length);n[0]=this.extent,n[1]=this.n,n[2]=this.padding;let i=t;for(let a=0;a<e.length;a++){var o=e[a];n[3+a]=i,n.set(o,i),i+=o.length}return n[3+e.length]=i,n.set(this.keys,i),i+=this.keys.length,n[3+e.length+1]=i,n.set(this.bboxes,i),i+=this.bboxes.length,n.buffer}static serialize(e,t){return e=e.toArrayBuffer(),t&&t.push(e),{buffer:e}}static deserialize(e){return new dn(e.buffer)}}const pn={};function fn(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(pn[e])throw new Error(e+" is already registered.");Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),pn[e]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}fn("Object",Object),fn("TransferableGridIndex",dn),fn("Color",He),fn("Error",Error),fn("AJAXError",N),fn("ResolvedImage",Ye),fn("StylePropertyFunction",xr),fn("StyleExpression",gr,{omit:["_evaluator"]}),fn("ZoomDependentExpression",br),fn("ZoomConstantExpression",_r),fn("CompoundExpression",Tt,{omit:["_evaluate"]});for(const Nc in Qt)Qt[Nc]._classRegistryKey||fn("Expression_"+Nc,Qt[Nc]);function mn(e){return e&&"undefined"!=typeof ArrayBuffer&&(e instanceof ArrayBuffer||e.constructor&&"ArrayBuffer"===e.constructor.name)}function gn(e,t){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||e instanceof Blob||e instanceof Error)return e;if(mn(e))return t&&t.push(e),e;if(T(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e))return n=e,t&&t.push(n.buffer),n;if(e instanceof ImageData)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){var r=[];for(const n of e)r.push(gn(n,t));return r}if("object"!=typeof e)throw new Error("can't serialize object of type "+typeof e);var n=e.constructor,i=n._classRegistryKey;if(!i)throw new Error("can't serialize object of unregistered class "+n.name);if(!pn[i])throw new Error(i+" is not registered.");var o,a=n.serialize?n.serialize(e,t):{};if(n.serialize){if(t&&a===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const r in e)!e.hasOwnProperty(r)||0<=pn[i].omit.indexOf(r)||(o=e[r],a[r]=0<=pn[i].shallow.indexOf(r)?o:gn(o,t));e instanceof Error&&(a.message=e.message)}if(a.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==i&&(a.$name=i),a}function yn(e){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||e instanceof Blob||e instanceof Error||mn(e)||T(e)||ArrayBuffer.isView(e)||e instanceof ImageData)return e;if(Array.isArray(e))return e.map(yn);if("object"!=typeof e)throw new Error("can't deserialize object of type "+typeof e);var t=e.$name||"Object";if(!pn[t])throw new Error("can't deserialize unregistered class "+t);var r=pn[t].klass;if(!r)throw new Error("can't deserialize unregistered class "+t);if(r.deserialize)return r.deserialize(e);var n,i=Object.create(r.prototype);for(const o of Object.keys(e))"$name"!==o&&(n=e[o],i[o]=0<=pn[t].shallow.indexOf(o)?n:yn(n));return i}class vn{constructor(){this.first=!0}update(e,t){var r=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=r,!0))}}const _n={"Latin-1 Supplement":e=>128<=e&&e<=255,Arabic:e=>1536<=e&&e<=1791,"Arabic Supplement":e=>1872<=e&&e<=1919,"Arabic Extended-A":e=>2208<=e&&e<=2303,"Hangul Jamo":e=>4352<=e&&e<=4607,"Unified Canadian Aboriginal Syllabics":e=>5120<=e&&e<=5759,Khmer:e=>6016<=e&&e<=6143,"Unified Canadian Aboriginal Syllabics Extended":e=>6320<=e&&e<=6399,"General Punctuation":e=>8192<=e&&e<=8303,"Letterlike Symbols":e=>8448<=e&&e<=8527,"Number Forms":e=>8528<=e&&e<=8591,"Miscellaneous Technical":e=>8960<=e&&e<=9215,"Control Pictures":e=>9216<=e&&e<=9279,"Optical Character Recognition":e=>9280<=e&&e<=9311,"Enclosed Alphanumerics":e=>9312<=e&&e<=9471,"Geometric Shapes":e=>9632<=e&&e<=9727,"Miscellaneous Symbols":e=>9728<=e&&e<=9983,"Miscellaneous Symbols and Arrows":e=>11008<=e&&e<=11263,"CJK Radicals Supplement":e=>11904<=e&&e<=12031,"Kangxi Radicals":e=>12032<=e&&e<=12255,"Ideographic Description Characters":e=>12272<=e&&e<=12287,"CJK Symbols and Punctuation":e=>12288<=e&&e<=12351,Hiragana:e=>12352<=e&&e<=12447,Katakana:e=>12448<=e&&e<=12543,Bopomofo:e=>12544<=e&&e<=12591,"Hangul Compatibility Jamo":e=>12592<=e&&e<=12687,Kanbun:e=>12688<=e&&e<=12703,"Bopomofo Extended":e=>12704<=e&&e<=12735,"CJK Strokes":e=>12736<=e&&e<=12783,"Katakana Phonetic Extensions":e=>12784<=e&&e<=12799,"Enclosed CJK Letters and Months":e=>12800<=e&&e<=13055,"CJK Compatibility":e=>13056<=e&&e<=13311,"CJK Unified Ideographs Extension A":e=>13312<=e&&e<=19903,"Yijing Hexagram Symbols":e=>19904<=e&&e<=19967,"CJK Unified Ideographs":e=>19968<=e&&e<=40959,"Yi Syllables":e=>40960<=e&&e<=42127,"Yi Radicals":e=>42128<=e&&e<=42191,"Hangul Jamo Extended-A":e=>43360<=e&&e<=43391,"Hangul Syllables":e=>44032<=e&&e<=55215,"Hangul Jamo Extended-B":e=>55216<=e&&e<=55295,"Private Use Area":e=>57344<=e&&e<=63743,"CJK Compatibility Ideographs":e=>63744<=e&&e<=64255,"Arabic Presentation Forms-A":e=>64336<=e&&e<=65023,"Vertical Forms":e=>65040<=e&&e<=65055,"CJK Compatibility Forms":e=>65072<=e&&e<=65103,"Small Form Variants":e=>65104<=e&&e<=65135,"Arabic Presentation Forms-B":e=>65136<=e&&e<=65279,"Halfwidth and Fullwidth Forms":e=>65280<=e&&e<=65519};function bn(e){for(const t of e)if(xn(t.charCodeAt(0)))return!0;return!1}function wn(e){for(const r of e)if(t=r.charCodeAt(0),_n.Arabic(t)||_n["Arabic Supplement"](t)||_n["Arabic Extended-A"](t)||_n["Arabic Presentation Forms-A"](t)||_n["Arabic Presentation Forms-B"](t))return;var t;return 1}function xn(e){return 746===e||747===e||!(e<4352)&&(_n["Bopomofo Extended"](e)||_n.Bopomofo(e)||_n["CJK Compatibility Forms"](e)&&!(65097<=e&&e<=65103)||_n["CJK Compatibility Ideographs"](e)||_n["CJK Compatibility"](e)||_n["CJK Radicals Supplement"](e)||_n["CJK Strokes"](e)||!(!_n["CJK Symbols and Punctuation"](e)||12296<=e&&e<=12305||12308<=e&&e<=12319||12336===e)||_n["CJK Unified Ideographs Extension A"](e)||_n["CJK Unified Ideographs"](e)||_n["Enclosed CJK Letters and Months"](e)||_n["Hangul Compatibility Jamo"](e)||_n["Hangul Jamo Extended-A"](e)||_n["Hangul Jamo Extended-B"](e)||_n["Hangul Jamo"](e)||_n["Hangul Syllables"](e)||_n.Hiragana(e)||_n["Ideographic Description Characters"](e)||_n.Kanbun(e)||_n["Kangxi Radicals"](e)||_n["Katakana Phonetic Extensions"](e)||_n.Katakana(e)&&12540!==e||!(!_n["Halfwidth and Fullwidth Forms"](e)||65288===e||65289===e||65293===e||65306<=e&&e<=65310||65339===e||65341===e||65343===e||65371<=e&&e<=65503||65507===e||65512<=e&&e<=65519)||!(!_n["Small Form Variants"](e)||65112<=e&&e<=65118||65123<=e&&e<=65126)||_n["Unified Canadian Aboriginal Syllabics"](e)||_n["Unified Canadian Aboriginal Syllabics Extended"](e)||_n["Vertical Forms"](e)||_n["Yijing Hexagram Symbols"](e)||_n["Yi Syllables"](e)||!!_n["Yi Radicals"](e))}function Cn(e){return!(xn(e)||_n["Latin-1 Supplement"](e)&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||_n["General Punctuation"](e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||_n["Letterlike Symbols"](e)||_n["Number Forms"](e)||_n["Miscellaneous Technical"](e)&&(8960<=e&&e<=8967||8972<=e&&e<=8991||8996<=e&&e<=9e3||9003===e||9085<=e&&e<=9114||9150<=e&&e<=9165||9167===e||9169<=e&&e<=9179||9186<=e&&e<=9215)||_n["Control Pictures"](e)&&9251!==e||_n["Optical Character Recognition"](e)||_n["Enclosed Alphanumerics"](e)||_n["Geometric Shapes"](e)||_n["Miscellaneous Symbols"](e)&&!(9754<=e&&e<=9759)||_n["Miscellaneous Symbols and Arrows"](e)&&(11026<=e&&e<=11055||11088<=e&&e<=11097||11192<=e&&e<=11243)||_n["CJK Symbols and Punctuation"](e)||_n.Katakana(e)||_n["Private Use Area"](e)||_n["CJK Compatibility Forms"](e)||_n["Small Form Variants"](e)||_n["Halfwidth and Fullwidth Forms"](e)||8734===e||8756===e||8757===e||9984<=e&&e<=10087||10102<=e&&e<=10131||65532===e||65533===e)}function Sn(e){return 1424<=e&&e<=2303||_n["Arabic Presentation Forms-A"](e)||_n["Arabic Presentation Forms-B"](e)}const En=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(e){this.pluginStatus=e.pluginStatus,this.pluginURL=e.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(e){this.applyArabicShaping=e.applyArabicShaping,this.processBidirectionalText=e.processBidirectionalText,this.processStyledBidirectionalText=e.processStyledBidirectionalText}isParsed(){return null!=this.applyArabicShaping&&null!=this.processBidirectionalText&&null!=this.processStyledBidirectionalText}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class Tn{constructor(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.zoomHistory=t.zoomHistory,this.transition=t.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new vn,this.transition={})}isSupportedScript(e){return function(e,t){for(const n of e)if(r=n.charCodeAt(0),!t&&Sn(r)||2304<=r&&r<=3583||3840<=r&&r<=4255||_n.Khmer(r))return!1;var r;return!0}(e,"loaded"===En.getRTLTextPluginStatus())}crossFadingFactor(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){var e=this.zoom,t=e-Math.floor(e),r=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*r}:{fromScale:.5,toScale:1,t:1-(1-r)*t}}}class In{constructor(e,t){this.property=e,this.value=t,this.expression=function(e,t){if(lr(e))return new xr(e,t);if(yr(e)){var r=wr(e,t);if("error"===r.result)throw new Error(r.value.map((e=>e.key+": "+e.message)).join(", "));return r.value}{let r=e;return"color"===t.type&&"string"==typeof e?r=He.parse(e):"padding"!==t.type||"number"!=typeof e&&!Array.isArray(e)?"variableAnchorOffsetCollection"===t.type&&Array.isArray(e)&&(r=$e.parse(e)):r=Ze.parse(e),{kind:"constant",evaluate:()=>r}}}(void 0===t?e.specification.default:t,e.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(e,t,r){return this.property.possiblyEvaluate(this,e,t,r)}}class kn{constructor(e){this.property=e,this.value=new In(e,void 0)}transitioned(e,t){return new Pn(this.property,this.value,t,g({},e.transition,this.transition),e.now)}untransitioned(){return new Pn(this.property,this.value,null,{},0)}}class An{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return b(this._values[e].value.value)}setValue(e,t){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new kn(this._values[e].property)),this._values[e].value=new In(this._values[e].property,null===t?void 0:b(t))}getTransition(e){return b(this._values[e].transition)}setTransition(e,t){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new kn(this._values[e].property)),this._values[e].transition=b(t)||void 0}serialize(){var e={};for(const r of Object.keys(this._values)){var t;void 0!==(t=(void 0!==(t=this.getValue(r))&&(e[r]=t),this.getTransition(r)))&&(e[r+"-transition"]=t)}return e}transitioned(e,t){var r=new Mn(this._properties);for(const n of Object.keys(this._values))r._values[n]=this._values[n].transitioned(e,t._values[n]);return r}untransitioned(){var e=new Mn(this._properties);for(const t of Object.keys(this._values))e._values[t]=this._values[t].untransitioned();return e}}class Pn{constructor(e,t,r,n,i){this.property=e,this.value=t,this.begin=i+n.delay||0,this.end=this.begin+n.duration||0,e.specification.transition&&(n.delay||n.duration)&&(this.prior=r)}possiblyEvaluate(e,t,r){var n=e.now||0,i=this.value.possiblyEvaluate(e,t,r),o=this.prior;return o?n>this.end||this.value.isDataDriven()?(this.prior=null,i):n<this.begin?o.possiblyEvaluate(e,t,r):(n=(n-this.begin)/(this.end-this.begin),this.property.interpolate(o.possiblyEvaluate(e,t,r),i,function(e){var t,r;return e<=0?0:1<=e?1:(r=(t=e*e)*e,4*(e<.5?r:3*(e-t)+r-.75))}(n))):i}}class Mn{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,t,r){var n=new Ln(this._properties);for(const i of Object.keys(this._values))n._values[i]=this._values[i].possiblyEvaluate(e,t,r);return n}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class Rn{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}hasValue(e){return void 0!==this._values[e].value}getValue(e){return b(this._values[e].value)}setValue(e,t){this._values[e]=new In(this._values[e].property,null===t?void 0:b(t))}serialize(){var e={};for(const r of Object.keys(this._values)){var t=this.getValue(r);void 0!==t&&(e[r]=t)}return e}possiblyEvaluate(e,t,r){var n=new Ln(this._properties);for(const i of Object.keys(this._values))n._values[i]=this._values[i].possiblyEvaluate(e,t,r);return n}}class On{constructor(e,t,r){this.property=e,this.value=t,this.parameters=r}isConstant(){return"constant"===this.value.kind}constantOr(e){return"constant"===this.value.kind?this.value.value:e}evaluate(e,t,r,n){return this.property.evaluate(this.value,this.parameters,e,t,r,n)}}class Ln{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class Dn{constructor(e){this.specification=e}possiblyEvaluate(e,t){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(t)}interpolate(e,t,r){var n=this.specification.type;return(n=Ft[n])?n(e,t,r):e}}class Nn{constructor(e,t){this.specification=e,this.overrides=t}possiblyEvaluate(e,t,r,n){return"constant"===e.expression.kind||"camera"===e.expression.kind?new On(this,{kind:"constant",value:e.expression.evaluate(t,null,{},r,n)},t):new On(this,e.expression,t)}interpolate(e,t,r){var n;return"constant"!==e.value.kind||"constant"!==t.value.kind?e:void 0===e.value.value||void 0===t.value.value?new On(this,{kind:"constant",value:void 0},e.parameters):(n=this.specification.type,(n=Ft[n])?(n=n(e.value.value,t.value.value,r),new On(this,{kind:"constant",value:n},e.parameters)):e)}evaluate(e,t,r,n,i,o){return"constant"===e.kind?e.value:e.evaluate(t,r,n,i,o)}}class zn extends Nn{possiblyEvaluate(e,t,r,n){return void 0===e.value?new On(this,{kind:"constant",value:void 0},t):"constant"===e.expression.kind?(r=e.expression.evaluate(t,null,{},r,n),n="resolvedImage"===e.property.specification.type&&"string"!=typeof r?r.name:r,r=this._calculate(n,n,n,t),new On(this,{kind:"constant",value:r},t)):"camera"===e.expression.kind?(n=this._calculate(e.expression.evaluate({zoom:t.zoom-1}),e.expression.evaluate({zoom:t.zoom}),e.expression.evaluate({zoom:t.zoom+1}),t),new On(this,{kind:"constant",value:n},t)):new On(this,e.expression,t)}evaluate(e,t,r,n,i,o){return"source"===e.kind?(i=e.evaluate(t,r,n,i,o),this._calculate(i,i,i,t)):"composite"===e.kind?this._calculate(e.evaluate({zoom:Math.floor(t.zoom)-1},r,n),e.evaluate({zoom:Math.floor(t.zoom)},r,n),e.evaluate({zoom:Math.floor(t.zoom)+1},r,n),t):e.value}_calculate(e,t,r,n){return n.zoom>n.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}}interpolate(e){return e}}class Fn{constructor(e){this.specification=e}possiblyEvaluate(e,t,r,n){if(void 0!==e.value)return"constant"===e.expression.kind?(r=e.expression.evaluate(t,null,{},r,n),this._calculate(r,r,r,t)):this._calculate(e.expression.evaluate(new Tn(Math.floor(t.zoom-1),t)),e.expression.evaluate(new Tn(Math.floor(t.zoom),t)),e.expression.evaluate(new Tn(Math.floor(t.zoom+1),t)),t)}_calculate(e,t,r,n){return n.zoom>n.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}}interpolate(e){return e}}class Bn{constructor(e){this.specification=e}possiblyEvaluate(e,t,r,n){return!!e.expression.evaluate(t,null,{},r,n)}interpolate(){return!1}}class Un{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const n in e){var t=((r=e[n]).specification.overridable&&this.overridableProperties.push(n),this.defaultPropertyValues[n]=new In(r,void 0)),r=this.defaultTransitionablePropertyValues[n]=new kn(r);this.defaultTransitioningPropertyValues[n]=r.untransitioned(),this.defaultPossiblyEvaluatedValues[n]=t.possiblyEvaluate({})}}}fn("DataDrivenProperty",Nn),fn("DataConstantProperty",Dn),fn("CrossFadedDataDrivenProperty",zn),fn("CrossFadedProperty",Fn),fn("ColorRampProperty",Bn);const jn="-transition";class qn extends V{constructor(e,t){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1},"custom"!==e.type&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,"background"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),t.layout&&(this._unevaluatedLayout=new Rn(t.layout)),t.paint)){this._transitionablePaint=new An(t.paint);for(const t in e.paint)this.setPaintProperty(t,e.paint[t],{validate:!1});for(const t in e.layout)this.setLayoutProperty(t,e.layout[t],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ln(t.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return"visibility"===e?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!=t){var n=`layers.${this.id}.layout.`+e;if(this._validate(un,n,e,t,r))return}"visibility"===e?this.visibility=t:this._unevaluatedLayout.setValue(e,t)}getPaintProperty(e){return e.endsWith(jn)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!=t){var n=`layers.${this.id}.paint.`+e;if(this._validate(cn,n,e,t,r))return!1}var i;return e.endsWith(jn)?(this._transitionablePaint.setTransition(e.slice(0,-11),t||void 0),!1):(r="cross-faded-data-driven"===(n=this._transitionablePaint._values[e]).property.specification["property-type"],i=n.value.isDataDriven(),n=n.value,this._transitionablePaint.setValue(e,t),this._handleSpecialPaintPropertyUpdate(e),(t=this._transitionablePaint._values[e].value).isDataDriven()||i||r||this._handleOverridablePaintPropertyUpdate(e,n,t))}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,t,r){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||"none"===this.visibility}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,t){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,t)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,t)}serialize(){var e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),_(e,((e,t)=>!(void 0===e||"layout"===t&&!Object.keys(e).length||"paint"===t&&!Object.keys(e).length)))}_validate(e,t,r,n){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return(!i||!1!==i.validate)&&hn(this,e.call(ln,{key:t,layerType:this.type,objectKey:r,value:n,styleSpec:G,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){var e=this.paint.get(t);if(e instanceof On&&ir(e.property.specification)&&("source"===e.value.kind||"composite"===e.value.kind)&&e.value.isStateDependent)return!0}return!1}}const Hn={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Vn{constructor(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Gn{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){var t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){e>this.capacity&&(this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement),e=this.uint8,this._refreshViews(),e)&&this.uint8.set(e)}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Kn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=0,n=0;return{members:e.map((e=>{i=e.type;var i=Hn[i].BYTES_PER_ELEMENT,o=r=Zn(r,Math.max(t,i)),a=e.components||1;return n=Math.max(n,i),r+=i*a,{name:e.name,type:e.type,components:a,offset:o}})),size:Zn(r,Math.max(n,t)),alignment:t}}function Zn(e,t){return Math.ceil(e/t)*t}class Wn extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t){var r=this.length;return this.resize(r+1),this.emplace(r,e,t)}emplace(e,t,r){var n=2*e;return this.int16[0+n]=t,this.int16[1+n]=r,e}}Wn.prototype.bytesPerElement=4,fn("StructArrayLayout2i4",Wn);class $n extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r){var n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}emplace(e,t,r,n){var i=3*e;return this.int16[0+i]=t,this.int16[1+i]=r,this.int16[2+i]=n,e}}$n.prototype.bytesPerElement=6,fn("StructArrayLayout3i6",$n);class Yn extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n){var i=this.length;return this.resize(i+1),this.emplace(i,e,t,r,n)}emplace(e,t,r,n,i){var o=4*e;return this.int16[0+o]=t,this.int16[1+o]=r,this.int16[2+o]=n,this.int16[3+o]=i,e}}Yn.prototype.bytesPerElement=8,fn("StructArrayLayout4i8",Yn);class Xn extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,o){var a=this.length;return this.resize(a+1),this.emplace(a,e,t,r,n,i,o)}emplace(e,t,r,n,i,o,a){var s=6*e;return this.int16[0+s]=t,this.int16[1+s]=r,this.int16[2+s]=n,this.int16[3+s]=i,this.int16[4+s]=o,this.int16[5+s]=a,e}}Xn.prototype.bytesPerElement=12,fn("StructArrayLayout2i4i12",Xn);class Qn extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,o){var a=this.length;return this.resize(a+1),this.emplace(a,e,t,r,n,i,o)}emplace(e,t,r,n,i,o,a){var s=4*e,l=8*e;return this.int16[0+s]=t,this.int16[1+s]=r,this.uint8[4+l]=n,this.uint8[5+l]=i,this.uint8[6+l]=o,this.uint8[7+l]=a,e}}Qn.prototype.bytesPerElement=8,fn("StructArrayLayout2i4ub8",Qn);class Jn extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t){var r=this.length;return this.resize(r+1),this.emplace(r,e,t)}emplace(e,t,r){var n=2*e;return this.float32[0+n]=t,this.float32[1+n]=r,e}}Jn.prototype.bytesPerElement=8,fn("StructArrayLayout2f8",Jn);class ei extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,o,a,s,l,c){var u=this.length;return this.resize(u+1),this.emplace(u,e,t,r,n,i,o,a,s,l,c)}emplace(e,t,r,n,i,o,a,s,l,c,u){var h=10*e;return this.uint16[0+h]=t,this.uint16[1+h]=r,this.uint16[2+h]=n,this.uint16[3+h]=i,this.uint16[4+h]=o,this.uint16[5+h]=a,this.uint16[6+h]=s,this.uint16[7+h]=l,this.uint16[8+h]=c,this.uint16[9+h]=u,e}}ei.prototype.bytesPerElement=20,fn("StructArrayLayout10ui20",ei);class ti extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,o,a,s,l,c,u,h){var d=this.length;return this.resize(d+1),this.emplace(d,e,t,r,n,i,o,a,s,l,c,u,h)}emplace(e,t,r,n,i,o,a,s,l,c,u,h,d){var p=12*e;return this.int16[0+p]=t,this.int16[1+p]=r,this.int16[2+p]=n,this.int16[3+p]=i,this.uint16[4+p]=o,this.uint16[5+p]=a,this.uint16[6+p]=s,this.uint16[7+p]=l,this.int16[8+p]=c,this.int16[9+p]=u,this.int16[10+p]=h,this.int16[11+p]=d,e}}ti.prototype.bytesPerElement=24,fn("StructArrayLayout4i4ui4i24",ti);class ri extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r){var n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}emplace(e,t,r,n){var i=3*e;return this.float32[0+i]=t,this.float32[1+i]=r,this.float32[2+i]=n,e}}ri.prototype.bytesPerElement=12,fn("StructArrayLayout3f12",ri);class ni extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){var t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.uint32[+e+0]=t,e}}ni.prototype.bytesPerElement=4,fn("StructArrayLayout1ul4",ni);class ii extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,o,a,s,l){var c=this.length;return this.resize(c+1),this.emplace(c,e,t,r,n,i,o,a,s,l)}emplace(e,t,r,n,i,o,a,s,l,c){var u=10*e,h=5*e;return this.int16[0+u]=t,this.int16[1+u]=r,this.int16[2+u]=n,this.int16[3+u]=i,this.int16[4+u]=o,this.int16[5+u]=a,this.uint32[3+h]=s,this.uint16[8+u]=l,this.uint16[9+u]=c,e}}ii.prototype.bytesPerElement=20,fn("StructArrayLayout6i1ul2ui20",ii);class oi extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,o){var a=this.length;return this.resize(a+1),this.emplace(a,e,t,r,n,i,o)}emplace(e,t,r,n,i,o,a){var s=6*e;return this.int16[0+s]=t,this.int16[1+s]=r,this.int16[2+s]=n,this.int16[3+s]=i,this.int16[4+s]=o,this.int16[5+s]=a,e}}oi.prototype.bytesPerElement=12,fn("StructArrayLayout2i2i2i12",oi);class ai extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i){var o=this.length;return this.resize(o+1),this.emplace(o,e,t,r,n,i)}emplace(e,t,r,n,i,o){var a=4*e,s=8*e;return this.float32[0+a]=t,this.float32[1+a]=r,this.float32[2+a]=n,this.int16[6+s]=i,this.int16[7+s]=o,e}}ai.prototype.bytesPerElement=16,fn("StructArrayLayout2f1f2i16",ai);class si extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,n){var i=this.length;return this.resize(i+1),this.emplace(i,e,t,r,n)}emplace(e,t,r,n,i){var o=12*e,a=3*e;return this.uint8[0+o]=t,this.uint8[1+o]=r,this.float32[1+a]=n,this.float32[2+a]=i,e}}si.prototype.bytesPerElement=12,fn("StructArrayLayout2ub2f12",si);class li extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r){var n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}emplace(e,t,r,n){var i=3*e;return this.uint16[0+i]=t,this.uint16[1+i]=r,this.uint16[2+i]=n,e}}li.prototype.bytesPerElement=6,fn("StructArrayLayout3ui6",li);class ci extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,o,a,s,l,c,u,h,d,p,f,m,g){var y=this.length;return this.resize(y+1),this.emplace(y,e,t,r,n,i,o,a,s,l,c,u,h,d,p,f,m,g)}emplace(e,t,r,n,i,o,a,s,l,c,u,h,d,p,f,m,g,y){var v=24*e,_=12*e,b=48*e;return this.int16[0+v]=t,this.int16[1+v]=r,this.uint16[2+v]=n,this.uint16[3+v]=i,this.uint32[2+_]=o,this.uint32[3+_]=a,this.uint32[4+_]=s,this.uint16[10+v]=l,this.uint16[11+v]=c,this.uint16[12+v]=u,this.float32[7+_]=h,this.float32[8+_]=d,this.uint8[36+b]=p,this.uint8[37+b]=f,this.uint8[38+b]=m,this.uint32[10+_]=g,this.int16[22+v]=y,e}}ci.prototype.bytesPerElement=48,fn("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",ci);class ui extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,o,a,s,l,c,u,h,d,p,f,m,g,y,v,_,b,w,x,C,S,E,T,I){var k=this.length;return this.resize(k+1),this.emplace(k,e,t,r,n,i,o,a,s,l,c,u,h,d,p,f,m,g,y,v,_,b,w,x,C,S,E,T,I)}emplace(e,t,r,n,i,o,a,s,l,c,u,h,d,p,f,m,g,y,v,_,b,w,x,C,S,E,T,I,k){var A=32*e,P=16*e;return this.int16[0+A]=t,this.int16[1+A]=r,this.int16[2+A]=n,this.int16[3+A]=i,this.int16[4+A]=o,this.int16[5+A]=a,this.int16[6+A]=s,this.int16[7+A]=l,this.uint16[8+A]=c,this.uint16[9+A]=u,this.uint16[10+A]=h,this.uint16[11+A]=d,this.uint16[12+A]=p,this.uint16[13+A]=f,this.uint16[14+A]=m,this.uint16[15+A]=g,this.uint16[16+A]=y,this.uint16[17+A]=v,this.uint16[18+A]=_,this.uint16[19+A]=b,this.uint16[20+A]=w,this.uint16[21+A]=x,this.uint16[22+A]=C,this.uint32[12+P]=S,this.float32[13+P]=E,this.float32[14+P]=T,this.uint16[30+A]=I,this.uint16[31+A]=k,e}}ui.prototype.bytesPerElement=64,fn("StructArrayLayout8i15ui1ul2f2ui64",ui);class hi extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){var t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.float32[+e+0]=t,e}}hi.prototype.bytesPerElement=4,fn("StructArrayLayout1f4",hi);class di extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r){var n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}emplace(e,t,r,n){var i=3*e;return this.uint16[0+6*e]=t,this.float32[1+i]=r,this.float32[2+i]=n,e}}di.prototype.bytesPerElement=12,fn("StructArrayLayout1ui2f12",di);class pi extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r){var n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}emplace(e,t,r,n){var i=4*e;return this.uint32[0+2*e]=t,this.uint16[2+i]=r,this.uint16[3+i]=n,e}}pi.prototype.bytesPerElement=8,fn("StructArrayLayout1ul2ui8",pi);class fi extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t){var r=this.length;return this.resize(r+1),this.emplace(r,e,t)}emplace(e,t,r){var n=2*e;return this.uint16[0+n]=t,this.uint16[1+n]=r,e}}fi.prototype.bytesPerElement=4,fn("StructArrayLayout2ui4",fi);class mi extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){var t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.uint16[+e+0]=t,e}}mi.prototype.bytesPerElement=2,fn("StructArrayLayout1ui2",mi);class gi extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,n){var i=this.length;return this.resize(i+1),this.emplace(i,e,t,r,n)}emplace(e,t,r,n,i){var o=4*e;return this.float32[0+o]=t,this.float32[1+o]=r,this.float32[2+o]=n,this.float32[3+o]=i,e}}gi.prototype.bytesPerElement=16,fn("StructArrayLayout4f16",gi);class yi extends Vn{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new o(this.anchorPointX,this.anchorPointY)}}yi.prototype.size=20;class vi extends ii{get(e){return new yi(this,e)}}fn("CollisionBoxArray",vi);class _i extends Vn{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}_i.prototype.size=48;class bi extends ci{get(e){return new _i(this,e)}}fn("PlacedSymbolArray",bi);class wi extends Vn{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}wi.prototype.size=64;class xi extends ui{get(e){return new wi(this,e)}}fn("SymbolInstanceArray",xi);class Ci extends hi{getoffsetX(e){return this.float32[+e+0]}}fn("GlyphOffsetArray",Ci);class Si extends $n{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}fn("SymbolLineVertexArray",Si);class Ei extends Vn{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Ei.prototype.size=12;class Ti extends di{get(e){return new Ei(this,e)}}fn("TextAnchorOffsetArray",Ti);class Ii extends Vn{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Ii.prototype.size=8;class ki extends pi{get(e){return new Ii(this,e)}}fn("FeatureIndexArray",ki);class Ai extends Wn{}class Pi extends Wn{}class Mi extends Wn{}class Ri extends Xn{}class Oi extends Qn{}class Li extends Jn{}class Di extends ei{}class Ni extends ti{}class zi extends ri{}class Fi extends ni{}class Bi extends oi{}class Ui extends si{}class ji extends li{}class qi extends fi{}const Hi=Kn([{name:"a_pos",components:2,type:"Int16"}],4).members;class Vi{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.segments=e}prepareSegment(e,t,r,n){let i=this.segments[this.segments.length-1];return e>Vi.MAX_VERTEX_ARRAY_LENGTH&&x(`Max vertices per segment is ${Vi.MAX_VERTEX_ARRAY_LENGTH}: bucket requested `+e),(!i||i.vertexLength+e>Vi.MAX_VERTEX_ARRAY_LENGTH||i.sortKey!==n)&&(i={vertexOffset:t.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0},void 0!==n&&(i.sortKey=n),this.segments.push(i)),i}get(){return this.segments}destroy(){for(const e of this.segments)for(const t in e.vaos)e.vaos[t].destroy()}static simpleSegment(e,t,r,n){return new Vi([{vertexOffset:e,primitiveOffset:t,vertexLength:r,primitiveLength:n,vaos:{},sortKey:0}])}}function Gi(e,t){return 256*(e=f(Math.floor(e),0,255))+f(Math.floor(t),0,255)}Vi.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,fn("SegmentVector",Vi);const Ki=Kn([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);Kt={exports:{}},Wt={exports:{},exports:function(e,t){for(var r,n,i=3&e.length,o=e.length-i,a=t,s=3432918353,l=461845907,c=0;c<o;)n=255&e.charCodeAt(c)|(255&e.charCodeAt(++c))<<8|(255&e.charCodeAt(++c))<<16|(255&e.charCodeAt(++c))<<24,++c,a=27492+(65535&(r=5*(65535&(a=(a^=n=(65535&(n=(n=(65535&n)*s+(((n>>>16)*s&65535)<<16)&4294967295)<<15|n>>>17))*l+(((n>>>16)*l&65535)<<16)&4294967295)<<13|a>>>19))+((5*(a>>>16)&65535)<<16)&4294967295))+((58964+(r>>>16)&65535)<<16);switch(n=0,i){case 3:n^=(255&e.charCodeAt(c+2))<<16;case 2:n^=(255&e.charCodeAt(c+1))<<8;case 1:a^=n=(65535&(n=(n=(65535&(n^=255&e.charCodeAt(c)))*s+(((n>>>16)*s&65535)<<16)&4294967295)<<15|n>>>17))*l+(((n>>>16)*l&65535)<<16)&4294967295}return a=2246822507*(65535&(a=(a^=e.length)^a>>>16))+((2246822507*(a>>>16)&65535)<<16)&4294967295,a=3266489909*(65535&(a^=a>>>13))+((3266489909*(a>>>16)&65535)<<16)&4294967295,(a^=a>>>16)>>>0}},Zt={exports:{},exports:function(e,t){for(var r,n=e.length,i=t^n,o=0;4<=n;)r=1540483477*(65535&(r=255&e.charCodeAt(o)|(255&e.charCodeAt(++o))<<8|(255&e.charCodeAt(++o))<<16|(255&e.charCodeAt(++o))<<24))+((1540483477*(r>>>16)&65535)<<16),i=1540483477*(65535&i)+((1540483477*(i>>>16)&65535)<<16)^1540483477*(65535&(r^=r>>>24))+((1540483477*(r>>>16)&65535)<<16),n-=4,++o;switch(n){case 3:i^=(255&e.charCodeAt(o+2))<<16;case 2:i^=(255&e.charCodeAt(o+1))<<8;case 1:i=1540483477*(65535&(i^=255&e.charCodeAt(o)))+((1540483477*(i>>>16)&65535)<<16)}return i=1540483477*(65535&(i^=i>>>13))+((1540483477*(i>>>16)&65535)<<16),(i^=i>>>15)>>>0}},Yt=Wt.exports,$t=Zt.exports,Kt.exports=Yt,Kt.exports.murmur3=Yt,Kt.exports.murmur2=$t;var Zi=r(Kt.exports);class Wi{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,t,r,n){this.ids.push($i(e)),this.positions.push(t,r,n)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");var t=$i(e);let r=0,n=this.ids.length-1;for(;r<n;){var i=r+n>>1;this.ids[i]>=t?n=i:r=1+i}for(var o=[];this.ids[r]===t;){var a=this.positions[3*r],s=this.positions[3*r+1],l=this.positions[3*r+2];o.push({index:a,start:s,end:l}),r++}return o}static serialize(e,t){var r=new Float64Array(e.ids);return Yi(r,e=new Uint32Array(e.positions),0,r.length-1),t&&t.push(r.buffer,e.buffer),{ids:r,positions:e}}static deserialize(e){var t=new Wi;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t}}function $i(e){var t=+e;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:Zi(String(e))}function Yi(e,t,r,n){for(;r<n;){var i=e[r+n>>1];let o=r-1,a=n+1;for(;;){for(;e[++o]<i;);for(;e[--a]>i;);if(o>=a)break;Xi(e,o,a),Xi(t,3*o,3*a),Xi(t,3*o+1,3*a+1),Xi(t,3*o+2,3*a+2)}a-r<n-a?(Yi(e,t,r,a),r=a+1):(Yi(e,t,a+1,n),n=a)}}function Xi(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}fn("FeaturePositionMap",Wi);class Qi{constructor(e,t){this.gl=e.gl,this.location=t}}class Ji extends Qi{constructor(e,t){super(e,t),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class eo extends Qi{constructor(e,t){super(e,t),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class to extends Qi{constructor(e,t){super(e,t),this.current=He.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const ro=new Float32Array(16);function no(e){return[Gi(255*e.r,255*e.g),Gi(255*e.b,255*e.a)]}class io{constructor(e,t,r){this.value=e,this.uniformNames=t.map((e=>"u_"+e)),this.type=r}setUniform(e,t,r){e.set(r.constantOr(this.value))}getBinding(e,t,r){return new("color"===this.type?to:Ji)(e,t)}}class oo{constructor(e,t){this.uniformNames=t.map((e=>"u_"+e)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr}setUniform(e,t,r,n){(n="u_pattern_to"===n?this.patternTo:"u_pattern_from"===n?this.patternFrom:"u_pixel_ratio_to"===n?this.pixelRatioTo:"u_pixel_ratio_from"===n?this.pixelRatioFrom:null)&&e.set(n)}getBinding(e,t,r){return new("u_pattern"===r.substr(0,9)?eo:Ji)(e,t)}}class ao{constructor(e,t,r,n){this.expression=e,this.type=r,this.maxValue=0,this.paintVertexAttributes=t.map((e=>({name:"a_"+e,type:"Float32",components:"color"===r?2:1,offset:0}))),this.paintVertexArray=new n}populatePaintArray(e,t,r,n,i){var o=this.paintVertexArray.length;t=this.expression.evaluate(new Tn(0),t,{},n,[],i);this.paintVertexArray.resize(e),this._setPaintValue(o,e,t)}updatePaintArray(e,t,r,n){r=this.expression.evaluate({zoom:0},r,n),this._setPaintValue(e,t,r)}_setPaintValue(e,t,r){if("color"===this.type){var n=no(r);for(let r=e;r<t;r++)this.paintVertexArray.emplace(r,n[0],n[1])}else{for(let n=e;n<t;n++)this.paintVertexArray.emplace(n,r);this.maxValue=Math.max(this.maxValue,Math.abs(r))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class so{constructor(e,t,r,n,i,o){this.expression=e,this.uniformNames=t.map((e=>`u_${e}_t`)),this.type=r,this.useIntegerZoom=n,this.zoom=i,this.maxValue=0,this.paintVertexAttributes=t.map((e=>({name:"a_"+e,type:"Float32",components:"color"===r?4:2,offset:0}))),this.paintVertexArray=new o}populatePaintArray(e,t,r,n,i){var o=this.expression.evaluate(new Tn(this.zoom),t,{},n,[],i);t=this.expression.evaluate(new Tn(this.zoom+1),t,{},n,[],i),n=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(n,e,o,t)}updatePaintArray(e,t,r,n){var i=this.expression.evaluate({zoom:this.zoom},r,n);r=this.expression.evaluate({zoom:this.zoom+1},r,n);this._setPaintValue(e,t,i,r)}_setPaintValue(e,t,r,n){if("color"===this.type){var i=no(r),o=no(n);for(let r=e;r<t;r++)this.paintVertexArray.emplace(r,i[0],i[1],o[0],o[1])}else{for(let i=e;i<t;i++)this.paintVertexArray.emplace(i,r,n);this.maxValue=Math.max(this.maxValue,Math.abs(r),Math.abs(n))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,t){t=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,t=f(this.expression.interpolationFactor(t,this.zoom,this.zoom+1),0,1),e.set(t)}getBinding(e,t,r){return new Ji(e,t)}}class lo{constructor(e,t,r,n,i,o){this.expression=e,this.type=t,this.useIntegerZoom=r,this.zoom=n,this.layerId=o,this.zoomInPaintVertexArray=new i,this.zoomOutPaintVertexArray=new i}populatePaintArray(e,t,r){var n=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(n,e,t.patterns&&t.patterns[this.layerId],r)}updatePaintArray(e,t,r,n,i){this._setPaintValues(e,t,r.patterns&&r.patterns[this.layerId],i)}_setPaintValues(e,t,r,n){if(n&&r){var{min:r,mid:i,max:o}=r,a=n[r],s=n[i],l=n[o];if(a&&s&&l)for(let r=e;r<t;r++)this.zoomInPaintVertexArray.emplace(r,s.tl[0],s.tl[1],s.br[0],s.br[1],a.tl[0],a.tl[1],a.br[0],a.br[1],s.pixelRatio,a.pixelRatio),this.zoomOutPaintVertexArray.emplace(r,s.tl[0],s.tl[1],s.br[0],s.br[1],l.tl[0],l.tl[1],l.br[0],l.br[1],s.pixelRatio,l.pixelRatio)}}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,Ki.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,Ki.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class co{constructor(e,t,r){this.binders={},this._buffers=[];var n,i,o,a,s,l,c=[];for(const u in e.paint._values)r(u)&&(l=e.paint.get(u))instanceof On&&ir(l.property.specification)&&(n=ho(u,e.type),i=l.value,o=l.property.specification.type,a=l.property.useIntegerZoom,l="cross-faded"===(l=l.property.specification["property-type"])||"cross-faded-data-driven"===l,"constant"===i.kind?(this.binders[u]=l?new oo(i.value,n):new io(i.value,n,o),c.push("/u_"+u)):"source"===i.kind||l?(s=po(u,o,"source"),this.binders[u]=l?new lo(i,o,a,t,s,e.id):new ao(i,n,o,s),c.push("/a_"+u)):(l=po(u,o,"composite"),this.binders[u]=new so(i,n,o,a,t,l),c.push("/z_"+u)));this.cacheKey=c.sort().join("")}getMaxValue(e){return(e=this.binders[e])instanceof ao||e instanceof so?e.maxValue:0}populatePaintArrays(e,t,r,n,i){for(const a in this.binders){var o=this.binders[a];(o instanceof ao||o instanceof so||o instanceof lo)&&o.populatePaintArray(e,t,r,n,i)}}setConstantPatternPositions(e,t){for(const n in this.binders){var r=this.binders[n];r instanceof oo&&r.setConstantPatternPositions(e,t)}}updatePaintArrays(e,t,r,n,i){let o=!1;for(const c in e)for(const u of t.getPositions(c)){var a=r.feature(u.index);for(const t in this.binders){var s,l=this.binders[t];(l instanceof ao||l instanceof so||l instanceof lo)&&!0===l.expression.isStateDependent&&(s=n.paint.get(t),l.expression=s.value,l.updatePaintArray(u.start,u.end,a,e[c],i),o=!0)}}return o}defines(){var e=[];for(const r in this.binders){var t=this.binders[r];(t instanceof io||t instanceof oo)&&e.push(...t.uniformNames.map((e=>"#define HAS_UNIFORM_"+e)))}return e}getBinderAttributes(){var e=[];for(const r in this.binders){var t=this.binders[r];if(t instanceof ao||t instanceof so)for(let r=0;r<t.paintVertexAttributes.length;r++)e.push(t.paintVertexAttributes[r].name);else if(t instanceof lo)for(let t=0;t<Ki.members.length;t++)e.push(Ki.members[t].name)}return e}getBinderUniforms(){var e=[];for(const r in this.binders){var t=this.binders[r];if(t instanceof io||t instanceof oo||t instanceof so)for(const r of t.uniformNames)e.push(r)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,t){var r=[];for(const o in this.binders){var n,i=this.binders[o];if(i instanceof io||i instanceof oo||i instanceof so)for(const a of i.uniformNames)t[a]&&(n=i.getBinding(e,t[a],a),r.push({name:a,property:o,binding:n}))}return r}setUniforms(e,t,r,n){for(var{name:i,property:o,binding:a}of t)this.binders[o].setUniform(a,n,r.get(o),i)}updatePaintBuffers(e){this._buffers=[];for(const n in this.binders){var t,r=this.binders[n];e&&r instanceof lo?(t=2===e.fromScale?r.zoomInPaintVertexBuffer:r.zoomOutPaintVertexBuffer)&&this._buffers.push(t):(r instanceof ao||r instanceof so)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}}upload(e){for(const r in this.binders){var t=this.binders[r];(t instanceof ao||t instanceof so||t instanceof lo)&&t.upload(e)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){var e=this.binders[t];(e instanceof ao||e instanceof so||e instanceof lo)&&e.destroy()}}}class uo{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>!0;this.programConfigurations={};for(const n of e)this.programConfigurations[n.id]=new co(n,t,r);this.needsUpload=!1,this._featureMap=new Wi,this._bufferOffset=0}populatePaintArrays(e,t,r,n,i,o){for(const a in this.programConfigurations)this.programConfigurations[a].populatePaintArrays(e,t,n,i,o);void 0!==t.id&&this._featureMap.add(t.id,r,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,t,r,n){for(const i of r)this.needsUpload=this.programConfigurations[i.id].updatePaintArrays(e,this._featureMap,t,i,n)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}function ho(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(t+"-","").replace(/-/g,"_")]}function po(e,t,r){var n={color:{source:Jn,composite:gi},number:{source:hi,composite:Jn}};return(e={"line-pattern":{source:Di,composite:Di},"fill-pattern":{source:Di,composite:Di},"fill-extrusion-pattern":{source:Di,composite:Di}}[e])&&e[r]||n[t][r]}fn("ConstantBinder",io),fn("CrossFadedConstantBinder",oo),fn("SourceExpressionBinder",ao),fn("CrossFadedCompositeBinder",lo),fn("CompositeExpressionBinder",so),fn("ProgramConfiguration",co,{omit:["_buffers"]}),fn("ProgramConfigurationSet",uo);const fo=8192,mo=Math.pow(2,14)-1,go=-mo-1;function yo(e){var t=fo/e.extent,r=e.loadGeometry();for(let s=0;s<r.length;s++){var n=r[s];for(let e=0;e<n.length;e++){var i=n[e],o=Math.round(i.x*t),a=Math.round(i.y*t);i.x=f(o,go,mo),i.y=f(a,go,mo),(o<i.x||o>i.x+1||a<i.y||a>i.y+1)&&x("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return r}function vo(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?yo(e):[]}}function _o(e,t,r,n,i){e.emplaceBack(2*t+(n+1)/2,2*r+(i+1)/2)}class bo{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Pi,this.indexArray=new ji,this.segments=new Vi,this.programConfigurations=new uo(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id))}populate(e,t,r){var n,i,o,a,s=this.layers[0],l=[];let c=null,u=!1;for({feature:n,id:i,index:o,sourceLayerIndex:a}of("circle"===s.type&&(c=s.layout.get("circle-sort-key"),u=!c.isConstant()),e)){var h,d=this.layers[0]._featureFilter.needGeometry,p=vo(n,d);this.layers[0]._featureFilter.filter(new Tn(this.zoom),p,r)&&(h=u?c.evaluate(p,{},r):void 0,d={id:i,properties:n.properties,type:n.type,sourceLayerIndex:a,index:o,geometry:d?p.geometry:yo(n),patterns:{},sortKey:h},l.push(d))}u&&l.sort(((e,t)=>e.sortKey-t.sortKey));for(const v of l){var{geometry:f,index:m,sourceLayerIndex:g}=v,y=e[m].feature;this.addFeature(v,f,m,r),t.featureIndex.insert(y,f,m,g,this.index)}}update(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Hi),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,t,r,n){for(const s of t)for(const t of s){var i=t.x,o=t.y;if(!(i<0||i>=fo||o<0||o>=fo)){var a=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey);const t=a.vertexLength;_o(this.layoutVertexArray,i,o,-1,-1),_o(this.layoutVertexArray,i,o,1,-1),_o(this.layoutVertexArray,i,o,1,1),_o(this.layoutVertexArray,i,o,-1,1),this.indexArray.emplaceBack(t,t+1,t+2),this.indexArray.emplaceBack(t,t+3,t+2),a.vertexLength+=4,a.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{},n)}}function wo(e,t){for(let r=0;r<e.length;r++)if(ko(t,e[r]))return!0;for(let r=0;r<t.length;r++)if(ko(e,t[r]))return!0;return!!So(e,t)}function xo(e,t,r){return ko(e,t)||!!Eo(t,e,r)}function Co(e,t){if(1===e.length)return Io(t,e[0]);for(let n=0;n<t.length;n++){var r=t[n];for(let t=0;t<r.length;t++)if(ko(e,r[t]))return!0}for(let n=0;n<e.length;n++)if(Io(t,e[n]))return!0;for(let n=0;n<t.length;n++)if(So(e,t[n]))return!0;return!1}function So(e,t){var r,n;if(0!==e.length&&0!==t.length)for(let l=0;l<e.length-1;l++){var i=e[l],o=e[l+1];for(let e=0;e<t.length-1;e++){var a=t[e],s=t[e+1];if(n=o,C(r=i,a,s)!==C(n,a,s)&&C(r,n,a)!==C(r,n,s))return 1}}}function Eo(e,t,r){var n=r*r;if(1===t.length)return e.distSqr(t[0])<n;for(let i=1;i<t.length;i++)if(To(e,t[i-1],t[i])<n)return 1}function To(e,t,r){var n=t.distSqr(r);return 0===n||(n=((e.x-t.x)*(r.x-t.x)+(e.y-t.y)*(r.y-t.y))/n)<0?e.distSqr(t):1<n?e.distSqr(r):e.distSqr(r.sub(t)._mult(n)._add(t))}function Io(e,t){let r,n,i,o=!1;for(let a=0;a<e.length;a++)for(let s=0,l=(r=e[a]).length-1;s<r.length;l=s++)n=r[s],i=r[l],n.y>t.y!=i.y>t.y&&t.x<(i.x-n.x)*(t.y-n.y)/(i.y-n.y)+n.x&&(o=!o);return o}function ko(e,t){let r=!1;for(let o=0,a=e.length-1;o<e.length;a=o++){var n=e[o],i=e[a];n.y>t.y!=i.y>t.y&&t.x<(i.x-n.x)*(t.y-n.y)/(i.y-n.y)+n.x&&(r=!r)}return r}function Ao(e,t,r){var n=t.paint.get(e).value;return"constant"===n.kind?n.value:r.programConfigurations.get(t.id).getMaxValue(e)}function Po(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function Mo(e,t,r,n,i){if(!t[0]&&!t[1])return e;var a=o.convert(t)._mult(i),s=("viewport"===r&&a._rotate(-n),[]);for(let o=0;o<e.length;o++){var l=e[o];s.push(l.sub(a))}return s}let Ro,Oo;fn("CircleBucket",bo,{omit:["layers"]});var Lo={get paint(){return Oo=Oo||new Un({"circle-radius":new Nn(G.paint_circle["circle-radius"]),"circle-color":new Nn(G.paint_circle["circle-color"]),"circle-blur":new Nn(G.paint_circle["circle-blur"]),"circle-opacity":new Nn(G.paint_circle["circle-opacity"]),"circle-translate":new Dn(G.paint_circle["circle-translate"]),"circle-translate-anchor":new Dn(G.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Dn(G.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Dn(G.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Nn(G.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Nn(G.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Nn(G.paint_circle["circle-stroke-opacity"])})},get layout(){return Ro=Ro||new Un({"circle-sort-key":new Nn(G.layout_circle["circle-sort-key"])})}},Do=1e-6,No="undefined"!=typeof Float32Array?Float32Array:Array;function zo(){var e=new No(9);return No!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function Fo(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Bo(e,t,r){var n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=t[9],p=t[10],f=t[11],m=t[12],g=t[13],y=t[14],v=(t=t[15],r[0]),_=r[1],b=r[2],w=r[3];return e[0]=v*n+_*s+b*h+w*m,e[1]=v*i+_*l+b*d+w*g,e[2]=v*o+_*c+b*p+w*y,e[3]=v*a+_*u+b*f+w*t,v=r[4],_=r[5],b=r[6],w=r[7],e[4]=v*n+_*s+b*h+w*m,e[5]=v*i+_*l+b*d+w*g,e[6]=v*o+_*c+b*p+w*y,e[7]=v*a+_*u+b*f+w*t,v=r[8],_=r[9],b=r[10],w=r[11],e[8]=v*n+_*s+b*h+w*m,e[9]=v*i+_*l+b*d+w*g,e[10]=v*o+_*c+b*p+w*y,e[11]=v*a+_*u+b*f+w*t,v=r[12],_=r[13],b=r[14],w=r[15],e[12]=v*n+_*s+b*h+w*m,e[13]=v*i+_*l+b*d+w*g,e[14]=v*o+_*c+b*p+w*y,e[15]=v*a+_*u+b*f+w*t,e}function Uo(){var e=new No(3);return No!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function jo(e,t,r){var n=new No(3);return n[0]=e,n[1]=t,n[2]=r,n}function qo(e,t,r){var n=t[0],i=t[1],o=t[2];t=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*o+r[12]*t,e[1]=r[1]*n+r[5]*i+r[9]*o+r[13]*t,e[2]=r[2]*n+r[6]*i+r[10]*o+r[14]*t,e[3]=r[3]*n+r[7]*i+r[11]*o+r[15]*t,e}function Ho(){var e=new No(4);return No!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)}),Wt=Bo,Uo(),Zt=new No(4),No!=Float32Array&&(Zt[0]=0,Zt[1]=0,Zt[2]=0,Zt[3]=0),Uo(),jo(1,0,0),jo(0,1,0),Ho(),Ho(),zo(),Yt=new No(2),No!=Float32Array&&(Yt[0]=0,Yt[1]=0);class Vo extends qn{constructor(e){super(e,Lo)}createBucket(e){return new bo(e)}queryRadius(e){return Ao("circle-radius",this,e)+Ao("circle-stroke-width",this,e)+Po(this.paint.get("circle-translate"))}queryIntersectsFeature(e,t,r,n,i,o,a,s){e=Mo(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),o.angle,a),t=this.paint.get("circle-radius").evaluate(t,r)+this.paint.get("circle-stroke-width").evaluate(t,r);var l="map"===this.paint.get("circle-pitch-alignment"),c=l?e:function(e,t){return e.map((e=>Go(e,t)))}(e,s),u=l?t*a:t;for(const p of n)for(const e of p){var h=l?e:Go(e,s);let t=u;var d=qo([],[e.x,e.y,0,1],s);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?t*=d[3]/o.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(t*=o.cameraToCenterDistance/d[3]),xo(c,h,t))return!0}return!1}}function Go(e,t){return e=qo([],[e.x,e.y,0,1],t),new o(e[0]/e[3],e[1]/e[3])}class Ko extends bo{}let Zo;fn("HeatmapBucket",Ko,{omit:["layers"]});var Wo={get paint(){return Zo=Zo||new Un({"heatmap-radius":new Nn(G.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Nn(G.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Dn(G.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Bn(G.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Dn(G.paint_heatmap["heatmap-opacity"])})}};function $o(e,t,r,n){let{width:i,height:o}=t;if(n){if(n instanceof Uint8ClampedArray)n=new Uint8Array(n.buffer);else if(n.length!==i*o*r)throw new RangeError(`mismatched image size. expected: ${n.length} but got: `+i*o*r)}else n=new Uint8Array(i*o*r);return e.width=i,e.height=o,e.data=n,e}function Yo(e,t,r){let{width:n,height:i}=t;var o;n===e.width&&i===e.height||(Xo(e,o=$o({},{width:n,height:i},r),{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,n),height:Math.min(e.height,i)},r),e.width=n,e.height=i,e.data=o.data)}function Xo(e,t,r,n,i,o){if(0!==i.width&&0!==i.height){if(i.width>e.width||i.height>e.height||r.x>e.width-i.width||r.y>e.height-i.height)throw new RangeError("out of range source coordinates for image copy");if(i.width>t.width||i.height>t.height||n.x>t.width-i.width||n.y>t.height-i.height)throw new RangeError("out of range destination coordinates for image copy");var a=e.data,s=t.data;if(a===s)throw new Error("srcData equals dstData, so image is already copied");for(let u=0;u<i.height;u++){var l=((r.y+u)*e.width+r.x)*o,c=((n.y+u)*t.width+n.x)*o;for(let e=0;e<i.width*o;e++)s[c+e]=a[l+e]}}}class Qo{constructor(e,t){$o(this,e,1,t)}resize(e){Yo(this,e,1)}clone(){return new Qo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,t,r,n,i){Xo(e,t,r,n,i,1)}}class Jo{constructor(e,t){$o(this,e,4,t)}resize(e){Yo(this,e,4)}replace(e,t){t?this.data.set(e):e instanceof Uint8ClampedArray?this.data=new Uint8Array(e.buffer):this.data=e}clone(){return new Jo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,t,r,n,i){Xo(e,t,r,n,i,4)}}function ea(e){const t={};var r=e.resolution||256,n=e.clips?e.clips.length:1;const i=e.image||new Jo({width:r,height:n});if(Math.log(r)/Math.LN2%1!=0)throw new Error("width is not a power of 2 - "+r);var o=(r,n,o)=>{t[e.evaluationKey]=o,o=e.expression.evaluate(t),i.data[r+n+0]=Math.floor(255*o.r/o.a),i.data[r+n+1]=Math.floor(255*o.g/o.a),i.data[r+n+2]=Math.floor(255*o.b/o.a),i.data[r+n+3]=Math.floor(255*o.a)};if(e.clips)for(let c=0,u=0;c<n;++c,u+=4*r)for(let t=0,n=0;t<r;t++,n+=4){var a=t/(r-1),{start:s,end:l}=e.clips[c];o(u,n,s*(1-a)+l*a)}else for(let c=0,u=0;c<r;c++,u+=4){o(0,u,c/(r-1))}return i}fn("AlphaImage",Qo),fn("RGBAImage",Jo);class ta extends qn{createBucket(e){return new Ko(e)}constructor(e){super(e,Wo),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){"heatmap-color"===e&&this._updateColorRamp()}_updateColorRamp(){var e=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=ea({expression:e,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}}let ra;var na={get paint(){return ra=ra||new Un({"hillshade-illumination-direction":new Dn(G.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Dn(G.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Dn(G.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Dn(G.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Dn(G.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Dn(G.paint_hillshade["hillshade-accent-color"])})}};class ia extends qn{constructor(e){super(e,na)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}}const oa=Kn([{name:"a_pos",components:2,type:"Int16"}],4).members;function aa(e,t,r){r=r||2;var n,i,o,a,s,l=t&&t.length,c=l?t[0]*r:e.length,u=sa(e,0,c,r,!0),h=[];if(u&&u.next!==u.prev){if(l&&(u=function(e,t,r,n){var i,o,a,s=[];for(i=0,o=t.length;i<o;i++)(a=sa(e,a=t[i]*n,i<o-1?t[i+1]*n:e.length,n,!1))===a.next&&(a.steiner=!0),s.push(function(e){for(var t=e,r=e;(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),(t=t.next)!==e;);return r}(a));for(s.sort(ua),i=0;i<s.length;i++)r=function(e,t){var r=function(e,t){var r,n=t,i=e.x,o=e.y,a=-1/0;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){var s=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=i&&a<s&&(a=s,r=n.x<n.next.x?n:n.next,s===i))return r}}while((n=n.next)!==t);if(!r)return null;var l,c=r,u=r.x,h=r.y,d=1/0;for(n=r;i>=n.x&&n.x>=u&&i!==n.x&&da(o<h?i:a,o,u,h,o<h?a:i,o,n.x,n.y)&&(l=Math.abs(o-n.y)/(i-n.x),va(n,e))&&(l<d||l===d&&(n.x>r.x||n.x===r.x&&function(e,t){return pa(e.prev,e,t.prev)<0&&pa(t.next,e,e.next)<0}(r,n)))&&(r=n,d=l),(n=n.next)!==c;);return r}(e,t);return r?(la(e=_a(r,e),e.next),la(r,r.next)):t}(s[i],r);return r}(e,t,u,r)),e.length>80*r){for(var d=n=e[0],p=i=e[1],f=r;f<c;f+=r)(o=e[f])<d&&(d=o),(a=e[f+1])<p&&(p=a),n<o&&(n=o),i<a&&(i=a);s=0!==(s=Math.max(n-d,i-p))?32767/s:0}ca(u,h,r,d,p,s,0)}return h}function sa(e,t,r,n,i){var o,a;if(i===0<Ca(e,t,r,n))for(o=t;o<r;o+=n)a=ba(o,e[o],e[o+1],a);else for(o=r-n;t<=o;o-=n)a=ba(o,e[o],e[o+1],a);return a&&fa(a,a.next)&&(wa(a),a=a.next),a}function la(e,t){if(!e)return e;t=t||e;var r,n=e;do{if(r=!1,n.steiner||!fa(n,n.next)&&0!==pa(n.prev,n,n.next))n=n.next;else{if(wa(n),(n=t=n.prev)===n.next)break;r=!0}}while(r||n!==t);return t}function ca(e,t,r,n,i,o,a){if(e){if(!a&&o){for(var s=e,l=n,c=i,u=o,h=s;0===h.z&&(h.z=ha(h.x,h.y,l,c,u)),h.prevZ=h.prev,h.nextZ=h.next,(h=h.next)!==s;);h.prevZ.nextZ=null,h.prevZ=null;var d,p,f,m,g,y,v,_,b=h,w=1;do{for(p=b,g=b=null,y=0;p;){for(y++,f=p,d=v=0;d<w&&(v++,f=f.nextZ);d++);for(_=w;0<v||0<_&&f;)0!==v&&(0===_||!f||p.z<=f.z)?(p=(m=p).nextZ,v--):(f=(m=f).nextZ,_--),g?g.nextZ=m:b=m,m.prevZ=g,g=m;p=f}}while(g.nextZ=null,w*=2,1<y)}for(var x,C,S=e;e.prev!==e.next;)if(x=e.prev,C=e.next,o?function(e,t,r,n){var i=e.prev,o=e,a=e.next;if(!(0<=pa(i,o,a))){for(var s=i.x,l=o.x,c=a.x,u=i.y,h=o.y,d=a.y,p=s<l?s<c?s:c:l<c?l:c,f=u<h?u<d?u:d:h<d?h:d,m=l<s?c<s?s:c:c<l?l:c,g=h<u?d<u?u:d:d<h?h:d,y=ha(p,f,t,r,n),v=ha(m,g,t,r,n),_=e.prevZ,b=e.nextZ;_&&_.z>=y&&b&&b.z<=v;){if(_.x>=p&&_.x<=m&&_.y>=f&&_.y<=g&&_!==i&&_!==a&&da(s,u,l,h,c,d,_.x,_.y)&&0<=pa(_.prev,_,_.next))return;if(_=_.prevZ,b.x>=p&&b.x<=m&&b.y>=f&&b.y<=g&&b!==i&&b!==a&&da(s,u,l,h,c,d,b.x,b.y)&&0<=pa(b.prev,b,b.next))return;b=b.nextZ}for(;_&&_.z>=y;){if(_.x>=p&&_.x<=m&&_.y>=f&&_.y<=g&&_!==i&&_!==a&&da(s,u,l,h,c,d,_.x,_.y)&&0<=pa(_.prev,_,_.next))return;_=_.prevZ}for(;b&&b.z<=v;){if(b.x>=p&&b.x<=m&&b.y>=f&&b.y<=g&&b!==i&&b!==a&&da(s,u,l,h,c,d,b.x,b.y)&&0<=pa(b.prev,b,b.next))return;b=b.nextZ}return 1}}(e,n,i,o):function(e){var t=e.prev,r=e;if(!(0<=pa(t,r,e=e.next))){for(var n=t.x,i=r.x,o=e.x,a=t.y,s=r.y,l=e.y,c=n<i?n<o?n:o:i<o?i:o,u=a<s?a<l?a:l:s<l?s:l,h=i<n?o<n?n:o:o<i?i:o,d=s<a?l<a?a:l:l<s?s:l,p=e.next;p!==t;){if(p.x>=c&&p.x<=h&&p.y>=u&&p.y<=d&&da(n,a,i,s,o,l,p.x,p.y)&&0<=pa(p.prev,p,p.next))return;p=p.next}return 1}}(e))t.push(x.i/r|0),t.push(e.i/r|0),t.push(C.i/r|0),wa(e),e=C.next,S=C.next;else if((e=C)===S){a?1===a?ca(e=function(e,t,r){var n=e;do{var i=n.prev,o=n.next.next}while(!fa(i,o)&&ma(i,n,n.next,o)&&va(i,o)&&va(o,i)&&(t.push(i.i/r|0),t.push(n.i/r|0),t.push(o.i/r|0),wa(n),wa(n.next),n=e=o),(n=n.next)!==e);return la(n)}(la(e),t,r),t,r,n,i,o,2):2===a&&function(e,t,r,n,i,o){var a=e;do{for(var s,l=a.next.next;l!==a.prev;){if(a.i!==l.i&&function(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&ma(r,r.next,e,t))return 1}while((r=r.next)!==e)}(e,t)&&(va(e,t)&&va(t,e)&&function(e,t){for(var r=e,n=!1,i=(e.x+t.x)/2,o=(e.y+t.y)/2;r.y>o!=r.next.y>o&&r.next.y!==r.y&&i<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(n=!n),(r=r.next)!==e;);return n}(e,t)&&(pa(e.prev,e,t.prev)||pa(e,t.prev,t))||fa(e,t)&&0<pa(e.prev,e,e.next)&&0<pa(t.prev,t,t.next))}(a,l))return s=_a(a,l),a=la(a,a.next),s=la(s,s.next),ca(a,t,r,n,i,o,0),ca(s,t,r,n,i,o,0);l=l.next}}while((a=a.next)!==e)}(e,t,r,n,i,o):ca(la(e),t,r,n,i,o,1);break}}}function ua(e,t){return e.x-t.x}function ha(e,t,r,n,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function da(e,t,r,n,i,o,a,s){return(e-a)*(o-s)<=(i-a)*(t-s)&&(r-a)*(t-s)<=(e-a)*(n-s)&&(i-a)*(n-s)<=(r-a)*(o-s)}function pa(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function fa(e,t){return e.x===t.x&&e.y===t.y}function ma(e,t,r,n){var i=ya(pa(e,t,r)),o=ya(pa(e,t,n)),a=ya(pa(r,n,e)),s=ya(pa(r,n,t));return i!==o&&a!==s||0===i&&ga(e,r,t)||0===o&&ga(e,n,t)||0===a&&ga(r,e,n)||!(0!==s||!ga(r,t,n))}function ga(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function ya(e){return 0<e?1:e<0?-1:0}function va(e,t){return pa(e.prev,e,e.next)<0?0<=pa(e,t,e.next)&&0<=pa(e,e.prev,t):pa(e,t,e.prev)<0||pa(e,e.next,t)<0}function _a(e,t){var r=new xa(e.i,e.x,e.y),n=new xa(t.i,t.x,t.y),i=e.next,o=t.prev;return(e.next=t).prev=e,(r.next=i).prev=r,(n.next=r).prev=n,(o.next=n).prev=o,n}function ba(e,t,r,n){return e=new xa(e,t,r),n?(e.next=n.next,(e.prev=n).next.prev=e,n.next=e):(e.prev=e).next=e,e}function wa(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function xa(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Ca(e,t,r,n){for(var i=0,o=t,a=r-n;o<r;o+=n)i+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return i}($t={exports:{}}).exports=aa,($t.exports.default=aa).deviation=function(e,t,r,n){var i=t&&t.length,o=i?t[0]*r:e.length,a=Math.abs(Ca(e,0,o,r));if(i)for(var s=0,l=t.length;s<l;s++){var c=t[s]*r,u=s<l-1?t[s+1]*r:e.length;a-=Math.abs(Ca(e,c,u,r))}var h=0;for(s=0;s<n.length;s+=3){var d=n[s]*r,p=n[s+1]*r,f=n[s+2]*r;h+=Math.abs((e[d]-e[f])*(e[1+p]-e[1+d])-(e[d]-e[p])*(e[1+f]-e[1+d]))}return 0===a&&0===h?0:Math.abs((h-a)/a)},aa.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},n=0,i=0;i<e.length;i++){for(var o=0;o<e[i].length;o++)for(var a=0;a<t;a++)r.vertices.push(e[i][o][a]);0<i&&(n+=e[i-1].length,r.holes.push(n))}return r};var Sa=r($t.exports);function Ea(e,t,r,n,i){!function e(t,r,n,i,o){for(;n<i;){600<i-n&&(a=i-n+1,c=r-n+1,l=Math.log(a),s=.5*Math.exp(2*l/3),l=.5*Math.sqrt(l*s*(a-s)/a)*(c-a/2<0?-1:1),e(t,r,Math.max(n,Math.floor(r-c*s/a+l)),c=Math.min(i,Math.floor(r+(a-c)*s/a+l)),o));var a,s,l,c,u=t[r],h=n,d=i;for(Ta(t,n,r),0<o(t[i],u)&&Ta(t,n,i);h<d;){for(Ta(t,h,d),h++,d--;o(t[h],u)<0;)h++;for(;0<o(t[d],u);)d--}0===o(t[n],u)?Ta(t,n,d):Ta(t,++d,i),d<=r&&(n=d+1),r<=d&&(i=d-1)}}(e,t,r||0,n||e.length-1,i||Ia)}function Ta(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function Ia(e,t){return e<t?-1:t<e?1:0}function ka(e,t){var r=e.length;if(r<=1)return[e];var n=[];let i,o;for(let s=0;s<r;s++){var a=function(e){let t=0;for(let r,n,i=0,o=e.length,a=o-1;i<o;a=i++)r=e[i],n=e[a],t+=(n.x-r.x)*(r.y+n.y);return t}(e[s]);0!==a&&(e[s].area=Math.abs(a),(o=void 0===o?a<0:o)===a<0?(i&&n.push(i),i=[e[s]]):i.push(e[s]))}if(i&&n.push(i),1<t)for(let s=0;s<n.length;s++)n[s].length<=t||(Ea(n[s],t,1,n[s].length-1,Aa),n[s]=n[s].slice(0,t));return n}function Aa(e,t){return t.area-e.area}function Pa(e,t,r){var n=r.patternDependencies;let i=!1;for(const a of t){var o;(o=((o=a.paint.get(e+"-pattern")).isConstant()||(i=!0),o.constantOr(null)))&&(i=!0,n[o.to]=!0,n[o.from]=!0)}return i}function Ma(e,t,r,n,i){var o=i.patternDependencies;for(const c of t){var a,s,l=c.paint.get(e+"-pattern").value;"constant"!==l.kind&&(a=l.evaluate({zoom:n-1},r,{},i.availableImages),s=l.evaluate({zoom:n},r,{},i.availableImages),l=l.evaluate({zoom:n+1},r,{},i.availableImages),a=a&&a.name?a.name:a,s=s&&s.name?s.name:s,l=l&&l.name?l.name:l,o[a]=!0,o[s]=!0,o[l]=!0,r.patterns[c.id]={min:a,mid:s,max:l})}return r}class Ra{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Mi,this.indexArray=new ji,this.indexArray2=new qi,this.programConfigurations=new uo(e.layers,e.zoom),this.segments=new Vi,this.segments2=new Vi,this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id))}populate(e,t,r){this.hasPattern=Pa("fill",this.layers,t);var n,i,o,a,s=this.layers[0].layout.get("fill-sort-key"),l=!s.isConstant(),c=[];for({feature:n,id:i,index:o,sourceLayerIndex:a}of e){var u,h=this.layers[0]._featureFilter.needGeometry,d=vo(n,h);this.layers[0]._featureFilter.filter(new Tn(this.zoom),d,r)&&(u=l?s.evaluate(d,{},r,t.availableImages):void 0,h={id:i,properties:n.properties,type:n.type,sourceLayerIndex:a,index:o,geometry:h?d.geometry:yo(n),patterns:{},sortKey:u},c.push(h))}l&&c.sort(((e,t)=>e.sortKey-t.sortKey));for(const y of c){var{geometry:p,index:f,sourceLayerIndex:m}=y,g=(this.hasPattern?(g=Ma("fill",this.layers,y,this.zoom,t),this.patternFeatures.push(g)):this.addFeature(y,p,f,r,{}),e[f].feature);t.featureIndex.insert(g,p,f,m,this.index)}}update(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)}addFeatures(e,t,r){for(const n of this.patternFeatures)this.addFeature(n,n.geometry,n.index,t,r)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,oa),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,t,r,n,i){for(const d of ka(t,500)){let e=0;for(const t of d)e+=t.length;var o=this.segments.prepareSegment(e,this.layoutVertexArray,this.indexArray),a=o.vertexLength,s=[],l=[];for(const t of d)if(0!==t.length){t!==d[0]&&l.push(s.length/2);var c=this.segments2.prepareSegment(t.length,this.layoutVertexArray,this.indexArray2),u=c.vertexLength;this.layoutVertexArray.emplaceBack(t[0].x,t[0].y),this.indexArray2.emplaceBack(u+t.length-1,u),s.push(t[0].x),s.push(t[0].y);for(let e=1;e<t.length;e++)this.layoutVertexArray.emplaceBack(t[e].x,t[e].y),this.indexArray2.emplaceBack(u+e-1,u+e),s.push(t[e].x),s.push(t[e].y);c.vertexLength+=t.length,c.primitiveLength+=t.length}var h=Sa(s,l);for(let t=0;t<h.length;t+=3)this.indexArray.emplaceBack(a+h[t],a+h[t+1],a+h[t+2]);o.vertexLength+=e,o.primitiveLength+=h.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,i,n)}}let Oa,La;fn("FillBucket",Ra,{omit:["layers","patternFeatures"]});var Da={get paint(){return La=La||new Un({"fill-antialias":new Dn(G.paint_fill["fill-antialias"]),"fill-opacity":new Nn(G.paint_fill["fill-opacity"]),"fill-color":new Nn(G.paint_fill["fill-color"]),"fill-outline-color":new Nn(G.paint_fill["fill-outline-color"]),"fill-translate":new Dn(G.paint_fill["fill-translate"]),"fill-translate-anchor":new Dn(G.paint_fill["fill-translate-anchor"]),"fill-pattern":new zn(G.paint_fill["fill-pattern"])})},get layout(){return Oa=Oa||new Un({"fill-sort-key":new Nn(G.layout_fill["fill-sort-key"])})}};class Na extends qn{constructor(e){super(e,Da)}recalculate(e,t){super.recalculate(e,t),"constant"===(e=this.paint._values["fill-outline-color"]).value.kind&&void 0===e.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new Ra(e)}queryRadius(){return Po(this.paint.get("fill-translate"))}queryIntersectsFeature(e,t,r,n,i,o,a){return Co(Mo(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),o.angle,a),n)}isTileClipped(){return!0}}Kt=Kn([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4);const za=Kn([{name:"a_centroid",components:2,type:"Int16"}],4),Fa=Kt.members;var Ba={},Ua=n;Zt=ja;function ja(e,t,r,n,i){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=n,this._values=i,e.readFields(qa,this,t)}function qa(e,t,r){if(1==e)t.id=r.readVarint();else if(2==e)for(var n=r,i=t,o=n.readVarint()+n.pos;n.pos<o;){var a=i._keys[n.readVarint()],s=i._values[n.readVarint()];i.properties[a]=s}else 3==e?t.type=r.readVarint():4==e&&(t._geometry=r.pos)}ja.types=["Unknown","Point","LineString","Polygon"],ja.prototype.loadGeometry=function(){for(var e,t,r=this._pbf,n=(r.pos=this._geometry,r.readVarint()+r.pos),i=1,o=0,a=0,s=0,l=[];r.pos<n;)if(o<=0&&(i=7&(t=r.readVarint()),o=t>>3),o--,1===i||2===i)a+=r.readSVarint(),s+=r.readSVarint(),1===i&&(e&&l.push(e),e=[]),e.push(new Ua(a,s));else{if(7!==i)throw new Error("unknown command "+i);e&&e.push(e[0].clone())}return e&&l.push(e),l},ja.prototype.bbox=function(){for(var e,t=this._pbf,r=(t.pos=this._geometry,t.readVarint()+t.pos),n=1,i=0,o=0,a=0,s=1/0,l=-1/0,c=1/0,u=-1/0;t.pos<r;)if(i<=0&&(n=7&(e=t.readVarint()),i=e>>3),i--,1===n||2===n)(o+=t.readSVarint())<s&&(s=o),l<o&&(l=o),(a+=t.readSVarint())<c&&(c=a),u<a&&(u=a);else if(7!==n)throw new Error("unknown command "+n);return[s,c,l,u]},ja.prototype.toGeoJSON=function(e,t,r){var n,i=this.extent*Math.pow(2,r),o=this.extent*e,a=this.extent*t,s=this.loadGeometry();r=ja.types[this.type];function l(e){for(var t=0;t<e.length;t++){var r=e[t],n=180-360*(r.y+a)/i;e[t]=[360*(r.x+o)/i-180,360/Math.PI*Math.atan(Math.exp(n*Math.PI/180))-90]}}switch(this.type){case 1:for(var c=[],u=0;u<s.length;u++)c[u]=s[u][0];l(s=c);break;case 2:for(u=0;u<s.length;u++)l(s[u]);break;case 3:for(s=function(e){var t=e.length;if(t<=1)return[e];for(var r,n,i=[],o=0;o<t;o++){var a=function(e){for(var t,r,n=0,i=0,o=e.length,a=o-1;i<o;a=i++)t=e[i],n+=((r=e[a]).x-t.x)*(t.y+r.y);return n}(e[o]);0!==a&&((n=void 0===n?a<0:n)===a<0?(r&&i.push(r),r=[e[o]]):r.push(e[o]))}return r&&i.push(r),i}(s),u=0;u<s.length;u++)for(n=0;n<s[u].length;n++)l(s[u][n])}return 1===s.length?s=s[0]:r="Multi"+r,e={type:"Feature",geometry:{type:r,coordinates:s},properties:this.properties},"id"in this&&(e.id=this.id),e};var Ha=Zt;Yt=Va;function Va(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Ga,this,t),this.length=this._features.length}function Ga(e,t,r){15===e?t.version=r.readVarint():1===e?t.name=r.readString():5===e?t.extent=r.readVarint():2===e?t._features.push(r.pos):3===e?t._keys.push(r.readString()):4===e&&t._values.push(function(e){for(var t=null,r=e.readVarint()+e.pos;e.pos<r;){var n=e.readVarint()>>3;t=1==n?e.readString():2==n?e.readFloat():3==n?e.readDouble():4==n?e.readVarint64():5==n?e.readVarint():6==n?e.readSVarint():7==n?e.readBoolean():null}return t}(r))}Va.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");return this._pbf.pos=this._features[e],e=this._pbf.readVarint()+this._pbf.pos,new Ha(this._pbf,e,this.extent,this._keys,this._values)};var Ka=Yt;function Za(e,t,r){3===e&&(e=new Ka(r,r.readVarint()+r.pos)).length&&(t[e.name]=e)}Ba.VectorTile=function(e,t){this.layers=e.readFields(Za,{},t)},Ba.VectorTileFeature=Zt,Ba.VectorTileLayer=Yt;const Wa=Ba.VectorTileFeature.types,$a=Math.pow(2,13);function Ya(e,t,r,n,i,o,a,s){e.emplaceBack(t,r,2*Math.floor(n*$a)+a,i*$a*2,o*$a*2,Math.round(s))}class Xa{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Ri,this.centroidVertexArray=new Ai,this.indexArray=new ji,this.programConfigurations=new uo(e.layers,e.zoom),this.segments=new Vi,this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id))}populate(e,t,r){for(var{feature:n,id:i,index:o,sourceLayerIndex:a}of(this.features=[],this.hasPattern=Pa("fill-extrusion",this.layers,t),e)){var s=this.layers[0]._featureFilter.needGeometry,l=vo(n,s);this.layers[0]._featureFilter.filter(new Tn(this.zoom),l,r)&&(i={id:i,sourceLayerIndex:a,index:o,geometry:s?l.geometry:yo(n),properties:n.properties,type:n.type,patterns:{}},this.hasPattern?this.features.push(Ma("fill-extrusion",this.layers,i,this.zoom,t)):this.addFeature(i,i.geometry,o,r,{}),t.featureIndex.insert(n,i.geometry,o,a,this.index,!0))}}addFeatures(e,t,r){for(const i of this.features){var n=i.geometry;this.addFeature(i,n,i.index,t,r)}}update(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.centroidVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Fa),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,za.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,t,r,n,i){var o={x:0,y:0,vertexCount:0};for(const m of ka(t,500)){let t=0;for(const e of m)t+=e.length;let r=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const e of m)if(0!==e.length&&!Ja(e)){let t=0;for(let n=0;n<e.length;n++){var a,s,l,c=e[n];1<=n&&(Qa(c,a=e[n-1])||(r.vertexLength+4>Vi.MAX_VERTEX_ARRAY_LENGTH&&(r=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)),s=c.sub(a)._perp()._unit(),32768<t+(l=a.dist(c))&&(t=0),Ya(this.layoutVertexArray,c.x,c.y,s.x,s.y,0,0,t),Ya(this.layoutVertexArray,c.x,c.y,s.x,s.y,0,1,t),o.x+=2*c.x,o.y+=2*c.y,o.vertexCount+=2,t+=l,Ya(this.layoutVertexArray,a.x,a.y,s.x,s.y,0,0,t),Ya(this.layoutVertexArray,a.x,a.y,s.x,s.y,0,1,t),o.x+=2*a.x,o.y+=2*a.y,o.vertexCount+=2,c=r.vertexLength,this.indexArray.emplaceBack(c,c+2,c+1),this.indexArray.emplaceBack(c+1,c+2,c+3),r.vertexLength+=4,r.primitiveLength+=2))}}if(r.vertexLength+t>Vi.MAX_VERTEX_ARRAY_LENGTH&&(r=this.segments.prepareSegment(t,this.layoutVertexArray,this.indexArray)),"Polygon"===Wa[e.type]){var u=[],h=[],d=r.vertexLength;for(const e of m)if(0!==e.length){e!==m[0]&&h.push(u.length/2);for(let t=0;t<e.length;t++){var p=e[t];Ya(this.layoutVertexArray,p.x,p.y,0,0,1,1,0),o.x+=p.x,o.y+=p.y,o.vertexCount+=1,u.push(p.x),u.push(p.y)}}var f=Sa(u,h);for(let e=0;e<f.length;e+=3)this.indexArray.emplaceBack(d+f[e],d+f[e+2],d+f[e+1]);r.primitiveLength+=f.length/3,r.vertexLength+=t}}for(let m=0;m<o.vertexCount;m++)this.centroidVertexArray.emplaceBack(Math.floor(o.x/o.vertexCount),Math.floor(o.y/o.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,i,n)}}function Qa(e,t){return e.x===t.x&&(e.x<0||e.x>fo)||e.y===t.y&&(e.y<0||e.y>fo)}function Ja(e){return e.every((e=>e.x<0))||e.every((e=>e.x>fo))||e.every((e=>e.y<0))||e.every((e=>e.y>fo))}let es;fn("FillExtrusionBucket",Xa,{omit:["layers","features"]});var ts={get paint(){return es=es||new Un({"fill-extrusion-opacity":new Dn(G["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Nn(G["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Dn(G["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Dn(G["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new zn(G["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Nn(G["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Nn(G["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Dn(G["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class rs extends qn{constructor(e){super(e,ts)}createBucket(e){return new Xa(e)}queryRadius(){return Po(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(e,t,r,n,i,a,s,l){return e=Mo(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),a.angle,s),s=this.paint.get("fill-extrusion-height").evaluate(t,r),t=this.paint.get("fill-extrusion-base").evaluate(t,r),r=function(e,t,r,n){var i=[];for(const s of e){var a=[s.x,s.y,n,1];qo(a,a,t),i.push(new o(a[0]/a[3],a[1]/a[3]))}return i}(e,l,0,0),e=function(e,t,r,n){var i=[],a=[],s=n[8]*t,l=n[9]*t,c=n[10]*t,u=n[11]*t,h=n[8]*r,d=n[9]*r,p=n[10]*r,f=n[11]*r;for(const E of e){var m=[],g=[];for(const e of E){var y=e.x,v=e.y,_=n[0]*y+n[4]*v+n[12],b=n[1]*y+n[5]*v+n[13],w=n[2]*y+n[6]*v+n[14],x=(y=n[3]*y+n[7]*v+n[15],v=w+c,y+u),C=_+h,S=b+d;w=w+p,y=y+f;(b=((_=new o((_+s)/x,(b+l)/x)).z=v/x,m.push(_),new o(C/y,S/y))).z=w/y,g.push(b)}i.push(m),a.push(g)}return[i,a]}(n,t,s,l),function(e,t,r){let n=1/0;Co(r,t)&&(n=is(r,t[0]));for(let c=0;c<t.length;c++){var i=t[c],o=e[c];for(let e=0;e<i.length-1;e++){var a=i[e],s=i[e+1],l=o[e];wo(r,s=[a,s,o[e+1],l,a])&&(n=Math.min(n,is(r,s)))}}return n!==1/0&&n}(e[0],e[1],r)}}function ns(e,t){return e.x*t.x+e.y*t.y}function is(e,t){if(1===e.length){let u=0;var r=t[u++];let h;for(;!h||r.equals(h);)if(!(h=t[u++]))return 1/0;for(;u<t.length;u++){var n=t[u],i=e[0],o=h.sub(r),a=n.sub(r),s=(i=i.sub(r),ns(o,o)),l=ns(o,a),c=((c=ns(a,a))*(o=ns(i,o))-l*(i=ns(i,a)))/(a=s*c-l*l);s=(s*i-l*o)/a,i=r.z*(1-c-s)+h.z*c+n.z*s;if(isFinite(i))return i}return 1/0}{let e=1/0;for(const r of t)e=Math.min(e,r.z);return e}}const os=Kn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,as=Kn([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,ss=Ba.VectorTileFeature.types,ls=Math.cos(Math.PI/180*37.5),cs=Math.pow(2,14)/.5;class us{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((e=>{this.gradients[e.id]={}})),this.layoutVertexArray=new Oi,this.layoutVertexArray2=new Li,this.indexArray=new ji,this.programConfigurations=new uo(e.layers,e.zoom),this.segments=new Vi,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id))}populate(e,t,r){this.hasPattern=Pa("line",this.layers,t);var n,i,o,a,s=this.layers[0].layout.get("line-sort-key"),l=!s.isConstant(),c=[];for({feature:n,id:i,index:o,sourceLayerIndex:a}of e){var u,h=this.layers[0]._featureFilter.needGeometry,d=vo(n,h);this.layers[0]._featureFilter.filter(new Tn(this.zoom),d,r)&&(u=l?s.evaluate(d,{},r):void 0,h={id:i,properties:n.properties,type:n.type,sourceLayerIndex:a,index:o,geometry:h?d.geometry:yo(n),patterns:{},sortKey:u},c.push(h))}l&&c.sort(((e,t)=>e.sortKey-t.sortKey));for(const y of c){var{geometry:p,index:f,sourceLayerIndex:m}=y,g=(this.hasPattern?(g=Ma("line",this.layers,y,this.zoom,t),this.patternFeatures.push(g)):this.addFeature(y,p,f,r,{}),e[f].feature);t.featureIndex.insert(g,p,f,m,this.index)}}update(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)}addFeatures(e,t,r){for(const n of this.patternFeatures)this.addFeature(n,n.geometry,n.index,t,r)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,as)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,os),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,t,r,n,i){var o=this.layers[0].layout,a=o.get("line-join").evaluate(e,{}),s=o.get("line-cap"),l=o.get("line-miter-limit"),c=o.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const u of t)this.addLine(u,e,a,s,l,c);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,i,n)}addLine(e,t,r,n,i,o){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let t=0;t<e.length-1;t++)this.totalDistance+=e[t].dist(e[t+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}var a="Polygon"===ss[t.type];let s=e.length;for(;2<=s&&e[s-1].equals(e[s-2]);)s--;let l=0;for(;l<s-1&&e[l].equals(e[l+1]);)l++;if(!(s<(a?3:2))){"bevel"===r&&(i=1.05);var c,u=this.overscaling<=16?15*fo/(512*this.overscaling):0,h=this.segments.prepareSegment(10*s,this.layoutVertexArray,this.indexArray);let t,x,C,S;this.e1=this.e2=-1,a&&(t=e[s-2],S=e[l].sub(t)._unit()._perp());for(let E=l;E<s;E++)if(!(c=E===s-1?a?e[l+1]:void 0:e[E+1])||!e[E].equals(c)){S&&(C=S),t&&(x=t),t=e[E],S=c?c.sub(t)._unit()._perp():C;let T=(C=C||S).add(S);0===T.x&&0===T.y||T._unit();var d=C.x*S.x+C.y*S.y,p=0!=(m=T.x*S.x+T.y*S.y)?1/m:1/0,f=2*Math.sqrt(2-2*m),m=m<ls&&x&&c,g=0<C.x*S.y-C.y*S.x,y=(m&&E>l&&2*u<(y=t.dist(x))&&(y=t.sub(t.sub(x)._mult(u/y)._round()),this.updateDistance(x,y),this.addCurrentVertex(y,C,0,0,h),x=y),x&&c);let I=y?r:a?"butt":n;if(y&&"round"===I&&(p<o?I="miter":p<=2&&(I="fakeround")),"bevel"===(I="miter"===I&&i<p?"bevel":I)&&(2<p&&(I="flipbevel"),p<i)&&(I="miter"),x&&this.updateDistance(x,t),"miter"===I)T._mult(p),this.addCurrentVertex(t,T,0,0,h);else if("flipbevel"===I)100<p?T=S.mult(-1):(v=p*C.add(S).mag()/C.sub(S).mag(),T._perp()._mult(v*(g?-1:1))),this.addCurrentVertex(t,T,0,0,h),this.addCurrentVertex(t,T.mult(-1),0,0,h);else if("bevel"===I||"fakeround"===I){var v=-Math.sqrt(p*p-1),_=(p=g?v:0,g?0:v);if(x&&this.addCurrentVertex(t,C,p,_,h),"fakeround"===I){var b=Math.round(180*f/Math.PI/20);for(let e=1;e<b;e++){let r=e/b;.5!==r&&(r+=r*(w=r-.5)*(r-1)*((1.0904+d*(d*(3.55645-1.43519*d)-3.2452))*w*w+(.848013+d*(.215638*d-1.06021))));var w=S.sub(C)._mult(r)._add(C)._unit()._mult(g?-1:1);this.addHalfVertex(t,w.x,w.y,!1,g,0,h)}}c&&this.addCurrentVertex(t,S,-p,-_,h)}else"butt"===I?this.addCurrentVertex(t,T,0,0,h):"square"===I?(f=x?1:-1,this.addCurrentVertex(t,T,f,f,h)):"round"===I&&(x&&(this.addCurrentVertex(t,C,0,0,h),this.addCurrentVertex(t,C,1,1,h,!0)),c)&&(this.addCurrentVertex(t,S,-1,-1,h,!0),this.addCurrentVertex(t,S,0,0,h));m&&E<s-1&&2*u<(p=t.dist(c))&&(_=t.add(c.sub(t)._mult(u/p)._round()),this.updateDistance(t,_),this.addCurrentVertex(_,S,0,0,h),t=_)}}}addCurrentVertex(e,t,r,n,i){let o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];var a=t.x+t.y*r,s=t.y-t.x*r,l=-t.x+t.y*n,c=-t.y-t.x*n;this.addHalfVertex(e,a,s,o,!1,r,i),this.addHalfVertex(e,l,c,o,!0,-n,i),this.distance>cs/2&&0===this.totalDistance&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(e,t,r,n,i,o))}addHalfVertex(e,t,r,n,i,o,a){var s=this;let{x:l,y:c}=e;return function(e){var c=.5*(s.lineClips?s.scaledDistance*(cs-1):s.scaledDistance);s.layoutVertexArray.emplaceBack((l<<1)+(n?1:0),(e<<1)+(i?1:0),Math.round(63*t)+128,Math.round(63*r)+128,1+(0===o?0:o<0?-1:1)|(63&c)<<2,c>>6),s.lineClips&&(l=s.scaledDistance-s.lineClips.start,n=s.lineClips.end-s.lineClips.start,s.layoutVertexArray2.emplaceBack(l/n,s.lineClipsArray.length)),e=a.vertexLength++;0<=s.e1&&0<=s.e2&&(s.indexArray.emplaceBack(s.e1,s.e2,e),a.primitiveLength++),i?s.e2=e:s.e1=e}(c)}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,t){this.distance+=e.dist(t),this.updateScaledDistance()}}let hs,ds;fn("LineBucket",us,{omit:["layers","patternFeatures"]});var ps={get paint(){return ds=ds||new Un({"line-opacity":new Nn(G.paint_line["line-opacity"]),"line-color":new Nn(G.paint_line["line-color"]),"line-translate":new Dn(G.paint_line["line-translate"]),"line-translate-anchor":new Dn(G.paint_line["line-translate-anchor"]),"line-width":new Nn(G.paint_line["line-width"]),"line-gap-width":new Nn(G.paint_line["line-gap-width"]),"line-offset":new Nn(G.paint_line["line-offset"]),"line-blur":new Nn(G.paint_line["line-blur"]),"line-dasharray":new Fn(G.paint_line["line-dasharray"]),"line-pattern":new zn(G.paint_line["line-pattern"]),"line-gradient":new Bn(G.paint_line["line-gradient"])})},get layout(){return hs=hs||new Un({"line-cap":new Dn(G.layout_line["line-cap"]),"line-join":new Nn(G.layout_line["line-join"]),"line-miter-limit":new Dn(G.layout_line["line-miter-limit"]),"line-round-limit":new Dn(G.layout_line["line-round-limit"]),"line-sort-key":new Nn(G.layout_line["line-sort-key"])})}};class fs extends Nn{possiblyEvaluate(e,t){return t=new Tn(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,zoomHistory:t.zoomHistory,transition:t.transition}),super.possiblyEvaluate(e,t)}evaluate(e,t,r,n){return t=g({},t,{zoom:Math.floor(t.zoom)}),super.evaluate(e,t,r,n)}}let ms;class gs extends qn{constructor(e){super(e,ps),this.gradientVersion=0,ms||((ms=new fs(ps.paint.properties["line-width"].specification)).useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(e){"line-gradient"===e&&(function(e){return void 0!==e._styleExpression}(e=this.gradientExpression())?this.stepInterpolant=e._styleExpression.expression instanceof Rt:this.stepInterpolant=!1,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(e,t){super.recalculate(e,t),this.paint._values["line-floorwidth"]=ms.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new us(e)}queryRadius(e){var t=ys(Ao("line-width",this,e),Ao("line-gap-width",this,e));e=Ao("line-offset",this,e);return t/2+Math.abs(e)+Po(this.paint.get("line-translate"))}queryIntersectsFeature(e,t,r,n,i,a,s){return e=Mo(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),a.angle,s),a=s/2*ys(this.paint.get("line-width").evaluate(t,r),this.paint.get("line-gap-width").evaluate(t,r)),function(e,t,r){for(let i=0;i<t.length;i++){var n=t[i];if(3<=e.length)for(let t=0;t<n.length;t++)if(ko(e,n[t]))return!0;if(function(e,t,r){if(1<e.length){if(So(e,t))return 1;for(let n=0;n<t.length;n++)if(Eo(t[n],e,r))return 1}for(let n=0;n<e.length;n++)if(Eo(e[n],t,r))return 1}(e,n,r))return!0}return!1}(e,n=(t=this.paint.get("line-offset").evaluate(t,r))?function(e,t){var r=[];for(let c=0;c<e.length;c++){var n=e[c],i=[];for(let e=0;e<n.length;e++){var a=n[e-1],s=n[e],l=n[e+1];a=0===e?new o(0,0):s.sub(a)._unit()._perp(),l=e===n.length-1?new o(0,0):l.sub(s)._unit()._perp(),0!=(l=(a=a._add(l)._unit()).x*l.x+a.y*l.y)&&a._mult(1/l),i.push(a._mult(t)._add(s))}r.push(i)}return r}(n,t*s):n,a)}isTileClipped(){return!0}}function ys(e,t){return 0<t?t+2*e:e}const vs=Kn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),_s=Kn([{name:"a_projected_pos",components:3,type:"Float32"}],4),bs=(Kn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Kn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),ws=(Kn([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Kn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4));function xs(e,t,r){return e.sections.forEach((e=>{var n,i;e.text=(e=e.text,i=r,"uppercase"===(n=(n=t).layout.get("text-transform").evaluate(i,{}))?e=e.toLocaleUpperCase():"lowercase"===n&&(e=e.toLocaleLowerCase()),e=En.applyArabicShaping?En.applyArabicShaping(e):e)})),e}$t=Kn([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4),Kn([{name:"triangle",components:3,type:"Uint16"}]),Kn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Kn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Kn([{type:"Float32",name:"offsetX"}]),Kn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Kn([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Cs={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"};var Ss=24,Es=(Kt={read:function(e,t,r,n,i){var o,a,s=8*i-n-1,l=(1<<s)-1,c=l>>1,u=-7,h=r?i-1:0,d=r?-1:1;i=e[t+h];for(h+=d,o=i&(1<<-u)-1,i>>=-u,u+=s;0<u;o=256*o+e[t+h],h+=d,u-=8);for(a=o&(1<<-u)-1,o>>=-u,u+=n;0<u;a=256*a+e[t+h],h+=d,u-=8);if(0===o)o=1-c;else{if(o===l)return a?NaN:1/0*(i?-1:1);a+=Math.pow(2,n),o-=c}return(i?-1:1)*a*Math.pow(2,o-n)},write:function(e,t,r,n,i,o){var a,s,l=8*o-i-1,c=(1<<l)-1,u=c>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:o-1,p=n?1:-1;o=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=c):(a=Math.floor(Math.log(t)/Math.LN2),t*(n=Math.pow(2,-a))<1&&(a--,n*=2),2<=(t+=1<=a+u?h/n:h*Math.pow(2,1-u))*n&&(a++,n/=2),c<=a+u?(s=0,a=c):1<=a+u?(s=(t*n-1)*Math.pow(2,i),a+=u):(s=t*Math.pow(2,u-1)*Math.pow(2,i),a=0));8<=i;e[r+d]=255&s,d+=p,s/=256,i-=8);for(a=a<<i|s,l+=i;0<l;e[r+d]=255&a,d+=p,a/=256,l-=8);e[r+d-p]|=128*o}},Zt=Ts,Kt);function Ts(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}Ts.Varint=0,Ts.Fixed64=1,Ts.Bytes=2,Ts.Fixed32=5;var Is=4294967296,ks=1/Is,As="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function Ps(e){return e.type===Ts.Bytes?e.readVarint()+e.pos:e.pos+1}function Ms(e,t,r){return r?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function Rs(e,t,r){var n=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(n);for(var i=r.pos-1;e<=i;i--)r.buf[i+n]=r.buf[i]}function Os(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function Ls(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function Ds(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function Ns(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function zs(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function Fs(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function Bs(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function Us(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function js(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function qs(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function Hs(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function Vs(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}Ts.prototype={destroy:function(){this.buf=null},readFields:function(e,t,r){for(r=r||this.length;this.pos<r;){var n=this.readVarint(),i=n>>3,o=this.pos;this.type=7&n,e(i,t,this),this.pos===o&&this.skip(n)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=qs(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=Vs(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=qs(this.buf,this.pos)+qs(this.buf,this.pos+4)*Is;return this.pos+=8,e},readSFixed64:function(){var e=qs(this.buf,this.pos)+Vs(this.buf,this.pos+4)*Is;return this.pos+=8,e},readFloat:function(){var e=Es.read(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=Es.read(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t=127&(i=(o=this.buf)[this.pos++]);if(i<128)return t;if(t|=(127&(i=o[this.pos++]))<<7,i<128)return t;if(t|=(127&(i=o[this.pos++]))<<14,i<128)return t;if(t|=(127&(i=o[this.pos++]))<<21,i<128)return t;var r,n,i=t|=(15&o[this.pos])<<28,o=e;if(r=(112&(n=(e=(t=this).buf)[t.pos++]))>>4,n<128)return Ms(i,r,o);if(r|=(127&(n=e[t.pos++]))<<3,n<128)return Ms(i,r,o);if(r|=(127&(n=e[t.pos++]))<<10,n<128)return Ms(i,r,o);if(r|=(127&(n=e[t.pos++]))<<17,n<128)return Ms(i,r,o);if(r|=(127&(n=e[t.pos++]))<<24,n<128)return Ms(i,r,o);if(r|=(1&(n=e[t.pos++]))<<31,n<128)return Ms(i,r,o);throw new Error("Expected varint not more than 10 bytes")},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;if(12<=(this.pos=e)-t&&As)return r=this.buf,As.decode(r.subarray(t,e));for(var r,n,i,o,a=this.buf,s=e,l="",c=t;c<s;){var u=a[c],h=null,d=239<u?4:223<u?3:191<u?2:1;if(s<c+d)break;1===d?u<128&&(h=u):2===d?128==(192&(n=a[c+1]))&&(h=(31&u)<<6|63&n)<=127&&(h=null):3===d?(n=a[c+1],i=a[c+2],128==(192&n)&&128==(192&i)&&((h=(15&u)<<12|(63&n)<<6|63&i)<=2047||55296<=h&&h<=57343)&&(h=null)):4===d&&(n=a[c+1],i=a[c+2],o=a[c+3],128==(192&n))&&128==(192&i)&&128==(192&o)&&((h=(15&u)<<18|(63&n)<<12|(63&i)<<6|63&o)<=65535||1114112<=h)&&(h=null),null===h?(h=65533,d=1):65535<h&&(h-=65536,l+=String.fromCharCode(h>>>10&1023|55296),h=56320|1023&h),l+=String.fromCharCode(h),c+=d}return l},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==Ts.Bytes)return e.push(this.readVarint(t));var r=Ps(this);for(e=e||[];this.pos<r;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==Ts.Bytes)return e.push(this.readSVarint());var t=Ps(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==Ts.Bytes)return e.push(this.readBoolean());var t=Ps(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==Ts.Bytes)return e.push(this.readFloat());var t=Ps(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==Ts.Bytes)return e.push(this.readDouble());var t=Ps(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==Ts.Bytes)return e.push(this.readFixed32());var t=Ps(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==Ts.Bytes)return e.push(this.readSFixed32());var t=Ps(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==Ts.Bytes)return e.push(this.readFixed64());var t=Ps(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==Ts.Bytes)return e.push(this.readSFixed64());var t=Ps(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){if((e&=7)===Ts.Varint)for(;127<this.buf[this.pos++];);else if(e===Ts.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Ts.Fixed32)this.pos+=4;else{if(e!==Ts.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t,r=this.length||16;r<this.pos+e;)r*=2;r!==this.length&&((t=new Uint8Array(r)).set(this.buf),this.buf=t,this.length=r)},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),Hs(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),Hs(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),Hs(this.buf,-1&e,this.pos),Hs(this.buf,Math.floor(e*ks),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),Hs(this.buf,-1&e,this.pos),Hs(this.buf,Math.floor(e*ks),this.pos+4),this.pos+=8},writeVarint:function(e){if(268435455<(e=+e||0)||e<0){var t=this;if(0<=(r=e)?(n=r%4294967296|0,i=r/4294967296|0):(i=~(-r/4294967296),4294967295^(n=~(-r%4294967296))?n=n+1|0:i=i+1|(n=0)),0x10000000000000000<=r||r<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10);var r=n,n=t,i=(r=(n.buf[n.pos++]=127&r|128,r>>>=7,n.buf[n.pos++]=127&r|128,r>>>=7,n.buf[n.pos++]=127&r|128,r>>>=7,n.buf[n.pos++]=127&r|128,r>>>=7,n.buf[n.pos]=127&r,i),t);t=(7&r)<<4;i.buf[i.pos++]|=t|((r>>>=3)?128:0),r&&(i.buf[i.pos++]=127&r|((r>>>=7)?128:0),r)&&(i.buf[i.pos++]=127&r|((r>>>=7)?128:0),r)&&(i.buf[i.pos++]=127&r|((r>>>=7)?128:0),r)&&(i.buf[i.pos++]=127&r|((r>>>=7)?128:0),r)&&(i.buf[i.pos++]=127&r)}else this.realloc(4),this.buf[this.pos++]=127&e|(127<e?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(127<e?128:0),e<=127)||(this.buf[this.pos++]=127&(e>>>=7)|(127<e?128:0),e<=127)||(this.buf[this.pos++]=e>>>7&127)},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(e,t,r){for(var n,i,o=0;o<t.length;o++){if(55295<(n=t.charCodeAt(o))&&n<57344){if(!i){56319<n||o+1===t.length?(e[r++]=239,e[r++]=191,e[r++]=189):i=n;continue}if(n<56320){e[r++]=239,e[r++]=191,e[r++]=189,i=n;continue}n=i-55296<<10|n-56320|65536,i=null}else i&&(e[r++]=239,e[r++]=191,e[r++]=189,i=null);n<128?e[r++]=n:(n<2048?e[r++]=n>>6|192:(n<65536?e[r++]=n>>12|224:(e[r++]=n>>18|240,e[r++]=n>>12&63|128),e[r++]=n>>6&63|128),e[r++]=63&n|128)}return r}(this.buf,e,this.pos),e=this.pos-t;128<=e&&Rs(t,e,this),this.pos=t-1,this.writeVarint(e),this.pos+=e},writeFloat:function(e){this.realloc(4),Es.write(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),Es.write(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var r=0;r<t;r++)this.buf[this.pos++]=e[r]},writeRawMessage:function(e,t){this.pos++;var r=this.pos;128<=(e=(e(t,this),this.pos-r))&&Rs(r,e,this),this.pos=r-1,this.writeVarint(e),this.pos+=e},writeMessage:function(e,t,r){this.writeTag(e,Ts.Bytes),this.writeRawMessage(t,r)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,Os,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,Ls,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,zs,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,Ds,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,Ns,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,Fs,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,Bs,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,Us,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,js,t)},writeBytesField:function(e,t){this.writeTag(e,Ts.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,Ts.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,Ts.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,Ts.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,Ts.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,Ts.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,Ts.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,Ts.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,Ts.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,Ts.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}};var Gs,Ks=r(Zt);function Zs(e,t,r){1===e&&r.readMessage(Ws,t)}function Ws(e,t,r){var n,i,o,a,s;3===e&&(({id:e,bitmap:r,width:n,height:i,left:o,top:a,advance:s}=r.readMessage($s,{})),t.push({id:e,bitmap:new Qo({width:n+6,height:i+6},r),metrics:{width:n,height:i,left:o,top:a,advance:s}}))}function $s(e,t,r){1===e?t.id=r.readVarint():2===e?t.bitmap=r.readBytes():3===e?t.width=r.readVarint():4===e?t.height=r.readVarint():5===e?t.left=r.readSVarint():6===e?t.top=r.readSVarint():7===e&&(t.advance=r.readVarint())}function Ys(e){let t=0,r=0;for(const l of e)t+=l.w*l.h,r=Math.max(r,l.w);e.sort(((e,t)=>t.h-e.h));var n=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}];let i=0,o=0;for(const l of e)for(let e=n.length-1;0<=e;e--){var a,s=n[e];if(!(l.w>s.w||l.h>s.h)){l.x=s.x,l.y=s.y,o=Math.max(o,l.y+l.h),i=Math.max(i,l.x+l.w),l.w===s.w&&l.h===s.h?(a=n.pop(),e<n.length&&(n[e]=a)):l.h===s.h?(s.x+=l.w,s.w-=l.w):(l.w!==s.w&&n.push({x:s.x+l.w,y:s.y,w:s.w-l.w,h:l.h}),s.y+=l.h,s.h-=l.h);break}}return{w:i,h:o,fill:t/(i*o)||0}}(Yt=Gs=Gs||{}).none="none",Yt.height="height",Yt.width="width";class Xs{constructor(e,t){let{pixelRatio:r,version:n,stretchX:i,stretchY:o,content:a,contentMatch:s}=t;this.paddedRect=e,this.pixelRatio=r,this.stretchX=i,this.stretchY=o,this.content=a,this.version=n,this.contentMatch=s}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Qs{constructor(e,t){var r={},n={},i=(this.haveRenderCallbacks=[],[]);this.addImages(e,r,i),this.addImages(t,n,i);const{w:o,h:a}=Ys(i);var s=new Jo({width:o||1,height:a||1});for(const d in e){var l=e[d],c=r[d].paddedRect;Jo.copy(l.data,s,{x:0,y:0},{x:c.x+1,y:c.y+1},l.data)}for(const d in t){var u=t[d],h=n[d].paddedRect;const e=h.x+1,r=h.y+1,i=u.data.width,o=u.data.height;Jo.copy(u.data,s,{x:0,y:0},{x:e,y:r},u.data),Jo.copy(u.data,s,{x:0,y:o-1},{x:e,y:r-1},{width:i,height:1}),Jo.copy(u.data,s,{x:0,y:0},{x:e,y:r+o},{width:i,height:1}),Jo.copy(u.data,s,{x:i-1,y:0},{x:e-1,y:r},{width:1,height:o}),Jo.copy(u.data,s,{x:0,y:0},{x:e+i,y:r},{width:1,height:o})}this.image=s,this.iconPositions=r,this.patternPositions=n}addImages(e,t,r){for(const o in e){var n=e[o],i={x:0,y:0,w:n.data.width+2,h:n.data.height+2};r.push(i),t[o]=new Xs(i,n),n.hasRenderCallback&&this.haveRenderCallbacks.push(o)}}patchUpdatedImages(e,t){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const r in e.updatedImages)this.patchUpdatedImage(this.iconPositions[r],e.getImage(r),t),this.patchUpdatedImage(this.patternPositions[r],e.getImage(r),t)}patchUpdatedImage(e,t,r){var n;e&&t&&e.version!==t.version&&(e.version=t.version,[e,n]=e.tl,r.update(t.data,void 0,{x:e,y:n}))}}fn("ImagePosition",Xs),fn("ImageAtlas",Qs),e.WritingMode=void 0,(Kt=e.WritingMode||(e.WritingMode={}))[Kt.none=0]="none",Kt[Kt.horizontal=1]="horizontal",Kt[Kt.vertical=2]="vertical",Kt[Kt.horizontalOnly=3]="horizontalOnly";const Js=-17;class el{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,t){var r=new el;return r.scale=e||1,r.fontStack=t,r}static forImage(e){var t=new el;return t.imageName=e,t}}class tl{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,t){var r=new tl;for(let i=0;i<e.sections.length;i++){var n=e.sections[i];n.image?r.addImageSection(n):r.addTextSection(n,t)}return r}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(){this.text=function(e){let t="";for(let i=0;i<e.length;i++){var r=e.charCodeAt(i+1)||null,n=e.charCodeAt(i-1)||null;r&&Cn(r)&&!Cs[e[i+1]]||n&&Cn(n)&&!Cs[e[i-1]]||!Cs[e[i]]?t+=e[i]:t+=Cs[e[i]]}return t}(this.text)}trim(){let e=0;for(let r=0;r<this.text.length&&nl[this.text.charCodeAt(r)];r++)e++;let t=this.text.length;for(let r=this.text.length-1;0<=r&&r>=e&&nl[this.text.charCodeAt(r)];r--)t--;this.text=this.text.substring(e,t),this.sectionIndex=this.sectionIndex.slice(e,t)}substring(e,t){var r=new tl;return r.text=this.text.substring(e,t),r.sectionIndex=this.sectionIndex.slice(e,t),r.sections=this.sections,r}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((e,t)=>Math.max(e,this.sections[t].scale)),0)}addTextSection(e,t){this.text+=e.text,this.sections.push(el.forText(e.scale,e.fontStack||t));var r=this.sections.length-1;for(let n=0;n<e.text.length;++n)this.sectionIndex.push(r)}addImageSection(e){var t;0===(e=e.image?e.image.name:"").length?x("Can't add FormattedSection with an empty image."):(t=this.getNextImageSectionCharCode())?(this.text+=String.fromCharCode(t),this.sections.push(el.forImage(e)),this.sectionIndex.push(this.sections.length-1)):x("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?63743<=this.imageSectionID?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function rl(t,r,n,i,o,a,s,l,c,u,h,d,p,f,m,g){var y=tl.fromFeature(t,o);let v;d===e.WritingMode.vertical&&y.verticalizePunctuation();var{processBidirectionalText:t,processStyledBidirectionalText:o}=En;if(t&&1===y.sections.length){v=[];for(const e of t(y.toString(),ll(y,u,a,r,i,f,m))){var _=new tl;_.text=e,_.sections=y.sections;for(let t=0;t<e.length;t++)_.sectionIndex.push(0);v.push(_)}}else if(o){v=[];for(const e of o(y.text,y.sectionIndex,ll(y,u,a,r,i,f,m))){var b=new tl;b.text=e[0],b.sectionIndex=e[1],b.sections=y.sections,v.push(b)}}else v=function(e,t){var r=[],n=e.text;let i=0;for(const o of t)r.push(e.substring(i,o)),i=o;return i<n.length&&r.push(e.substring(i,n.length)),r}(y,ll(y,u,a,r,i,f,m));o={positionedLines:t=[],text:y.toString(),top:h[1],bottom:h[1],left:h[0],right:h[0],writingMode:d,iconsInText:!1,verticalizable:!1};{var w=o,x=r,C=n,S=i,E=(a=v,s),T=(f=l,m=c,d),I=u,k=p,A=g;let t=0,y=Js,_=0,b=0;var P="right"===m?1:"left"===m?0:.5;let J=0;for(const r of a){r.trim();var M=r.getMaxScale(),R=(M-1)*Ss,O={positionedGlyphs:[],lineOffset:0},L=(w.positionedLines[J]=O).positionedGlyphs;let n=0;if(r.length()){for(let i=0;i<r.length();i++){var D=r.getSection(i),N=r.getSectionIndex(i),z=r.getCharCode(i);let o=0,a=null,s=null,l=null,c=Ss;var F=!(T===e.WritingMode.horizontal||!k&&!xn(z)||k&&(nl[z]||function(e){return _n.Arabic(e)||_n["Arabic Supplement"](e)||_n["Arabic Extended-A"](e)||_n["Arabic Presentation Forms-A"](e)||_n["Arabic Presentation Forms-B"](e)}(z)));if(D.imageName){if(!(U=S[D.imageName]))continue;l=D.imageName,w.iconsInText=w.iconsInText||!0,s=U.paddedRect;var B,U=U.displaySize;0<(B=(o=R+(B=(D.scale=D.scale*Ss/A,a={width:U[0],height:U[1],left:1,top:-3,advance:F?U[1]:U[0]},Ss-U[1]*D.scale)),c=a.advance,F?U[0]*D.scale-Ss*M:U[1]*D.scale-Ss*M))&&B>n&&(n=B)}else{if((B=(U=C[D.fontStack])&&U[z])&&B.rect)s=B.rect,a=B.metrics;else{var j;if(!(j=(j=x[D.fontStack])&&j[z]))continue;a=j.metrics}o=(M-D.scale)*Ss}F?(w.verticalizable=!0,L.push({glyph:z,imageName:l,x:t,y:y+o,vertical:F,scale:D.scale,fontStack:D.fontStack,sectionIndex:N,metrics:a,rect:s}),t+=c*D.scale+I):(L.push({glyph:z,imageName:l,x:t,y:y+o,vertical:F,scale:D.scale,fontStack:D.fontStack,sectionIndex:N,metrics:a,rect:s}),t+=a.advance*D.scale+I)}0!==L.length&&(q=t-I,_=Math.max(q,_),function(e,t,r,n,i){if(n||i){var o=(o=e[r]).metrics.advance*o.scale,a=(e[r].x+o)*n;for(let t=0;t<=r;t++)e[t].x-=a,e[t].y+=i}}(L,0,L.length-1,P,n)),t=0;var q=E*M+n;O.lineOffset=Math.max(n,R),y+=q,b=Math.max(q,b)}else y+=E;++J}m=y-Js;var{horizontalAlign:f,verticalAlign:h}=cl(f);{var H=w.positionedLines,V=P,G=f,K=h,Z=_,W=b,$=E,Y=m,X=a.length,Q=(V-G)*Z;let e=0;e=W!==$?-Y*K-Js:(-K*X+.5)*$;for(const t of H)for(const r of t.positionedGlyphs)r.x+=Q,r.y+=e}w.top+=-h*m,w.bottom=w.top+m,w.left+=-f*_,w.right=w.left+_}return!function(e){for(const t of e)if(0!==t.positionedGlyphs.length)return;return 1}(t)&&o}const nl={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},il={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function ol(e,t,r,n,i,o){return t.imageName?(n=n[t.imageName])?n.displaySize[0]*t.scale*Ss/o+i:0:(o=(n=r[t.fontStack])&&n[e])?o.metrics.advance*t.scale+i:0}function al(e,t,r,n){var i=Math.pow(e-t,2);return n?e<t?i/2:2*i:i+Math.abs(r)*r}function sl(e,t,r,n,i,o){let a=null,s=al(t,r,i,o);for(const c of n){var l=al(t-c.x,r,i,o)+c.badness;l<=s&&(a=c,s=l)}return{index:e,x:t,priorBreak:a,badness:s}}function ll(e,t,r,n,i,o,a){if("point"!==o)return[];if(!e)return[];var s=[],l=function(e,t,r,n,i,o){let a=0;for(let l=0;l<e.length();l++){var s=e.getSection(l);a+=ol(e.getCharCode(l),s,n,i,t,o)}return a/(r=Math.max(1,Math.ceil(a/r)))}(e,t,r,n,i,a),c=0<=e.text.indexOf("\u200b");let u=0;for(let f=0;f<e.length();f++){var h,d=e.getSection(f),p=e.getCharCode(f);nl[p]||(u+=ol(p,d,n,i,t,a)),f<e.length()-1&&(h=!((h=p)<11904||!_n["Bopomofo Extended"](h)&&!(_n.Bopomofo(h)||_n["CJK Compatibility Forms"](h)||_n["CJK Compatibility Ideographs"](h)||_n["CJK Compatibility"](h)||_n["CJK Radicals Supplement"](h)||_n["CJK Strokes"](h)||_n["CJK Symbols and Punctuation"](h)||_n["CJK Unified Ideographs Extension A"](h)||_n["CJK Unified Ideographs"](h)||_n["Enclosed CJK Letters and Months"](h)||_n["Halfwidth and Fullwidth Forms"](h)||_n.Hiragana(h)||_n["Ideographic Description Characters"](h)||_n["Kangxi Radicals"](h)||_n["Katakana Phonetic Extensions"](h)||_n.Katakana(h)||_n["Vertical Forms"](h)||_n["Yi Radicals"](h)||_n["Yi Syllables"](h))),il[p]||h||d.imageName)&&s.push(sl(f+1,u,l,s,function(e,t,r){let n=0;return 10===e&&(n-=1e4),r&&(n+=150),40!==e&&65288!==e||(n+=50),41!==t&&65289!==t||(n+=50),n}(p,e.getCharCode(f+1),h&&c),!1))}return function e(t){return t?e(t.priorBreak).concat(t.index):[]}(sl(e.length(),u,l,s,0,!0))}function cl(e){let t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function ul(e){let t=e.left,r=e.top,n=e.right-t,i=e.bottom-r;var o=e.image.content[2]-e.image.content[0],a=e.image.content[3]-e.image.content[1];return 0!=a&&0!==n&&0!==i&&(o/=a,e.image.contentMatch===Gs.height?n/i<o&&(t*=(a=i*o)/n,n=a):e.image.contentMatch===Gs.width&&0!=o&&n/i>o&&(r*=(a=n/o)/a,i=a)),{x1:t,y1:r,x2:t+n,y2:r+i}}function hl(e,t,r,n,i,o){let a;(e=e.image).content&&(s=e.content,l=e.pixelRatio||1,a=[s[0]/l,s[1]/l,e.displaySize[0]-s[2]/l,e.displaySize[1]-s[3]/l]);var s=t.left*o,l=t.right*o;let c,u,h,d;return u="width"===r||"both"===r?(d=i[0]+s-n[3],i[0]+l+n[1]):(d=i[0]+(s+l-e.displaySize[0])/2)+e.displaySize[0],s=t.top*o,l=t.bottom*o,h="height"===r||"both"===r?(c=i[1]+s-n[0],i[1]+l+n[2]):(c=i[1]+(s+l-e.displaySize[1])/2)+e.displaySize[1],{image:e,top:c,right:u,bottom:h,left:d,collisionPadding:a}}const dl=128,pl=32640;function fl(e,t){if("constant"===(t=t.expression).kind)return{kind:"constant",layoutSize:t.evaluate(new Tn(e+1))};if("source"===t.kind)return{kind:"source"};{var{zoomStops:r,interpolationType:n}=t;let a=0;for(;a<r.length&&r[a]<=e;)a++;let s=a=Math.max(0,a-1);for(;s<r.length&&r[s]<e+1;)s++;s=Math.min(r.length-1,s);var i=r[a],o=r[s];return"composite"===t.kind?{kind:"composite",minZoom:i,maxZoom:o,interpolationType:n}:{kind:"camera",minZoom:i,maxZoom:o,minSize:t.evaluate(new Tn(i)),maxSize:t.evaluate(new Tn(o)),interpolationType:n}}}function ml(e,t,r){let n="never";return(t=e.get(t))?n=t:e.get(r)&&(n="always"),n}const gl=Ba.VectorTileFeature.types,yl=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function vl(e,t,r,n,i,o,a,s,l,c,u,h,d){var p=s?Math.min(pl,Math.round(s[0])):0;s=s?Math.min(pl,Math.round(s[1])):0;e.emplaceBack(t,r,Math.round(32*n),Math.round(32*i),o,a,(p<<1)+(l?1:0),s,16*c,16*u,256*h,256*d)}function _l(e,t,r){e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r)}function bl(e){for(const t of e.sections)if(function(e){for(const t of e)if(Sn(t.charCodeAt(0)))return 1}(t.text))return!0;return!1}class wl{constructor(e){this.layoutVertexArray=new Ni,this.indexArray=new ji,this.programConfigurations=e,this.segments=new Vi,this.dynamicLayoutVertexArray=new zi,this.opacityVertexArray=new Fi,this.hasVisibleVertices=!1,this.placedSymbolArray=new bi}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(e,t,r,n){!this.isEmpty()&&(r&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,vs.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,_s.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,yl,!0),this.opacityVertexBuffer.itemSize=1),r||n)&&this.programConfigurations.upload(e)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}fn("SymbolBuffers",wl);class xl{constructor(e,t,r){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new r,this.segments=new Vi,this.collisionVertexArray=new Ui}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,bs.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}fn("CollisionBuffers",xl);class Cl{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Fo([]),this.placementViewportMatrix=Fo([]);var r=this.layers[0]._unevaluatedLayout._values,n=(r=(this.textSizeData=fl(this.zoom,r["text-size"]),this.iconSizeData=fl(this.zoom,r["icon-size"]),this.layers[0].layout)).get("symbol-sort-key"),i=r.get("symbol-z-order");this.canOverlap="never"!==ml(r,"text-overlap","text-allow-overlap")||"never"!==ml(r,"icon-overlap","icon-allow-overlap")||r.get("text-ignore-placement")||r.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==i&&!n.isConstant(),n="viewport-y"===i||"auto"===i&&!this.sortFeaturesByKey;this.sortFeaturesByY=n&&this.canOverlap,"point"===r.get("symbol-placement")&&(this.writingModes=r.get("text-writing-mode").map((t=>e.WritingMode[t]))),this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id)),this.sourceID=t.sourceID}createArrays(){this.text=new wl(new uo(this.layers,this.zoom,(e=>/^text/.test(e)))),this.icon=new wl(new uo(this.layers,this.zoom,(e=>/^icon/.test(e)))),this.glyphOffsetArray=new Ci,this.lineVertexArray=new Si,this.symbolInstances=new xi,this.textAnchorOffsets=new Ti}calculateGlyphDependencies(e,t,r,n,i){for(let a=0;a<e.length;a++){var o;t[e.charCodeAt(a)]=!0,(r||n)&&i&&(o=Cs[e.charAt(a)])&&(t[o.charCodeAt(0)]=!0)}}populate(t,r,n){var i=this.layers[0],o=i.layout,a=o.get("text-font"),s=o.get("text-field"),l=o.get("icon-image"),c=("constant"!==s.value.kind||s.value.value instanceof Ke&&!s.value.value.isEmpty()||0<s.value.value.toString().length)&&("constant"!==a.value.kind||0<a.value.value.length),u="constant"!==l.value.kind||!!l.value.value||0<Object.keys(l.parameters).length,h=o.get("symbol-sort-key");if(this.features=[],c||u){var d,p,f,m,g=r.iconDependencies,y=r.glyphDependencies,v=r.availableImages,_=new Tn(this.zoom);for({feature:d,id:p,index:f,sourceLayerIndex:m}of t){var b,w=i._featureFilter.needGeometry,x=vo(d,w);if(i._featureFilter.filter(_,x,n)){let t,r;if(w||(x.geometry=yo(d)),c&&(w=i.getValueAndResolveTokens("text-field",x,n,v),w=Ke.factory(w),!(b=this.hasRTLText=this.hasRTLText||bl(w))||"unavailable"===En.getRTLTextPluginStatus()||b&&En.isParsed())&&(t=xs(w,i,x)),u&&(r=(b=i.getValueAndResolveTokens("icon-image",x,n,v))instanceof Ye?b:Ye.fromString(b)),(t||r)&&(w=this.sortFeaturesByKey?h.evaluate(x,{},n):void 0,w={id:p,text:t,icon:r,index:f,sourceLayerIndex:m,geometry:x.geometry,properties:d.properties,type:gl[d.type],sortKey:w},this.features.push(w),r&&(g[r.name]=!0),t)){var C,S,E=a.evaluate(x,{},n).join(","),T="viewport"!==o.get("text-rotation-alignment")&&"point"!==o.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&0<=this.writingModes.indexOf(e.WritingMode.vertical);for(const e of t.sections)e.image?g[e.image.name]=!0:(C=bn(t.toString()),S=y[S=e.fontStack||E]=y[S]||{},this.calculateGlyphDependencies(e.text,S,T,this.allowVerticalPlacement,C))}}}"line"===o.get("symbol-placement")&&(this.features=function(e){const t={},r={},n=[];let i=0;function o(t){n.push(e[t]),i++}function a(e,t,i){var o=r[e];return delete r[e],r[t]=o,n[o].geometry[0].pop(),n[o].geometry[0]=n[o].geometry[0].concat(i[0]),o}function s(e,r,i){var o=t[r];return delete t[r],t[e]=o,n[o].geometry[0].shift(),n[o].geometry[0]=i[0].concat(n[o].geometry[0]),o}function l(e,t,r){return`${e}:${(r=r?t[0][t[0].length-1]:t[0][0]).x}:`+r.y}for(let m=0;m<e.length;m++){var c,u,h,d,p,f=(p=e[m]).geometry;(p=p.text?p.text.toString():null)?(c=l(p,f),u=l(p,f,!0),c in r&&u in t&&r[c]!==t[u]?(h=s(c,u,f),d=a(c,u,n[h].geometry),delete t[c],delete r[u],r[l(p,n[d].geometry,!0)]=d,n[h].geometry=null):c in r?a(c,u,f):u in t?s(c,u,f):(o(m),t[c]=i-1,r[u]=i-1)):o(m)}return n.filter((e=>e.geometry))}(this.features)),this.sortFeaturesByKey&&this.features.sort(((e,t)=>e.sortKey-t.sortKey))}}update(e,t,r){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,r),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,r))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,t){var r=this.lineVertexArray.length;if(void 0!==e.segment){let r=e.dist(t[e.segment+1]),o=e.dist(t[e.segment]);var n={};for(let i=e.segment+1;i<t.length;i++)n[i]={x:t[i].x,y:t[i].y,tileUnitDistanceFromAnchor:r},i<t.length-1&&(r+=t[i+1].dist(t[i]));for(let i=e.segment||0;0<=i;i--)n[i]={x:t[i].x,y:t[i].y,tileUnitDistanceFromAnchor:o},0<i&&(o+=t[i-1].dist(t[i]));for(let e=0;e<t.length;e++){var i=n[e];this.lineVertexArray.emplaceBack(i.x,i.y,i.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}}addSymbols(t,r,n,i,o,a,s,l,c,u,h,d){var p=t.indexArray,f=t.layoutVertexArray,m=t.segments.prepareSegment(4*r.length,f,p,this.canOverlap?a.sortKey:void 0),g=this.glyphOffsetArray.length,y=m.vertexLength,v=this.allowVerticalPlacement&&s===e.WritingMode.vertical?Math.PI/2:0,_=a.text&&a.text.sections;for(let e=0;e<r.length;e++){var{tl:b,tr:w,bl:x,br:C,tex:S,pixelOffsetTL:E,pixelOffsetBR:T,minFontScaleX:I,minFontScaleY:k,glyphOffset:A,isSDF:P,sectionIndex:M}=r[e],R=m.vertexLength,O=A[1];vl(f,l.x,l.y,b.x,O+b.y,S.x,S.y,n,P,E.x,E.y,I,k),vl(f,l.x,l.y,w.x,O+w.y,S.x+S.w,S.y,n,P,T.x,E.y,I,k),vl(f,l.x,l.y,x.x,O+x.y,S.x,S.y+S.h,n,P,E.x,T.y,I,k),vl(f,l.x,l.y,C.x,O+C.y,S.x+S.w,S.y+S.h,n,P,T.x,T.y,I,k),_l(t.dynamicLayoutVertexArray,l,v),p.emplaceBack(R,R+1,R+2),p.emplaceBack(R+1,R+2,R+3),m.vertexLength+=4,m.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(A[0]),e!==r.length-1&&M===r[e+1].sectionIndex||t.programConfigurations.populatePaintArrays(f.length,a,a.index,{},d,_&&_[M])}t.placedSymbolArray.emplaceBack(l.x,l.y,g,this.glyphOffsetArray.length-g,y,c,u,l.segment,n?n[0]:0,n?n[1]:0,i[0],i[1],s,0,!1,0,h)}_addCollisionDebugVertex(e,t,r,n,i,o){return t.emplaceBack(0,0),e.emplaceBack(r.x,r.y,n,i,Math.round(o.x),Math.round(o.y))}addCollisionDebugVertices(e,t,r,n,i,a,s){var l=i.segments.prepareSegment(4,i.layoutVertexArray,i.indexArray),c=l.vertexLength,u=i.layoutVertexArray,h=i.collisionVertexArray,d=s.anchorX;s=s.anchorY;(t=(this._addCollisionDebugVertex(u,h,a,d,s,new o(e,t)),this._addCollisionDebugVertex(u,h,a,d,s,new o(r,t)),this._addCollisionDebugVertex(u,h,a,d,s,new o(r,n)),this._addCollisionDebugVertex(u,h,a,d,s,new o(e,n)),l.vertexLength+=4,i.indexArray)).emplaceBack(c,c+1),t.emplaceBack(c+1,c+2),t.emplaceBack(c+2,c+3),t.emplaceBack(c+3,c),l.primitiveLength+=4}addDebugCollisionBoxes(e,t,r,n){for(let c=e;c<t;c++){var i=this.collisionBoxArray.get(c),o=i.x1,a=i.y1,s=i.x2,l=i.y2;this.addCollisionDebugVertices(o,a,s,l,n?this.textCollisionBox:this.iconCollisionBox,i.anchorPoint,r)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new xl(Bi,ws.members,qi),this.iconCollisionBox=new xl(Bi,ws.members,qi);for(let t=0;t<this.symbolInstances.length;t++){var e=this.symbolInstances.get(t);this.addDebugCollisionBoxes(e.textBoxStartIndex,e.textBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.verticalTextBoxStartIndex,e.verticalTextBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.iconBoxStartIndex,e.iconBoxEndIndex,e,!1),this.addDebugCollisionBoxes(e.verticalIconBoxStartIndex,e.verticalIconBoxEndIndex,e,!1)}}_deserializeCollisionBoxesForSymbol(e,t,r,n,i,o,a,s,l){var c={};for(let f=t;f<r;f++){var u=e.get(f);c.textBox={x1:u.x1,y1:u.y1,x2:u.x2,y2:u.y2,anchorPointX:u.anchorPointX,anchorPointY:u.anchorPointY},c.textFeatureIndex=u.featureIndex;break}for(let f=n;f<i;f++){var h=e.get(f);c.verticalTextBox={x1:h.x1,y1:h.y1,x2:h.x2,y2:h.y2,anchorPointX:h.anchorPointX,anchorPointY:h.anchorPointY},c.verticalTextFeatureIndex=h.featureIndex;break}for(let f=o;f<a;f++){var d=e.get(f);c.iconBox={x1:d.x1,y1:d.y1,x2:d.x2,y2:d.y2,anchorPointX:d.anchorPointX,anchorPointY:d.anchorPointY},c.iconFeatureIndex=d.featureIndex;break}for(let f=s;f<l;f++){var p=e.get(f);c.verticalIconBox={x1:p.x1,y1:p.y1,x2:p.x2,y2:p.y2,anchorPointX:p.anchorPointX,anchorPointY:p.anchorPointY},c.verticalIconFeatureIndex=p.featureIndex;break}return c}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let r=0;r<this.symbolInstances.length;r++){var t=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,t.textBoxStartIndex,t.textBoxEndIndex,t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t.iconBoxStartIndex,t.iconBoxEndIndex,t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex))}}hasTextData(){return 0<this.text.segments.get().length}hasIconData(){return 0<this.icon.segments.get().length}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&0<this.textCollisionBox.segments.get().length}hasIconCollisionBoxData(){return this.hasDebugData()&&0<this.iconCollisionBox.segments.get().length}addIndicesForPlacedSymbol(e,t){var r=(t=e.placedSymbolArray.get(t)).vertexStartIndex+4*t.numGlyphs;for(let n=t.vertexStartIndex;n<r;n+=4)e.indexArray.emplaceBack(n,n+1,n+2),e.indexArray.emplaceBack(n+1,n+2,n+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;var t=Math.sin(e),r=Math.cos(e);const n=[],i=[];var o=[];for(let s=0;s<this.symbolInstances.length;++s){o.push(s);var a=this.symbolInstances.get(s);n.push(0|Math.round(t*a.anchorX+r*a.anchorY)),i.push(a.featureIndex)}return o.sort(((e,t)=>n[e]-n[t]||i[t]-i[e])),o}addToSortKeyRanges(e,t){var r=this.sortKeyRanges[this.sortKeyRanges.length-1];r&&r.sortKey===t?r.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(1<this.text.segments.get().length||1<this.icon.segments.get().length)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const e of this.symbolInstanceIndexes){var t=this.symbolInstances.get(e);this.featureSortOrder.push(t.featureIndex),[t.rightJustifiedTextSymbolIndex,t.centerJustifiedTextSymbolIndex,t.leftJustifiedTextSymbolIndex].forEach(((e,t,r)=>{0<=e&&r.indexOf(e)===t&&this.addIndicesForPlacedSymbol(this.text,e)})),0<=t.verticalPlacedTextSymbolIndex&&this.addIndicesForPlacedSymbol(this.text,t.verticalPlacedTextSymbolIndex),0<=t.placedIconSymbolIndex&&this.addIndicesForPlacedSymbol(this.icon,t.placedIconSymbolIndex),0<=t.verticalPlacedIconSymbolIndex&&this.addIndicesForPlacedSymbol(this.icon,t.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Sl,El;fn("SymbolBucket",Cl,{omit:["layers","collisionBoxArray","features","compareText"]}),Cl.MAX_GLYPHS=65535,Cl.addDynamicAttributes=_l;var Tl={get paint(){return El=El||new Un({"icon-opacity":new Nn(G.paint_symbol["icon-opacity"]),"icon-color":new Nn(G.paint_symbol["icon-color"]),"icon-halo-color":new Nn(G.paint_symbol["icon-halo-color"]),"icon-halo-width":new Nn(G.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Nn(G.paint_symbol["icon-halo-blur"]),"icon-translate":new Dn(G.paint_symbol["icon-translate"]),"icon-translate-anchor":new Dn(G.paint_symbol["icon-translate-anchor"]),"text-opacity":new Nn(G.paint_symbol["text-opacity"]),"text-color":new Nn(G.paint_symbol["text-color"],{runtimeType:le,getOverride:e=>e.textColor,hasOverride:e=>!!e.textColor}),"text-halo-color":new Nn(G.paint_symbol["text-halo-color"]),"text-halo-width":new Nn(G.paint_symbol["text-halo-width"]),"text-halo-blur":new Nn(G.paint_symbol["text-halo-blur"]),"text-translate":new Dn(G.paint_symbol["text-translate"]),"text-translate-anchor":new Dn(G.paint_symbol["text-translate-anchor"])})},get layout(){return Sl=Sl||new Un({"symbol-placement":new Dn(G.layout_symbol["symbol-placement"]),"symbol-spacing":new Dn(G.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Dn(G.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Nn(G.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Dn(G.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Dn(G.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Dn(G.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Dn(G.layout_symbol["icon-ignore-placement"]),"icon-optional":new Dn(G.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Dn(G.layout_symbol["icon-rotation-alignment"]),"icon-size":new Nn(G.layout_symbol["icon-size"]),"icon-text-fit":new Dn(G.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Dn(G.layout_symbol["icon-text-fit-padding"]),"icon-image":new Nn(G.layout_symbol["icon-image"]),"icon-rotate":new Nn(G.layout_symbol["icon-rotate"]),"icon-padding":new Nn(G.layout_symbol["icon-padding"]),"icon-keep-upright":new Dn(G.layout_symbol["icon-keep-upright"]),"icon-offset":new Nn(G.layout_symbol["icon-offset"]),"icon-anchor":new Nn(G.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Dn(G.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Dn(G.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Dn(G.layout_symbol["text-rotation-alignment"]),"text-field":new Nn(G.layout_symbol["text-field"]),"text-font":new Nn(G.layout_symbol["text-font"]),"text-size":new Nn(G.layout_symbol["text-size"]),"text-max-width":new Nn(G.layout_symbol["text-max-width"]),"text-line-height":new Dn(G.layout_symbol["text-line-height"]),"text-letter-spacing":new Nn(G.layout_symbol["text-letter-spacing"]),"text-justify":new Nn(G.layout_symbol["text-justify"]),"text-radial-offset":new Nn(G.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Dn(G.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Nn(G.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Nn(G.layout_symbol["text-anchor"]),"text-max-angle":new Dn(G.layout_symbol["text-max-angle"]),"text-writing-mode":new Dn(G.layout_symbol["text-writing-mode"]),"text-rotate":new Nn(G.layout_symbol["text-rotate"]),"text-padding":new Dn(G.layout_symbol["text-padding"]),"text-keep-upright":new Dn(G.layout_symbol["text-keep-upright"]),"text-transform":new Nn(G.layout_symbol["text-transform"]),"text-offset":new Nn(G.layout_symbol["text-offset"]),"text-allow-overlap":new Dn(G.layout_symbol["text-allow-overlap"]),"text-overlap":new Dn(G.layout_symbol["text-overlap"]),"text-ignore-placement":new Dn(G.layout_symbol["text-ignore-placement"]),"text-optional":new Dn(G.layout_symbol["text-optional"])})}};class Il{constructor(e){if(void 0===e.property.overrides)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:ie,this.defaultValue=e}evaluate(e){if(e.formattedSection){var t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}fn("FormatSectionOverride",Il,{omit:["defaultValue"]});class kl extends qn{constructor(e){super(e,Tl)}recalculate(e,t){if(super.recalculate(e,t),"auto"===this.layout.get("icon-rotation-alignment")&&("point"!==this.layout.get("symbol-placement")?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-rotation-alignment")&&("point"!==this.layout.get("symbol-placement")?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]="map"===this.layout.get("text-rotation-alignment")?"map":"viewport"),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement"))if(e=this.layout.get("text-writing-mode")){var r=[];for(const t of e)r.indexOf(t)<0&&r.push(t);this.layout._values["text-writing-mode"]=r}else this.layout._values["text-writing-mode"]=["horizontal"];this._setPaintOverrides()}getValueAndResolveTokens(e,t,r,n){return r=this.layout.get(e).evaluate(t,{},r,n),(n=this._unevaluatedLayout._values[e]).isDataDriven()||yr(n.value)||!r?r:function(e,t){return t.replace(/{([^{}]+)}/g,((t,r)=>e&&r in e?String(e[r]):""))}(t.properties,r)}createBucket(e){return new Cl(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const r of Tl.paint.overridableProperties)if(kl.hasPaintOverride(this.layout,r)){var e=this.paint.get(r),t=new Il(e);t=new gr(t,e.property.specification);let n=null;n="constant"===e.value.kind||"source"===e.value.kind?new _r("source",t):new br("composite",t,e.value.zoomStops),this.paint._values[r]=new On(e.property,n,e.parameters)}}_handleOverridablePaintPropertyUpdate(e,t,r){return!(!this.layout||t.isDataDriven()||r.isDataDriven())&&kl.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,t){e=e.get("text-field");const r=Tl.paint.properties[t];let n=!1;const i=e=>{for(const t of e)if(r.overrides&&r.overrides.hasOverride(t))return void(n=!0)};if("constant"===e.value.kind&&e.value.value instanceof Ke)i(e.value.value.sections);else if("source"===e.value.kind){const r=e=>{var t;n||(e instanceof tt&&Je(e.value)===de?(t=e.value,i(t.sections)):e instanceof Xt?i(e.sections):e.eachChild(r))};(t=e.value)._styleExpression&&r(t._styleExpression.expression)}return n}}let Al;var Pl={get paint(){return Al=Al||new Un({"background-color":new Dn(G.paint_background["background-color"]),"background-pattern":new Fn(G.paint_background["background-pattern"]),"background-opacity":new Dn(G.paint_background["background-opacity"])})}};class Ml extends qn{constructor(e){super(e,Pl)}}let Rl;var Ol={get paint(){return Rl=Rl||new Un({"raster-opacity":new Dn(G.paint_raster["raster-opacity"]),"raster-hue-rotate":new Dn(G.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Dn(G.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Dn(G.paint_raster["raster-brightness-max"]),"raster-saturation":new Dn(G.paint_raster["raster-saturation"]),"raster-contrast":new Dn(G.paint_raster["raster-contrast"]),"raster-resampling":new Dn(G.paint_raster["raster-resampling"]),"raster-fade-duration":new Dn(G.paint_raster["raster-fade-duration"])})}};class Ll extends qn{constructor(e){super(e,Ol)}}class Dl extends qn{constructor(e){super(e,{}),this.onAdd=e=>{this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)},this.onRemove=e=>{this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)},this.implementation=e}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Nl{constructor(e){this._methodToThrottle=e,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._methodToThrottle()}),0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const zl=6371008.8;class Fl{constructor(e,t){if(isNaN(e)||isNaN(t))throw new Error(`Invalid LngLat object: (${e}, ${t})`);if(this.lng=+e,this.lat=+t,90<this.lat||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Fl(m(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){var t=Math.PI/180,r=this.lat*t,n=e.lat*t;r=Math.sin(r)*Math.sin(n)+Math.cos(r)*Math.cos(n)*Math.cos((e.lng-this.lng)*t);return zl*Math.acos(Math.min(r,1))}static convert(e){if(e instanceof Fl)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new Fl(Number(e[0]),Number(e[1]));if(Array.isArray(e)||"object"!=typeof e||null===e)throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]");return new Fl(Number("lng"in e?e.lng:e.lon),Number(e.lat))}}const Bl=2*Math.PI*zl;function Ul(e){return Bl*Math.cos(e*Math.PI/180)}function jl(e){return(180+e)/360}function ql(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function Hl(e,t){return e/Ul(t)}function Vl(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}class Gl{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.x=+e,this.y=+t,this.z=+r}static fromLngLat(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e=Fl.convert(e),new Gl(jl(e.lng),ql(e.lat),Hl(t,e.lat))}toLngLat(){return new Fl(function(e){return 360*e-180}(this.x),Vl(this.y))}toAltitude(){return function(e,t){return e*Ul(Vl(t))}(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Bl*function(e){return 1/Math.cos(e*Math.PI/180)}(Vl(this.y))}}function Kl(e,t,r){return[e*(r=2*Math.PI*6378137/256/Math.pow(2,r))-2*Math.PI*6378137/2,t*r-2*Math.PI*6378137/2]}class Zl{constructor(e,t,r){if(e<0||25<e||r<0||r>=Math.pow(2,e)||t<0||t>=Math.pow(2,e))throw new Error(`x=${t}, y=${r}, z=${e} outside of bounds. 0<=x<${Math.pow(2,e)}, 0<=y<${Math.pow(2,e)} 0<=z<=25 `);this.z=e,this.x=t,this.y=r,this.key=Yl(0,e,e,t,r)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,t,r){var n=function(e,t,r){var n=Kl(256*e,256*(t=Math.pow(2,r)-t-1),r);return e=Kl(256*(e+1),256*(t+1),r),n[0]+","+n[1]+","+e[0]+","+e[1]}(this.x,this.y,this.z),i=function(e,t,r){let n,i="";for(let o=e;0<o;o--)n=1<<o-1,i+=(t&n?1:0)+(r&n?2:0);return i}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===r?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,1<t?"@2x":"").replace(/{quadkey}/g,i).replace(/{bbox-epsg-3857}/g,n)}isChildOf(e){var t=this.z-e.z;return 0<t&&e.x===this.x>>t&&e.y===this.y>>t}getTilePoint(e){var t=Math.pow(2,this.z);return new o((e.x*t-this.x)*fo,(e.y*t-this.y)*fo)}toString(){return`${this.z}/${this.x}/`+this.y}}class Wl{constructor(e,t){this.wrap=e,this.canonical=t,this.key=Yl(e,t.z,t.z,t.x,t.y)}}class $l{constructor(e,t,r,n,i){if(e<r)throw new Error(`overscaledZ should be >= z; overscaledZ = ${e}; z = `+r);this.overscaledZ=e,this.wrap=t,this.canonical=new Zl(r,+n,+i),this.key=Yl(t,e,r,n,i)}clone(){return new $l(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = `+this.overscaledZ);var t=this.canonical.z-e;return e>this.canonical.z?new $l(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new $l(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)}calculateScaledKey(e,t){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = `+this.overscaledZ);var r=this.canonical.z-e;return e>this.canonical.z?Yl(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):Yl(this.wrap*+t,e,e,this.canonical.x>>r,this.canonical.y>>r)}isChildOf(e){var t;return e.wrap===this.wrap&&(t=this.canonical.z-e.canonical.z,0===e.overscaledZ||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t)}children(e){var t,r;return this.overscaledZ>=e?[new $l(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)]:(e=this.canonical.z+1,t=2*this.canonical.x,r=2*this.canonical.y,[new $l(e,this.wrap,e,t,r),new $l(e,this.wrap,e,1+t,r),new $l(e,this.wrap,e,t,1+r),new $l(e,this.wrap,e,1+t,1+r)])}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new $l(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new $l(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Wl(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/`+this.canonical.y}getTilePoint(e){return this.canonical.getTilePoint(new Gl(e.x-this.wrap,e.y))}}function Yl(e,t,r,n,i){var o=1<<r;return(o*o*(e=(e*=2)<0?-1*e-1:e)+o*i+n).toString(36)+r.toString(36)+t.toString(36)}fn("CanonicalTileID",Zl),fn("OverscaledTileID",$l,{omit:["posMatrix"]});class Xl{constructor(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;if(this.uid=e,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(r&&!["mapbox","terrarium","custom"].includes(r))x(`"${r}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);else{this.stride=t.height;var s=this.dim=t.height-2;switch(this.data=new Uint32Array(t.data.buffer),r){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=n,this.greenFactor=i,this.blueFactor=o,this.baseShift=a;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let e=0;e<s;e++)this.data[this._idx(-1,e)]=this.data[this._idx(0,e)],this.data[this._idx(s,e)]=this.data[this._idx(s-1,e)],this.data[this._idx(e,-1)]=this.data[this._idx(e,0)],this.data[this._idx(e,s)]=this.data[this._idx(e,s-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(s,-1)]=this.data[this._idx(s-1,0)],this.data[this._idx(-1,s)]=this.data[this._idx(0,s-1)],this.data[this._idx(s,s)]=this.data[this._idx(s-1,s-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let e=0;e<s;e++)for(let t=0;t<s;t++){var l=this.get(e,t);l>this.max&&(this.max=l),l<this.min&&(this.min=l)}}}get(e,t){var r=new Uint8Array(this.data.buffer);e=4*this._idx(e,t);return this.unpack(r[e],r[1+e],r[2+e])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)}unpack(e,t,r){return e*this.redFactor+t*this.greenFactor+r*this.blueFactor-this.baseShift}getPixels(){return new Jo({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,t,r){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let n=t*this.dim,i=t*this.dim+this.dim,o=r*this.dim,a=r*this.dim+this.dim;switch(t){case-1:n=i-1;break;case 1:i=n+1}switch(r){case-1:o=a-1;break;case 1:a=o+1}var s=-t*this.dim,l=-r*this.dim;for(let c=o;c<a;c++)for(let t=n;t<i;t++)this.data[this._idx(t,c)]=e.data[this._idx(t+s,c+l)]}}fn("DEMData",Xl);class Ql{constructor(e){this._stringToNumber={},this._numberToString=[];for(let r=0;r<e.length;r++){var t=e[r];this._stringToNumber[t]=r,this._numberToString[r]=t}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${e} can't be >= this._numberToString.length `+this._numberToString.length);return this._numberToString[e]}}class Jl{constructor(e,t,r,n,i){this.type="Feature",(this._vectorTileFeature=e)._z=t,e._x=r,e._y=n,this.properties=e.properties,this.id=i}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){var e={geometry:this.geometry};for(const t in this)"_geometry"!==t&&"_vectorTileFeature"!==t&&(e[t]=this[t]);return e}}class ec{constructor(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new dn(fo,16,0),this.grid3D=new dn(fo,16,0),this.featureIndexArray=new ki,this.promoteId=t}insert(e,t,r,n,i,o){var a=this.featureIndexArray.length,s=(this.featureIndexArray.emplaceBack(r,n,i),o?this.grid3D:this.grid);for(let h=0;h<t.length;h++){var l=t[h],c=[1/0,1/0,-1/0,-1/0];for(let e=0;e<l.length;e++){var u=l[e];c[0]=Math.min(c[0],u.x),c[1]=Math.min(c[1],u.y),c[2]=Math.max(c[2],u.x),c[3]=Math.max(c[3],u.y)}c[0]<fo&&c[1]<fo&&0<=c[2]&&0<=c[3]&&s.insert(a,c[0],c[1],c[2],c[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Ba.VectorTile(new Ks(this.rawTileData)).layers,this.sourceLayerCoder=new Ql(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(e,t,r,n){this.loadVTLayers();const i=e.params||{},a=fo/e.tileSize/e.scale,s=Er(i.filter),l=e.queryGeometry,c=e.queryPadding*a;var u=rc(l),h=this.grid.query(u.minX-c,u.minY-c,u.maxX+c,u.maxY+c);u=rc(e.cameraQueryGeometry);for(const m of this.grid3D.query(u.minX-c,u.minY-c,u.maxX+c,u.maxY+c,((t,r,n,i)=>function(e,t,r,n,i){for(const o of e)if(t<=o.x&&r<=o.y&&n>=o.x&&i>=o.y)return!0;var a=[new o(t,r),new o(t,i),new o(n,i),new o(n,r)];if(2<e.length)for(const o of a)if(ko(e,o))return!0;for(let o=0;o<e.length-1;o++)if(function(e,t,r){var n=r[0],i=r[2];if(!(e.x<n.x&&t.x<n.x||e.x>i.x&&t.x>i.x||e.y<n.y&&t.y<n.y||e.y>i.y&&t.y>i.y))return(n=C(e,t,r[0]))!==C(e,t,r[1])||n!==C(e,t,r[2])||n!==C(e,t,r[3])}(e[o],e[o+1],a))return!0;return!1}(e.cameraQueryGeometry,t-c,r-c,n+c,i+c))))h.push(m);h.sort(nc);var d={};let p;for(let o=0;o<h.length;o++){var f=h[o];if(f!==p){p=f,f=this.featureIndexArray.get(f);let o=null;this.loadMatchingFeature(d,f.bucketIndex,f.sourceLayerIndex,f.featureIndex,s,i.layers,i.availableImages,t,r,n,((t,r,n)=>(o=o||yo(t),r.queryIntersectsFeature(l,t,n,o,this.z,e.transform,a,e.pixelPosMatrix))))}}return d}loadMatchingFeature(e,t,r,n,i,o,a,s,l,c,u){var h=this.bucketLayerIDs[t];if(!o||function(e,t){for(let r=0;r<e.length;r++)if(0<=t.indexOf(e[r]))return 1}(o,h)){t=this.sourceLayerCoder.decode(r);var d=this.vtLayers[t].feature(n);if(i.needGeometry){if(r=vo(d,!0),!i.filter(new Tn(this.tileID.overscaledZ),r,this.tileID.canonical))return}else if(!i.filter(new Tn(this.tileID.overscaledZ),d))return;var p=this.getId(d,t);for(let t=0;t<h.length;t++){var f=h[t];if(!(o&&o.indexOf(f)<0))if(m=s[f]){let t={};p&&c&&(t=c.getState(m.sourceLayer||"_geojsonTileLayer",p));var m,y=g({},l[f]);if(m=(y.paint=tc(y.paint,m.paint,d,t,a),y.layout=tc(y.layout,m.layout,d,t,a),!u||u(d,m,t))){var v=new Jl(d,this.z,this.x,this.y,p);v.layer=y;let t=e[f];(t=void 0===t?e[f]=[]:t).push({featureIndex:n,feature:v,intersectionZ:m})}}}}}lookupSymbolFeatures(e,t,r,n,i,o,a,s){var l={},c=(this.loadVTLayers(),Er(i));for(const u of e)this.loadMatchingFeature(l,r,n,u,c,o,a,s,t);return l}hasLayer(e){for(const t of this.bucketLayerIDs)for(const r of t)if(e===r)return!0;return!1}getId(e,t){let r=e.id;return this.promoteId&&(t="string"==typeof this.promoteId?this.promoteId:this.promoteId[t],"boolean"==typeof(r=e.properties[t]))?Number(r):r}}function tc(e,t,r,n,i){return v(e,((e,o)=>(o=t instanceof Ln?t.get(o):null)&&o.evaluate?o.evaluate(r,n,i):o))}function rc(e){let t=1/0,r=1/0,n=-1/0,i=-1/0;for(const o of e)t=Math.min(t,o.x),r=Math.min(r,o.y),n=Math.max(n,o.x),i=Math.max(i,o.y);return{minX:t,minY:r,maxX:n,maxY:i}}function nc(e,t){return t-e}function ic(e,t,r,n,i){var a=[];for(let l=0;l<e.length;l++){var s=e[l];let c;for(let e=0;e<s.length-1;e++){let l=s[e],u=s[e+1];l.x<t&&u.x<t||(l.x<t?l=new o(t,l.y+(u.y-l.y)*((t-l.x)/(u.x-l.x)))._round():u.x<t&&(u=new o(t,l.y+(u.y-l.y)*((t-l.x)/(u.x-l.x)))._round()),l.y<r&&u.y<r)||(l.y<r?l=new o(l.x+(u.x-l.x)*((r-l.y)/(u.y-l.y)),r)._round():u.y<r&&(u=new o(l.x+(u.x-l.x)*((r-l.y)/(u.y-l.y)),r)._round()),l.x>=n&&u.x>=n)||(l.x>=n?l=new o(n,l.y+(u.y-l.y)*((n-l.x)/(u.x-l.x)))._round():u.x>=n&&(u=new o(n,l.y+(u.y-l.y)*((n-l.x)/(u.x-l.x)))._round()),l.y>=i&&u.y>=i)||(l.y>=i?l=new o(l.x+(u.x-l.x)*((i-l.y)/(u.y-l.y)),i)._round():u.y>=i&&(u=new o(l.x+(u.x-l.x)*((i-l.y)/(u.y-l.y)),i)._round()),c&&l.equals(c[c.length-1])||(c=[l],a.push(c)),c.push(u))}}return a}fn("FeatureIndex",ec,{omit:["rawTileData","sourceLayerCoder"]});class oc extends o{constructor(e,t,r,n){super(e,t),this.angle=r,void 0!==n&&(this.segment=n)}clone(){return new oc(this.x,this.y,this.angle,this.segment)}}function ac(e,t,r,n,i){if(void 0!==t.segment&&0!==r){let c=t,u=t.segment+1,h=0;for(;h>-r/2;){if(--u<0)return;h-=e[u].dist(c),c=e[u]}h+=e[u].dist(e[u+1]),u++;var o=[];let d=0;for(;h<r/2;){var a=e[u-1],s=e[u],l=e[u+1];if(!l)return;for(a=a.angleTo(s)-s.angleTo(l),a=Math.abs((a+3*Math.PI)%(2*Math.PI)-Math.PI),o.push({distance:h,angleDelta:a}),d+=a;h-o[0].distance>n;)d-=o.shift().angleDelta;if(d>i)return;u++,h+=s.dist(l)}}return 1}function sc(e){let t=0;for(let r=0;r<e.length-1;r++)t+=e[r].dist(e[r+1]);return t}function lc(e,t,r){return e?.6*t*r:0}function cc(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function uc(e,t,r,n,i,o,a,s,l){var c=lc(n,o,a),u=(i=(n=cc(n,i))*a,0===e[0].x||e[0].x===l||0===e[0].y||e[0].y===l);t-i<t/4&&(t=i+t/4),o*=2;return function e(t,r,n,i,o,a,s,l,c){const u=a/2,h=sc(t);let d=0,p=r-n,f=[];for(let m=0;m<t.length-1;m++){const e=t[m],r=t[m+1],s=e.dist(r),l=r.angleTo(e);for(;p+n<d+s;){const g=((p+=n)-d)/s,y=Ft.number(e.x,r.x,g),v=Ft.number(e.y,r.y,g);if(0<=y&&y<c&&0<=v&&v<c&&0<=p-u&&p+u<=h){const e=new oc(y,v,l,m);e._round(),i&&!ac(t,e,a,i,o)||f.push(e)}}d+=s}return l||f.length||s||(f=e(t,d/2,n,i,o,a,s,!0,c)),f}(e,u?t/2*s%t:(n/2+o)*a*s%t,t,c,r,i,u,!1,l)}fn("Anchor",oc);function hc(e,t,r,n){var i=[];const a=e.image,s=a.pixelRatio;var l=a.paddedRect.w-2,c=a.paddedRect.h-2;let u={x1:e.left,y1:e.top,x2:e.right,y2:e.bottom};var h=a.stretchX||[[0,l]],d=a.stretchY||[[0,c]],p=(e,t)=>e+t[1]-t[0];const f=h.reduce(p,0),m=d.reduce(p,0);var g,y,v,_=c-m;let b=0,w=f,x=0,C=m,S=0,E=p=l-f,T=0,I=_;a.content&&n&&(y=(g=a.content)[2]-g[0],v=g[3]-g[1],a.contentMatch&&a.content&&(u=ul(e)),b=dc(h,0,g[0]),x=dc(d,0,g[1]),w=dc(h,g[0],g[2]),C=dc(d,g[1],g[3]),S=g[0]-b,T=g[1]-x,E=y-w,I=v-C);const k=u.x1,A=u.y1,P=u.x2-k,M=u.y2-A;var R=(e,n,i,l)=>{var c=(e.stretch-b)/w*P+k,u=e.fixed-S-E*e.stretch/f,h=(n.stretch-x)/C*M+A,d=n.fixed-T-I*n.stretch/m,p=(i.stretch-b)/w*P+k,g=i.fixed-S-E*i.stretch/f,y=(l.stretch-x)/C*M+A,v=l.fixed-T-I*l.stretch/m,_=new o(c,h);h=new o(p,h),p=new o(p,y),c=new o(c,y),y=new o(u/s,d/s),u=new o(g/s,v/s),(d=t*Math.PI/180)&&(g=Math.sin(d),v=Math.cos(d),_._matMult(d=[v,-g,g,v]),h._matMult(d),c._matMult(d),p._matMult(d)),g=e.stretch+e.fixed,v=i.stretch+i.fixed,d=n.stretch+n.fixed,e=l.stretch+l.fixed;return{tl:_,tr:h,bl:c,br:p,tex:{x:a.paddedRect.x+1+g,y:a.paddedRect.y+1+d,w:v-g,h:e-d},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:y,pixelOffsetBR:u,minFontScaleX:E/s/P,minFontScaleY:I/s/M,isSDF:r}};if(n&&(a.stretchX||a.stretchY)){var O=pc(h,p,f),L=pc(d,_,m);for(let e=0;e<O.length-1;e++){var D=O[e],N=O[e+1];for(let e=0;e<L.length-1;e++){var z=L[e],F=L[e+1];i.push(R(D,z,N,F))}}}else i.push(R({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:1+l},{fixed:0,stretch:1+c}));return i}function dc(e,t,r){let n=0;for(const i of e)n+=Math.max(t,Math.min(r,i[1]))-Math.max(t,Math.min(r,i[0]));return n}function pc(e,t,r){var n,i,o=[{fixed:-1,stretch:0}];for([n,i]of e){var a=o[o.length-1];o.push({fixed:n-a.stretch,stretch:a.stretch}),o.push({fixed:n-a.stretch,stretch:a.stretch+(i-n)})}return o.push({fixed:t+1,stretch:r}),o}class fc{constructor(e,t,r,n,i,a,s,l,c,u){if(this.boxStartIndex=e.length,c){let e=a.top,t=a.bottom;0<(c=((c=a.collisionPadding)&&(e-=c[1],t+=c[3]),t-e))&&(c=Math.max(10,c),this.circleDiameter=c)}else{var h;(l=((c=null!=(c=a.image)&&c.contentMatch&&a.image.content?ul(a):{x1:a.left,y1:a.top,x2:a.right,y2:a.bottom}).y1=c.y1*s-l[0],c.x2=c.x2*s+l[1],c.y2=c.y2*s+l[2],c.x1=c.x1*s-l[3],a.collisionPadding))&&(c.x1-=l[0]*s,c.y1-=l[1]*s,c.x2+=l[2]*s,c.y2+=l[3]*s),u&&(a=new o(c.x1,c.y1),l=new o(c.x2,c.y1),s=new o(c.x1,c.y2),h=new o(c.x2,c.y2),u=u*Math.PI/180,a._rotate(u),l._rotate(u),s._rotate(u),h._rotate(u),c.x1=Math.min(a.x,l.x,s.x,h.x),c.x2=Math.max(a.x,l.x,s.x,h.x),c.y1=Math.min(a.y,l.y,s.y,h.y),c.y2=Math.max(a.y,l.y,s.y,h.y)),e.emplaceBack(t.x,t.y,c.x1,c.y1,c.x2,c.y2,r,n,i)}this.boxEndIndex=e.length}}class mc{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:gc;if(this.data=e,this.length=this.data.length,this.compare=t,0<this.length)for(let r=(this.length>>1)-1;0<=r;r--)this._down(r)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){var e,t;if(0!==this.length)return e=this.data[0],t=this.data.pop(),this.length--,0<this.length&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){for(var{data:t,compare:r}=this,n=t[e];0<e;){var i=e-1>>1,o=t[i];if(0<=r(n,o))break;t[e]=o,e=i}t[e]=n}_down(e){for(var{data:t,compare:r}=this,n=this.length>>1,i=t[e];e<n;){let n=1+(e<<1),a=t[n];var o=n+1;if(o<this.length&&r(t[o],a)<0&&(n=o,a=t[o]),0<=r(a,i))break;t[e]=a,e=n}t[e]=i}}function gc(e,t){return e<t?-1:t<e?1:0}function yc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=1/0,i=1/0,a=-1/0,s=-1/0;var l=e[0];for(let o=0;o<l.length;o++){var c=l[o];(!o||c.x<n)&&(n=c.x),(!o||c.y<i)&&(i=c.y),(!o||c.x>a)&&(a=c.x),(!o||c.y>s)&&(s=c.y)}var u=a-n,h=s-i,d=Math.min(u,h);let p=d/2;var f=new mc([],vc);if(0===d)return new o(n,i);for(let o=n;o<a;o+=d)for(let t=i;t<s;t+=d)f.push(new _c(o+p,t+p,p,e));let m=function(e){let t=0,r=0,n=0;var i=e[0];for(let l=0,c=i.length,u=c-1;l<c;u=l++){var o=i[l],a=i[u],s=o.x*a.y-a.x*o.y;r+=(o.x+a.x)*s,n+=(o.y+a.y)*s,t+=3*s}return new _c(r/t,n/t,0,e)}(e),g=f.length;for(;f.length;){var y=f.pop();(y.d>m.d||!m.d)&&(m=y,r)&&console.log("found best %d after %d probes",Math.round(1e4*y.d)/1e4,g),y.max-m.d<=t||(p=y.h/2,f.push(new _c(y.p.x-p,y.p.y-p,p,e)),f.push(new _c(y.p.x+p,y.p.y-p,p,e)),f.push(new _c(y.p.x-p,y.p.y+p,p,e)),f.push(new _c(y.p.x+p,y.p.y+p,p,e)),g+=4)}return r&&(console.log("num probes: "+g),console.log("best distance: "+m.d)),m.p}function vc(e,t){return t.max-e.max}function _c(e,t,r,n){this.p=new o(e,t),this.h=r,this.d=function(e,t){let r=!1,n=1/0;for(let s=0;s<t.length;s++){var i=t[s];for(let t=0,s=i.length,l=s-1;t<s;l=t++){var o=i[t],a=i[l];o.y>e.y!=a.y>e.y&&e.x<(a.x-o.x)*(e.y-o.y)/(a.y-o.y)+o.x&&(r=!r),n=Math.min(n,To(e,o,a))}}return(r?1:-1)*Math.sqrt(n)}(this.p,n),this.max=this.d+this.h*Math.SQRT2}e.TextAnchorEnum=void 0,(Yt=e.TextAnchorEnum||(e.TextAnchorEnum={}))[Yt.center=1]="center",Yt[Yt.left=2]="left",Yt[Yt.right=3]="right",Yt[Yt.top=4]="top",Yt[Yt.bottom=5]="bottom",Yt[Yt["top-left"]=6]="top-left",Yt[Yt["top-right"]=7]="top-right",Yt[Yt["bottom-left"]=8]="bottom-left",Yt[Yt["bottom-right"]=9]="bottom-right";const bc=Number.POSITIVE_INFINITY;function wc(e,t){if(t[1]!==bc){var r=e,n=t[0],i=t[1];let o=0,a=0;switch(n=Math.abs(n),i=Math.abs(i),r){case"top-right":case"top-left":case"top":a=i-7;break;case"bottom-right":case"bottom-left":case"bottom":a=7-i}switch(r){case"top-right":case"bottom-right":case"right":o=-n;break;case"top-left":case"bottom-left":case"left":o=n}return[o,a]}{r=e;var o=t[0];let n=0,i=0;var a=(o=o<0?0:o)/Math.SQRT2;switch(r){case"top-right":case"top-left":i=a-7;break;case"bottom-right":case"bottom-left":i=7-a;break;case"bottom":i=7-o;break;case"top":i=o-7}switch(r){case"top-right":case"bottom-right":n=-a;break;case"top-left":case"bottom-left":n=a;break;case"left":n=o;break;case"right":n=-o}return[n,i]}}function xc(e,t,r){var n=e.layout,i=null==(i=n.get("text-variable-anchor-offset"))?void 0:i.evaluate(t,{},r);if(i){var o=i.values,a=[];for(let e=0;e<o.length;e+=2){var s=a[e]=o[e],l=o[e+1].map((e=>e*Ss));s.startsWith("top")?l[1]-=7:s.startsWith("bottom")&&(l[1]+=7),a[e+1]=l}return new $e(a)}if(i=n.get("text-variable-anchor")){let o;var c=(o=void 0!==(e=e._unevaluatedLayout).getValue("text-radial-offset")?[n.get("text-radial-offset").evaluate(t,{},r)*Ss,bc]:n.get("text-offset").evaluate(t,{},r).map((e=>e*Ss)),[]);for(const e of i)c.push(e,wc(e,o));return new $e(c)}return null}function Cc(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Sc(e,t,r,n,i,a,s,l,c,u,h,d,p,f,m){r=function(e,t,r,n,i,a,s,l){var c=n.layout.get("text-rotate").evaluate(a,{})*Math.PI/180,u=[];for(const x of t.positionedLines)for(const e of x.positionedGlyphs)if(e.rect){var h=e.rect||{};let n=4,a=!0,C=1,S=0;var d,p=(i||l)&&e.vertical,f=e.metrics.advance*e.scale/2,m=(l&&t.verticalizable&&(m=(e.scale-1)*Ss,d=(Ss-e.metrics.width*e.scale)/2,S=x.lineOffset/2-(e.imageName?-d:m)),e.imageName&&(a=(d=s[e.imageName]).sdf,C=d.pixelRatio,n=1/C),i?[e.x+f,e.y]:[0,0]);let E=i?[0,0]:[e.x+f+r[0],e.y+r[1]-S],T=[0,0];p&&(T=E,E=[0,0]);var g=e.metrics.isDoubleResolution?2:1,y=(e.metrics.left-n)*e.scale-f+E[0],v=(-e.metrics.top-n)*e.scale+E[1],_=y+h.w/g*e.scale/C,b=(g=v+h.h/g*e.scale/C,new o(y,v)),w=(v=new o(_,v),y=new o(y,g),_=new o(_,g),p&&(g=new o(-f,f-Js),p=-Math.PI/2,f=12-f,w=e.imageName?f:0,f=new o(22-f,-w),w=new o(...T),b._rotateAround(p,g)._add(f)._add(w),v._rotateAround(p,g)._add(f)._add(w),y._rotateAround(p,g)._add(f)._add(w),_._rotateAround(p,g)._add(f)._add(w)),c&&(p=Math.sin(c),g=Math.cos(c),b._matMult(f=[g,-p,p,g]),v._matMult(f),y._matMult(f),_._matMult(f)),new o(0,0));p=new o(0,0),u.push({tl:b,tr:v,bl:y,br:_,tex:h,writingMode:t.writingMode,glyphOffset:m,sectionIndex:e.sectionIndex,isSDF:a,pixelOffsetTL:w,pixelOffsetBR:p,minFontScaleX:0,minFontScaleY:0})}return u}(0,r,l,i,a,s,n,e.allowVerticalPlacement);let g=null;"source"===(n=e.textSizeData).kind?(g=[dl*i.layout.get("text-size").evaluate(s,{})])[0]>pl&&x(`${e.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`):"composite"===n.kind&&((g=[dl*f.compositeTextSizes[0].evaluate(s,{},m),dl*f.compositeTextSizes[1].evaluate(s,{},m)])[0]>pl||g[1]>pl)&&x(`${e.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`),e.addSymbols(e.text,r,g,l,a,s,u,t,c.lineStartIndex,c.lineLength,p,m);for(const o of h)d[o]=e.text.placedSymbolArray.length-1;return 4*r.length}function Ec(e){for(const t in e)return e[t];return null}const Tc=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];function Ic(e,t,r,n,i,o){var a;i-n<=r||(function e(t,r,n,i,o,a){for(;i<o;){if(600<o-i){const s=o-i+1,l=n-i+1,c=Math.log(s),u=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*u*(s-u)/s)*(l-s/2<0?-1:1);e(t,r,n,Math.max(i,Math.floor(n-l*u/s+h)),Math.min(o,Math.floor(n+(s-l)*u/s+h)),a)}const s=r[2*n+a];let l=i,c=o;for(kc(t,r,i,n),r[2*o+a]>s&&kc(t,r,i,o);l<c;){for(kc(t,r,l,c),l++,c--;r[2*l+a]<s;)l++;for(;r[2*c+a]>s;)c--}r[2*i+a]===s?kc(t,r,i,c):(c++,kc(t,r,c,o)),c<=n&&(i=c+1),n<=c&&(o=c-1)}}(e,t,a=n+i>>1,n,i,o),Ic(e,t,r,n,a-1,1-o),Ic(e,t,r,1+a,i,1-o))}function kc(e,t,r,n){Ac(e,r,n),Ac(t,2*r,2*n),Ac(t,2*r+1,2*n+1)}function Ac(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function Pc(e,t,r,n){return(e-=r)*e+(r=t-n)*r}e.PerformanceMarkers=void 0,(Kt=e.PerformanceMarkers||(e.PerformanceMarkers={})).create="create",Kt.load="load",Kt.fullLoad="fullLoad";let Mc=null,Rc=[];const Oc=1e3/60,Lc="loadTime",Dc="fullLoadTime";Yt={mark(e){performance.mark(e)},frame(e){var t;null!=Mc&&(t=e-Mc,Rc.push(t)),Mc=e},clearMetrics(){Mc=null,Rc=[],performance.clearMeasures(Lc),performance.clearMeasures(Dc);for(const t in e.PerformanceMarkers)performance.clearMarks(e.PerformanceMarkers[t])},getPerformanceMetrics(){performance.measure(Lc,e.PerformanceMarkers.create,e.PerformanceMarkers.load),performance.measure(Dc,e.PerformanceMarkers.create,e.PerformanceMarkers.fullLoad);var t=performance.getEntriesByName(Lc)[0].duration,r=performance.getEntriesByName(Dc)[0].duration,n=Rc.length,i=1/(Rc.reduce(((e,t)=>e+t),0)/n/1e3),o=Rc.filter((e=>e>Oc)).reduce(((e,t)=>e+(t-Oc)/Oc),0);return{loadTime:t,fullLoadTime:r,fps:i,percentDroppedFrames:o/(n+o)*100,totalFrames:n}}},e.AJAXError=N,e.Actor=class{constructor(e,t){this.target=e,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Nl((()=>this.process())),this.subscription=function(e,t,r,n){return e.addEventListener(t,r,n),{unsubscribe:()=>{e.removeEventListener(t,r,n)}}}(this.target,"message",(e=>this.receive(e)),!1),this.globalScope=S(self)?e:window}registerMessageHandler(e,t){this.messageHandlers[e]=t}sendAsync(e,t){return new Promise(((r,n)=>{const i=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[i]={resolve:r,reject:n},t&&t.signal.addEventListener("abort",(()=>{delete this.resolveRejects[i];var t={id:i,type:"<cancel>",origin:location.origin,targetMapId:e.targetMapId,sourceMapId:this.mapId};this.target.postMessage(t)}),{once:!0}),r=[],n=Object.assign(Object.assign({},e),{id:i,sourceMapId:this.mapId,origin:location.origin,data:gn(e.data,r)}),this.target.postMessage(n,{transfer:r})}))}receive(e){var t,r=(e=e.data).id;"file://"!==e.origin&&"file://"!==location.origin&&e.origin!==location.origin||e.targetMapId&&this.mapId!==e.targetMapId||("<cancel>"===e.type?(delete this.tasks[r],t=this.abortControllers[r],delete this.abortControllers[r],t&&t.abort()):S(self)||e.mustQueue?(this.tasks[r]=e,this.taskQueue.push(r),this.invoker.trigger()):this.processTask(r,e))}process(){var e,t;0!==this.taskQueue.length&&(e=this.taskQueue.shift(),t=this.tasks[e],delete this.tasks[e],0<this.taskQueue.length&&this.invoker.trigger(),t)&&this.processTask(e,t)}processTask(e,r){return t(this,void 0,void 0,(function*(){if("<response>"===r.type)return t=this.resolveRejects[e],delete this.resolveRejects[e],t?void(r.error?t.reject(yn(r.error)):t.resolve(yn(r.data))):void 0;if(this.messageHandlers[r.type]){var t=yn(r.data),n=new AbortController;this.abortControllers[e]=n;try{var i=yield this.messageHandlers[r.type](r.sourceMapId,t,n);this.completeTask(e,null,i)}catch(t){this.completeTask(e,t)}}else this.completeTask(e,new Error(`Could not find a registered handler for ${r.type}, map ID: ${this.mapId}, available handlers: `+Object.keys(this.messageHandlers).join(", ")))}))}completeTask(e,t,r){var n=[];delete this.abortControllers[e],e={id:e,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?gn(t):null,data:gn(r,n)};this.target.postMessage(e,{transfer:n})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},e.AlphaImage=Qo,e.CanonicalTileID=Zl,e.CollisionBoxArray=vi,e.CollisionCircleLayoutArray=class extends ai{},e.Color=He,e.DEMData=Xl,e.DataConstantProperty=Dn,e.DictionaryCoder=Ql,e.EXTENT=fo,e.ErrorEvent=H,e.EvaluationParameters=Tn,e.Event=q,e.Evented=V,e.FeatureIndex=ec,e.FillBucket=Ra,e.FillExtrusionBucket=Xa,e.GLOBAL_DISPATCHER_ID=D,e.GeoJSONFeature=Jl,e.ImageAtlas=Qs,e.ImagePosition=Xs,e.KDBush=class e{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");var r,[n,i]=new Uint8Array(t,0,2);if(219!==n)throw new Error("Data does not appear to be in a KDBush format.");if(1!=(n=i>>4))throw new Error(`Got v${n} data when expected v1.`);if(n=Tc[15&i])return[i]=new Uint16Array(t,2,1),[r]=new Uint32Array(t,4,1),new e(r,i,n,t);throw new Error("Unrecognized array type.")}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Float64Array,n=arguments.length>3?arguments[3]:void 0;if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+t,2),65535),this.ArrayType=r,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;var i=Tc.indexOf(this.ArrayType),o=2*e*this.ArrayType.BYTES_PER_ELEMENT,a=e*this.IndexArrayType.BYTES_PER_ELEMENT,s=(8-a%8)%8;if(i<0)throw new Error(`Unexpected typed array class: ${r}.`);n&&n instanceof ArrayBuffer?(this.data=n,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+a+s,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+o+a+s),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+a+s,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+i]),new Uint16Array(this.data,2,1)[0]=t,new Uint32Array(this.data,4,1)[0]=e)}add(e,t){var r=this._pos>>1;return this.ids[r]=r,this.coords[this._pos++]=e,this.coords[this._pos++]=t,r}finish(){var e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return Ic(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,t,r,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");for(var{ids:i,coords:o,nodeSize:a}=this,s=[0,i.length-1,0],l=[];s.length;){var c=s.pop()||0,u=s.pop()||0,h=s.pop()||0;if(u-h<=a)for(let a=h;a<=u;a++){var d=o[2*a],p=o[2*a+1];e<=d&&d<=r&&t<=p&&p<=n&&l.push(i[a])}else{var f=h+u>>1,m=o[2*f],g=o[2*f+1];e<=m&&m<=r&&t<=g&&g<=n&&l.push(i[f]),(0===c?e<=m:t<=g)&&(s.push(h),s.push(f-1),s.push(1-c)),(0===c?m<=r:g<=n)&&(s.push(1+f),s.push(u),s.push(1-c))}}return l}within(e,t,r){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");for(var{ids:n,coords:i,nodeSize:o}=this,a=[0,n.length-1,0],s=[],l=r*r;a.length;){var c=a.pop()||0,u=a.pop()||0,h=a.pop()||0;if(u-h<=o)for(let r=h;r<=u;r++)Pc(i[2*r],i[2*r+1],e,t)<=l&&s.push(n[r]);else{var d=h+u>>1,p=i[2*d],f=i[2*d+1];Pc(p,f,e,t)<=l&&s.push(n[d]),(0===c?e-r<=p:t-r<=f)&&(a.push(h),a.push(d-1),a.push(1-c)),(0===c?p<=e+r:f<=t+r)&&(a.push(1+d),a.push(u),a.push(1-c))}}return s}},e.LineBucket=us,e.LineStripIndexArray=class extends mi{},e.LngLat=Fl,e.MercatorCoordinate=Gl,e.ONE_EM=Ss,e.OverscaledTileID=$l,e.PerformanceUtils=Yt,e.Point=o,e.Pos3dArray=class extends $n{},e.PosArray=Ai,e.Properties=Un,e.Protobuf=Ks,e.QuadTriangleArray=class extends li{},e.RGBAImage=Jo,e.RasterBoundsArray=class extends Yn{},e.RequestPerformance=class{constructor(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let e=performance.getEntriesByName(this._marks.measure);return 0===e.length&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),e=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),e}},e.SegmentVector=Vi,e.SymbolBucket=Cl,e.Transitionable=An,e.TriangleIndexArray=ji,e.Uniform1f=Ji,e.Uniform1i=class extends Qi{constructor(e,t){super(e,t),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1i(this.location,e))}},e.Uniform2f=class extends Qi{constructor(e,t){super(e,t),this.current=[0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]||(this.current=e,this.gl.uniform2f(this.location,e[0],e[1]))}},e.Uniform3f=class extends Qi{constructor(e,t){super(e,t),this.current=[0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]||(this.current=e,this.gl.uniform3f(this.location,e[0],e[1],e[2]))}},e.Uniform4f=eo,e.UniformColor=to,e.UniformMatrix4f=class extends Qi{constructor(e,t){super(e,t),this.current=ro}set(e){if(e[12]!==this.current[12]||e[0]!==this.current[0])this.current=e,this.gl.uniformMatrix4fv(this.location,!1,e);else for(let t=1;t<16;t++)if(e[t]!==this.current[t]){this.current=e,this.gl.uniformMatrix4fv(this.location,!1,e);break}}},e.UnwrappedTileID=Wl,e.ValidationError=ee,e.ZoomHistory=vn,e.__awaiter=t,e.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e},e.addDynamicAttributes=_l,e.addProtocol=function(e,t){O.REGISTERED_PROTOCOLS[e]=t},e.arrayBufferToImage=e=>new Promise(((t,r)=>{const n=new Image;n.onload=()=>{t(n),URL.revokeObjectURL(n.src),n.onload=null,window.requestAnimationFrame((()=>{n.src=I}))},n.onerror=()=>r(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));var i=new Blob([new Uint8Array(e)],{type:"image/png"});n.src=e.byteLength?URL.createObjectURL(i):I})),e.arrayBufferToImageBitmap=e=>t(void 0,void 0,void 0,(function*(){if(0===e.byteLength)return createImageBitmap(new ImageData(1,1));var t=new Blob([new Uint8Array(e)],{type:"image/png"});try{return createImageBitmap(t)}catch(t){throw new Error(`Could not load image because of ${t.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}})),e.bezier=p,e.clamp=f,e.clipLine=ic,e.clone=function(e){var t=new No(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.clone$1=b,e.clone$2=function(e){var t=new No(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},e.collisionCircleLayout=$t,e.config=O,e.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},e.create=function(){var e=new No(16);return No!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},e.create$1=zo,e.create$2=function(){var e=new No(4);return No!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},e.createAbortError=R,e.createExpression=vr,e.createFilter=Er,e.createLayout=Kn,e.createStyleLayer=function(e){if("custom"===e.type)return new Dl(e);switch(e.type){case"background":return new Ml(e);case"circle":return new Vo(e);case"fill":return new Na(e);case"fill-extrusion":return new rs(e);case"heatmap":return new ta(e);case"hillshade":return new ia(e);case"line":return new gs(e);case"raster":return new Ll(e);case"symbol":return new kl(e)}},e.cross=function(e,t,r){var n=t[0],i=t[1],o=(t=t[2],r[0]),a=r[1];return r=r[2],e[0]=i*r-t*a,e[1]=t*o-n*r,e[2]=n*a-i*o,e},e.deepEqual=function e(t,r){if(Array.isArray(t)){if(!Array.isArray(r)||t.length!==r.length)return!1;for(let n=0;n<t.length;n++)if(!e(t[n],r[n]))return!1}else{if("object"!=typeof t||null===t||null===r)return t===r;if("object"!=typeof r)return!1;if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(!e(t[n],r[n]))return!1}return!0},e.defaultEasing=a,e.degreesToRadians=function(e){return e*Math.PI/180},e.derefLayers=function(e){e=e.slice();var t=Object.create(null);for(let r=0;r<e.length;r++)t[e[r].id]=e[r];for(let r=0;r<e.length;r++)"ref"in e[r]&&(e[r]=function(e,t){const r={};for(const n in e)"ref"!==n&&(r[n]=e[n]);return K.forEach((e=>{e in t&&(r[e]=t[e])})),r}(e[r],t[e[r].ref]));return e},e.diffStyles=function(e,t){if(!e)return[{command:"setStyle",args:[t]}];let r=[];try{if(!Z(e.version,t.version))return[{command:"setStyle",args:[t]}];Z(e.center,t.center)||r.push({command:"setCenter",args:[t.center]}),Z(e.zoom,t.zoom)||r.push({command:"setZoom",args:[t.zoom]}),Z(e.bearing,t.bearing)||r.push({command:"setBearing",args:[t.bearing]}),Z(e.pitch,t.pitch)||r.push({command:"setPitch",args:[t.pitch]}),Z(e.sprite,t.sprite)||r.push({command:"setSprite",args:[t.sprite]}),Z(e.glyphs,t.glyphs)||r.push({command:"setGlyphs",args:[t.glyphs]}),Z(e.transition,t.transition)||r.push({command:"setTransition",args:[t.transition]}),Z(e.light,t.light)||r.push({command:"setLight",args:[t.light]}),Z(e.terrain,t.terrain)||r.push({command:"setTerrain",args:[t.terrain]}),Z(e.sky,t.sky)||r.push({command:"setSky",args:[t.sky]});const m={};var n=[];!function(e,t,r,n){let i;for(i in t=t||{},e=e||{})!Object.prototype.hasOwnProperty.call(e,i)||Object.prototype.hasOwnProperty.call(t,i)||Y(i,r,n);for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&(Object.prototype.hasOwnProperty.call(e,i)?Z(e[i],t[i])||("geojson"===e[i].type&&"geojson"===t[i].type&&function(e,t,r){let n;for(n in e[r])if(Object.prototype.hasOwnProperty.call(e[r],n)&&"data"!==n&&!Z(e[r][n],t[r][n]))return;for(n in t[r])if(Object.prototype.hasOwnProperty.call(t[r],n)&&"data"!==n&&!Z(e[r][n],t[r][n]))return;return 1}(e,t,i)?W(r,{command:"setGeoJSONSourceData",args:[i,t[i].data]}):(a=t,Y(o=i,s=r,n),$(o,a,s))):$(i,t,r));var o,a,s}(e.sources,t.sources,n,m);const g=[];e.layers&&e.layers.forEach((e=>{"source"in e&&m[e.source]?r.push({command:"removeLayer",args:[e.id]}):g.push(e)})),r=r.concat(n);{var i=g,o=t.layers,a=r;o=o||[];var s,l,c=(i=i||[]).map(Q),u=o.map(Q),h=i.reduce(J,{}),d=o.reduce(J,{}),p=c.slice(),f=Object.create(null);let e,n,m;for(let t=0,r=0;t<c.length;t++)e=c[t],Object.prototype.hasOwnProperty.call(d,e)?r++:(W(a,{command:"removeLayer",args:[e]}),p.splice(p.indexOf(e,r),1));for(let t=0,r=0;t<u.length;t++)e=u[u.length-1-t],p[p.length-1-t]!==e&&(Object.prototype.hasOwnProperty.call(h,e)?(W(a,{command:"removeLayer",args:[e]}),p.splice(p.lastIndexOf(e,p.length-r),1)):r++,n=p[p.length-t],W(a,{command:"addLayer",args:[d[e],n]}),p.splice(p.length-t,0,e),f[e]=!0);for(let t=0;t<u.length;t++)if(s=h[e=u[t]],l=d[e],!f[e]&&!Z(s,l))if(Z(s.source,l.source)&&Z(s["source-layer"],l["source-layer"])&&Z(s.type,l.type)){for(m in X(s.layout,l.layout,a,e,null,"setLayoutProperty"),X(s.paint,l.paint,a,e,null,"setPaintProperty"),Z(s.filter,l.filter)||W(a,{command:"setFilter",args:[e,l.filter]}),Z(s.minzoom,l.minzoom)&&Z(s.maxzoom,l.maxzoom)||W(a,{command:"setLayerZoomRange",args:[e,l.minzoom,l.maxzoom]}),s)Object.prototype.hasOwnProperty.call(s,m)&&"layout"!==m&&"paint"!==m&&"filter"!==m&&"metadata"!==m&&"minzoom"!==m&&"maxzoom"!==m&&(0===m.indexOf("paint.")?X(s[m],l[m],a,e,m.slice(6),"setPaintProperty"):Z(s[m],l[m])||W(a,{command:"setLayerProperty",args:[e,m,l[m]]}));for(m in l)Object.prototype.hasOwnProperty.call(l,m)&&!Object.prototype.hasOwnProperty.call(s,m)&&"layout"!==m&&"paint"!==m&&"filter"!==m&&"metadata"!==m&&"minzoom"!==m&&"maxzoom"!==m&&(0===m.indexOf("paint.")?X(s[m],l[m],a,e,m.slice(6),"setPaintProperty"):Z(s[m],l[m])||W(a,{command:"setLayerProperty",args:[e,m,l[m]]}))}else W(a,{command:"removeLayer",args:[e]}),W(a,{command:"addLayer",args:[l,n=p[p.lastIndexOf(e)+1]]})}}catch(e){console.warn("Unable to compute style diff:",e),r=[{command:"setStyle",args:[t]}]}return r},e.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},e.dot$1=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},e.earthRadius=zl,e.emitValidationErrors=hn,e.emptyStyle=function(){var e={},t=G.$version;for(const n in G.$root){var r=G.$root[n];if(r.required){let i=null;null!=(i="version"===n?t:"array"===r.type?[]:{})&&(e[n]=i)}}return e},e.equals=function(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5],l=e[6],c=e[7],u=e[8],h=e[9],d=e[10],p=e[11],f=e[12],m=e[13],g=e[14],y=(e=e[15],t[0]),v=t[1],_=t[2],b=t[3],w=t[4],x=t[5],C=t[6],S=t[7],E=t[8],T=t[9],I=t[10],k=t[11],A=t[12],P=t[13],M=t[14];t=t[15];return Math.abs(r-y)<=Do*Math.max(1,Math.abs(r),Math.abs(y))&&Math.abs(n-v)<=Do*Math.max(1,Math.abs(n),Math.abs(v))&&Math.abs(i-_)<=Do*Math.max(1,Math.abs(i),Math.abs(_))&&Math.abs(o-b)<=Do*Math.max(1,Math.abs(o),Math.abs(b))&&Math.abs(a-w)<=Do*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(s-x)<=Do*Math.max(1,Math.abs(s),Math.abs(x))&&Math.abs(l-C)<=Do*Math.max(1,Math.abs(l),Math.abs(C))&&Math.abs(c-S)<=Do*Math.max(1,Math.abs(c),Math.abs(S))&&Math.abs(u-E)<=Do*Math.max(1,Math.abs(u),Math.abs(E))&&Math.abs(h-T)<=Do*Math.max(1,Math.abs(h),Math.abs(T))&&Math.abs(d-I)<=Do*Math.max(1,Math.abs(d),Math.abs(I))&&Math.abs(p-k)<=Do*Math.max(1,Math.abs(p),Math.abs(k))&&Math.abs(f-A)<=Do*Math.max(1,Math.abs(f),Math.abs(A))&&Math.abs(m-P)<=Do*Math.max(1,Math.abs(m),Math.abs(P))&&Math.abs(g-M)<=Do*Math.max(1,Math.abs(g),Math.abs(M))&&Math.abs(e-t)<=Do*Math.max(1,Math.abs(e),Math.abs(t))},e.evaluateSizeForFeature=function(e,t,r){let{uSize:n,uSizeT:i}=t,{lowerSize:o,upperSize:a}=r;return"source"===e.kind?o/dl:"composite"===e.kind?Ft.number(o/dl,a/dl,i):n},e.evaluateSizeForZoom=function(e,t){let r=0,n=0;var i,o,a;return"constant"===e.kind?n=e.layoutSize:"source"!==e.kind&&(({interpolationType:a,minZoom:i,maxZoom:o}=e),a=a?f(Bt.interpolationFactor(a,t,i,o),0,1):0,"camera"===e.kind?n=Ft.number(e.minSize,e.maxSize,a):r=a),{uSizeT:r,uSize:n}},e.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]},e.extend=g,e.filterObject=_,e.findLineIntersection=function(e,t,r,n){var i=t.y-e.y,a=(t=t.x-e.x,n.y-r.y),s=a*t-(n=n.x-r.x)*i;return 0==s?null:(n=(n*(e.y-r.y)-a*(e.x-r.x))/s,new o(e.x+n*t,e.y+n*i))},e.fromRotation=function(e,t){var r=Math.sin(t);t=Math.cos(t);return e[0]=t,e[1]=r,e[2]=0,e[3]=-r,e[4]=t,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},e.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},e.getAnchorAlignment=cl,e.getAnchorJustification=Cc,e.getArrayBuffer=(e,t)=>F(g(e,{type:"arrayBuffer"}),t),e.getDefaultExportFromCjs=r,e.getImageData=function(e,r,n,i,o){return t(this,void 0,void 0,(function*(){if(d())try{return yield k(e,r,n,i,o)}catch(t){}return a=r,s=n,l=i,c=o,u=(t=e).width,h=t.height,A&&P||(A=new OffscreenCanvas(u,h),P=A.getContext("2d",{willReadFrequently:!0})),A.width=u,A.height=h,P.drawImage(t,0,0,u,h),t=P.getImageData(a,s,l,c),P.clearRect(0,0,u,h),t.data;var t,a,s,l,c,u,h}))},e.getJSON=(e,t)=>F(g(e,{type:"json"}),t),e.getOverlapMode=ml,e.getProtocol=L,e.getReferrer=z,e.getVideo=e=>{const t=window.document.createElement("video");return t.muted=!0,new Promise((r=>{t.onloadstart=()=>{r(t)};for(const i of e){var n=window.document.createElement("source");B(i)||(t.crossOrigin="Anonymous"),n.src=i,t.appendChild(n)}}))},e.groupByLayout=function(e,t){var r={};for(let o=0;o<e.length;o++){var n=t&&t[e[o].id]||Rr(e[o]);t&&(t[e[o].id]=n);let i=r[n];(i=i||(r[n]=[])).push(e[o])}var i=[];for(const o in r)i.push(r[o]);return i},e.identity=Fo,e.interpolate=Ft,e.invert=function(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],p=t[11],f=t[12],m=t[13],g=t[14],y=r*s-n*a,v=r*l-i*a,_=r*c-o*a,b=n*l-i*s,w=n*c-o*s,x=i*c-o*l,C=u*m-h*f,S=u*g-d*f,E=u*(t=t[15])-p*f,T=h*g-d*m,I=h*t-p*m,k=d*t-p*g,A=y*k-v*I+_*T+b*E-w*S+x*C;return A?(e[0]=(s*k-l*I+c*T)*(A=1/A),e[1]=(i*I-n*k-o*T)*A,e[2]=(m*x-g*w+t*b)*A,e[3]=(d*w-h*x-p*b)*A,e[4]=(l*E-a*k-c*S)*A,e[5]=(r*k-i*E+o*S)*A,e[6]=(g*_-f*x-t*v)*A,e[7]=(u*x-d*_+p*v)*A,e[8]=(a*I-s*E+c*C)*A,e[9]=(n*E-r*I-o*C)*A,e[10]=(f*w-m*_+t*y)*A,e[11]=(h*_-u*w-p*y)*A,e[12]=(s*S-a*T-l*C)*A,e[13]=(r*T-n*S+i*C)*A,e[14]=(m*v-f*b-g*y)*A,e[15]=(u*b-h*v+d*y)*A,e):null},e.isAbortError=function(e){return e.message===M},e.isImageBitmap=T,e.isOffscreenCanvasDistorted=d,e.isSafari=function(e){var t;return null==E&&(t=e.navigator?e.navigator.userAgent:null,E=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))),E},e.isWorker=S,e.keysDifference=function(e,t){var r=[];for(const n in e)n in t||r.push(n);return r},e.makeRequest=F,e.mapObject=v,e.mercatorXfromLng=jl,e.mercatorYfromLat=ql,e.mercatorZfromAltitude=Hl,e.mul=Wt,e.mul$1=function(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e},e.multiply=Bo,e.nextPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},e.normalize=function(e,t){var r=t[0],n=t[1],i=t[2];return 0<(r=r*r+n*n+i*i)&&(r=1/Math.sqrt(r)),e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},e.offscreenCanvasSupported=h,e.ortho=function(e,t,r,n,i,o,a){var s=1/(t-r),l=1/(n-i),c=1/(o-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+r)*s,e[13]=(i+n)*l,e[14]=(a+o)*c,e[15]=1,e},e.parseCacheControl=function(e){const t={};return e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((e,r,n,i)=>(n=n||i,t[r]=!n||n.toLowerCase(),""))),t["max-age"]&&(e=parseInt(t["max-age"],10),isNaN(e)?delete t["max-age"]:t["max-age"]=e),t},e.parseGlyphPbf=function(e){return new Ks(e).readFields(Zs,[])},e.pbf=Zt,e.performSymbolLayout=function(t){t.bucket.createArrays();var r,n,i=512*t.bucket.overscaling,o=(t.bucket.tilePixelRatio=fo/i,t.bucket.compareText={},t.bucket.iconsNeedLinear=!1,t.bucket.layers[0]),a=o.layout,s={layoutIconSize:(i=o._unevaluatedLayout._values)["icon-size"].possiblyEvaluate(new Tn(t.bucket.zoom+1),t.canonical),layoutTextSize:i["text-size"].possiblyEvaluate(new Tn(t.bucket.zoom+1),t.canonical),textMaxSize:i["text-size"].possiblyEvaluate(new Tn(18))};"composite"===t.bucket.textSizeData.kind&&(({minZoom:r,maxZoom:n}=t.bucket.textSizeData),s.compositeTextSizes=[i["text-size"].possiblyEvaluate(new Tn(r),t.canonical),i["text-size"].possiblyEvaluate(new Tn(n),t.canonical)]),"composite"===t.bucket.iconSizeData.kind&&(({minZoom:r,maxZoom:n}=t.bucket.iconSizeData),s.compositeIconSizes=[i["icon-size"].possiblyEvaluate(new Tn(r),t.canonical),i["icon-size"].possiblyEvaluate(new Tn(n),t.canonical)]);const l=a.get("text-line-height")*Ss;var c="viewport"!==a.get("text-rotation-alignment")&&"point"!==a.get("symbol-placement"),u=a.get("text-keep-upright"),h=a.get("text-size");for(const v of t.bucket.features){const r=a.get("text-font").evaluate(v,{},t.canonical).join(","),n=h.evaluate(v,{},t.canonical),i=s.layoutTextSize.evaluate(v,{},t.canonical);var d=s.layoutIconSize.evaluate(v,{},t.canonical);const _={horizontal:{},vertical:void 0},b=v.text;let w=[0,0];if(b){const s=b.toString();var p=a.get("text-letter-spacing").evaluate(v,{},t.canonical)*Ss;const h=wn(s)?p:0,d=a.get("text-anchor").evaluate(v,{},t.canonical);var f=xc(o,v,t.canonical);f||(p=a.get("text-radial-offset").evaluate(v,{},t.canonical),w=p?wc(d,[p*Ss,bc]):a.get("text-offset").evaluate(v,{},t.canonical).map((e=>e*Ss)));let x=c?"center":a.get("text-justify").evaluate(v,{},t.canonical);const C=a.get("symbol-placement"),S="point"===C?a.get("text-max-width").evaluate(v,{},t.canonical)*Ss:0;if(p=()=>{t.bucket.allowVerticalPlacement&&bn(s)&&(_.vertical=rl(b,t.glyphMap,t.glyphPositions,t.imagePositions,r,S,l,d,"left",h,w,e.WritingMode.vertical,!0,C,i,n))},!c&&f){var m,g=new Set;if("auto"===x)for(let e=0;e<f.values.length;e+=2)g.add(Cc(f.values[e]));else g.add(x);let o=!1;for(const a of g)_.horizontal[a]||(o?_.horizontal[a]=_.horizontal[0]:(m=rl(b,t.glyphMap,t.glyphPositions,t.imagePositions,r,S,l,"center",a,h,w,e.WritingMode.horizontal,!1,C,i,n))&&(_.horizontal[a]=m,o=1===m.positionedLines.length));p()}else{"auto"===x&&(x=Cc(d));var y=rl(b,t.glyphMap,t.glyphPositions,t.imagePositions,r,S,l,d,x,h,w,e.WritingMode.horizontal,!1,C,i,n);y&&(_.horizontal[x]=y),p(),bn(s)&&c&&u&&(_.vertical=rl(b,t.glyphMap,t.glyphPositions,t.imagePositions,r,S,l,d,x,h,w,e.WritingMode.vertical,!1,C,i,n))}}let C,S=!1;v.icon&&v.icon.name&&(y=t.imageMap[v.icon.name])&&(C=function(e,t,r){var{horizontalAlign:r,verticalAlign:n}=cl(r),i=t[0];t=t[1],r=(i-=e.displaySize[0]*r)+e.displaySize[0];return{image:e,top:t=t-e.displaySize[1]*n,bottom:t+e.displaySize[1],left:i,right:r}}(t.imagePositions[v.icon.name],a.get("icon-offset").evaluate(v,{},t.canonical),a.get("icon-anchor").evaluate(v,{},t.canonical)),S=!!y.sdf,void 0===t.bucket.sdfIcons?t.bucket.sdfIcons=S:t.bucket.sdfIcons!==S&&x("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),y.pixelRatio!==t.bucket.pixelRatio||0!==a.get("icon-rotate").constantOr(1))&&(t.bucket.iconsNeedLinear=!0),p=Ec(_.horizontal)||_.vertical,t.bucket.iconsInText=!!p&&p.iconsInText,(p||C)&&function(t,r,n,i,o,a,s,l,c,u,h){let d=a.textMaxSize.evaluate(r,{});void 0===d&&(d=s);const p=t.layers[0].layout,f=p.get("icon-offset").evaluate(r,{},h),m=Ec(n.horizontal),g=s/24,y=t.tilePixelRatio*g,v=t.tilePixelRatio*d/24,_=t.tilePixelRatio*l,b=t.tilePixelRatio*p.get("symbol-spacing"),w=p.get("text-padding")*t.tilePixelRatio,C=function(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return[(t=(e=e.get("icon-padding").evaluate(t,{},r))&&e.values)[0]*n,t[1]*n,t[2]*n,t[3]*n]}(p,r,h,t.tilePixelRatio),S=p.get("text-max-angle")/180*Math.PI,E="viewport"!==p.get("text-rotation-alignment")&&"point"!==p.get("symbol-placement"),T="map"===p.get("icon-rotation-alignment")&&"point"!==p.get("symbol-placement"),I=p.get("symbol-placement"),k=b/2,A=p.get("icon-text-fit");let P;i&&"none"!==A&&(t.allowVerticalPlacement&&n.vertical&&(P=hl(i,n.vertical,A,p.get("icon-text-fit-padding"),f,g)),m)&&(i=hl(i,m,A,p.get("icon-text-fit-padding"),f,g));var M=(l,d)=>{if(!(d.x<0||d.x>=fo||d.y<0||d.y>=fo)){var p=t,m=d;d=l;var g=n;l=i;var v=o,b=P,S=t.layers[0],I=t.collisionBoxArray,k=r.index,A=r.sourceLayerIndex,M=t.index,R=y,O=[w,w,w,w],L=E,D=c,N=_,z=C,F=T,B=f,U=r,j=a,q=u,H=h,V=s,G=p.addToLineVertexArray(m,d);let J,ee,te,re,ne=0,ie=0,oe=0,ae=0,se=-1,le=-1;var K={};let ce=Zi("");if(p.allowVerticalPlacement&&g.vertical&&(d=S.layout.get("text-rotate").evaluate(U,{},H)+90,Z=g.vertical,te=new fc(I,m,k,A,M,Z,R,O,L,d),b)&&(re=new fc(I,m,k,A,M,b,N,z,L,d)),l){var Z=S.layout.get("icon-rotate").evaluate(U,{}),W=hc(l,Z,q,d="none"!==S.layout.get("icon-text-fit"));b=b?hc(b,Z,q,d):void 0;let t=null;"source"===(q=(ee=new fc(I,m,k,A,M,l,N,z,!1,Z),ne=4*W.length,p.iconSizeData)).kind?(t=[dl*S.layout.get("icon-size").evaluate(U,{})])[0]>pl&&x(`${p.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`):"composite"===q.kind&&((t=[dl*j.compositeIconSizes[0].evaluate(U,{},H),dl*j.compositeIconSizes[1].evaluate(U,{},H)])[0]>pl||t[1]>pl)&&x(`${p.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`),p.addSymbols(p.icon,W,t,B,F,U,e.WritingMode.none,m,G.lineStartIndex,G.lineLength,-1,H),se=p.icon.placedSymbolArray.length-1,b&&(ie=4*b.length,p.addSymbols(p.icon,b,t,B,F,U,e.WritingMode.vertical,m,G.lineStartIndex,G.lineLength,-1,H),le=p.icon.placedSymbolArray.length-1)}var $=Object.keys(g.horizontal);for(const t of $){var Y=g.horizontal[t],X=(J||(ce=Zi(Y.text),X=S.layout.get("text-rotate").evaluate(U,{},H),J=new fc(I,m,k,A,M,Y,R,O,L,X)),1===Y.positionedLines.length);if(oe+=Sc(p,m,Y,v,S,L,U,D,G,g.vertical?e.WritingMode.horizontal:e.WritingMode.horizontalOnly,X?$:[t],K,se,j,H),X)break}g.vertical&&(ae+=Sc(p,m,g.vertical,v,S,L,U,D,G,e.WritingMode.vertical,["vertical"],K,le,j,H)),d=J?J.boxStartIndex:p.collisionBoxArray.length,l=J?J.boxEndIndex:p.collisionBoxArray.length,N=te?te.boxStartIndex:p.collisionBoxArray.length,z=te?te.boxEndIndex:p.collisionBoxArray.length,q=ee?ee.boxStartIndex:p.collisionBoxArray.length,W=ee?ee.boxEndIndex:p.collisionBoxArray.length,b=re?re.boxStartIndex:p.collisionBoxArray.length,B=re?re.boxEndIndex:p.collisionBoxArray.length;let ue=-1;F=(e,t)=>e&&e.circleDiameter?Math.max(e.circleDiameter,t):t,ue=F(J,ue),ue=F(te,ue),ue=F(ee,ue),(F=-1<(ue=F(re,ue))?1:0)&&(ue*=V/Ss),p.glyphOffsetArray.length>=Cl.MAX_GLYPHS&&x("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==U.sortKey&&p.addToSortKeyRanges(p.symbolInstances.length,U.sortKey);V=xc(S,U,H);var[V,Q]=function(t,r){var n=t.length,i=null==r?void 0:r.values;if(0<(null==i?void 0:i.length))for(let s=0;s<i.length;s+=2){var o=e.TextAnchorEnum[i[s]],a=i[s+1];t.emplaceBack(o,a[0],a[1])}return[n,t.length]}(p.textAnchorOffsets,V);p.symbolInstances.emplaceBack(m.x,m.y,0<=K.right?K.right:-1,0<=K.center?K.center:-1,0<=K.left?K.left:-1,K.vertical||-1,se,le,ce,d,l,N,z,q,W,b,B,k,oe,ae,ne,ie,F,0,R,ue,V,Q)}};if("line"===I)for(const e of ic(r.geometry,0,0,fo,fo))for(const r of uc(e,b,S,n.vertical||m,i,24,v,t.overscaling,fo))m&&function(e,t,r,n){if(t in(e=e.compareText)){var i=e[t];for(let e=i.length-1;0<=e;e--)if(n.dist(i[e])<r)return 1}else e[t]=[];return e[t].push(n),0}(t,m.text,k,r)||M(e,r);else if("line-center"===I)for(const e of r.geometry){var R;1<e.length&&(R=function(e,t,r,n,i,o){var a=lc(r,24,o),s=cc(r,n)*o;let l=0;var c=sc(e)/2;for(let m=0;m<e.length-1;m++){var u,h,d=e[m],p=e[m+1],f=d.dist(p);if(l+f>c)return u=(c-l)/f,h=Ft.number(d.x,p.x,u),u=Ft.number(d.y,p.y,u),(h=new oc(h,u,p.angleTo(d),m))._round(),!a||ac(e,h,s,a,t)?h:void 0;l+=f}}(e,S,n.vertical||m,i,0,v))&&M(e,R)}else if("Polygon"===r.type)for(const e of ka(r.geometry,0)){var O=yc(e,16);M(e[0],new oc(O.x,O.y,0))}else if("LineString"===r.type)for(const e of r.geometry)M(e,new oc(e[0].x,e[0].y,0));else if("Point"===r.type)for(const e of r.geometry)for(const t of e)M([t],new oc(t.x,t.y,0))}(t.bucket,v,_,C,t.imageMap,s,i,d,w,S,t.canonical)}t.showCollisionBoxes&&t.bucket.generateCollisionDebugBuffers()},e.perspective=function(e,t,r,n,i){return t=1/Math.tan(t/2),e[0]=t/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0?(e[10]=(i+n)*(r=1/(n-i)),e[14]=2*i*n*r):(e[10]=-1,e[14]=-2*n),e},e.pick=function(e,t){var r={};for(let i=0;i<t.length;i++){var n=t[i];n in e&&(r[n]=e[n])}return r},e.pointGeometry=n,e.polygonIntersectsPolygon=wo,e.potpack=Ys,e.readImageUsingVideoFrame=k,e.register=fn,e.removeProtocol=function(e){delete O.REGISTERED_PROTOCOLS[e]},e.renderColorRamp=ea,e.renderStyleImage=function(e){var t=e.userImage;return!!(t&&t.render&&t.render())&&(e.data.replace(new Uint8Array(t.data.buffer)),!0)},e.rotate=function(e,t,r){var n=t[0],i=t[1],o=t[2],a=(t=t[3],Math.sin(r));r=Math.cos(r);return e[0]=n*r+o*a,e[1]=i*r+t*a,e[2]=n*-a+o*r,e[3]=i*-a+t*r,e},e.rotateX=function(e,t,r){var n=Math.sin(r),i=(r=Math.cos(r),t[4]),o=t[5],a=t[6],s=t[7],l=t[8],c=t[9],u=t[10],h=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=i*r+l*n,e[5]=o*r+c*n,e[6]=a*r+u*n,e[7]=s*r+h*n,e[8]=l*r-i*n,e[9]=c*r-o*n,e[10]=u*r-a*n,e[11]=h*r-s*n,e},e.rotateZ=function(e,t,r){var n=Math.sin(r),i=(r=Math.cos(r),t[0]),o=t[1],a=t[2],s=t[3],l=t[4],c=t[5],u=t[6],h=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=i*r+l*n,e[1]=o*r+c*n,e[2]=a*r+u*n,e[3]=s*r+h*n,e[4]=l*r-i*n,e[5]=c*r-o*n,e[6]=u*r-a*n,e[7]=h*r-s*n,e},e.rtlWorkerPlugin=En,e.sameOrigin=B,e.scale=function(e,t,r){var n=r[0],i=r[1];r=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},e.scale$1=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},e.sphericalToCartesian=function(e){let[t,r,n]=e;return r=(r+=90)*(Math.PI/180),n*=Math.PI/180,{x:t*Math.cos(r)*Math.sin(n),y:t*Math.sin(r)*Math.sin(n),z:t*Math.cos(n)}},e.sqrLen=function(e){var t=e[0];return t*t+(e=e[1])*e},e.sub=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e},e.toEvaluationFeature=vo,e.transformMat3=function(e,t,r){var n=t[0],i=t[1];t=t[2];return e[0]=n*r[0]+i*r[3]+t*r[6],e[1]=n*r[1]+i*r[4]+t*r[7],e[2]=n*r[2]+i*r[5]+t*r[8],e},e.transformMat4=qo,e.transformMat4$1=function(e,t,r){var n=t[0];t=t[1];return e[0]=r[0]*n+r[4]*t+r[12],e[1]=r[1]*n+r[5]*t+r[13],e},e.translate=function(e,t,r){var n,i,o,a,s,l,c,u,h,d,p,f,m=r[0],g=r[1];r=r[2];return t===e?(e[12]=t[0]*m+t[4]*g+t[8]*r+t[12],e[13]=t[1]*m+t[5]*g+t[9]*r+t[13],e[14]=t[2]*m+t[6]*g+t[10]*r+t[14],e[15]=t[3]*m+t[7]*g+t[11]*r+t[15]):(n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=t[9],p=t[10],f=t[11],e[0]=n,e[1]=i,e[2]=o,e[3]=a,e[4]=s,e[5]=l,e[6]=c,e[7]=u,e[8]=h,e[9]=d,e[10]=p,e[11]=f,e[12]=n*m+s*g+h*r+t[12],e[13]=i*m+l*g+d*r+t[13],e[14]=o*m+c*g+p*r+t[14],e[15]=a*m+u*g+f*r+t[15]),e},e.unicodeBlockLookup=_n,e.uniqueId=function(){return y++},e.v8Spec=G,e.validateCustomStyleLayer=function(e){var t=[],r=e.id;return void 0===r&&t.push({message:`layers.${r}: missing required property "id"`}),void 0===e.render&&t.push({message:`layers.${r}: missing required method "render"`}),e.renderingMode&&"2d"!==e.renderingMode&&"3d"!==e.renderingMode&&t.push({message:`layers.${r}: property "renderingMode" must be either "2d" or "3d"`}),t},e.validateLight=Ot,e.validateStyle=ln,e.vectorTile=Ba,e.warnOnce=x,e.wrap=m})),r("worker",0,(function(e){class t{constructor(e){this.keyCache={},e&&this.replace(e)}replace(e){this._layerConfigs={},this._layers={},this.update(e,[])}update(t,r){for(const s of t){this._layerConfigs[s.id]=s;var n=this._layers[s.id]=e.createStyleLayer(s);n._featureFilter=e.createFilter(n.filter),this.keyCache[s.id]&&delete this.keyCache[s.id]}for(const e of r)delete this.keyCache[e],delete this._layerConfigs[e],delete this._layers[e];this.familiesBySource={};for(const s of e.groupByLayout(Object.values(this._layerConfigs),this.keyCache)){var i=s.map((e=>this._layers[e.id])),o=i[0];if("none"!==o.visibility){var a=o.source||"";let e=this.familiesBySource[a];e=e||(this.familiesBySource[a]={});let t=e[a=o.sourceLayer||"_geojsonTileLayer"];(t=t||(e[a]=[])).push(i)}}}}class r{constructor(t){var r={},n=[];for(const e in t){var i=t[e],o=r[e]={};for(const e in i){var a,s=i[+e];s&&0!==s.bitmap.width&&0!==s.bitmap.height&&(a={x:0,y:0,w:s.bitmap.width+2,h:s.bitmap.height+2},n.push(a),o[e]={rect:a,metrics:s.metrics})}}var{w:l,h:c}=e.potpack(n),u=new e.AlphaImage({width:l||1,height:c||1});for(const f in t){var h=t[f];for(const t in h){var d,p=h[+t];p&&0!==p.bitmap.width&&0!==p.bitmap.height&&(d=r[f][t].rect,e.AlphaImage.copy(p.bitmap,u,{x:0,y:0},{x:d.x+1,y:d.y+1},p.bitmap))}}this.image=u,this.positions=r}}e.register("GlyphAtlas",r);class n{constructor(t){this.tileID=new e.OverscaledTileID(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.uid=t.uid,this.zoom=t.zoom,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.returnDependencies=!!t.returnDependencies,this.promoteId=t.promoteId,this.inFlightDependencies=[]}parse(t,n,o,a){return e.__awaiter(this,void 0,void 0,(function*(){this.status="parsing",this.data=t,this.collisionBoxArray=new e.CollisionBoxArray;var s=new e.DictionaryCoder(Object.keys(t.layers).sort()),l=new e.FeatureIndex(this.tileID,this.promoteId),c=(l.bucketLayerIDs=[],{}),u={featureIndex:l,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:o},h=n.familiesBySource[this.source];for(const r in h){var d=t.layers[r];if(d){1===d.version&&e.warnOnce(`Vector tile source "${this.source}" layer "${r}" does not use vector tile spec v2 and therefore may have some rendering errors.`);var p=s.encode(r),f=[];for(let e=0;e<d.length;e++){var m=d.feature(e),g=l.getId(m,r);f.push({feature:m,id:g,index:e,sourceLayerIndex:p})}for(const t of h[r]){var y=t[0];y.source!==this.source&&e.warnOnce(`layer.source = ${y.source} does not equal this.source = `+this.source),y.minzoom&&this.zoom<Math.floor(y.minzoom)||y.maxzoom&&this.zoom>=y.maxzoom||"none"!==y.visibility&&(i(t,this.zoom,o),(c[y.id]=y.createBucket({index:l.bucketLayerIDs.length,layers:t,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:p,sourceID:this.source})).populate(f,u,this.tileID.canonical),l.bucketLayerIDs.push(t.map((e=>e.id))))}}}var v=e.mapObject(u.glyphDependencies,(e=>Object.keys(e).map(Number)));this.inFlightDependencies.forEach((e=>null==e?void 0:e.abort())),this.inFlightDependencies=[];let _=Promise.resolve({});Object.keys(v).length&&(w=new AbortController,this.inFlightDependencies.push(w),_=a.sendAsync({type:"GG",data:{stacks:v,source:this.source,tileID:this.tileID,type:"glyphs"}},w)),v=Object.keys(u.iconDependencies);let b=Promise.resolve({});v.length&&(w=new AbortController,this.inFlightDependencies.push(w),b=a.sendAsync({type:"GI",data:{icons:v,source:this.source,tileID:this.tileID,type:"icons"}},w));var w;v=Object.keys(u.patternDependencies);let x=Promise.resolve({});v.length&&(w=new AbortController,this.inFlightDependencies.push(w),x=a.sendAsync({type:"GI",data:{icons:v,source:this.source,tileID:this.tileID,type:"patterns"}},w));var[C,S,v]=yield Promise.all([_,b,x]),E=new r(C),T=new e.ImageAtlas(S,v);for(const t in c){var I=c[t];I instanceof e.SymbolBucket?(i(I.layers,this.zoom,o),e.performSymbolLayout({bucket:I,glyphMap:C,glyphPositions:E.positions,imageMap:S,imagePositions:T.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):I.hasPattern&&(I instanceof e.LineBucket||I instanceof e.FillBucket||I instanceof e.FillExtrusionBucket)&&(i(I.layers,this.zoom,o),I.addFeatures(u,this.tileID.canonical,T.patternPositions))}return this.status="done",{buckets:Object.values(c).filter((e=>!e.isEmpty())),featureIndex:l,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:E.image,imageAtlas:T,glyphMap:this.returnDependencies?C:null,iconMap:this.returnDependencies?S:null,glyphPositions:this.returnDependencies?E.positions:null}}))}}function i(t,r,n){var i=new e.EvaluationParameters(r);for(const e of t)e.recalculate(i,n)}class o{constructor(e,t,r){this.actor=e,this.layerIndex=t,this.availableImages=r,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(t,r){return e.__awaiter(this,void 0,void 0,(function*(){var n=yield e.getArrayBuffer(t.request,r);try{return{vectorTile:new e.vectorTile.VectorTile(new e.Protobuf(n.data)),rawData:n.data,cacheControl:n.cacheControl,expires:n.expires}}catch(r){n=31===(n=new Uint8Array(n.data))[0]&&139===n[1];let i=`Unable to parse the tile at ${t.request.url}, `;throw i+=n?"please make sure the data is not gzipped and that you have configured the relevant header in the server":"got error: "+r.messge,new Error(i)}}))}loadTile(t){return e.__awaiter(this,void 0,void 0,(function*(){var r=t.uid,i=!!(t&&t.request&&t.request.collectResourceTiming)&&new e.RequestPerformance(t.request),o=new n(t),a=(this.loading[r]=o,new AbortController);o.abort=a;try{var s=yield this.loadVectorTile(t,a);if(delete this.loading[r],!s)return null;var l,c=s.rawData,u={},h=(s.expires&&(u.expires=s.expires),s.cacheControl&&(u.cacheControl=s.cacheControl),{}),d=(i&&(l=i.finish())&&(h.resourceTiming=JSON.parse(JSON.stringify(l))),o.vectorTile=s.vectorTile,o.parse(s.vectorTile,this.layerIndex,this.availableImages,this.actor));this.loaded[r]=o,this.fetching[r]={rawTileData:c,cacheControl:u,resourceTiming:h};try{var p=yield d;return e.extend({rawTileData:c.slice(0)},p,u,h)}finally{delete this.fetching[r]}}catch(i){throw delete this.loading[r],o.status="done",this.loaded[r]=o,i}}))}reloadTile(t){return e.__awaiter(this,void 0,void 0,(function*(){var r=t.uid;if(!this.loaded||!this.loaded[r])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");var n=this.loaded[r];if(n.showCollisionBoxes=t.showCollisionBoxes,"parsing"===n.status){var i,o,a,s=yield n.parse(n.vectorTile,this.layerIndex,this.availableImages,this.actor);let t;return t=this.fetching[r]?(({rawTileData:i,cacheControl:o,resourceTiming:a}=this.fetching[r]),delete this.fetching[r],e.extend({rawTileData:i.slice(0)},s,o,a)):s}if("done"===n.status&&n.vectorTile)return n.parse(n.vectorTile,this.layerIndex,this.availableImages,this.actor)}))}abortTile(t){return e.__awaiter(this,void 0,void 0,(function*(){var e=this.loading,r=t.uid;e&&e[r]&&e[r].abort&&(e[r].abort.abort(),delete e[r])}))}removeTile(t){return e.__awaiter(this,void 0,void 0,(function*(){this.loaded&&this.loaded[t.uid]&&delete this.loaded[t.uid]}))}}class a{constructor(){this.loaded={}}loadTile(t){return e.__awaiter(this,void 0,void 0,(function*(){var{uid:r,encoding:n,rawImageData:i,redFactor:o,greenFactor:a,blueFactor:s,baseShift:l}=t,c=i.width+2,u=i.height+2;c=e.isImageBitmap(i)?new e.RGBAImage({width:c,height:u},yield e.getImageData(i,-1,-1,c,u)):i,u=new e.DEMData(r,c,n,o,a,s,l);return this.loaded=this.loaded||{},this.loaded[r]=u}))}removeTile(e){var t=this.loaded;e=e.uid;t&&t[e]&&delete t[e]}}function s(e,t){if(0!==e.length){l(e[0],t);for(var r=1;r<e.length;r++)l(e[r],!t)}}function l(e,t){for(var r=0,n=0,i=0,o=e.length,a=o-1;i<o;a=i++){var s=(e[i][0]-e[a][0])*(e[a][1]+e[i][1]),l=r+s;n+=Math.abs(r)>=Math.abs(s)?r-l+s:s-l+r,r=l}0<=r+n!=!!t&&e.reverse()}var c=e.getDefaultExportFromCjs((function e(t,r){var n,i=t&&t.type;if("FeatureCollection"===i)for(n=0;n<t.features.length;n++)e(t.features[n],r);else if("GeometryCollection"===i)for(n=0;n<t.geometries.length;n++)e(t.geometries[n],r);else if("Feature"===i)e(t.geometry,r);else if("Polygon"===i)s(t.coordinates,r);else if("MultiPolygon"===i)for(n=0;n<t.coordinates.length;n++)s(t.coordinates[n],r);return t}));const u=e.vectorTile.VectorTileFeature.prototype.toGeoJSON;let h=class{constructor(t){this._feature=t,this.extent=e.EXTENT,this.type=t.type,this.properties=t.tags,"id"in t&&!isNaN(t.id)&&(this.id=parseInt(t.id,10))}loadGeometry(){if(1===this._feature.type){var t=[];for(const r of this._feature.geometry)t.push([new e.Point(r[0],r[1])]);return t}var r=[];for(const i of this._feature.geometry){var n=[];for(const t of i)n.push(new e.Point(t[0],t[1]));r.push(n)}return r}toGeoJSON(e,t,r){return u.call(this,e,t,r)}},d=class{constructor(t){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=e.EXTENT,this.length=t.length,this._features=t}feature(e){return new h(this._features[e])}};var p={exports:{}},f=e.pointGeometry,m=e.vectorTile.VectorTileFeature,g=y;function y(e,t){this.options=t||{},this.features=e,this.length=e.length}function v(e,t){this.id="number"==typeof e.id?e.id:void 0,this.type=e.type,this.rawGeometry=1===e.type?[e.geometry]:e.geometry,this.properties=e.tags,this.extent=t||4096}y.prototype.feature=function(e){return new v(this.features[e],this.options.extent)},v.prototype.loadGeometry=function(){var e=this.rawGeometry;this.geometry=[];for(var t=0;t<e.length;t++){for(var r=e[t],n=[],i=0;i<r.length;i++)n.push(new f(r[i][0],r[i][1]));this.geometry.push(n)}return this.geometry},v.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var e=this.geometry,t=1/0,r=-1/0,n=1/0,i=-1/0,o=0;o<e.length;o++)for(var a=e[o],s=0;s<a.length;s++){var l=a[s];t=Math.min(t,l.x),r=Math.max(r,l.x),n=Math.min(n,l.y),i=Math.max(i,l.y)}return[t,n,r,i]},v.prototype.toGeoJSON=m.prototype.toGeoJSON;var _=e.pbf,b=g;function w(e){var t,r=new _,n=e,i=r;for(t in n.layers)i.writeMessage(3,x,n.layers[t]);return r.finish()}function x(e,t){t.writeVarintField(15,e.version||1),t.writeStringField(1,e.name||""),t.writeVarintField(5,e.extent||4096);for(var r={keys:[],values:[],keycache:{},valuecache:{}},n=0;n<e.length;n++)r.feature=e.feature(n),t.writeMessage(2,C,r);var i=r.keys;for(n=0;n<i.length;n++)t.writeStringField(3,i[n]);var o=r.values;for(n=0;n<o.length;n++)t.writeMessage(4,k,o[n])}function C(e,t){var r=e.feature;void 0!==r.id&&t.writeVarintField(1,r.id),t.writeMessage(2,S,e),t.writeVarintField(3,r.type),t.writeMessage(4,I,r)}function S(e,t){var r,n=e.feature,i=e.keys,o=e.values,a=e.keycache,s=e.valuecache;for(r in n.properties){var l,c=n.properties[r],u=a[r];null!==c&&(void 0===u&&(i.push(r),u=i.length-1,a[r]=u),t.writeVarint(u),void 0===(l=s[u=(u=typeof c)+":"+(c="string"!=u&&"boolean"!=u&&"number"!=u?JSON.stringify(c):c)])&&(o.push(c),l=o.length-1,s[u]=l),t.writeVarint(l))}}function E(e,t){return(t<<3)+(7&e)}function T(e){return e<<1^e>>31}function I(e,t){for(var r=e.loadGeometry(),n=e.type,i=0,o=0,a=r.length,s=0;s<a;s++){for(var l=r[s],c=1,u=(1===n&&(c=l.length),t.writeVarint(E(1,c)),3===n?l.length-1:l.length),h=0;h<u;h++){1===h&&1!==n&&t.writeVarint(E(2,u-1));var d=l[h].x-i,p=l[h].y-o;t.writeVarint(T(d)),t.writeVarint(T(p)),i+=d,o+=p}3===n&&t.writeVarint(15)}}function k(e,t){var r=typeof e;"string"==r?t.writeStringField(1,e):"boolean"==r?t.writeBooleanField(7,e):"number"==r&&(e%1!=0?t.writeDoubleField(3,e):e<0?t.writeSVarintField(6,e):t.writeVarintField(5,e))}p.exports=w,p.exports.fromVectorTileJs=w,p.exports.fromGeojsonVt=function(e,t){t=t||{};var r,n={};for(r in e)n[r]=new b(e[r].features,t),n[r].name=r,n[r].version=t.version,n[r].extent=t.extent;return w({layers:n})},p.exports.GeoJSONWrapper=b;var A,P=e.getDefaultExportFromCjs(p.exports);const M={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:e=>e},R=Math.fround||(A=new Float32Array(1),e=>(A[0]=+e,A[0]));class O{constructor(e){this.options=Object.assign(Object.create(M),e),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(e){var{log:t,minZoom:r,maxZoom:n}=this.options,i=(t&&console.time("total time"),`prepare ${e.length} points`),o=(t&&console.time(i),this.points=e,[]);for(let u=0;u<e.length;u++){var a,s=e[u];s.geometry&&([s,a]=s.geometry.coordinates,s=R(N(s)),a=R(z(a)),o.push(s,a,1/0,u,-1,1),this.options.reduce)&&o.push(0)}let l=this.trees[n+1]=this._createTree(o);t&&console.timeEnd(i);for(let u=n;u>=r;u--){var c=+Date.now();l=this.trees[u]=this._createTree(this._cluster(l,u)),t&&console.log("z%d: %d clusters in %dms",u,l.numItems,+Date.now()-c)}return t&&console.timeEnd("total time"),this}getClusters(e,t){let r=((e[0]+180)%360+360)%360-180;var n=Math.max(-90,Math.min(90,e[1]));let i=180===e[2]?180:((e[2]+180)%360+360)%360-180;var o=Math.max(-90,Math.min(90,e[3]));if(360<=e[2]-e[0])r=-180,i=180;else if(r>i)return e=this.getClusters([r,n,180,o],t),a=this.getClusters([-180,n,i,o],t),e.concat(a);var a=(e=this.trees[this._limitZoom(t)]).range(N(r),z(o),N(i),z(n)),s=e.data,l=[];for(const u of a){var c=this.stride*u;l.push(1<s[c+5]?L(s,c,this.clusterProps):this.points[s[c+3]])}return l}getChildren(e){var t=this._getOriginId(e),r=this._getOriginZoom(e),n="No cluster with the specified id.",i=this.trees[r];if(!i)throw new Error(n);var o=i.data;if(t*this.stride>=o.length)throw new Error(n);r=this.options.radius/(this.options.extent*Math.pow(2,r-1));var a=o[t*this.stride],s=(t=o[t*this.stride+1],[]);for(const c of i.within(a,t,r)){var l=c*this.stride;o[4+l]===e&&s.push(1<o[l+5]?L(o,l,this.clusterProps):this.points[o[l+3]])}if(0===s.length)throw new Error(n);return s}getLeaves(e,t,r){var n=[];return this._appendLeaves(n,e,t=t||10,r=r||0,0),n}getTile(e,t,r){var n,i=this.trees[this._limitZoom(e)],{extent:o,radius:n}=(e=Math.pow(2,e),this.options),o=(r-(n=n/o))/e,a=(r+1+n)/e,s={features:[]};return this._addTileFeatures(i.range((t-n)/e,o,(t+1+n)/e,a),i.data,t,r,e,s),0===t&&this._addTileFeatures(i.range(1-n/e,o,1,a),i.data,e,r,e,s),t===e-1&&this._addTileFeatures(i.range(0,o,n/e,a),i.data,-1,r,e,s),s.features.length?s:null}getClusterExpansionZoom(e){let t=this._getOriginZoom(e)-1;for(;t<=this.options.maxZoom;){var r=this.getChildren(e);if(t++,1!==r.length)break;e=r[0].properties.cluster_id}return t}_appendLeaves(e,t,r,n,i){for(const a of this.getChildren(t)){var o=a.properties;if(o&&o.cluster?i+o.point_count<=n?i+=o.point_count:i=this._appendLeaves(e,o.cluster_id,r,n,i):i<n?i++:e.push(a),e.length===r)break}return i}_createTree(t){var r=new e.KDBush(t.length/this.stride|0,this.options.nodeSize,Float32Array);for(let e=0;e<t.length;e+=this.stride)r.add(t[e],t[e+1]);return r.finish(),r.data=t,r}_addTileFeatures(e,t,r,n,i,o){for(const u of e){var a,s=u*this.stride,l=1<t[s+5];let e,h,d;d=l?(e=D(t,s,this.clusterProps),h=t[s],t[1+s]):(c=this.points[t[s+3]],[c,a]=(e=c.properties,c.geometry.coordinates),h=N(c),z(a));var c={type:1,geometry:[[Math.round(this.options.extent*(h*i-r)),Math.round(this.options.extent*(d*i-n))]],tags:e};let p;void 0!==(p=l||this.options.generateId?t[s+3]:this.points[t[s+3]].id)&&(c.id=p),o.features.push(c)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,t){var{radius:r,extent:n,reduce:i,minPoints:o}=this.options,a=r/(n*Math.pow(2,t)),s=e.data,l=[],c=this.stride;for(let _=0;_<s.length;_+=c)if(!(s[_+2]<=t)){s[_+2]=t;var u=s[_],h=s[_+1],d=e.within(s[_],s[_+1],a),p=s[_+5];let r=p;for(const e of d){var f=e*c;s[2+f]>t&&(r+=s[f+5])}if(r>p&&r>=o){let e,n=u*p,o=h*p,a=-1;var m=(_/c<<5)+(t+1)+this.points.length;for(const r of d){var g,y=r*c;s[2+y]<=t||(s[2+y]=t,g=s[y+5],n+=s[y]*g,o+=s[1+y]*g,s[4+y]=m,i&&(e||(e=this._map(s,_,!0),a=this.clusterProps.length,this.clusterProps.push(e)),i(e,this._map(s,y))))}s[_+4]=m,l.push(n/r,o/r,1/0,m,-1,r),i&&l.push(a)}else{for(let e=0;e<c;e++)l.push(s[_+e]);if(1<r)for(const e of d){var v=e*c;if(!(s[2+v]<=t)){s[2+v]=t;for(let e=0;e<c;e++)l.push(s[v+e])}}}}return l}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,t,r){var n;return 1<e[t+5]?(n=this.clusterProps[e[t+6]],r?Object.assign({},n):n):(n=this.points[e[t+3]].properties,e=this.options.map(n),r&&e===n?Object.assign({},e):e)}}function L(e,t,r){return{type:"Feature",id:e[t+3],properties:D(e,t,r),geometry:{type:"Point",coordinates:[360*(e[t]-.5),function(e){return e=(180-360*e)*Math.PI/180,360*Math.atan(Math.exp(e))/Math.PI-90}(e[t+1])]}}}function D(e,t,r){var n=e[t+5],i=1e4<=n?Math.round(n/1e3)+"k":1e3<=n?Math.round(n/100)/10+"k":n,o=e[t+6];r=-1===o?{}:Object.assign({},r[o]);return Object.assign(r,{cluster:!0,cluster_id:e[t+3],point_count:n,point_count_abbreviated:i})}function N(e){return e/360+.5}function z(e){return e=Math.sin(e*Math.PI/180),(e=.5-.25*Math.log((1+e)/(1-e))/Math.PI)<0?0:1<e?1:e}function F(e,t,r,n){for(var i,o=n,a=r-t>>1,s=r-t,l=e[t],c=e[t+1],u=e[r],h=e[r+1],d=t+3;d<r;d+=3){var p=function(e,t,r,n,i,o){var a,s=i-r,l=o-n;return 0==s&&0==l||(1<(a=((e-r)*s+(t-n)*l)/(s*s+l*l))?(r=i,n=o):0<a&&(r+=s*a,n+=l*a)),(s=e-r)*s+(l=t-n)*l}(e[d],e[d+1],l,c,u,h);o<p?(i=d,o=p):p===o&&(p=Math.abs(d-a))<s&&(i=d,s=p)}n<o&&(3<i-t&&F(e,t,i,n),e[i+2]=o,3<r-i)&&F(e,i,r,n)}function B(e,t,r,n){var i=e={id:void 0===e?null:e,type:t,geometry:r,tags:n,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},o=i.geometry;if("Point"===(t=i.type)||"MultiPoint"===t||"LineString"===t)U(i,o);else if("Polygon"===t||"MultiLineString"===t)for(var a=0;a<o.length;a++)U(i,o[a]);else if("MultiPolygon"===t)for(a=0;a<o.length;a++)for(var s=0;s<o[a].length;s++)U(i,o[a][s]);return e}function U(e,t){for(var r=0;r<t.length;r+=3)e.minX=Math.min(e.minX,t[r]),e.minY=Math.min(e.minY,t[r+1]),e.maxX=Math.max(e.maxX,t[r]),e.maxY=Math.max(e.maxY,t[r+1])}function j(e,t,r,n){if(t.geometry){var i=t.geometry.coordinates,o=t.geometry.type,a=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2),s=[],l=t.id;if(r.promoteId?l=t.properties[r.promoteId]:r.generateId&&(l=n||0),"Point"===o)q(i,s);else if("MultiPoint"===o)for(var c=0;c<i.length;c++)q(i[c],s);else if("LineString"===o)H(i,s,a,!1);else if("MultiLineString"===o){if(r.lineMetrics){for(c=0;c<i.length;c++)H(i[c],s=[],a,!1),e.push(B(l,"LineString",s,t.properties));return}V(i,s,a,!1)}else if("Polygon"===o)V(i,s,a,!0);else{if("MultiPolygon"!==o){if("GeometryCollection"!==o)throw new Error("Input data is not a valid GeoJSON object.");for(c=0;c<t.geometry.geometries.length;c++)j(e,{id:l,geometry:t.geometry.geometries[c],properties:t.properties},r,n);return}for(c=0;c<i.length;c++){var u=[];V(i[c],u,a,!0),s.push(u)}}e.push(B(l,o,s,t.properties))}}function q(e,t){t.push(G(e[0])),t.push(K(e[1])),t.push(0)}function H(e,t,r,n){for(var i,o,a=0,s=0;s<e.length;s++){var l=G(e[s][0]),c=K(e[s][1]);t.push(l),t.push(c),t.push(0),0<s&&(a+=n?(i*c-l*o)/2:Math.sqrt(Math.pow(l-i,2)+Math.pow(c-o,2))),i=l,o=c}var u=t.length-3;t[2]=1,F(t,0,u,r),t[2+u]=1,t.size=Math.abs(a),t.start=0,t.end=t.size}function V(e,t,r,n){for(var i=0;i<e.length;i++){var o=[];H(e[i],o,r,n),t.push(o)}}function G(e){return e/360+.5}function K(e){return e=Math.sin(e*Math.PI/180),(e=.5-.25*Math.log((1+e)/(1-e))/Math.PI)<0?0:1<e?1:e}function Z(e,t,r,n,i,o,a,s){if(n/=t,(r/=t)<=o&&a<n)return e;if(a<r||n<=o)return null;for(var l=[],c=0;c<e.length;c++){var u=e[c],h=u.geometry,d=u.type,p=0===i?u.minX:u.minY,f=0===i?u.maxX:u.maxY;if(r<=p&&f<n)l.push(u);else if(!(f<r||n<=p)){var m=[];if("Point"===d||"MultiPoint"===d){x=w=y=void 0;for(var g=h,y=m,v=r,_=n,b=i,w=0;w<g.length;w+=3){var x=g[w+b];v<=x&&x<=_&&(y.push(g[w]),y.push(g[w+1]),y.push(g[w+2]))}}else if("LineString"===d)W(h,m,r,n,i,!1,s.lineMetrics);else if("MultiLineString"===d)Y(h,m,r,n,i,!1);else if("Polygon"===d)Y(h,m,r,n,i,!0);else if("MultiPolygon"===d)for(var C=0;C<h.length;C++){var S=[];Y(h[C],S,r,n,i,!0),S.length&&m.push(S)}if(m.length)if(s.lineMetrics&&"LineString"===d)for(C=0;C<m.length;C++)l.push(B(u.id,d,m[C],u.tags));else"LineString"!==d&&"MultiLineString"!==d||(1===m.length?(d="LineString",m=m[0]):d="MultiLineString"),"Point"!==d&&"MultiPoint"!==d||(d=3===m.length?"Point":"MultiPoint"),l.push(B(u.id,d,m,u.tags))}}return l.length?l:null}function W(e,t,r,n,i,o,a){for(var s,l,c=$(e),u=0===i?Q:J,h=e.start,d=0;d<e.length-3;d+=3){var p=e[d],f=e[d+1],m=e[d+2],g=e[d+3],y=e[d+4],v=0===i?p:f,_=0===i?g:y,b=!1;a&&(s=Math.sqrt(Math.pow(p-g,2)+Math.pow(f-y,2))),v<r?r<_&&(l=u(c,p,f,g,y,r),a)&&(c.start=h+s*l):n<v?_<n&&(l=u(c,p,f,g,y,n),a)&&(c.start=h+s*l):X(c,p,f,m),_<r&&r<=v&&(l=u(c,p,f,g,y,r),b=!0),n<_&&v<=n&&(l=u(c,p,f,g,y,n),b=!0),!o&&b&&(a&&(c.end=h+s*l),t.push(c),c=$(e)),a&&(h+=s)}var w=e.length-3;p=e[w],f=e[1+w],m=e[2+w];r<=(v=0===i?p:f)&&v<=n&&X(c,p,f,m),w=c.length-3,o&&3<=w&&(c[w]!==c[0]||c[1+w]!==c[1])&&X(c,c[0],c[1],c[2]),c.length&&t.push(c)}function $(e){var t=[];return t.size=e.size,t.start=e.start,t.end=e.end,t}function Y(e,t,r,n,i,o){for(var a=0;a<e.length;a++)W(e[a],t,r,n,i,o,!1)}function X(e,t,r,n){e.push(t),e.push(r),e.push(n)}function Q(e,t,r,n,i,o){return n=(o-t)/(n-t),e.push(o),e.push(r+(i-r)*n),e.push(1),n}function J(e,t,r,n,i,o){return i=(o-r)/(i-r),e.push(t+(n-t)*i),e.push(o),e.push(1),i}function ee(e,t){for(var r=[],n=0;n<e.length;n++){var i=e[n],o=i.type;if("Point"===o||"MultiPoint"===o||"LineString"===o)a=te(i.geometry,t);else if("MultiLineString"===o||"Polygon"===o)for(var a=[],s=0;s<i.geometry.length;s++)a.push(te(i.geometry[s],t));else if("MultiPolygon"===o)for(a=[],s=0;s<i.geometry.length;s++){for(var l=[],c=0;c<i.geometry[s].length;c++)l.push(te(i.geometry[s][c],t));a.push(l)}r.push(B(i.id,o,a,i.tags))}return r}function te(e,t){var r=[];r.size=e.size,void 0!==e.start&&(r.start=e.start,r.end=e.end);for(var n=0;n<e.length;n+=3)r.push(e[n]+t,e[n+1],e[n+2]);return r}function re(e,t){if(!e.transformed){for(var r,n=1<<e.z,i=e.x,o=e.y,a=0;a<e.features.length;a++){var s=e.features[a],l=s.geometry,c=s.type;if(s.geometry=[],1===c)for(r=0;r<l.length;r+=2)s.geometry.push(ne(l[r],l[r+1],t,n,i,o));else for(r=0;r<l.length;r++){for(var u=[],h=0;h<l[r].length;h+=2)u.push(ne(l[r][h],l[r][h+1],t,n,i,o));s.geometry.push(u)}}e.transformed=!0}return e}function ne(e,t,r,n,i,o){return[Math.round(r*(e*n-i)),Math.round(r*(t*n-o))]}function ie(e,t,r,n,i){for(var o=t===i.maxZoom?0:i.tolerance/((1<<t)*i.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:r,y:n,z:t,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<e.length;s++){a.numFeatures++,_=v=y=g=m=f=h=l=void 0;var l=a,c=e[s],u=o,h=i,d=c.geometry,p=c.type,f=[];if("Point"===p||"MultiPoint"===p)for(var m=0;m<d.length;m+=3)f.push(d[m]),f.push(d[m+1]),l.numPoints++,l.numSimplified++;else if("LineString"===p)oe(f,d,l,u,!1,!1);else if("MultiLineString"===p||"Polygon"===p)for(m=0;m<d.length;m++)oe(f,d[m],l,u,"Polygon"===p,0===m);else if("MultiPolygon"===p)for(var g=0;g<d.length;g++){var y=d[g];for(m=0;m<y.length;m++)oe(f,y[m],l,u,!0,0===m)}if(f.length){var v=c.tags||null;if("LineString"===p&&h.lineMetrics){for(var _ in v={},c.tags)v[_]=c.tags[_];v.mapbox_clip_start=d.start/d.size,v.mapbox_clip_end=d.end/d.size}h={geometry:f,type:"Polygon"===p||"MultiPolygon"===p?3:"LineString"===p||"MultiLineString"===p?2:1,tags:v},null!==c.id&&(h.id=c.id),l.features.push(h)}h=e[s].minX;var b=e[s].minY,w=e[s].maxX,x=e[s].maxY;h<a.minX&&(a.minX=h),b<a.minY&&(a.minY=b),a.maxX<w&&(a.maxX=w),a.maxY<x&&(a.maxY=x)}return a}function oe(e,t,r,n,i,o){var a=n*n;if(0<n&&t.size<(i?a:n))r.numPoints+=t.length/3;else{for(var s=[],l=0;l<t.length;l+=3)(0===n||t[l+2]>a)&&(r.numSimplified++,s.push(t[l]),s.push(t[l+1])),r.numPoints++;if(i){for(var c=s,u=(i=o,0),h=0,d=c.length,p=d-2;h<d;p=h,h+=2)u+=(c[h]-c[p])*(c[h+1]+c[p+1]);if(0<u===i)for(h=0,d=c.length;h<d/2;h+=2){var f=c[h],m=c[h+1];c[h]=c[d-2-h],c[h+1]=c[d-1-h],c[d-2-h]=f,c[d-1-h]=m}}e.push(s)}}function ae(e,t){var r=(t=this.options=function(e,t){for(var r in t)e[r]=t[r];return e}(Object.create(this.options),t)).debug;if(r&&console.time("preprocess data"),t.maxZoom<0||24<t.maxZoom)throw new Error("maxZoom should be in the 0-24 range");if(t.promoteId&&t.generateId)throw new Error("promoteId and generateId cannot be used together.");var n,i,o,a,s;e=function(e,t){var r=[];if("FeatureCollection"===e.type)for(var n=0;n<e.features.length;n++)j(r,e.features[n],t,n);else"Feature"===e.type?j(r,e,t):j(r,{geometry:e},t);return r}(e,t);this.tiles={},this.tileCoords=[],r&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",t.indexMaxZoom,t.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),a=Z(o=n=e,1,-1-(i=t.buffer/t.extent),i,0,-1,2,t),s=Z(n,1,1-i,2+i,0,-1,2,t),(e=o=(a||s)&&(o=Z(n,1,-i,1+i,0,-1,2,t)||[],a&&(o=ee(a,1).concat(o)),s)?o.concat(ee(s,-1)):o).length&&this.splitTile(e,0,0,0),r&&(e.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function se(e,t,r){return 32*((1<<e)*r+t)+e}function le(e,t){return t?e.properties[t]:e.id}function ce(e,t){if(null==e)return 1;if("Feature"===e.type)return null!=le(e,t);if("FeatureCollection"===e.type){var r=new Set;for(const i of e.features){var n=le(i,t);if(null==n)return;if(r.has(n))return;r.add(n)}return 1}}function ue(e,t){var r=new Map;if(null!=e)if("Feature"===e.type)r.set(le(e,t),e);else for(const n of e.features)r.set(le(n,t),n);return r}ae.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ae.prototype.splitTile=function(e,t,r,n,i,o,a){for(var s=[e,t,r,n],l=this.options,c=l.debug;s.length;){n=s.pop(),r=s.pop(),t=s.pop(),e=s.pop();var u,h,d,p,f,m,g,y,v,_=1<<t,b=se(t,r,n),w=this.tiles[b];if(w||(1<c&&console.time("creation"),w=this.tiles[b]=ie(e,t,r,n,l),this.tileCoords.push({z:t,x:r,y:n}),c&&(1<c&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",t,r,n,w.numFeatures,w.numPoints,w.numSimplified),console.timeEnd("creation")),this.stats[b="z"+t]=(this.stats[b]||0)+1,this.total++)),w.source=e,i){if(t===l.maxZoom||t===i)continue;b=1<<i-t;if(r!==Math.floor(o/b)||n!==Math.floor(a/b))continue}else if(t===l.indexMaxZoom||w.numPoints<=l.indexMaxPoints)continue;w.source=null,0!==e.length&&(1<c&&console.time("clipping"),u=.5-(b=.5*l.buffer/l.extent),d=1+b,g=p=f=m=null,y=Z(e,_,r-b,r+(h=.5+b),0,w.minX,w.maxX,l),v=Z(e,_,r+u,r+d,0,w.minX,w.maxX,l),e=null,y&&(g=Z(y,_,n-b,n+h,1,w.minY,w.maxY,l),p=Z(y,_,n+u,n+d,1,w.minY,w.maxY,l),y=null),v&&(f=Z(v,_,n-b,n+h,1,w.minY,w.maxY,l),m=Z(v,_,n+u,n+d,1,w.minY,w.maxY,l),v=null),1<c&&console.timeEnd("clipping"),s.push(g||[],t+1,2*r,2*n),s.push(p||[],t+1,2*r,2*n+1),s.push(f||[],t+1,2*r+1,2*n),s.push(m||[],t+1,2*r+1,2*n+1))}},ae.prototype.getTile=function(e,t,r){var n=(i=this.options).extent,i=i.debug;if(e<0||24<e)return null;var o=se(e,t=(t%(o=1<<e)+o)%o,r);if(this.tiles[o])return re(this.tiles[o],n);1<i&&console.log("drilling down to z%d-%d-%d",e,t,r);for(var a,s=e,l=t,c=r;!a&&0<s;)s--,l=Math.floor(l/2),c=Math.floor(c/2),a=this.tiles[se(s,l,c)];return a&&a.source&&(1<i&&console.log("found parent tile z%d-%d-%d",s,l,c),1<i&&console.time("drilling down"),this.splitTile(a.source,s,l,c,e,t,r),1<i&&console.timeEnd("drilling down"),this.tiles[o])?re(this.tiles[o],n):null};class he extends o{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(t,r){return e.__awaiter(this,void 0,void 0,(function*(){var e=t.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");if(!(e=this._geoJSONIndex.getTile(e.z,e.x,e.y)))return null;e=new d(e.features);let r=P(e);return{vectorTile:e,rawData:(r=0===r.byteOffset&&r.byteLength===r.buffer.byteLength?r:new Uint8Array(r)).buffer}}))}loadData(t){return e.__awaiter(this,void 0,void 0,(function*(){null!=(r=this._pendingRequest)&&r.abort();var r=!!(t&&t.request&&t.request.collectResourceTiming)&&new e.RequestPerformance(t.request);this._pendingRequest=new AbortController;try{let a=yield this.loadGeoJSON(t,this._pendingRequest);if(delete this._pendingRequest,"object"!=typeof a)throw new Error(`Input data given to '${t.source}' is not a valid GeoJSON object.`);if(c(a,!0),t.filter){const r=e.createExpression(t.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===r.result)throw new Error(r.value.map((e=>e.key+": "+e.message)).join(", "));var n=a.features.filter((e=>r.value.evaluate({zoom:0},e)));a={type:"FeatureCollection",features:n}}this._geoJSONIndex=t.cluster?new O(function(t){let{superclusterOptions:r,clusterProperties:n}=t;if(n&&r){const t={},a={},s={accumulated:null,zoom:0},l={properties:null},c=Object.keys(n);for(const r of c){var[i,o]=n[r],o=e.createExpression(o),i=e.createExpression("string"==typeof i?[i,["accumulated"],["get",r]]:i);t[r]=o.value,a[r]=i.value}r.map=e=>{l.properties=e;var r={};for(const n of c)r[n]=t[n].evaluate(s,l);return r},r.reduce=(e,t)=>{l.properties=t;for(const r of c)s.accumulated=e[r],e[r]=a[r].evaluate(s,l)}}return r}(t)).load(a.features):function(e,t){return new ae(e,t)}(a,t.geojsonVtOptions),this.loaded={};var i,o={};return r&&(i=r.finish())&&(o.resourceTiming={},o.resourceTiming[t.source]=JSON.parse(JSON.stringify(i))),o}catch(p){if(delete this._pendingRequest,e.isAbortError(p))return{abandoned:!0};throw p}}))}reloadTile(e){var t=this.loaded,r=e.uid;return t&&t[r]?super.reloadTile(e):this.loadTile(e)}loadGeoJSON(t,r){return e.__awaiter(this,void 0,void 0,(function*(){var n,i=t.promoteId;if(t.request)return n=yield e.getJSON(t.request,r),this._dataUpdateable=ce(n.data,i)?ue(n.data,i):void 0,n.data;if("string"==typeof t.data)try{var o=JSON.parse(t.data);return this._dataUpdateable=ce(o,i)?ue(o,i):void 0,o}catch(n){throw new Error(`Input data given to '${t.source}' is not a valid GeoJSON object.`)}if(!t.dataDiff)throw new Error(`Input data given to '${t.source}' is not a valid GeoJSON object.`);if(this._dataUpdateable)return function(e,t,r){if(t.removeAll&&e.clear(),t.remove)for(const l of t.remove)e.delete(l);if(t.add)for(const l of t.add){var n=le(l,r);null!=n&&e.set(n,l)}if(t.update)for(const l of t.update){let t=e.get(l.id);if(null!=t){var i=l.newGeometry||l.removeAllProperties,o=!l.removeAllProperties&&(0<(null==(o=l.removeProperties)?void 0:o.length)||0<(null==(o=l.addOrUpdateProperties)?void 0:o.length));if((i||o)&&(t=Object.assign({},t),e.set(l.id,t),o)&&(t.properties=Object.assign({},t.properties)),l.newGeometry&&(t.geometry=l.newGeometry),l.removeAllProperties)t.properties={};else if(0<(null==(i=l.removeProperties)?void 0:i.length))for(const e of l.removeProperties)Object.prototype.hasOwnProperty.call(t.properties,e)&&delete t.properties[e];if(0<(null==(i=l.addOrUpdateProperties)?void 0:i.length))for(var{key:a,value:s}of l.addOrUpdateProperties)t.properties[a]=s}}}(this._dataUpdateable,t.dataDiff,i),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())};throw new Error("Cannot update existing geojson data in "+t.source)}))}removeSource(t){return e.__awaiter(this,void 0,void 0,(function*(){this._pendingRequest&&this._pendingRequest.abort()}))}getClusterExpansionZoom(e){return this._geoJSONIndex.getClusterExpansionZoom(e.clusterId)}getClusterChildren(e){return this._geoJSONIndex.getChildren(e.clusterId)}getClusterLeaves(e){return this._geoJSONIndex.getLeaves(e.clusterId,e.limit,e.offset)}}class de{constructor(t){this.self=t,this.actor=new e.Actor(t),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(e,t)=>{if(this.externalWorkerSourceTypes[e])throw new Error(`Worker source with name "${e}" already registered.`);this.externalWorkerSourceTypes[e]=t},this.self.addProtocol=e.addProtocol,this.self.removeProtocol=e.removeProtocol,this.self.registerRTLTextPlugin=t=>{if(e.rtlWorkerPlugin.isParsed())throw new Error("RTL text plugin already registered.");e.rtlWorkerPlugin.setMethods(t)},this.actor.registerMessageHandler("LDT",((e,t)=>this._getDEMWorkerSource(e,t.source).loadTile(t))),this.actor.registerMessageHandler("RDT",((t,r)=>e.__awaiter(this,void 0,void 0,(function*(){this._getDEMWorkerSource(t,r.source).removeTile(r)})))),this.actor.registerMessageHandler("GCEZ",((t,r)=>e.__awaiter(this,void 0,void 0,(function*(){return this._getWorkerSource(t,r.type,r.source).getClusterExpansionZoom(r)})))),this.actor.registerMessageHandler("GCC",((t,r)=>e.__awaiter(this,void 0,void 0,(function*(){return this._getWorkerSource(t,r.type,r.source).getClusterChildren(r)})))),this.actor.registerMessageHandler("GCL",((t,r)=>e.__awaiter(this,void 0,void 0,(function*(){return this._getWorkerSource(t,r.type,r.source).getClusterLeaves(r)})))),this.actor.registerMessageHandler("LD",((e,t)=>this._getWorkerSource(e,t.type,t.source).loadData(t))),this.actor.registerMessageHandler("LT",((e,t)=>this._getWorkerSource(e,t.type,t.source).loadTile(t))),this.actor.registerMessageHandler("RT",((e,t)=>this._getWorkerSource(e,t.type,t.source).reloadTile(t))),this.actor.registerMessageHandler("AT",((e,t)=>this._getWorkerSource(e,t.type,t.source).abortTile(t))),this.actor.registerMessageHandler("RMT",((e,t)=>this._getWorkerSource(e,t.type,t.source).removeTile(t))),this.actor.registerMessageHandler("RS",((t,r)=>e.__awaiter(this,void 0,void 0,(function*(){var e;this.workerSources[t]&&this.workerSources[t][r.type]&&this.workerSources[t][r.type][r.source]&&(e=this.workerSources[t][r.type][r.source],delete this.workerSources[t][r.type][r.source],void 0!==e.removeSource)&&e.removeSource(r)})))),this.actor.registerMessageHandler("RM",(t=>e.__awaiter(this,void 0,void 0,(function*(){delete this.layerIndexes[t],delete this.availableImages[t],delete this.workerSources[t],delete this.demWorkerSources[t]})))),this.actor.registerMessageHandler("SR",((t,r)=>e.__awaiter(this,void 0,void 0,(function*(){this.referrer=r})))),this.actor.registerMessageHandler("SRPS",((e,t)=>this._syncRTLPluginState(e,t))),this.actor.registerMessageHandler("IS",((t,r)=>e.__awaiter(this,void 0,void 0,(function*(){this.self.importScripts(r)})))),this.actor.registerMessageHandler("SI",((e,t)=>this._setImages(e,t))),this.actor.registerMessageHandler("UL",((t,r)=>e.__awaiter(this,void 0,void 0,(function*(){this._getLayerIndex(t).update(r.layers,r.removedIds)})))),this.actor.registerMessageHandler("SL",((t,r)=>e.__awaiter(this,void 0,void 0,(function*(){this._getLayerIndex(t).replace(r)}))))}_setImages(t,r){return e.__awaiter(this,void 0,void 0,(function*(){this.availableImages[t]=r;for(const n in this.workerSources[t]){var e=this.workerSources[t][n];for(const t in e)e[t].availableImages=r}}))}_syncRTLPluginState(t,r){return e.__awaiter(this,void 0,void 0,(function*(){if(e.rtlWorkerPlugin.isParsed())return e.rtlWorkerPlugin.getState();if("loading"!==r.pluginStatus)return e.rtlWorkerPlugin.setState(r),r;var t=r.pluginURL,n=(this.self.importScripts(t),e.rtlWorkerPlugin.isParsed());if(n)return e.rtlWorkerPlugin.setState(n={pluginStatus:"loaded",pluginURL:t}),n;throw e.rtlWorkerPlugin.setState({pluginStatus:"error",pluginURL:""}),new Error("RTL Text Plugin failed to import scripts from "+t)}))}_getAvailableImages(e){let t=this.availableImages[e];return t||[]}_getLayerIndex(e){let r=this.layerIndexes[e];return r||(this.layerIndexes[e]=new t)}_getWorkerSource(e,t,r){if(this.workerSources[e]||(this.workerSources[e]={}),this.workerSources[e][t]||(this.workerSources[e][t]={}),!this.workerSources[e][t][r]){var n={sendAsync:(t,r)=>(t.targetMapId=e,this.actor.sendAsync(t,r))};switch(t){case"vector":this.workerSources[e][t][r]=new o(n,this._getLayerIndex(e),this._getAvailableImages(e));break;case"geojson":this.workerSources[e][t][r]=new he(n,this._getLayerIndex(e),this._getAvailableImages(e));break;default:this.workerSources[e][t][r]=new this.externalWorkerSourceTypes[t](n,this._getLayerIndex(e),this._getAvailableImages(e))}}return this.workerSources[e][t][r]}_getDEMWorkerSource(e,t){return this.demWorkerSources[e]||(this.demWorkerSources[e]={}),this.demWorkerSources[e][t]||(this.demWorkerSources[e][t]=new a),this.demWorkerSources[e][t]}}return e.isWorker(self)&&(self.worker=new de(self)),de})),r("index",0,(function(e,t){var r,n="4.1.2";let i,o;const a={now:tt="undefined"!=typeof performance&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:e=>new Promise(((r,n)=>{const i=requestAnimationFrame(r);e.signal.addEventListener("abort",(()=>{cancelAnimationFrame(i),n(t.createAbortError())}))})),getImageData(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.getImageCanvasContext(e).getImageData(-t,-t,e.width+2*t,e.height+2*t)},getImageCanvasContext(e){var t=window.document.createElement("canvas"),r=t.getContext("2d",{willReadFrequently:!0});if(r)return t.width=e.width,t.height=e.height,r.drawImage(e,0,0,e.width,e.height),r;throw new Error("failed to create canvas 2d context")},resolveURL:e=>((i=i||document.createElement("a")).href=e,i.href),hardwareConcurrency:"undefined"!=typeof navigator&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(o=null==o?matchMedia("(prefers-reduced-motion: reduce)"):o).matches}};class s{static testProp(e){if(s.docStyle)for(let t=0;t<e.length;t++)if(e[t]in s.docStyle)return e[t];return e[0]}static create(e,t,r){return e=window.document.createElement(e),void 0!==t&&(e.className=t),r&&r.appendChild(e),e}static createNS(e,t){return window.document.createElementNS(e,t)}static disableDrag(){s.docStyle&&s.selectProp&&(s.userSelect=s.docStyle[s.selectProp],s.docStyle[s.selectProp]="none")}static enableDrag(){s.docStyle&&s.selectProp&&(s.docStyle[s.selectProp]=s.userSelect)}static setTransform(e,t){e.style[s.transformProp]=t}static addEventListener(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};"passive"in n?e.addEventListener(t,r,n):e.addEventListener(t,r,n.capture)}static removeEventListener(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};"passive"in n?e.removeEventListener(t,r,n):e.removeEventListener(t,r,n.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",s.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",s.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",s.suppressClickInternal,!0)}),0)}static getScale(e){var t=e.getBoundingClientRect();return{x:t.width/e.offsetWidth||1,y:t.height/e.offsetHeight||1,boundingClientRect:t}}static getPoint(e,r,n){var i=r.boundingClientRect;return new t.Point((n.clientX-i.left)/r.x-e.clientLeft,(n.clientY-i.top)/r.y-e.clientTop)}static mousePos(e,t){var r=s.getScale(e);return s.getPoint(e,r,t)}static touchPos(e,t){var r=[],n=s.getScale(e);for(let i=0;i<t.length;i++)r.push(s.getPoint(e,n,t[i]));return r}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}}s.docStyle="undefined"!=typeof window&&window.document&&window.document.documentElement.style,s.selectProp=s.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),s.transformProp=s.testProp(["transform","WebkitTransform"]);const l={supported:!1,testSupport:function(e){!h&&u&&(d?p(e):c=e)}};let c,u,h=!1,d=!1;function p(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,u),e.isContextLost())return;l.supported=!0}catch(e){}e.deleteTexture(t),h=!0}"undefined"!=typeof document&&((u=document.createElement("img")).onload=function(){c&&p(c),c=null,d=!0},u.onerror=function(){h=!0,c=null},u.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(e){let r,n,i,o;e.resetRequestQueue=()=>{r=[],n=0,i=0,o={}},e.addThrottleControl=e=>{var t=i++;return o[t]=e,t},e.removeThrottleControl=e=>{delete o[e],c()},e.getImage=function(e,n){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return new Promise(((o,a)=>{l.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),t.extend(e,{type:"image"});var s={abortController:n,requestParameters:e,supportImageRefresh:i,state:"queued",onError:e=>{a(e)},onSuccess:e=>{o(e)}};r.push(s),c()}))};const a=e=>"function"==typeof createImageBitmap?t.arrayBufferToImageBitmap(e):t.arrayBufferToImage(e),s=e=>t.__awaiter(this,void 0,void 0,(function*(){e.state="running";var{requestParameters:r,supportImageRefresh:i,onError:o,onSuccess:s,abortController:l}=e,i=(i=!1===i&&!t.isWorker(self)&&!t.getProtocol(r.url)&&(!r.headers||Object.keys(r.headers).reduce(((e,t)=>e&&"accept"===t),!0)),n++,i?u(r,l):t.makeRequest(r,l));try{var h=yield i;delete e.abortController,e.state="completed",h.data instanceof HTMLImageElement||t.isImageBitmap(h.data)?s(h):h.data&&s({data:yield a(h.data),cacheControl:h.cacheControl,expires:h.expires})}catch(r){delete e.abortController,o(r)}finally{n--,c()}})),c=()=>{var e=(()=>{for(const e of Object.keys(o))if(o[e]())return!0;return!1})()?t.config.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:t.config.MAX_PARALLEL_IMAGE_REQUESTS;for(let t=n;t<e&&0<r.length;t++){var i=r.shift();i.abortController.signal.aborted?t--:s(i)}},u=(e,r)=>new Promise(((n,i)=>{const o=new Image;var a=e.url,s=e.credentials;s&&"include"===s?o.crossOrigin="use-credentials":(s&&"same-origin"===s||!t.sameOrigin(a))&&(o.crossOrigin="anonymous"),r.signal.addEventListener("abort",(()=>{o.src="",i(t.createAbortError())})),o.fetchPriority="high",o.onload=()=>{o.onerror=o.onload=null,n({data:o})},o.onerror=()=>{o.onerror=o.onload=null,r.signal.aborted||i(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},o.src=a}))}(r=r||{}),r.resetRequestQueue();class f{constructor(e){this._transformRequestFn=e}transformRequest(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}}normalizeSpriteURL(e,t,r){return e=function(e){var t=e.match(m);if(t)return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]};throw new Error(`Unable to parse URL "${e}"`)}(e),e.path+=""+t+r,function(e){var t=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+t}(e)}setTransformRequest(e){this._transformRequestFn=e}}const m=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function g(e){var t=[];if("string"==typeof e)t.push({id:"default",url:e});else if(e&&0<e.length){var r,n,i=[];for({id:r,url:n}of e){var o=""+r+n;-1===i.indexOf(o)&&(i.push(o),t.push({id:r,url:n}))}}return t}class y{constructor(e,t,r,n){this.context=e,this.format=r,this.texture=e.gl.createTexture(),this.update(t,n)}update(e,r,n){var{width:i,height:o}=e,a=!(this.size&&this.size[0]===i&&this.size[1]===o||n),s=this.context,l=s.gl;this.useMipmap=Boolean(r&&r.useMipmap),l.bindTexture(l.TEXTURE_2D,this.texture),s.pixelStoreUnpackFlipY.set(!1),s.pixelStoreUnpack.set(1),s.pixelStoreUnpackPremultiplyAlpha.set(this.format===l.RGBA&&(!r||!1!==r.premultiply)),a?(this.size=[i,o],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||t.isImageBitmap(e)?l.texImage2D(l.TEXTURE_2D,0,this.format,this.format,l.UNSIGNED_BYTE,e):l.texImage2D(l.TEXTURE_2D,0,this.format,i,o,0,this.format,l.UNSIGNED_BYTE,e.data)):(({x:s,y:r}=n||{x:0,y:0}),e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||t.isImageBitmap(e)?l.texSubImage2D(l.TEXTURE_2D,0,s,r,l.RGBA,l.UNSIGNED_BYTE,e):l.texSubImage2D(l.TEXTURE_2D,0,s,r,i,o,l.RGBA,l.UNSIGNED_BYTE,e.data)),this.useMipmap&&this.isSizePowerOfTwo()&&l.generateMipmap(l.TEXTURE_2D)}bind(e,t,r){var n;(n=(n=this.context).gl).bindTexture(n.TEXTURE_2D,this.texture),r!==n.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(r=n.LINEAR),e!==this.filter&&(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,r||e),this.filter=e),t!==this.wrap&&(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,t),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,t),this.wrap=t)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){this.context.gl.deleteTexture(this.texture),this.texture=null}}class v extends t.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new t.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e)){for(var{ids:t,promiseResolve:r}of this.requestors)r(this._getImagesForIds(t));this.requestors=[]}}getImage(e){var r;return(e=this.images[e])&&!e.data&&e.spriteData&&(r=e.spriteData,e.data=new t.RGBAImage({width:r.width,height:r.height},r.context.getImageData(r.x,r.y,r.width,r.height).data),e.spriteData=null),e}addImage(e,t){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,t)&&(this.images[e]=t)}_validate(e,r){let n=!0;var i=r.data||r.spriteData;return this._validateStretch(r.stretchX,i&&i.width)||(this.fire(new t.ErrorEvent(new Error(`Image "${e}" has invalid "stretchX" value`))),n=!1),this._validateStretch(r.stretchY,i&&i.height)||(this.fire(new t.ErrorEvent(new Error(`Image "${e}" has invalid "stretchY" value`))),n=!1),this._validateContent(r.content,r)||(this.fire(new t.ErrorEvent(new Error(`Image "${e}" has invalid "content" value`))),n=!1),n}_validateStretch(e,t){if(e){let r=0;for(const n of e){if(n[0]<r||n[1]<n[0]||t<n[1])return!1;r=n[1]}}return!0}_validateContent(e,t){var r,n;return!e||4===e.length&&(r=(n=t.spriteData)&&n.width||t.data.width,n=n&&n.height||t.data.height,!(e[0]<0||r<e[0]||e[1]<0||n<e[1]||e[2]<0||r<e[2]||e[3]<0||n<e[3]||e[2]<e[0]||e[3]<e[1]))}updateImage(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];var n=this.getImage(e);if(r&&(n.data.width!==t.data.width||n.data.height!==t.data.height))throw new Error(`size mismatch between old image (${n.data.width}x${n.data.height}) and new image (${t.data.width}x${t.data.height}).`);t.version=n.version+1,this.images[e]=t,this.updatedImages[e]=!0}removeImage(e){var t=this.images[e];delete this.images[e],delete this.patterns[e],t.userImage&&t.userImage.onRemove&&t.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise(((t,r)=>{let n=!0;if(!this.isLoaded())for(const i of e)this.images[i]||(n=!1);this.isLoaded()||n?t(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:t})}))}_getImagesForIds(e){var r={};for(const n of e){let e=this.getImage(n);e||(this.fire(new t.Event("styleimagemissing",{id:n})),e=this.getImage(n)),e?r[n]={data:e.data.clone(),pixelRatio:e.pixelRatio,sdf:e.sdf,version:e.version,stretchX:e.stretchX,stretchY:e.stretchY,content:e.content,contentMatch:e.contentMatch,hasRenderCallback:Boolean(e.userImage&&e.userImage.render)}:t.warnOnce(`Image "${n}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return r}getPixelSize(){var{width:e,height:t}=this.atlasImage;return{width:e,height:t}}getPattern(e){var r=this.patterns[e],n=this.getImage(e);return n?(r&&r.position.version===n.version?r:(r?r.position.version=n.version:(r={w:n.data.width+2,h:n.data.height+2,x:0,y:0},n=new t.ImagePosition(r,n),this.patterns[e]={bin:r,position:n}),this._updatePatternAtlas(),this.patterns[e])).position:null}bind(e){var t=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new y(e,this.atlasImage,t.RGBA),this.atlasTexture.bind(t.LINEAR,t.CLAMP_TO_EDGE)}_updatePatternAtlas(){var e=[];for(const t in this.patterns)e.push(this.patterns[t].bin);const{w:r,h:n}=t.potpack(e);var i=this.atlasImage;i.resize({width:r||1,height:n||1});for(const l in this.patterns){var o=(a=this.patterns[l].bin).x+1,a=a.y+1,s=this.getImage(l).data;const e=s.width,r=s.height;t.RGBAImage.copy(s,i,{x:0,y:0},{x:o,y:a},{width:e,height:r}),t.RGBAImage.copy(s,i,{x:0,y:r-1},{x:o,y:a-1},{width:e,height:1}),t.RGBAImage.copy(s,i,{x:0,y:0},{x:o,y:a+r},{width:e,height:1}),t.RGBAImage.copy(s,i,{x:e-1,y:0},{x:o-1,y:a},{width:1,height:r}),t.RGBAImage.copy(s,i,{x:0,y:0},{x:o+e,y:a},{width:1,height:r})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const n of e){var r;this.callbackDispatchedThisFrame[n]||(this.callbackDispatchedThisFrame[n]=!0,(r=this.getImage(n))||t.warnOnce(`Image with ID: "${n}" was not found`),t.renderStyleImage(r)&&this.updateImage(n,r))}}}const _=1e20;function b(e,t,r,n,i,o,a,s,l){for(let c=t;c<t+n;c++)w(e,r*o+c,o,i,a,s,l);for(let c=r;c<r+i;c++)w(e,c*o+t,1,n,a,s,l)}function w(e,t,r,n,i,o,a){a[o[0]=0]=-_,a[1]=_,i[0]=e[t];for(let h=1,d=0,p=0;h<n;h++){i[h]=e[t+h*r];var s=h*h;do{var l=o[d];p=(i[h]-i[l]+s-l*l)/(h-l)/2}while(p<=a[d]&&-1<--d);o[++d]=h,a[d]=p,a[d+1]=_}for(let h=0,d=0;h<n;h++){for(;a[d+1]<h;)d++;var c=o[d],u=h-c;e[t+h*r]=i[c]+u*u}}class x{constructor(e,t){this.requestManager=e,this.localIdeographFontFamily=t,this.entries={}}setURL(e){this.url=e}getGlyphs(e){return t.__awaiter(this,void 0,void 0,(function*(){var t=[];for(const a in e)for(const r of e[a])t.push(this._getAndCacheGlyphsPromise(a,r));var r,n,i,o={};for({stack:r,id:n,glyph:i}of yield Promise.all(t))o[r]||(o[r]={}),o[r][n]=i&&{id:i.id,bitmap:i.bitmap.clone(),metrics:i.metrics};return o}))}_getAndCacheGlyphsPromise(e,r){return t.__awaiter(this,void 0,void 0,(function*(){let t=this.entries[e];var n=(t=t||(this.entries[e]={glyphs:{},requests:{},ranges:{}})).glyphs[r];if(void 0!==n)return{stack:e,id:r,glyph:n};if(n=this._tinySDF(t,e,r))return t.glyphs[r]=n,{stack:e,id:r,glyph:n};var i=Math.floor(r/256);if(65535<256*i)throw new Error("glyphs > 65535 not supported");if(t.ranges[i])return{stack:e,id:r,glyph:n};if(!this.url)throw new Error("glyphsUrl is not set");t.requests[i]||(n=x.loadGlyphRange(e,i,this.url,this.requestManager),t.requests[i]=n);var o=yield t.requests[i];for(const e in o)this._doesCharSupportLocalGlyph(+e)||(t.glyphs[+e]=o[+e]);return t.ranges[i]=!0,{stack:e,id:r,glyph:o[r]||null}}))}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&(t.unicodeBlockLookup["CJK Unified Ideographs"](e)||t.unicodeBlockLookup["Hangul Syllables"](e)||t.unicodeBlockLookup.Hiragana(e)||t.unicodeBlockLookup.Katakana(e))}_tinySDF(e,r,n){var i=this.localIdeographFontFamily;if(i&&this._doesCharSupportLocalGlyph(n)){let o=e.tinySDF;if(!o){let t="400";/bold/i.test(r)?t="900":/medium/i.test(r)?t="500":/light/i.test(r)&&(t="200"),o=e.tinySDF=new x.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:i,fontWeight:t})}return r=o.draw(String.fromCharCode(n)),{id:n,bitmap:new t.AlphaImage({width:r.width||60,height:r.height||60},r.data),metrics:{width:r.glyphWidth/2||24,height:r.glyphHeight/2||24,left:r.glyphLeft/2+.5||0,top:r.glyphTop/2-27.5||-8,advance:r.glyphAdvance/2||24,isDoubleResolution:!0}}}}}x.loadGlyphRange=function(e,r,n,i){return t.__awaiter(this,void 0,void 0,(function*(){var o=256*r,a=255+o,s=i.transformRequest(n.replace("{fontstack}",e).replace("{range}",o+"-"+a),"Glyphs");if(!(s=yield t.getArrayBuffer(s,new AbortController))||!s.data)throw new Error(`Could not load glyph range. range: ${r}, ${o}-`+a);var l={};for(const e of t.parseGlyphPbf(s.data))l[e.id]=e;return l}))},x.TinySDF=class{constructor(){let{fontSize:e=24,buffer:t=3,radius:r=8,cutoff:n=.25,fontFamily:i="sans-serif",fontWeight:o="normal",fontStyle:a="normal"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.buffer=t,this.cutoff=n,this.radius=r,n=this.size=e+4*t,r=this._createCanvas(n),t=this.ctx=r.getContext("2d",{willReadFrequently:!0}),t.font=a+` ${o} ${e}px `+i,t.textBaseline="alphabetic",t.textAlign="left",t.fillStyle="black",this.gridOuter=new Float64Array(n*n),this.gridInner=new Float64Array(n*n),this.f=new Float64Array(n),this.z=new Float64Array(n+1),this.v=new Uint16Array(n)}_createCanvas(e){var t=document.createElement("canvas");return t.width=t.height=e,t}draw(e){var{width:t,actualBoundingBoxAscent:r,actualBoundingBoxDescent:n,actualBoundingBoxLeft:i,actualBoundingBoxRight:o}=this.ctx.measureText(e),r=Math.ceil(r),a=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(o-i))),s=Math.min(this.size-this.buffer,r+Math.ceil(n)),l=a+2*this.buffer,o=s+2*this.buffer,c=Math.max(l*o,0),u=new Uint8ClampedArray(c),i={data:u,width:l,height:o,glyphWidth:a,glyphHeight:s,glyphTop:r,glyphLeft:0,glyphAdvance:t};if(0!==a&&0!==s){var{ctx:n,buffer:h,gridInner:d,gridOuter:p}=this,f=(n.clearRect(h,h,a,s),n.fillText(e,h,h+r),n.getImageData(h,h,a,s));p.fill(_,0,c),d.fill(0,0,c);for(let e=0;e<s;e++)for(let t=0;t<a;t++){var m,g=f.data[4*(e*a+t)+3]/255;0!=g&&(m=(e+h)*l+t+h,1==g?(p[m]=0,d[m]=_):(p[m]=0<(g=.5-g)?g*g:0,d[m]=g<0?g*g:0))}b(p,0,0,l,o,l,this.f,this.v,this.z),b(d,h,h,a,s,l,this.f,this.v,this.z);for(let e=0;e<c;e++){var y=Math.sqrt(p[e])-Math.sqrt(d[e]);u[e]=Math.round(255-255*(y/this.radius+this.cutoff))}}return i}};class C{constructor(){this.specification=t.v8Spec.light.position}possiblyEvaluate(e,r){return t.sphericalToCartesian(e.expression.evaluate(r))}interpolate(e,r,n){return{x:t.interpolate.number(e.x,r.x,n),y:t.interpolate.number(e.y,r.y,n),z:t.interpolate.number(e.z,r.z,n)}}}const S="-transition";let E;class T extends t.Evented{constructor(e){super(),E=E||new t.Properties({anchor:new t.DataConstantProperty(t.v8Spec.light.anchor),position:new C,color:new t.DataConstantProperty(t.v8Spec.light.color),intensity:new t.DataConstantProperty(t.v8Spec.light.intensity)}),this._transitionable=new t.Transitionable(E),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this._validate(t.validateLight,e,r))for(const t in e){var n=e[t];t.endsWith(S)?this._transitionable.setTransition(t.slice(0,-11),n):this._transitionable.setValue(t,n)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,r,n){return(!n||!1!==n.validate)&&t.emitValidationErrors(this,e.call(t.validateStyle,{value:r,style:{glyphs:!0,sprite:!0},styleSpec:t.v8Spec}))}}class I{constructor(e,t){this.width=e,this.height=t,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,t){var r=e.join(",")+String(t);return this.dashEntry[r]||(this.dashEntry[r]=this.addDash(e,t)),this.dashEntry[r]}getDashRanges(e,t,r){var n=[],i=e.length%2==1?-e[e.length-1]*r:0,o=e[0]*r;let a=!0,s=(n.push({left:i,right:o,isDash:a,zeroLength:0===e[0]}),e[0]);for(let c=1;c<e.length;c++){a=!a;var l=e[c];i=s*r,o=(s+=l)*r;n.push({left:i,right:o,isDash:a,zeroLength:0===l})}return n}addRoundDash(e,t,r){var n=t/2;for(let c=-r;c<=r;c++){var i=this.nextRow+r+c,o=this.width*i;let t=0,u=e[t];for(let i=0;i<this.width;i++){1<i/u.right&&(u=e[++t]);var a=Math.abs(i-u.left),s=Math.abs(i-u.right);a=Math.min(a,s);let h;var l;s=c/r*(1+n);h=u.isDash?(l=n-Math.abs(s),Math.sqrt(a*a+l*l)):n-Math.sqrt(a*a+s*s),this.data[o+i]=Math.max(0,Math.min(255,h+128))}}}addRegularDash(e){for(let u=e.length-1;0<=u;--u){var t=e[u],r=e[u+1];t.zeroLength?e.splice(u,1):r&&r.isDash===t.isDash&&(r.left=t.left,e.splice(u,1))}var n=e[0],i=e[e.length-1],o=(n.isDash===i.isDash&&(n.left=i.left-this.width,i.right=n.right+this.width),this.width*this.nextRow);let a=0,s=e[a];for(let u=0;u<this.width;u++){1<u/s.right&&(s=e[++a]);var l=Math.abs(u-s.left),c=Math.abs(u-s.right);l=Math.min(l,c),c=s.isDash?l:-l;this.data[o+u]=Math.max(0,Math.min(255,c+128))}}addDash(e,r){var n,i,o=r?7:0,a=2*o+1;if(this.nextRow+a>this.height)return t.warnOnce("LineAtlas out of space"),null;let s=0;for(let t=0;t<e.length;t++)s+=e[t];return 0!==s&&(n=this.width/s,i=this.getDashRanges(e,this.width,n),r?this.addRoundDash(i,n,o):this.addRegularDash(i)),r={y:(this.nextRow+o+.5)/this.height,height:2*o/this.height,width:s},this.nextRow+=a,this.dirty=!0,r}bind(e){e=e.gl,this.texture?(e.bindTexture(e.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,e.texSubImage2D(e.TEXTURE_2D,0,0,0,this.width,this.height,e.ALPHA,e.UNSIGNED_BYTE,this.data))):(this.texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texImage2D(e.TEXTURE_2D,0,e.ALPHA,this.width,this.height,0,e.ALPHA,e.UNSIGNED_BYTE,this.data))}}const k="maplibre_preloaded_worker_pool";class A{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<A.workerCount;)this.workers.push(new Worker(t.config.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],0===this.numActive()&&(this.workers.forEach((e=>{e.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[k]}numActive(){return Object.keys(this.active).length}}let P,M;function R(){return P=P||new A}tt=Math.floor(a.hardwareConcurrency/2),A.workerCount=t.isSafari(globalThis)?Math.max(Math.min(tt,3),1):1;class O{constructor(e,r){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=r;var n=this.workerPool.acquire(r);for(let o=0;o<n.length;o++){var i=n[o];(i=new t.Actor(i,r)).name="Worker "+o,this.actors.push(i)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,t){var r=[];for(const n of this.actors)r.push(n.sendAsync({type:e,data:t}));return Promise.all(r)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.actors.forEach((e=>{e.remove()})),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,t){for(const r of this.actors)r.registerMessageHandler(e,t)}}function L(){return M||(M=new O(R(),t.GLOBAL_DISPATCHER_ID)).registerMessageHandler("GR",((e,r,n)=>t.makeRequest(r,n))),M}function D(e,r,n,i,o,a){var s,l,c,u=function(e,t,r){if(e)for(const o of e){var n=t[o];if(n&&n.source===r&&"fill-extrusion"===n.type)return!0}else for(const o in t){var i=t[o];if(i.source===r&&"fill-extrusion"===i.type)return!0}return!1}(o&&o.layers,r,e.id),h=a.maxPitchScaleFactor(),d=((i=e.tilesIn(i,h,u)).sort(N),[]);for(const f of i)d.push({wrappedTileID:f.tileID.wrapped().key,queryResults:f.tile.queryRenderedFeatures(r,n,e._state,f.queryGeometry,f.cameraQueryGeometry,f.scale,o,a,h,(s=e.transform,l=f.tileID,void 0,c=t.create(),t.translate(c,c,[1,1,0]),t.scale(c,c,[.5*s.width,.5*s.height,1]),t.multiply(c,c,s.calculatePosMatrix(l.toUnwrapped()))))});var p=function(e){var t={},r={};for(const c of e){var n=c.queryResults,i=c.wrappedTileID,o=r[i]=r[i]||{};for(const e in n){var a=n[e],s=o[e]=o[e]||{},l=t[e]=t[e]||[];for(const e of a)s[e.featureIndex]||(s[e.featureIndex]=!0,l.push(e))}}return t}(d);for(const t in p)p[t].forEach((t=>{t=t.feature;var r=e.getFeatureState(t.layer["source-layer"],t.id);t.source=t.layer.source,t.layer["source-layer"]&&(t.sourceLayer=t.layer["source-layer"]),t.state=r}));return p}function N(e,t){return e=e.tileID,t=t.tileID,e.overscaledZ-t.overscaledZ||e.canonical.y-t.canonical.y||e.wrap-t.wrap||e.canonical.x-t.canonical.x}function z(e,r,n){return t.__awaiter(this,void 0,void 0,(function*(){let i=e;var o;return e.url?i=(o=yield t.getJSON(r.transformRequest(e.url,"Source"),n)).data:yield a.frameAsync(n),i?(o=t.pick(t.extend(i,e),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]),"vector_layers"in i&&i.vector_layers&&(o.vectorLayerIds=i.vector_layers.map((e=>e.id))),o):null}))}class F{constructor(e,t){e&&(t?this.setSouthWest(e).setNorthEast(t):Array.isArray(e)&&(4===e.length?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof t.LngLat?new t.LngLat(e.lng,e.lat):t.LngLat.convert(e),this}setSouthWest(e){return this._sw=e instanceof t.LngLat?new t.LngLat(e.lng,e.lat):t.LngLat.convert(e),this}extend(e){var r,n=this._sw,i=this._ne;let o,a;if(e instanceof t.LngLat)o=e,a=e;else{if(!(e instanceof F))return Array.isArray(e)?4===e.length||e.every(Array.isArray)?(r=e,this.extend(F.convert(r))):this.extend(t.LngLat.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(t.LngLat.convert(e)):this;if(o=e._sw,a=e._ne,!o||!a)return this}return n||i?(n.lng=Math.min(o.lng,n.lng),n.lat=Math.min(o.lat,n.lat),i.lng=Math.max(a.lng,i.lng),i.lat=Math.max(a.lat,i.lat)):(this._sw=new t.LngLat(o.lng,o.lat),this._ne=new t.LngLat(a.lng,a.lat)),this}getCenter(){return new t.LngLat((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new t.LngLat(this.getWest(),this.getNorth())}getSouthEast(){return new t.LngLat(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){var{lng:e,lat:r}=t.LngLat.convert(e),r=this._sw.lat<=r&&r<=this._ne.lat;let n=this._sw.lng<=e&&e<=this._ne.lng;return this._sw.lng>this._ne.lng&&(n=this._sw.lng>=e&&e>=this._ne.lng),r&&n}static convert(e){return e instanceof F?e:e&&new F(e)}static fromLngLat(e){return function(r){var n=(r=360*r/40075017)/Math.cos(Math.PI/180*e.lat);return new F(new t.LngLat(e.lng-n,e.lat-r),new t.LngLat(e.lng+n,e.lat+r))}(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)}}class B{constructor(e,t,r){this.bounds=F.convert(this.validateBounds(e)),this.minzoom=t||0,this.maxzoom=r||24}validateBounds(e){return Array.isArray(e)&&4===e.length?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){var r=Math.pow(2,e.z);const n=Math.floor(t.mercatorXfromLng(this.bounds.getWest())*r),i=Math.floor(t.mercatorYfromLat(this.bounds.getNorth())*r),o=Math.ceil(t.mercatorXfromLng(this.bounds.getEast())*r),a=Math.ceil(t.mercatorYfromLat(this.bounds.getSouth())*r);return e.x>=n&&e.x<o&&e.y>=i&&e.y<a}}class U extends t.Evented{constructor(e,r,n,i){if(super(),this.id=e,this.dispatcher=n,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,t.extend(this,t.pick(r,["url","scheme","tileSize","promoteId"])),this._options=t.extend({type:"vector"},r),this._collectResourceTiming=r.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(i)}load(){return t.__awaiter(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{var e=yield z(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(t.extend(this,e),e.bounds&&(this.tileBounds=new B(e.bounds,this.minzoom,this.maxzoom)),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new t.ErrorEvent(e))}}))}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty((()=>{this._options.tiles=e})),this}setUrl(e){return this.setSourceProperty((()=>{this.url=e,this._options.url=e})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return t.extend({},this._options)}loadTile(e){return t.__awaiter(this,void 0,void 0,(function*(){var t=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);(t={request:this.map._requestManager.transformRequest(t,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId}).request.collectResourceTiming=this._collectResourceTiming;let r="RT";if(e.actor&&"expired"!==e.state){if("loading"===e.state)return new Promise(((t,r)=>{e.reloadPromise={resolve:t,reject:r}}))}else e.actor=this.dispatcher.getActor(),r="LT";e.abortController=new AbortController;try{var n=yield e.actor.sendAsync({type:r,data:t},e.abortController);delete e.abortController,e.aborted||this._afterTileLoadWorkerResponse(e,n)}catch(t){if(delete e.abortController,!e.aborted){if(t&&404!==t.status)throw t;this._afterTileLoadWorkerResponse(e,null)}}}))}_afterTileLoadWorkerResponse(e,t){t&&t.resourceTiming&&(e.resourceTiming=t.resourceTiming),t&&this.map._refreshExpiredTiles&&e.setExpiryData(t),e.loadVectorData(t,this.map.painter),e.reloadPromise&&(t=e.reloadPromise,e.reloadPromise=null,this.loadTile(e).then(t.resolve).catch(t.reject))}abortTile(e){return t.__awaiter(this,void 0,void 0,(function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))}))}unloadTile(e){return t.__awaiter(this,void 0,void 0,(function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))}))}hasTransition(){return!1}}class j extends t.Evented{constructor(e,r,n,i){super(),this.id=e,this.dispatcher=n,this.setEventedParent(i),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=t.extend({type:"raster"},r),t.extend(this,t.pick(r,["url","scheme","tileSize"]))}load(){return t.__awaiter(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{var e=yield z(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,e&&(t.extend(this,e),e.bounds&&(this.tileBounds=new B(e.bounds,this.minzoom,this.maxzoom)),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new t.ErrorEvent(e))}}))}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load()}setTiles(e){return this.setSourceProperty((()=>{this._options.tiles=e})),this}setUrl(e){return this.setSourceProperty((()=>{this.url=e,this._options.url=e})),this}serialize(){return t.extend({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return t.__awaiter(this,void 0,void 0,(function*(){var t=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{var n,i,o,a=yield r.getImage(this.map._requestManager.transformRequest(t,"Tile"),e.abortController,this.map._refreshExpiredTiles);delete e.abortController,e.aborted?e.state="unloaded":a&&a.data&&(this.map._refreshExpiredTiles&&a.cacheControl&&a.expires&&e.setExpiryData({cacheControl:a.cacheControl,expires:a.expires}),i=(n=this.map.painter.context).gl,o=a.data,e.texture=this.map.painter.getTileTexture(o.width),e.texture?e.texture.update(o,{useMipmap:!0}):(e.texture=new y(n,o,i.RGBA,{useMipmap:!0}),e.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE,i.LINEAR_MIPMAP_NEAREST),n.extTextureFilterAnisotropic&&i.texParameterf(i.TEXTURE_2D,n.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,n.extTextureFilterAnisotropicMax)),e.state="loaded")}catch(t){if(delete e.abortController,e.aborted)e.state="unloaded";else if(t)throw e.state="errored",t}}))}abortTile(e){return t.__awaiter(this,void 0,void 0,(function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)}))}unloadTile(e){return t.__awaiter(this,void 0,void 0,(function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)}))}hasTransition(){return!1}}class q extends j{constructor(e,r,n,i){super(e,r,n,i),this.type="raster-dem",this.maxzoom=22,this._options=t.extend({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox",this.redFactor=r.redFactor,this.greenFactor=r.greenFactor,this.blueFactor=r.blueFactor,this.baseShift=r.baseShift}loadTile(e){return t.__awaiter(this,void 0,void 0,(function*(){var n=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);n=this.map._requestManager.transformRequest(n,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{var i,o,a,s,l=yield r.getImage(n,e.abortController,this.map._refreshExpiredTiles);delete e.abortController,e.aborted?e.state="unloaded":l&&l.data&&(i=l.data,this.map._refreshExpiredTiles&&l.cacheControl&&l.expires&&e.setExpiryData({cacheControl:l.cacheControl,expires:l.expires}),o=t.isImageBitmap(i)&&t.offscreenCanvasSupported()?i:yield this.readImageNow(i),a={type:this.type,uid:e.uid,source:this.id,rawImageData:o,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift},e.actor&&"expired"!==e.state||(e.actor=this.dispatcher.getActor(),s=yield e.actor.sendAsync({type:"LDT",data:a}),e.dem=s,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"))}catch(n){if(delete e.abortController,e.aborted)e.state="unloaded";else if(n)throw e.state="errored",n}}))}readImageNow(e){return t.__awaiter(this,void 0,void 0,(function*(){if("undefined"!=typeof VideoFrame&&t.isOffscreenCanvasDistorted()){var r=e.width+2,n=e.height+2;try{return new t.RGBAImage({width:r,height:n},yield t.readImageUsingVideoFrame(e,-1,-1,r,n))}catch(r){}}return a.getImageData(e,1)}))}_getNeighboringTiles(e){var r=e.canonical,n=Math.pow(2,r.z),i=(r.x-1+n)%n,o=0===r.x?e.wrap-1:e.wrap,a=(r.x+1+n)%n,s=r.x+1===n?e.wrap+1:e.wrap,l={};return l[new t.OverscaledTileID(e.overscaledZ,o,r.z,i,r.y).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,s,r.z,a,r.y).key]={backfilled:!1},0<r.y&&(l[new t.OverscaledTileID(e.overscaledZ,o,r.z,i,r.y-1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,e.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,s,r.z,a,r.y-1).key]={backfilled:!1}),r.y+1<n&&(l[new t.OverscaledTileID(e.overscaledZ,o,r.z,i,r.y+1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,e.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,s,r.z,a,r.y+1).key]={backfilled:!1}),l}unloadTile(e){return t.__awaiter(this,void 0,void 0,(function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))}))}}class H extends t.Evented{constructor(e,r,n,i){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=n.getActor(),this.setEventedParent(i),this._data=r.data,this._options=t.extend({},r),this._collectResourceTiming=r.collectResourceTiming,void 0!==r.maxzoom&&(this.maxzoom=r.maxzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId,e=t.EXTENT/this.tileSize,this.workerOptions=t.extend({source:this.id,cluster:r.cluster||!1,geojsonVtOptions:{buffer:(void 0!==r.buffer?r.buffer:128)*e,tolerance:(void 0!==r.tolerance?r.tolerance:.375)*e,extent:t.EXTENT,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:void 0!==r.clusterMaxZoom?r.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:t.EXTENT,radius:(r.clusterRadius||50)*e,log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter},r.workerOptions),"string"==typeof this.promoteId&&(this.workerOptions.promoteId=this.promoteId)}load(){return t.__awaiter(this,void 0,void 0,(function*(){yield this._updateWorkerData()}))}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(e){return this._updateWorkerData(e),this}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(void 0!==e.clusterRadius&&(this.workerOptions.superclusterOptions.radius=e.clusterRadius),void 0!==e.clusterMaxZoom)&&(this.workerOptions.superclusterOptions.maxZoom=e.clusterMaxZoom),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,t,r){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:t,offset:r}})}_updateWorkerData(e){return t.__awaiter(this,void 0,void 0,(function*(){var r=t.extend({type:this.type},this.workerOptions);e?r.dataDiff=e:"string"==typeof this._data?(r.request=this.map._requestManager.transformRequest(a.resolveURL(this._data),"Source"),r.request.collectResourceTiming=this._collectResourceTiming):r.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new t.Event("dataloading",{dataType:"source"}));try{var n=yield this.actor.sendAsync({type:"LD",data:r});if(this._pendingLoads--,this._removed||n.abandoned)this.fire(new t.Event("dataabort",{dataType:"source"}));else{let e=null;n.resourceTiming&&n.resourceTiming[this.id]&&(e=n.resourceTiming[this.id].slice(0));var i={dataType:"source"};this._collectResourceTiming&&e&&0<e.length&&t.extend(i,{resourceTiming:e}),this.fire(new t.Event("data",Object.assign(Object.assign({},i),{sourceDataType:"metadata"}))),this.fire(new t.Event("data",Object.assign(Object.assign({},i),{sourceDataType:"content"})))}}catch(r){this._pendingLoads--,this._removed?this.fire(new t.Event("dataabort",{dataType:"source"})):this.fire(new t.ErrorEvent(r))}}))}loaded(){return 0===this._pendingLoads}loadTile(e){return t.__awaiter(this,void 0,void 0,(function*(){var t=e.actor?"RT":"LT",r=(e.actor=this.actor,{type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId});e.abortController=new AbortController,r=yield this.actor.sendAsync({type:t,data:r},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(r,this.map.painter,"RT"==t)}))}abortTile(e){return t.__awaiter(this,void 0,void 0,(function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0}))}unloadTile(e){return t.__awaiter(this,void 0,void 0,(function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})}))}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return t.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var V=t.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class G extends t.Evented{constructor(e,t,r,n){super(),this.id=e,this.dispatcher=r,this.coordinates=t.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(n),this.options=t}load(e){return t.__awaiter(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{var n=yield r.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,n&&n.data&&(this.image=n.data,e&&(this.coordinates=e),this._finishLoading())}catch(n){this._request=null,this.fire(new t.ErrorEvent(n))}}))}loaded(){return this._loaded}updateImage(e){return e.url&&(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally((()=>{this.texture=null}))),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){return e=(this.coordinates=e).map(t.MercatorCoordinate.fromLngLat),this.tileID=function(e){let r=1/0,n=1/0,i=-1/0,o=-1/0;for(const t of e)r=Math.min(r,t.x),n=Math.min(n,t.y),i=Math.max(i,t.x),o=Math.max(o,t.y);e=i-r;var a=o-n;e=Math.max(e,a),a=Math.max(0,Math.floor(-Math.log(e)/Math.LN2)),e=Math.pow(2,a);return new t.CanonicalTileID(a,Math.floor((r+i)/2*e),Math.floor((n+o)/2*e))}(e),this.minzoom=this.maxzoom=this.tileID.z,e=e.map((e=>this.tileID.getTilePoint(e)._round())),this._boundsArray=new t.RasterBoundsArray,this._boundsArray.emplaceBack(e[0].x,e[0].y,0,0),this._boundsArray.emplaceBack(e[1].x,e[1].y,t.EXTENT,0),this._boundsArray.emplaceBack(e[3].x,e[3].y,0,t.EXTENT),this._boundsArray.emplaceBack(e[2].x,e[2].y,t.EXTENT,t.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(0!==Object.keys(this.tiles).length&&this.image){var e=this.map.painter.context,r=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,V.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new y(e,this.image,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE));let i=!1;for(const e in this.tiles){var n=this.tiles[e];"loaded"!==n.state&&(n.state="loaded",n.texture=this.texture,i=!0)}i&&this.fire(new t.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}}loadTile(e){return t.__awaiter(this,void 0,void 0,(function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e).buckets={}:e.state="errored"}))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class K extends G{constructor(e,t,r,n){super(e,t,r,n),this.roundZoom=!0,this.type="video",this.options=t}load(){return t.__awaiter(this,void 0,void 0,(function*(){this._loaded=!1;var e=this.options;this.urls=[];for(const t of e.urls)this.urls.push(this.map._requestManager.transformRequest(t,"Source").url);try{var r=yield t.getVideo(this.urls);this._loaded=!0,r&&(this.video=r,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading())}catch(e){this.fire(new t.ErrorEvent(e))}}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){var r;this.video&&(e<(r=this.video.seekable).start(0)||e>r.end(0)?this.fire(new t.ErrorEvent(new t.ValidationError("sources."+this.id,null,`Playback for this video can be set only between the ${r.start(0)} and ${r.end(0)}-second mark.`))):this.video.currentTime=e)}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var e=this.map.painter.context,r=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,V.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new y(e,this.video,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE));let i=!1;for(const e in this.tiles){var n=this.tiles[e];"loaded"!==n.state&&(n.state="loaded",n.texture=this.texture,i=!0)}i&&this.fire(new t.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Z extends G{constructor(e,r,n,i){super(e,r,n,i),r.coordinates?Array.isArray(r.coordinates)&&4===r.coordinates.length&&!r.coordinates.some((e=>!Array.isArray(e)||2!==e.length||e.some((e=>"number"!=typeof e))))||this.fire(new t.ErrorEvent(new t.ValidationError("sources."+e,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new t.ErrorEvent(new t.ValidationError("sources."+e,null,'missing required property "coordinates"'))),r.animate&&"boolean"!=typeof r.animate&&this.fire(new t.ErrorEvent(new t.ValidationError("sources."+e,null,'optional "animate" property must be a boolean value'))),r.canvas?"string"==typeof r.canvas||r.canvas instanceof HTMLCanvasElement||this.fire(new t.ErrorEvent(new t.ValidationError("sources."+e,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new t.ErrorEvent(new t.ValidationError("sources."+e,null,'missing required property "canvas"'))),this.options=r,this.animate=void 0===r.animate||r.animate}load(){return t.__awaiter(this,void 0,void 0,(function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new t.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}))}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var r=this.map.painter.context,n=r.gl;this.boundsBuffer||(this.boundsBuffer=r.createVertexBuffer(this._boundsArray,V.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new y(r,this.canvas,n.RGBA,{premultiply:!0});let o=!1;for(const e in this.tiles){var i=this.tiles[e];"loaded"!==i.state&&(i.state="loaded",i.texture=this.texture,o=!0)}o&&this.fire(new t.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const W={},$=e=>{switch(e){case"geojson":return H;case"image":return G;case"raster":return j;case"raster-dem":return q;case"vector":return U;case"video":return K;case"canvas":return Z}return W[e]};const Y="RTLPluginLoaded";class X extends t.Evented{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=L()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch((e=>{throw this.status="error",e}))}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return t.__awaiter(this,arguments,void 0,(function(e){var t=this;let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function*(){if(t.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(t.url=a.resolveURL(e),!t.url)throw new Error(`requested url ${e} is invalid`);if("unavailable"===t.status){if(!r)return t._requestImport();t.status="deferred",t._syncState(t.status)}else if("requested"===t.status)return t._requestImport()}()}))}_requestImport(){return t.__awaiter(this,void 0,void 0,(function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new t.Event(Y))}))}lazyLoad(){"unavailable"===this.status?this.status="requested":"deferred"===this.status&&this._requestImport()}}let Q=null;function J(){return Q=Q||new X}class ee{constructor(e,r){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=t.uniqueId(),this.uses=0,this.tileSize=r,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){(e+=this.timeAdded)<this.fadeEndTime||(this.fadeEndTime=e)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,r,n){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(e,t){var r={};if(t)for(const n of e){const e=n.layerIds.map((e=>t.getLayer(e))).filter(Boolean);if(0!==e.length){n.layers=e,n.stateDependentLayerIds&&(n.stateDependentLayers=n.stateDependentLayerIds.map((t=>e.filter((e=>e.id===t))[0])));for(const t of e)r[t.id]=n}}return r}(e.buckets,r.style),this.hasSymbolBuckets=!1;for(const e in this.buckets){var i=this.buckets[e];if(i instanceof t.SymbolBucket){if(this.hasSymbolBuckets=!0,!n)break;i.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const e in this.buckets){var o=this.buckets[e];if(o instanceof t.SymbolBucket&&o.hasRTLText){this.hasRTLText=!0,J().lazyLoad();break}}this.queryPadding=0;for(const e in this.buckets){var a=this.buckets[e];this.queryPadding=Math.max(this.queryPadding,r.style.getLayer(e).queryRadius(a))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new t.CollisionBoxArray}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const n in this.buckets){var t=this.buckets[n];t.uploadPending()&&t.upload(e)}var r=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new y(e,this.imageAtlas.image,r.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new y(e,this.glyphAtlasImage,r.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,t,r,n,i,o,a,s,l,c){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:n,cameraQueryGeometry:i,scale:o,tileSize:this.tileSize,pixelPosMatrix:c,transform:s,params:a,queryPadding:this.queryPadding*l},e,t,r):{}}querySourceFeatures(e,r){var n=this.latestFeatureIndex;if(n&&n.rawTileData){var i=n.loadVTLayers(),o=r&&r.sourceLayer?r.sourceLayer:"",a=i._geojsonTileLayer||i[o];if(a){var s=t.createFilter(r&&r.filter),{z:l,x:c,y:u}=this.tileID.canonical,h={z:l,x:c,y:u};for(let r=0;r<a.length;r++){var d=a.feature(r);if(s.needGeometry){var p=t.toEvaluationFeature(d,!0);if(!s.filter(new t.EvaluationParameters(this.tileID.overscaledZ),p,this.tileID.canonical))continue}else if(!s.filter(new t.EvaluationParameters(this.tileID.overscaledZ),d))continue;p=n.getId(d,o),(d=new t.GeoJSONFeature(d,l,c,u,p)).tile=h,e.push(d)}}}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){var r=this.expirationTime;if(e.cacheControl?(n=t.parseCacheControl(e.cacheControl))["max-age"]&&(this.expirationTime=Date.now()+1e3*n["max-age"]):e.expires&&(this.expirationTime=new Date(e.expires).getTime()),this.expirationTime){var n=Date.now();let t=!1;this.expirationTime>n?t=!1:!r||this.expirationTime<r||!(e=this.expirationTime-r)?t=!0:this.expirationTime=n+Math.max(e,3e4),t?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(e,t){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(e).length){var r,n,i,o=this.latestFeatureIndex.loadVTLayers();for(const a in this.buckets)t.style.hasLayer(a)&&(n=o[i=(r=this.buckets[a]).layers[0].sourceLayer||"_geojsonTileLayer"],i=e[i],n)&&i&&0!==Object.keys(i).length&&(r.update(i,n,this.imageAtlas&&this.imageAtlas.patternPositions||{}),i=t&&t.style&&t.style.getLayer(a))&&(this.queryPadding=Math.max(this.queryPadding,i.queryRadius(r)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<a.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=a.now()+e}setDependencies(e,t){var r={};for(const n of t)r[n]=!0;this.dependencies[e]=r}hasDependency(e,t){for(const n of e){var r=this.dependencies[n];if(r)for(const e of t)if(r[e])return!0}return!1}}class te{constructor(e,t){this.max=e,this.onRemove=t,this.reset()}reset(){for(const e in this.data)for(const t of this.data[e])t.timeout&&clearTimeout(t.timeout),this.onRemove(t.value);return this.data={},this.order=[],this}add(e,t,r){var n=e.wrapped().key;void 0===this.data[n]&&(this.data[n]=[]);const i={value:t,timeout:void 0};return void 0!==r&&(i.timeout=setTimeout((()=>{this.remove(e,i)}),r)),this.data[n].push(i),this.order.push(n),this.order.length>this.max&&(t=this._getAndRemoveByKey(this.order[0]))&&this.onRemove(t),this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){var t=this.data[e].shift();return t.timeout&&clearTimeout(t.timeout),0===this.data[e].length&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),t.value}getByKey(e){return(e=this.data[e])?e[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,t){var r;return this.has(e)&&(e=e.wrapped().key,t=void 0===t?0:this.data[e].indexOf(t),r=this.data[e][t],this.data[e].splice(t,1),r.timeout&&clearTimeout(r.timeout),0===this.data[e].length&&delete this.data[e],this.onRemove(r.value),this.order.splice(this.order.indexOf(e),1)),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){var t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this}filter(e){var t=[];for(const r in this.data)for(const n of this.data[r])e(n.value)||t.push(n);for(const r of t)this.remove(r.value.tileID,r)}}class re{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,r,n){var i=String(r);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][i]=this.stateChanges[e][i]||{},t.extend(this.stateChanges[e][i],n),null===this.deletedStates[e]){this.deletedStates[e]={};for(const t in this.state[e])t!==i&&(this.deletedStates[e][t]=null)}else if(this.deletedStates[e]&&null===this.deletedStates[e][i]){this.deletedStates[e][i]={};for(const t in this.state[e][i])n[t]||(this.deletedStates[e][i][t]=null)}else for(const t in n)this.deletedStates[e]&&this.deletedStates[e][i]&&null===this.deletedStates[e][i][t]&&delete this.deletedStates[e][i][t]}removeFeatureState(e,t,r){if(!(null===this.deletedStates[e])){var n=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},r&&void 0!==t)null!==this.deletedStates[e][n]&&(this.deletedStates[e][n]=this.deletedStates[e][n]||{},this.deletedStates[e][n][r]=null);else if(void 0!==t)if(this.stateChanges[e]&&this.stateChanges[e][n])for(r in this.deletedStates[e][n]={},this.stateChanges[e][n])this.deletedStates[e][n][r]=null;else this.deletedStates[e][n]=null;else this.deletedStates[e]=null}}getState(e,r){var n=String(r),i=this.state[e]||{},o=this.stateChanges[e]||{},a=t.extend({},i[n],o[n]);if(null===this.deletedStates[e])return{};if(this.deletedStates[e]){if(null===(i=this.deletedStates[e][r]))return{};for(const e in i)delete a[e]}return a}initializeTileState(e,t){e.setFeatureState(this.state,t)}coalesceChanges(e,r){var n={};for(const a in this.stateChanges){this.state[a]=this.state[a]||{};var i={};for(const e in this.stateChanges[a])this.state[a][e]||(this.state[a][e]={}),t.extend(this.state[a][e],this.stateChanges[a][e]),i[e]=this.state[a][e];n[a]=i}for(const a in this.deletedStates){this.state[a]=this.state[a]||{};var o={};if(null===this.deletedStates[a])for(const e in this.state[a])o[e]={},this.state[a][e]={};else for(const e in this.deletedStates[a]){if(null===this.deletedStates[a][e])this.state[a][e]={};else for(const t of Object.keys(this.deletedStates[a][e]))delete this.state[a][e][t];o[e]=this.state[a][e]}n[a]=n[a]||{},t.extend(n[a],o)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(n).length)for(const t in e)e[t].setFeatureState(n,r)}}class ne extends t.Evented{constructor(e,t,r){super(),this.id=e,this.dispatcher=r,this.on("data",(e=>{"source"===e.dataType&&"metadata"===e.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===e.dataType&&"content"===e.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)})),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((e,t,r,n)=>{if((t=new($(t.type))(e,t,r,n)).id!==e)throw new Error(`Expected Source id to be ${e} instead of `+t.id);return t})(e,t,r,this),this._tiles={},this._cache=new te(0,(e=>this._unloadTile(e))),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new re,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(!this._sourceErrored){if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;if(void 0===this.used&&void 0===this.usedForTerrain||this.used||this.usedForTerrain){if(!this._updated)return!1;for(const t in this._tiles){var e=this._tiles[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}}}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){var e;this._paused&&(e=this._shouldReloadOnResume,this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform)&&this.update(this.transform,this.terrain)}_loadTile(e,r,n){return t.__awaiter(this,void 0,void 0,(function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,r,n)}catch(r){e.state="errored",404!==r.status?this._source.fire(new t.ErrorEvent(r,{tile:e})):this.update(this.transform,this.terrain)}}))}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new t.Event("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const r in this._tiles){var t=this._tiles[r];t.upload(e),t.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map((e=>e.tileID)).sort(ie).map((e=>e.key))}getRenderableIds(e){var r=[];for(const t in this._tiles)this._isIdRenderable(t,e)&&r.push(this._tiles[t]);return e?r.sort(((e,r)=>{e=e.tileID,r=r.tileID;var n=new t.Point(e.canonical.x,e.canonical.y)._rotate(this.transform.angle),i=new t.Point(r.canonical.x,r.canonical.y)._rotate(this.transform.angle);return e.overscaledZ-r.overscaledZ||i.y-n.y||i.x-n.x})).map((e=>e.tileID.key)):r.map((e=>e.tileID)).sort(ie).map((e=>e.key))}hasRenderableParent(e){return!!(e=this.findLoadedParent(e,0))&&this._isIdRenderable(e.tileID.key)}_isIdRenderable(e,t){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(t||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)"errored"!==this._tiles[e].state&&this._reloadTile(e,"reloading")}}_reloadTile(e,r){return t.__awaiter(this,void 0,void 0,(function*(){var t=this._tiles[e];t&&("loading"!==t.state&&(t.state=r),yield this._loadTile(t,e,r))}))}_tileLoaded(e,r,n){e.timeAdded=a.now(),"expired"===n&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(r,e),"raster-dem"===this.getSource().type&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new t.Event("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){var t=this.getRenderableIds();for(let i=0;i<t.length;i++){var r=t[i];e.neighboringTiles&&e.neighboringTiles[r]&&(n(e,r=this.getTileByID(r)),n(r,e))}function n(e,t){e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0;let r=t.tileID.canonical.x-e.tileID.canonical.x;var n=t.tileID.canonical.y-e.tileID.canonical.y,i=Math.pow(2,e.tileID.canonical.z),o=t.tileID.key;0===r&&0==n||1<Math.abs(n)||(1<Math.abs(r)&&(1===Math.abs(r+i)?r+=i:1===Math.abs(r-i)&&(r-=i)),t.dem&&e.dem&&(e.dem.backfillBorder(t.dem,r,n),e.neighboringTiles)&&e.neighboringTiles[o]&&(e.neighboringTiles[o].backfilled=!0))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,t,r,n){for(const o in this._tiles){let a=this._tiles[o];if(!(n[o]||!a.hasData()||a.tileID.overscaledZ<=t||a.tileID.overscaledZ>r)){let r=a.tileID;for(;a&&a.tileID.overscaledZ>t+1;){var i=a.tileID.scaledTo(a.tileID.overscaledZ-1);(a=this._tiles[i.key])&&a.hasData()&&(r=i)}let o=r;for(;o.overscaledZ>t;)if(e[(o=o.scaledTo(o.overscaledZ-1)).key]){n[r.key]=r;break}}}}findLoadedParent(e,t){var r;if(e.key in this._loadedParentTiles)return(r=this._loadedParentTiles[e.key])&&r.tileID.overscaledZ>=t?r:null;for(let i=e.overscaledZ-1;i>=t;i--){var n=e.scaledTo(i);if(n=this._getLoadedTile(n))return n}}_getLoadedTile(e){var t=this._tiles[e.key];return t&&t.hasData()?t:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){var r=Math.ceil(e.width/this._source.tileSize)+1,n=(e=Math.ceil(e.height/this._source.tileSize)+1,null===this._maxTileCacheZoomLevels?t.config.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels);r=Math.floor(r*e*n),e="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,r):r;this._cache.setMaxSize(e)}handleWrapJump(e){var t=void 0===this._prevLng?e:this._prevLng,r=Math.round((e-t)/360);if(this._prevLng=e,r){var n={};for(const e in this._tiles){var i=this._tiles[e];i.tileID=i.tileID.unwrapTo(i.tileID.wrap+r),n[i.tileID.key]=i}this._tiles=n;for(const e in this._timers)clearTimeout(this._timers[e]),delete this._timers[e];for(const e in this._tiles){var o=this._tiles[e];this._setTileReloadTimer(e,o)}}}update(e,r){if(this.transform=e,this.terrain=r,this._sourceLoaded&&!this._paused){let b;this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?b=e.getVisibleUnwrappedCoordinates(this._source.tileID).map((e=>new t.OverscaledTileID(e.canonical.z,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y))):(b=e.coveringTiles({tileSize:(this.usedForTerrain?this:this._source).tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:r}),this._source.hasTile&&(b=b.filter((e=>this._source.hasTile(e))))):b=[];e=e.coveringZoomLevel(this._source);var n=Math.max(e-ne.maxOverzooming,this._source.minzoom),i=Math.max(e+ne.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){var o,s={};for(const e of b)e.canonical.z>this._source.minzoom&&(s[(o=e.scaledTo(e.canonical.z-1)).key]=o,s[(o=e.scaledTo(Math.max(this._source.minzoom,Math.min(e.canonical.z,5)))).key]=o);b=b.concat(Object.values(s))}var l=0===b.length&&!this._updated&&this._didEmitContent,c=(this._updated=!0,l&&this.fire(new t.Event("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id})),this._updateRetainedTiles(b,e));if(oe(this._source.type)){var u={},h={},d=(l=Object.keys(c),a.now());for(const e of l){var p=c[e],f=this._tiles[e];!f||0!==f.fadeEndTime&&f.fadeEndTime<=d||((f=this.findLoadedParent(p,n))&&(this._addTile(f.tileID),u[f.tileID.key]=f.tileID),h[e]=p)}this._retainLoadedChildren(h,e,i,c);for(const e in u)c[e]||(this._coveredTiles[e]=!0,c[e]=u[e]);if(r){var m={},g={};for(const e of b)this._tiles[e.key].hasData()?m[e.key]=e:g[e.key]=e;for(const e in g){var y=g[e].children(this._source.maxzoom);this._tiles[y[0].key]&&this._tiles[y[1].key]&&this._tiles[y[2].key]&&this._tiles[y[3].key]&&(m[y[0].key]=c[y[0].key]=y[0],m[y[1].key]=c[y[1].key]=y[1],m[y[2].key]=c[y[2].key]=y[2],m[y[3].key]=c[y[3].key]=y[3],delete g[e])}for(const e in g){var v=this.findLoadedParent(g[e],this._source.minzoom);if(v){m[v.tileID.key]=c[v.tileID.key]=v.tileID;for(const e in m)m[e].isChildOf(v.tileID)&&delete m[e]}}for(const e in this._tiles)m[e]||(this._coveredTiles[e]=!0)}}for(const e in c)this._tiles[e].clearFadeHold();for(const e of t.keysDifference(this._tiles,c)){var _=this._tiles[e];_.hasSymbolBuckets&&!_.holdingForFade()?_.setHoldDuration(this.map._fadeDuration):_.hasSymbolBuckets&&!_.symbolFadeFinished()||this._removeTile(e)}this._updateLoadedParentTileCache()}}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,t){var r={},n={},i=Math.max(t-ne.maxOverzooming,this._source.minzoom),o=Math.max(t+ne.maxUnderzooming,this._source.minzoom),a={};for(const d of e){var s=this._addTile(d);r[d.key]=d,s.hasData()||t<this._source.maxzoom&&(a[d.key]=d)}this._retainLoadedChildren(a,t,o,r);for(const d of e){let e=this._tiles[d.key];if(!e.hasData()){if(t+1>this._source.maxzoom){var l=d.children(this._source.maxzoom)[0],c=this.getTile(l);if(c&&c.hasData()){r[l.key]=l;continue}}else if(r[(c=d.children(this._source.maxzoom))[0].key]&&r[c[1].key]&&r[c[2].key]&&r[c[3].key])continue;let o=e.wasRequested();for(let t=d.overscaledZ-1;t>=i;--t){var u=d.scaledTo(t);if(n[u.key])break;if(n[u.key]=!0,e=!(e=this.getTile(u))&&o?this._addTile(u):e){var h=e.hasData();if((o||h)&&(r[u.key]=u),o=e.wasRequested(),h)break}}}}return r}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const r in this._tiles){var e=[];let n,i=this._tiles[r].tileID;for(;0<i.overscaledZ;){if(i.key in this._loadedParentTiles){n=this._loadedParentTiles[i.key];break}e.push(i.key);var t=i.scaledTo(i.overscaledZ-1);if(n=this._getLoadedTile(t))break;i=t}for(const t of e)this._loadedParentTiles[t]=n}}_addTile(e){let r=this._tiles[e.key];var n;return r||((r=this._cache.getAndRemove(e))&&(this._setTileReloadTimer(e.key,r),r.tileID=e,this._state.initializeTileState(r,this.map?this.map.painter:null),this._cacheTimers[e.key])&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,r)),(n=r)||(r=new ee(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(r,e.key,r.state)),r.uses++,this._tiles[e.key]=r,n)||this._source.fire(new t.Event("dataloading",{tile:r,coord:r.tileID,dataType:"source"})),r}_setTileReloadTimer(e,t){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]),(t=t.getExpiryTimeout())&&(this._timers[e]=setTimeout((()=>{this._reloadTile(e,"expired"),delete this._timers[e]}),t))}_removeTile(e){var t=this._tiles[e];t&&(t.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),0<t.uses||(t.hasData()&&"reloading"!==t.state?this._cache.add(t.tileID,t,t.getExpiryTimeout()):(t.aborted=!0,this._abortTile(t),this._unloadTile(t))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,r,n){var i=[];const o=this.transform;if(o){n=n?o.getCameraQueryGeometry(e):e;var a=e.map((e=>o.pointCoordinate(e,this.terrain))),s=n.map((e=>o.pointCoordinate(e,this.terrain))),l=this.getIds();let p=1/0,f=1/0,m=-1/0,g=-1/0;for(const e of s)p=Math.min(p,e.x),f=Math.min(f,e.y),m=Math.max(m,e.x),g=Math.max(g,e.y);for(let e=0;e<l.length;e++){var c=this._tiles[l[e]];if(!c.holdingForFade()){const e=c.tileID;var u=Math.pow(2,o.zoom-c.tileID.overscaledZ),h=r*c.queryPadding*t.EXTENT/c.tileSize/u,d=[e.getTilePoint(new t.MercatorCoordinate(p,f)),e.getTilePoint(new t.MercatorCoordinate(m,g))];d[0].x-h<t.EXTENT&&d[0].y-h<t.EXTENT&&0<=d[1].x+h&&0<=d[1].y+h&&(d=a.map((t=>e.getTilePoint(t))),h=s.map((t=>e.getTilePoint(t))),i.push({tile:c,tileID:e,queryGeometry:d,cameraQueryGeometry:h,scale:u}))}}}return i}getVisibleCoordinates(e){e=this.getRenderableIds(e).map((e=>this._tiles[e].tileID));for(const t of e)t.posMatrix=this.transform.calculatePosMatrix(t.toUnwrapped());return e}hasTransition(){if(this._source.hasTransition())return!0;if(oe(this._source.type)){var e=a.now();for(const t in this._tiles)if(this._tiles[t].fadeEndTime>=e)return!0}return!1}setFeatureState(e,t,r){this._state.updateState(e=e||"_geojsonTileLayer",t,r)}removeFeatureState(e,t,r){this._state.removeFeatureState(e=e||"_geojsonTileLayer",t,r)}getFeatureState(e,t){return this._state.getState(e=e||"_geojsonTileLayer",t)}setDependencies(e,t,r){(e=this._tiles[e])&&e.setDependencies(t,r)}reloadTilesForDependencies(e,t){for(const r in this._tiles)this._tiles[r].hasDependency(e,t)&&this._reloadTile(r,"reloading");this._cache.filter((r=>!r.hasDependency(e,t)))}}function ie(e,t){var r=Math.abs(2*e.wrap)-(e.wrap<0),n=Math.abs(2*t.wrap)-(t.wrap<0);return e.overscaledZ-t.overscaledZ||n-r||t.canonical.y-e.canonical.y||t.canonical.x-e.canonical.x}function oe(e){return"raster"===e||"image"===e||"video"===e}ne.maxOverzooming=10,ne.maxUnderzooming=3;class ae{constructor(e,t){this.reset(e,t)}reset(e,t){this.points=e||[],this._distances=[0];for(let r=1;r<this.points.length;r++)this._distances[r]=this._distances[r-1]+this.points[r].dist(this.points[r-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(t||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(1===this.points.length)return this.points[0];e=t.clamp(e,0,1);let r=1,n=this._distances[r];for(var i=e*this.paddedLength+this.padding;n<i&&r<this._distances.length;)n=this._distances[++r];e=r-1;var o=n-(a=this._distances[e]),a=0<o?(i-a)/o:0;return this.points[e].mult(1-a).add(this.points[r].mult(a))}}function se(e,t){return"always"===e||"never"!==e&&"never"!==t}class le{constructor(e,t,r){var n=this.boxCells=[],i=this.circleCells=[];this.xCellCount=Math.ceil(e/r),this.yCellCount=Math.ceil(t/r);for(let o=0;o<this.xCellCount*this.yCellCount;o++)n.push([]),i.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=t,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/t,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,t,r,n,i){this._forEachCell(t,r,n,i,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(i)}insertCircle(e,t,r,n){this._forEachCell(t-n,r-n,t+n,r+n,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(t),this.circles.push(r),this.circles.push(n)}_insertBoxCell(e,t,r,n,i,o){this.boxCells[i].push(o)}_insertCircleCell(e,t,r,n,i,o){this.circleCells[i].push(o)}_query(e,t,r,n,i,o,a){if(r<0||e>this.width||n<0||t>this.height)return[];var s=[];if(e<=0&&t<=0&&this.width<=r&&this.height<=n){if(i)return[{key:null,x1:e,y1:t,x2:r,y2:n}];for(let e=0;e<this.boxKeys.length;e++)s.push({key:this.boxKeys[e],x1:this.bboxes[4*e],y1:this.bboxes[4*e+1],x2:this.bboxes[4*e+2],y2:this.bboxes[4*e+3]});for(let e=0;e<this.circleKeys.length;e++){var l=this.circles[3*e],c=this.circles[3*e+1],u=this.circles[3*e+2];s.push({key:this.circleKeys[e],x1:l-u,y1:c-u,x2:l+u,y2:c+u})}}else this._forEachCell(e,t,r,n,this._queryCell,s,{hitTest:i,overlapMode:o,seenUids:{box:{},circle:{}}},a);return s}query(e,t,r,n){return this._query(e,t,r,n,!1,null)}hitTest(e,t,r,n,i,o){return 0<this._query(e,t,r,n,!0,i,o).length}hitTestCircle(e,t,r,n,i){var o=e-r,a=e+r,s=t-r,l=t+r;return!(a<0||o>this.width||l<0||s>this.height)&&(this._forEachCell(o,s,a,l,this._queryCellCircle,o=[],{hitTest:!0,overlapMode:n,circle:{x:e,y:t,radius:r},seenUids:{box:{},circle:{}}},i),0<o.length)}_queryCell(e,t,r,n,i,o,a,s){var{seenUids:l,hitTest:c,overlapMode:u}=a;if(null!==(a=this.boxCells[i])){var h=this.bboxes;for(const i of a)if(!l.box[i]){l.box[i]=!0;var d=4*i,p=this.boxKeys[i];if(e<=h[2+d]&&t<=h[3+d]&&r>=h[0+d]&&n>=h[1+d]&&(!s||s(p))&&(!c||!se(u,p.overlapMode))&&(o.push({key:p,x1:h[d],y1:h[1+d],x2:h[2+d],y2:h[3+d]}),c))return!0}}if(null!==(a=this.circleCells[i])){var f=this.circles;for(const i of a)if(!l.circle[i]){l.circle[i]=!0;var m=3*i,g=this.circleKeys[i];if(this._circleAndRectCollide(f[m],f[1+m],f[2+m],e,t,r,n)&&(!s||s(g))&&(!c||!se(u,g.overlapMode))){var y=f[m],v=f[1+m];m=f[2+m];if(o.push({key:g,x1:y-m,y1:v-m,x2:y+m,y2:v+m}),c)return!0}}}return!1}_queryCellCircle(e,t,r,n,i,o,a,s){var{circle:l,seenUids:c,overlapMode:u}=a;if(null!==(a=this.boxCells[i])){var h=this.bboxes;for(const e of a)if(!c.box[e]){c.box[e]=!0;var d=4*e,p=this.boxKeys[e];if(this._circleAndRectCollide(l.x,l.y,l.radius,h[0+d],h[1+d],h[2+d],h[3+d])&&(!s||s(p))&&!se(u,p.overlapMode))return o.push(!0),!0}}if(null!==(a=this.circleCells[i])){var f=this.circles;for(const e of a)if(!c.circle[e]){c.circle[e]=!0;var m=3*e,g=this.circleKeys[e];if(this._circlesCollide(f[m],f[1+m],f[2+m],l.x,l.y,l.radius)&&(!s||s(g))&&!se(u,g.overlapMode))return o.push(!0),!0}}}_forEachCell(e,t,r,n,i,o,a,s){var l=this._convertToXCellCoord(e),c=this._convertToYCellCoord(t),u=this._convertToXCellCoord(r),h=this._convertToYCellCoord(n);for(let p=l;p<=u;p++)for(let l=c;l<=h;l++){var d=this.xCellCount*l+p;if(i.call(this,e,t,r,n,d,o,a,s))return}}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,t,r,n,i,o){return(n-=e)*n+(e=i-t)*e<(i=r+o)*i}_circleAndRectCollide(e,t,r,n,i,o,a){return!((o=(o-n)/2)+r<(e=Math.abs(e-(n+o)))||(n=(a-i)/2)+r<(a=Math.abs(t-(i+n)))||!(e<=o||a<=n||(t=e-o)*t+(i=a-n)*i<=r*r))}}function ce(e,r,n,i,o){var a=t.create();return r?(t.scale(a,a,[1/o,1/o,1]),n||t.rotateZ(a,a,i.angle)):t.multiply(a,i.labelPlaneMatrix,e),a}function ue(e,r,n,i,o){return r?(r=t.clone(e),t.scale(r,r,[o,o,1]),n||t.rotateZ(r,r,-i.angle),r):i.glCoordMatrix}function he(e,r,n){let i;return n?(i=[e.x,e.y,n(e.x,e.y),1],t.transformMat4(i,i,r)):xe(i=[e.x,e.y,0,1],i,r),n=i[3],{point:new t.Point(i[0]/n,i[1]/n),signedDistanceFromCamera:n}}function de(e,t){return.5+e/t*.5}function pe(e,t,r,n,i,o,a,s,l,c,u,h,d){var p=s.glyphStartIndex+s.numGlyphs,f=s.lineStartIndex,m=s.lineStartIndex+s.lineLength,g=t.getoffsetX(s.glyphStartIndex);t=t.getoffsetX(p-1);return(p=_e(e*g,r,n,i,o,a,s.segment,f,m,l,c,u,h,d))&&(g=_e(e*t,r,n,i,o,a,s.segment,f,m,l,c,u,h,d))?{first:p,last:g}:null}function fe(e,r,n,i){if(e===t.WritingMode.horizontal){var o=Math.abs(n.y-r.y);if(Math.abs(n.x-r.x)*i<o)return{useVertical:!0}}return(e===t.WritingMode.vertical?r.y<n.y:r.x>n.x)?{needsFlipping:!0}:null}function me(e,r,n,i,o,a,s,l,c,u,h,d,p,f,m,g){var y=r/24,v=e.lineOffsetX*y,_=e.lineOffsetY*y;let b;if(1<e.numGlyphs){var w=e.glyphStartIndex+e.numGlyphs,x=e.lineStartIndex,C=e.lineStartIndex+e.lineLength;if(!(r=pe(y,l,v,_,n,h,d,e,c,a,p,m,g)))return{notEnoughRoom:!0};var S=he(r.first.point,s,g).point;s=he(r.last.point,s,g).point;if(i&&!n&&(S=fe(e.writingMode,S,s,f)))return S;b=[r.first];for(let t=e.glyphStartIndex+1;t<w-1;t++)b.push(_e(y*l.getoffsetX(t),v,_,n,h,d,e.segment,x,C,c,a,p,m,g));b.push(r.last)}else{if(i&&!n&&(s=he(d,o,g).point,S=e.lineStartIndex+e.segment+1,S=0<(i=he(r=new t.Point(c.getx(S),c.gety(S)),o,g)).signedDistanceFromCamera?i.point:ge(d,r,s,1,o,g),i=fe(e.writingMode,s,S,f)))return i;if(!(r=_e(y*l.getoffsetX(e.glyphStartIndex),v,_,n,h,d,e.segment,e.lineStartIndex,e.lineStartIndex+e.lineLength,c,a,p,m,g)))return{notEnoughRoom:!0};b=[r]}for(const E of b)t.addDynamicAttributes(u,E.point,E.angle);return{}}function ge(e,t,r,n,i,o){return e=he(e.add(e.sub(t)._unit()),i,o).point,t=r.sub(e),r.add(t._mult(n/t.mag()))}function ye(e,r){var n,i,{projectionCache:r,lineVertexArray:o,labelPlaneMatrix:a,tileAnchorPoint:s,distanceFromAnchor:l,getElevation:c,previousVertex:u,direction:h,absOffsetX:d}=r;return r.projections[e]||(0<(i=he(n=new t.Point(o.getx(e),o.gety(e)),a,c)).signedDistanceFromCamera?(r.projections[e]=i.point,i.point):(r=e-h,ge(0===l?s:new t.Point(o.getx(r),o.gety(r)),n,u,d-l+1,a,c)))}function ve(e,t,r){return e._unit()._perp()._mult(t*r)}function _e(e,r,n,i,o,a,s,l,c,u,h,d,p,f){let m,g,y=0<(e=i?e-r:e+r)?1:-1,v=0,_=(i&&(y*=-1,v=Math.PI),y<0&&(v+=Math.PI),0<y?l+s:l+s+1),b=o,w=o,x=0,C=0;var S=Math.abs(e),E=[];let T;for(;x+C<=S;){if((_+=y)<l||_>=c)return null;x+=C,w=b,g=m;var I={projectionCache:d,lineVertexArray:u,labelPlaneMatrix:h,tileAnchorPoint:a,distanceFromAnchor:x,getElevation:f,previousVertex:w,direction:y,absOffsetX:S};if(b=ye(_,I),0===n)E.push(w),T=b.sub(w);else{let e;var k=b.sub(w);e=0===k.mag()?ve(ye(_+y,I).sub(b),n,y):ve(k,n,y),g=g||w.add(e),m=function(e,r,n,i,o,a,s,l){var{projectionCache:c,direction:u}=l;if(!c.offsets[e]){if(r=n.add(r),e+u<i||o<=e+u)return c.offsets[e]=r;o=ve((i=ye(e+u,l)).sub(n),s,u),l=n.add(o),s=i.add(o),c.offsets[e]=t.findLineIntersection(a,r,l,s)||r}return c.offsets[e]}(_,e,b,l,c,g,n,I),E.push(g),T=m.sub(g)}C=T.mag()}return r=(S-x)/C,i=T._mult(r)._add(g||w),s=v+Math.atan2(b.y-w.y,b.x-w.x),E.push(i),{point:i,angle:p?s:0,path:E}}const be=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function we(e,t){for(let n=0;n<e;n++){var r=t.length;t.resize(r+4),t.float32.set(be,3*r)}}function xe(e,t,r){var n=t[0];t=t[1];e[0]=r[0]*n+r[4]*t+r[12],e[1]=r[1]*n+r[5]*t+r[13],e[3]=r[3]*n+r[7]*t+r[15]}class Ce{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new le(e.width+200,e.height+200,25),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new le(e.width+200,e.height+200,25);this.transform=e,this.grid=t,this.ignoredGrid=r,this.pitchfactor=Math.cos(e._pitch)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+100,this.screenBottomBoundary=e.height+100,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,t,r,n,i,o){o=r*(n=this.projectAndGetPerspectiveRatio(n,e.anchorPointX,e.anchorPointY,o)).perspectiveRatio,r=e.x1*o+n.point.x;var a=e.y1*o+n.point.y,s=e.x2*o+n.point.x;e=e.y2*o+n.point.y;return!this.isInsideGrid(r,a,s,e)||"always"!==t&&this.grid.hitTest(r,a,s,e,t,i)||n.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[r,a,s,e],offscreen:this.isOffscreen(r,a,s,e)}}placeCollisionCircles(e,r,n,i,o,a,s,l,c,u,h,d,p,f){var m=[],g=new t.Point(r.anchorX,r.anchorY);a=he(g,a,f),a=de(this.transform.cameraToCenterDistance,a.signedDistanceFromCamera),u=(u?o/a:o*a)/t.ONE_EM,o=he(g,s,f).point;let y=!1,v=!1,_=!0;if(i=pe(u,i,r.lineOffsetX*u,r.lineOffsetY*u,!1,o,g,r,n,s,{projections:{},offsets:{}},!1,f)){var b=.5*d*a+p,w=(u=new t.Point(-100,-100),o=new t.Point(this.screenRightBoundary,this.screenBottomBoundary),new ae),x=i.first,C=i.last;let r=[];for(let e=x.path.length-1;1<=e;e--)r.push(x.path[e]);for(let e=1;e<C.path.length;e++)r.push(C.path[e]);var S=2.5*b;l&&(g=r.map((e=>he(e,l,f))),r=g.some((e=>e.signedDistanceFromCamera<=0))?[]:g.map((e=>e.point)));let n=[];if(0<r.length){var E=r[0].clone(),T=r[0].clone();for(let e=1;e<r.length;e++)E.x=Math.min(E.x,r[e].x),E.y=Math.min(E.y,r[e].y),T.x=Math.max(T.x,r[e].x),T.y=Math.max(T.y,r[e].y);n=E.x>=u.x&&T.x<=o.x&&E.y>=u.y&&T.y<=o.y?[r]:T.x<u.x||E.x>o.x||T.y<u.y||E.y>o.y?[]:t.clipLine([r],u.x,u.y,o.x,o.y)}for(const t of n){w.reset(t,.25*b);let r=0;r=w.length<=.5*b?1:Math.ceil(w.paddedLength/S)+1;for(let t=0;t<r;t++){var I=t/Math.max(r-1,1),k=(I=w.lerp(I)).x+100,A=(I=I.y+100,m.push(k,I,b,0),k-b),P=I-b,M=k+b,R=I+b;if(_=_&&this.isOffscreen(A,P,M,R),v=v||this.isInsideGrid(A,P,M,R),"always"!==e&&this.grid.hitTestCircle(k,I,b,e,h)&&(y=!0,!c))return{circles:[],offscreen:!1,collisionDetected:y}}}}return{circles:!c&&y||!v||a<this.perspectiveRatioCutoff?[]:m,offscreen:_,collisionDetected:y}}queryRenderedSymbols(e){if(0===e.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};var r=[];let n=1/0,i=1/0,o=-1/0,a=-1/0;for(const d of e){var s=new t.Point(d.x+100,d.y+100);n=Math.min(n,s.x),i=Math.min(i,s.y),o=Math.max(o,s.x),a=Math.max(a,s.y),r.push(s)}var l={},c={};for(const d of this.grid.query(n,i,o,a).concat(this.ignoredGrid.query(n,i,o,a))){var u,h=d.key;void 0===l[h.bucketInstanceId]&&(l[h.bucketInstanceId]={}),l[h.bucketInstanceId][h.featureIndex]||(u=[new t.Point(d.x1,d.y1),new t.Point(d.x2,d.y1),new t.Point(d.x2,d.y2),new t.Point(d.x1,d.y2)],t.polygonIntersectsPolygon(r,u)&&(l[h.bucketInstanceId][h.featureIndex]=!0,void 0===c[h.bucketInstanceId]&&(c[h.bucketInstanceId]=[]),c[h.bucketInstanceId].push(h.featureIndex)))}return c}insertCollisionBox(e,t,r,n,i,o){(r?this.ignoredGrid:this.grid).insert({bucketInstanceId:n,featureIndex:i,collisionGroupID:o,overlapMode:t},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,t,r,n,i,o){var a=r?this.ignoredGrid:this.grid,s={bucketInstanceId:n,featureIndex:i,collisionGroupID:o,overlapMode:t};for(let l=0;l<e.length;l+=4)a.insertCircle(s,e[l],e[l+1],e[l+2])}projectAndGetPerspectiveRatio(e,r,n,i){let o;return i?(o=[r,n,i(r,n),1],t.transformMat4(o,o,e)):xe(o=[r,n,0,1],o,e),{point:new t.Point((o[0]/o[3]+1)/2*this.transform.width+100,(-o[1]/o[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/o[3]*.5}}isOffscreen(e,t,r,n){return r<100||e>=this.screenRightBoundary||n<100||t>this.screenBottomBoundary}isInsideGrid(e,t,r,n){return 0<=r&&e<this.gridRightBoundary&&0<=n&&t<this.gridBottomBoundary}getViewportMatrix(){var e=t.identity([]);return t.translate(e,e,[-100,-100,0]),e}}function Se(e,r,n){return r*(t.EXTENT/(e.tileSize*Math.pow(2,n-e.tileID.overscaledZ)))}class Ee{constructor(e,t,r,n){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?t:-t))):n&&r?1:0,this.placed=r}isHidden(){return 0===this.opacity&&!this.placed}}class Te{constructor(e,t,r,n,i){this.text=new Ee(e?e.text:null,t,r,i),this.icon=new Ee(e?e.icon:null,t,n,i)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ie{constructor(e,t,r){this.text=e,this.icon=t,this.skipFade=r}}class ke{constructor(){this.invProjMatrix=t.create(),this.viewportMatrix=t.create(),this.circles=[]}}class Ae{constructor(e,t,r,n,i){this.bucketInstanceId=e,this.featureIndex=t,this.sourceLayerIndex=r,this.bucketIndex=n,this.tileID=i}}class Pe{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const t=++this.maxGroupID;this.collisionGroups[e]={ID:t,predicate:e=>e.collisionGroupID===t}}return this.collisionGroups[e]}}function Me(e,r,n,i,o){var{horizontalAlign:e,verticalAlign:a}=t.getAnchorAlignment(e);return new t.Point(-(e-.5)*r+i[0]*o,-(a-.5)*n+i[1]*o)}function Re(e,r,n,i,o,a){var{x1:e,x2:s,y1:l,y2:c,anchorPointX:u,anchorPointY:h}=e;r=new t.Point(r,n);return i&&r._rotate(o?a:-a),{x1:e+r.x,y1:l+r.y,x2:s+r.x,y2:c+r.y,anchorPointX:u,anchorPointY:h}}class Oe{constructor(e,t,r,n,i){this.transform=e.clone(),this.terrain=t,this.collisionIndex=new Ce(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=r,this.retainedQueryData={},this.collisionGroups=new Pe(n),this.collisionCircleArrays={},(this.prevPlacement=i)&&(i.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(e,r,n,i){var o=n.getBucket(r),a=n.latestFeatureIndex;if(o&&a&&r.id===o.layerIds[0]){r=n.collisionBoxArray;var s=o.layers[0].layout,l=Math.pow(2,this.transform.zoom-n.tileID.overscaledZ),c=n.tileSize/t.EXTENT,u=this.transform.calculatePosMatrix(n.tileID.toUnwrapped()),h="map"===s.get("text-pitch-alignment"),d="map"===s.get("text-rotation-alignment"),p=Se(n,1,this.transform.zoom),f=ce(u,h,d,this.transform,p);let _=null;h&&(h=ue(u,h,d,this.transform,p),_=t.multiply([],this.transform.labelPlaneMatrix,h)),this.retainedQueryData[o.bucketInstanceId]=new Ae(o.bucketInstanceId,a,o.sourceLayerIndex,o.index,n.tileID);var m={bucket:o,layout:s,posMatrix:u,textLabelPlaneMatrix:f,labelToScreenMatrix:_,scale:l,textPixelRatio:c,holdingForFade:n.holdingForFade(),collisionBoxArray:r,partiallyEvaluatedTextSize:t.evaluateSizeForZoom(o.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(o.sourceID)};if(i)for(const t of o.sortKeyRanges){var{sortKey:g,symbolInstanceStart:y,symbolInstanceEnd:v}=t;e.push({sortKey:g,symbolInstanceStart:y,symbolInstanceEnd:v,parameters:m})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:o.symbolInstances.length,parameters:m})}}attemptAnchorPlacement(e,r,n,i,o,a,s,l,c,u,h,d,p,f,m,g){var y=t.TextAnchorEnum[e.textAnchor],v=Me(y,n,i,e=[e.textOffset0,e.textOffset1],o);r=this.collisionIndex.placeCollisionBox(Re(r,v.x,v.y,a,s,this.transform.angle),h,l,c,u.predicate,g);if((!m||0!==this.collisionIndex.placeCollisionBox(Re(m,v.x,v.y,a,s,this.transform.angle),h,l,c,u.predicate,g).box.length)&&0<r.box.length){let t;if(this.prevPlacement&&this.prevPlacement.variableOffsets[d.crossTileID]&&this.prevPlacement.placements[d.crossTileID]&&this.prevPlacement.placements[d.crossTileID].text&&(t=this.prevPlacement.variableOffsets[d.crossTileID].anchor),0===d.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[d.crossTileID]={textOffset:e,width:n,height:i,anchor:y,textBoxScale:o,prevAnchor:t},this.markUsedJustification(p,y,d,f),p.allowVerticalPlacement&&(this.markUsedOrientation(p,f,d),this.placedOrientations[d.crossTileID]=f),{shift:v,placedGlyphBoxes:r}}}placeLayerBucketPart(e,r,n){const{bucket:i,layout:o,posMatrix:a,textLabelPlaneMatrix:s,labelToScreenMatrix:l,textPixelRatio:c,holdingForFade:u,collisionBoxArray:h,partiallyEvaluatedTextSize:d,collisionGroup:p}=e.parameters,f=o.get("text-optional"),m=o.get("icon-optional"),g=t.getOverlapMode(o,"text-overlap","text-allow-overlap"),y="always"===g,v=t.getOverlapMode(o,"icon-overlap","icon-allow-overlap");var _="always"===v;const b="map"===o.get("text-rotation-alignment"),w="map"===o.get("text-pitch-alignment"),x="none"!==o.get("icon-text-fit");var C="viewport-y"===o.get("symbol-z-order");const S=y&&(_||!i.hasIconData()||m),E=_&&(y||!i.hasTextData()||f),T=(!i.collisionArrays&&h&&i.deserializeCollisionBoxes(h),this.retainedQueryData[i.bucketInstanceId].tileID),I=this.terrain?(e,t)=>this.terrain.getElevation(T,e,t):null;var k=(e,h)=>{if(!r[e.crossTileID])if(u)this.placements[e.crossTileID]=new Ie(!1,!1,!1);else{let u=!1,P=!1,M=!0,R=null,O={box:null,offscreen:null},L={box:null,offscreen:null},D=null,N=null,z=0,F=0,B=0;h.textFeatureIndex?z=h.textFeatureIndex:e.useRuntimeCollisionCircles&&(z=e.featureIndex),h.verticalTextFeatureIndex&&(F=h.verticalTextFeatureIndex);const U=h.textBox;if(U){var _=r=>{let n=t.WritingMode.horizontal;return i.allowVerticalPlacement&&!r&&this.prevPlacement&&(r=this.prevPlacement.placedOrientations[e.crossTileID])&&(this.placedOrientations[e.crossTileID]=r,n=r,this.markUsedOrientation(i,n,e)),n},C=(r,n)=>{if(i.allowVerticalPlacement&&0<e.numVerticalGlyphVertices&&h.verticalTextBox){for(const e of i.writingModes)if(e===t.WritingMode.vertical?(O=n(),L=O):O=r(),O&&O.box&&O.box.length)break}else O=r()};const r=e.textAnchorOffsetStartIndex,n=e.textAnchorOffsetEndIndex;if(n===r){const r=(t,r)=>((t=this.collisionIndex.placeCollisionBox(t,g,c,a,p.predicate,I))&&t.box&&t.box.length&&(this.markUsedOrientation(i,r,e),this.placedOrientations[e.crossTileID]=r),t);C((()=>r(U,t.WritingMode.horizontal)),(()=>{var n=h.verticalTextBox;return i.allowVerticalPlacement&&0<e.numVerticalGlyphVertices&&n?r(n,t.WritingMode.vertical):{box:null,offscreen:null}})),_(O&&O.box&&O.box.length)}else{let o=t.TextAnchorEnum[null==(T=null==(T=this.prevPlacement)?void 0:T.variableOffsets[e.crossTileID])?void 0:T.anchor];const s=(t,s,l)=>{var h=t.x2-t.x1,d=t.y2-t.y1,f=e.textBoxScale,m=x&&"never"===v?s:null;let y={box:[],offscreen:!1},_="never"===g?1:2,C="never";o&&_++;for(let v=0;v<_;v++){for(let s=r;s<n;s++){var S=i.textAnchorOffsets.get(s);if((!o||S.textAnchor===o)&&(S=this.attemptAnchorPlacement(S,t,h,d,f,b,w,c,a,p,C,e,i,l,m,I))&&(y=S.placedGlyphBoxes)&&y.box&&y.box.length)return u=!0,R=S.shift,y}o?o=null:C=g}return y};C((()=>s(U,h.iconBox,t.WritingMode.horizontal)),(()=>{var r=h.verticalTextBox,n=O&&O.box&&O.box.length;return i.allowVerticalPlacement&&!n&&0<e.numVerticalGlyphVertices&&r?s(r,h.verticalIconBox,t.WritingMode.vertical):{box:null,offscreen:null}})),O&&(u=O.box,M=O.offscreen);var T=_(O&&O.box);!u&&this.prevPlacement&&(C=this.prevPlacement.variableOffsets[e.crossTileID])&&(this.variableOffsets[e.crossTileID]=C,this.markUsedJustification(i,C.anchor,e,T))}}u=(_=O)&&_.box&&0<_.box.length,M=_&&_.offscreen,e.useRuntimeCollisionCircles&&(C=i.text.placedSymbolArray.get(e.centerJustifiedTextSymbolIndex),T=t.evaluateSizeForFeature(i.textSizeData,d,C),A=o.get("text-padding"),k=e.collisionCircleDiameter,(D=this.collisionIndex.placeCollisionCircles(g,C,i.lineVertexArray,i.glyphOffsetArray,T,a,s,l,n,w,p.predicate,k,A,I)).circles.length&&D.collisionDetected&&!n&&t.warnOnce("Collisions detected, but collision boxes are not shown"),u=y||0<D.circles.length&&!D.collisionDetected,M=M&&D.offscreen),h.iconFeatureIndex&&(B=h.iconFeatureIndex),h.iconBox&&(C=e=>(e=x&&R?Re(e,R.x,R.y,b,w,this.transform.angle):e,this.collisionIndex.placeCollisionBox(e,v,c,a,p.predicate,I)),P=0<(N=L&&L.box&&L.box.length&&h.verticalIconBox?C(h.verticalIconBox):C(h.iconBox)).box.length,M=M&&N.offscreen);T=f||0===e.numHorizontalGlyphVertices&&0===e.numVerticalGlyphVertices;var k=m||0===e.numIconVertices;if(T||k?k?T||(P=P&&u):u=P&&u:P=u=P&&u,u&&_&&_.box&&(L&&L.box&&F?this.collisionIndex.insertCollisionBox(_.box,g,o.get("text-ignore-placement"),i.bucketInstanceId,F,p.ID):this.collisionIndex.insertCollisionBox(_.box,g,o.get("text-ignore-placement"),i.bucketInstanceId,z,p.ID)),P&&N&&this.collisionIndex.insertCollisionBox(N.box,v,o.get("icon-ignore-placement"),i.bucketInstanceId,B,p.ID),D&&(u&&this.collisionIndex.insertCollisionCircles(D.circles,g,o.get("text-ignore-placement"),i.bucketInstanceId,z,p.ID),n)){var A=i.bucketInstanceId;let e=this.collisionCircleArrays[A];void 0===e&&(e=this.collisionCircleArrays[A]=new ke);for(let t=0;t<D.circles.length;t+=4)e.circles.push(D.circles[t+0]),e.circles.push(D.circles[t+1]),e.circles.push(D.circles[t+2]),e.circles.push(D.collisionDetected?1:0)}if(0===e.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");if(0===i.bucketInstanceId)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[e.crossTileID]=new Ie(u||S,P||E,M||i.justReloaded),r[e.crossTileID]=!0}};if(C){if(0!==e.symbolInstanceStart)throw new Error("bucket.bucketInstanceId should be 0");var A=i.getSortedSymbolIndexes(this.transform.angle);for(let e=A.length-1;0<=e;--e){var P=A[e];k(i.symbolInstances.get(P),i.collisionArrays[P])}}else for(let t=e.symbolInstanceStart;t<e.symbolInstanceEnd;t++)k(i.symbolInstances.get(t),i.collisionArrays[t]);n&&i.bucketInstanceId in this.collisionCircleArrays&&(_=this.collisionCircleArrays[i.bucketInstanceId],t.invert(_.invProjMatrix,a),_.viewportMatrix=this.collisionIndex.getViewportMatrix()),i.justReloaded=!1}markUsedJustification(e,r,n,i){var o={left:n.leftJustifiedTextSymbolIndex,center:n.centerJustifiedTextSymbolIndex,right:n.rightJustifiedTextSymbolIndex};let a;a=i===t.WritingMode.vertical?n.verticalPlacedTextSymbolIndex:o[t.getAnchorJustification(r)];for(const t of[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex,n.verticalPlacedTextSymbolIndex])0<=t&&(e.text.placedSymbolArray.get(t).crossTileID=0<=a&&t!==a?0:n.crossTileID)}markUsedOrientation(e,r,n){var i=r===t.WritingMode.horizontal||r===t.WritingMode.horizontalOnly?r:0;r=r===t.WritingMode.vertical?r:0;for(const t of[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex])e.text.placedSymbolArray.get(t).placedOrientation=i;n.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(n.verticalPlacedTextSymbolIndex).placedOrientation=r)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;var t=this.prevPlacement;let r=!1;this.prevZoomAdjustment=t?t.zoomAdjustment(this.transform.zoom):0;var n=t?t.symbolFadeChange(e):1,i=t?t.opacities:{},o=t?t.variableOffsets:{},a=t?t.placedOrientations:{};for(const h in this.placements){var s=this.placements[h],l=i[h];r=l?(this.opacities[h]=new Te(l,n,s.text,s.icon),r||s.text!==l.text.placed||s.icon!==l.icon.placed):(this.opacities[h]=new Te(null,n,s.text,s.icon,s.skipFade),r||s.text||s.icon)}for(const h in i){var c,u=i[h];this.opacities[h]||(c=new Te(u,n,!1,!1)).isHidden()||(this.opacities[h]=c,r=r||u.text.placed||u.icon.placed)}for(const h in o)this.variableOffsets[h]||!this.opacities[h]||this.opacities[h].isHidden()||(this.variableOffsets[h]=o[h]);for(const h in a)this.placedOrientations[h]||!this.opacities[h]||this.opacities[h].isHidden()||(this.placedOrientations[h]=a[h]);if(t&&void 0===t.lastPlacementChangeTime)throw new Error("Last placement time for previous placement is not defined");r?this.lastPlacementChangeTime=e:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=t?t.lastPlacementChangeTime:e)}updateLayerOpacities(e,t){var r={};for(const i of t){var n=i.getBucket(e);n&&i.latestFeatureIndex&&e.id===n.layerIds[0]&&this.updateBucketOpacities(n,r,i.collisionBoxArray)}}updateBucketOpacities(e,r,n){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();var i=e.layers[0],o=i.layout,a=new Te(null,0,!1,!1,!0),s=o.get("text-allow-overlap"),l=o.get("icon-allow-overlap"),c=i._unevaluatedLayout.hasValue("text-variable-anchor")||i._unevaluatedLayout.hasValue("text-variable-anchor-offset"),u="map"===o.get("text-rotation-alignment"),h="map"===o.get("text-pitch-alignment"),d="none"!==o.get("icon-text-fit"),p=new Te(null,0,s&&(l||!e.hasIconData()||o.get("icon-optional")),l&&(s||!e.hasTextData()||o.get("text-optional")),!0),f=(!e.collisionArrays&&n&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(n),(e,t,r)=>{for(let n=0;n<t/4;n++)e.opacityVertexArray.emplaceBack(r);e.hasVisibleVertices=e.hasVisibleVertices||r!==He});for(let S=0;S<e.symbolInstances.length;S++){var m=e.symbolInstances.get(S),{numHorizontalGlyphVertices:g,numVerticalGlyphVertices:y,crossTileID:v}=m,_=r[v];let n=this.opacities[v];_?n=a:n||(n=p,this.opacities[v]=n),r[v]=!0;_=0<m.numIconVertices;var b=this.placedOrientations[m.crossTileID];const i=b===t.WritingMode.vertical;var w=b===t.WritingMode.horizontal||b===t.WritingMode.horizontalOnly;if(0<g||0<y){var x=qe(n.text),C=i?He:x,g=(f(e.text,g,C),w?He:x);f(e.text,y,g);const t=n.text.isHidden();[m.rightJustifiedTextSymbolIndex,m.centerJustifiedTextSymbolIndex,m.leftJustifiedTextSymbolIndex].forEach((r=>{0<=r&&(e.text.placedSymbolArray.get(r).hidden=t||i?1:0)})),0<=m.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(m.verticalPlacedTextSymbolIndex).hidden=t||w?1:0),(x=((C=this.variableOffsets[m.crossTileID])&&this.markUsedJustification(e,C.anchor,m,b),this.placedOrientations[m.crossTileID]))&&(this.markUsedJustification(e,"left",m,x),this.markUsedOrientation(e,x,m))}if(_&&(y=qe(n.icon),g=!(d&&m.verticalPlacedIconSymbolIndex&&i),0<=m.placedIconSymbolIndex&&(C=g?y:He,f(e.icon,m.numIconVertices,C),e.icon.placedSymbolArray.get(m.placedIconSymbolIndex).hidden=n.icon.isHidden()),0<=m.verticalPlacedIconSymbolIndex)&&(b=g?He:y,f(e.icon,m.numVerticalIconVertices,b),e.icon.placedSymbolArray.get(m.verticalPlacedIconSymbolIndex).hidden=n.icon.isHidden()),(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&(x=e.collisionArrays[S])){let r=new t.Point(0,0);if(x.textBox||x.verticalTextBox){let t=!0;c&&((_=this.variableOffsets[v])?(r=Me(_.anchor,_.width,_.height,_.textOffset,_.textBoxScale),u&&r._rotate(h?this.transform.angle:-this.transform.angle)):t=!1),x.textBox&&Le(e.textCollisionBox.collisionVertexArray,n.text.placed,!t||i,r.x,r.y),x.verticalTextBox&&Le(e.textCollisionBox.collisionVertexArray,n.text.placed,!t||w,r.x,r.y)}g=Boolean(!w&&x.verticalIconBox),x.iconBox&&Le(e.iconCollisionBox.collisionVertexArray,n.icon.placed,g,d?r.x:0,d?r.y:0),x.verticalIconBox&&Le(e.iconCollisionBox.collisionVertexArray,n.icon.placed,!g,d?r.x:0,d?r.y:0)}}if(e.sortFeatures(this.transform.angle),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);e.bucketInstanceId in this.collisionCircleArrays&&(i=this.collisionCircleArrays[e.bucketInstanceId],e.placementInvProjMatrix=i.invProjMatrix,e.placementViewportMatrix=i.viewportMatrix,e.collisionCircleArray=i.circles,delete this.collisionCircleArrays[e.bucketInstanceId])}symbolFadeChange(e){return 0===this.fadeDuration?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,t){var r=this.zoomAtLastRecencyCheck===t?1-this.zoomAdjustment(t):1;return this.zoomAtLastRecencyCheck=t,this.commitTime+this.fadeDuration*r>e}setStale(){this.stale=!0}}function Le(e,t,r,n,i){e.emplaceBack(t?1:0,r?1:0,n||0,i||0),e.emplaceBack(t?1:0,r?1:0,n||0,i||0),e.emplaceBack(t?1:0,r?1:0,n||0,i||0),e.emplaceBack(t?1:0,r?1:0,n||0,i||0)}const De=Math.pow(2,25),Ne=Math.pow(2,24),ze=Math.pow(2,17),Fe=Math.pow(2,16),Be=Math.pow(2,9),Ue=Math.pow(2,8),je=Math.pow(2,1);function qe(e){var t;return 0!==e.opacity||e.placed?1===e.opacity&&e.placed?4294967295:(t=e.placed?1:0,(e=Math.floor(127*e.opacity))*De+t*Ne+e*ze+t*Fe+e*Be+t*Ue+e*je+t):0}const He=0;class Ve{constructor(e){this._sortAcrossTiles="viewport-y"!==e.layout.get("symbol-z-order")&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,t,r,n,i){for(var o=this._bucketParts;this._currentTileIndex<e.length;){var a=e[this._currentTileIndex];if(t.getBucketParts(o,n,a,this._sortAcrossTiles),this._currentTileIndex++,i())return!0}for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,o.sort(((e,t)=>e.sortKey-t.sortKey)));this._currentPartIndex<o.length;){var s=o[this._currentPartIndex];if(t.placeLayerBucketPart(s,this._seenCrossTileIDs,r),this._currentPartIndex++,i())return!0}return!1}}class Ge{constructor(e,t,r,n,i,o,a,s){this.placement=new Oe(e,t,o,a,s),this._currentPlacementIndex=r.length-1,this._forceFullPlacement=n,this._showCollisionBoxes=i,this._done=!1}isDone(){return this._done}continuePlacement(e,t,r){const n=a.now();for(var i=()=>!this._forceFullPlacement&&2<a.now()-n;0<=this._currentPlacementIndex;){var o=t[e[this._currentPlacementIndex]],s=this.placement.collisionIndex.transform.zoom;if("symbol"===o.type&&(!o.minzoom||o.minzoom<=s)&&(!o.maxzoom||o.maxzoom>s)){if(this._inProgressLayer||(this._inProgressLayer=new Ve(o)),this._inProgressLayer.continuePlacement(r[o.source],this.placement,this._showCollisionBoxes,o,i))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const Ke=512/t.EXTENT/2;class Ze{constructor(e,r,n){this.tileID=e,this.bucketInstanceId=n,this._symbolsByKey={};var i,o,a=new Map;for(let t=0;t<r.length;t++){var s=r.get(t),l=s.key,c=a.get(l);c?c.push(s):a.set(l,[s])}for([i,o]of a){var u={positions:o.map((e=>({x:Math.floor(e.anchorX*Ke),y:Math.floor(e.anchorY*Ke)}))),crossTileIDs:o.map((e=>e.crossTileID))};if(128<u.positions.length){var h,d,p=new t.KDBush(u.positions.length,16,Uint16Array);for({x:h,y:d}of u.positions)p.add(h,d);p.finish(),delete u.positions,u.index=p}this._symbolsByKey[i]=u}}getScaledCoordinates(e,r){var{x:n,y:i,z:o}=this.tileID.canonical,{x:r,y:a,z:s}=r.canonical,o=(s=s-o,Ke/Math.pow(2,s)),s=(r*t.EXTENT+e.anchorX)*o,a=(r=(a*t.EXTENT+e.anchorY)*o,n*t.EXTENT*Ke);e=i*t.EXTENT*Ke;return{x:Math.floor(s-a),y:Math.floor(r-e)}}findMatches(e,t,r){var n=this.tileID.canonical.z<t.canonical.z?1:Math.pow(2,this.tileID.canonical.z-t.canonical.z);for(let u=0;u<e.length;u++){var i=e.get(u);if(!i.crossTileID){var o=this._symbolsByKey[i.key];if(o){var a=this.getScaledCoordinates(i,t);if(o.index)for(const e of o.index.range(a.x-n,a.y-n,a.x+n,a.y+n).sort()){var s=o.crossTileIDs[e];if(!r[s]){r[s]=!0,i.crossTileID=s;break}}else if(o.positions)for(let e=0;e<o.positions.length;e++){var l=o.positions[e],c=o.crossTileIDs[e];if(Math.abs(l.x-a.x)<=n&&Math.abs(l.y-a.y)<=n&&!r[c]){r[c]=!0,i.crossTileID=c;break}}}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((e=>{let{crossTileIDs:t}=e;return t}))}}class We{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class $e{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){var t=Math.round((e-this.lng)/360);if(0!==t)for(const o in this.indexes){var r=this.indexes[o],n={};for(const e in r){var i=r[e];i.tileID=i.tileID.unwrapTo(i.tileID.wrap+t),n[i.tileID.key]=i}this.indexes[o]=n}this.lng=e}addBucket(e,t,r){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===t.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let l=0;l<t.symbolInstances.length;l++)t.symbolInstances.get(l).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});var n=this.usedCrossTileIDs[e.overscaledZ];for(const l in this.indexes){var i=this.indexes[l];if(Number(l)>e.overscaledZ)for(const r in i){var o=i[r];o.tileID.isChildOf(e)&&o.findMatches(t.symbolInstances,e,n)}else{var a=i[e.scaledTo(Number(l)).key];a&&a.findMatches(t.symbolInstances,e,n)}}for(let l=0;l<t.symbolInstances.length;l++){var s=t.symbolInstances.get(l);s.crossTileID||(s.crossTileID=r.generate(),n[s.crossTileID]=!0)}return void 0===this.indexes[e.overscaledZ]&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new Ze(e,t.symbolInstances,t.bucketInstanceId),!0}removeBucketCrossTileIDs(e,t){for(const r of t.getCrossTileIDsLists())for(const t of r)delete this.usedCrossTileIDs[e][t]}removeStaleBuckets(e){let t=!1;for(const n in this.indexes){var r=this.indexes[n];for(const i in r)e[r[i].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,r[i]),delete r[i],t=!0)}return t}}class Ye{constructor(){this.layerIndexes={},this.crossTileIDs=new We,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,t,r){let n=this.layerIndexes[e.id],i=!1;var o={};(n=void 0===n?this.layerIndexes[e.id]=new $e:n).handleWrapJump(r);for(const s of t){var a=s.getBucket(e);a&&e.id===a.layerIds[0]&&(a.bucketInstanceId||(a.bucketInstanceId=++this.maxBucketInstanceId),n.addBucket(s.tileID,a,this.crossTileIDs)&&(i=!0),o[a.bucketInstanceId]=!0)}return!!n.removeStaleBuckets(o)||i}pruneUnusedLayers(e){const t={};e.forEach((e=>{t[e]=!0}));for(const r in this.layerIndexes)t[r]||delete this.layerIndexes[r]}}const Xe=(e,r)=>t.emitValidationErrors(e,r&&r.filter((e=>"source.canvas"!==e.identifier))),Qe=t.emptyStyle();class Je extends t.Evented{constructor(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this._rtlPluginLoaded=()=>{for(const t in this.sourceCaches){var e=this.sourceCaches[t].getSource().type;"vector"!==e&&"geojson"!==e||this.sourceCaches[t].reload()}},this.map=e,this.dispatcher=new O(R(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",((e,t)=>this.getGlyphs(e,t))),this.dispatcher.registerMessageHandler("GI",((e,t)=>this.getImages(e,t))),this.imageManager=new v,this.imageManager.setEventedParent(this),this.glyphManager=new x(e._requestManager,r.localIdeographFontFamily),this.lineAtlas=new I(256,512),this.crossTileSymbolIndex=new Ye,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new t.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",t.getReferrer()),J().on(Y,this._rtlPluginLoaded),this.on("data",(e=>{if("source"===e.dataType&&"metadata"===e.sourceDataType&&(e=this.sourceCaches[e.sourceId])){var t=e.getSource();if(t&&t.vectorLayerIds)for(const e in this._layers){var r=this._layers[e];r.source===t.id&&this._validateLayer(r)}}}))}loadURL(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;this.fire(new t.Event("dataloading",{dataType:"style"})),r.validate="boolean"!=typeof r.validate||r.validate,e=this.map._requestManager.transformRequest(e,"Style"),this._loadStyleRequest=new AbortController,t.getJSON(e,this._loadStyleRequest).then((e=>{this._loadStyleRequest=null,this._load(e.data,r,n)})).catch((e=>{this._loadStyleRequest=null,e&&this.fire(new t.ErrorEvent(e))}))}loadJSON(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;this.fire(new t.Event("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,a.frameAsync(this._frameRequest).then((()=>{this._frameRequest=null,r.validate=!1!==r.validate,this._load(e,r,n)})).catch((()=>{}))}loadEmpty(){this.fire(new t.Event("dataloading",{dataType:"style"})),this._load(Qe,{validate:!1})}_load(e,r,n){var i=r.transformStyle?r.transformStyle(n,e):e;if(!r.validate||!Xe(this,t.validateStyle(i))){this._loaded=!0;for(const e in(this.stylesheet=i).sources)this.addSource(e,i.sources[e],{validate:!1});i.sprite?this._loadSprite(i.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(i.glyphs),this._createLayers(),this.light=new T(this.stylesheet.light),this.map.setTerrain(null!=(n=this.stylesheet.terrain)?n:null),this.fire(new t.Event("data",{dataType:"style"})),this.fire(new t.Event("style.load"))}}_createLayers(){var e=t.derefLayers(this.stylesheet.layers);this.dispatcher.broadcast("SL",e),this._order=e.map((e=>e.id)),this._layers={},this._serializedLayers=null;for(const n of e){var r=t.createStyleLayer(n);r.setEventedParent(this,{layer:{id:n.id}}),this._layers[n.id]=r}}_loadSprite(e){let n,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(e,n,i,o){return t.__awaiter(this,void 0,void 0,(function*(){var s,l,c=g(e),u=1<i?"@2x":"",h={},d={};for({id:s,url:l}of c){var p=n.transformRequest(n.normalizeSpriteURL(l,u,".json"),"SpriteJSON");h[s]=t.getJSON(p,o),p=n.transformRequest(n.normalizeSpriteURL(l,u,".png"),"SpriteImage"),d[s]=r.getImage(p,o)}return yield Promise.all([...Object.values(h),...Object.values(d)]),function(e,r){return t.__awaiter(this,void 0,void 0,(function*(){var t={};for(const g in e){t[g]={};var n=a.getImageCanvasContext((yield r[g]).data),i=(yield e[g]).data;for(const e in i){var{width:o,height:s,x:l,y:c,sdf:u,pixelRatio:h,stretchX:d,stretchY:p,content:f,contentMatch:m}=i[e];t[g][e]={data:null,pixelRatio:h,sdf:u,stretchX:d,stretchY:p,content:f,spriteData:{width:o,height:s,x:l,y:c,context:n},contentMatch:m}}}return t}))}(h,d)}))}(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then((e=>{if(this._spriteRequest=null,e)for(const r in e){this._spritesImagesIds[r]=[];for(const t of this._spritesImagesIds[r]?this._spritesImagesIds[r].filter((t=>!(t in e))):[])this.imageManager.removeImage(t),this._changedImages[t]=!0;for(const n in e[r]){var t="default"===r?n:r+":"+n;this._spritesImagesIds[r].push(t),t in this.imageManager.images?this.imageManager.updateImage(t,e[r][n],!1):this.imageManager.addImage(t,e[r][n]),i&&(this._changedImages[t]=!0)}}})).catch((e=>{this._spriteRequest=null,n=e,this.fire(new t.ErrorEvent(n))})).finally((()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),i&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new t.Event("data",{dataType:"style"})),o&&o(n)}))}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new t.Event("data",{dataType:"style"}))}_validateLayer(e){var r,n=this.sourceCaches[e.source];n&&(r=e.sourceLayer)&&("geojson"===(n=n.getSource()).type||n.vectorLayerIds&&-1===n.vectorLayerIds.indexOf(r))&&this.fire(new t.ErrorEvent(new Error(`Source layer "${r}" does not exist on source "${n.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(const e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e){var t=this._serializedAllLayers();if(!e||0===e.length)return Object.values(t);var r=[];for(const n of e)t[n]&&r.push(t[n]);return r}_serializedAllLayers(){var e=this._serializedLayers;if(!e){e=this._serializedLayers={};for(const r of Object.keys(this._layers)){var t=this._layers[r];"custom"!==t.type&&(e[r]=t.serialize())}}return e}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const e in this.sourceCaches)if(this.sourceCaches[e].hasTransition())return!0;for(const e in this._layers)if(this._layers[e].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(this._loaded){var r=this._changed;if(this._changed){var n=Object.keys(this._updatedLayers),i=Object.keys(this._removedLayers);(n.length||i.length)&&this._updateWorkerLayers(n,i);for(const e in this._updatedSources){var o=this._updatedSources[e];if("reload"===o)this._reloadSource(e);else{if("clear"!==o)throw new Error("Invalid action "+o);this._clearSource(e)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const t in this._updatedPaintProps)this._layers[t].updateTransitions(e);this.light.updateTransitions(e),this._resetUpdates()}var a={};for(const e in this.sourceCaches){var s=this.sourceCaches[e];a[e]=s.used,s.used=!1}for(const t of this._order){var l=this._layers[t];l.recalculate(e,this._availableImages),!l.isHidden(e.zoom)&&l.source&&(this.sourceCaches[l.source].used=!0)}for(const e in a){var c=this.sourceCaches[e];a[e]!==c.used&&c.fire(new t.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:e}))}this.light.recalculate(e),this.z=e.zoom,r&&this.fire(new t.Event("data",{dataType:"style"}))}}_updateTilesForChangedImages(){var e=Object.keys(this._changedImages);if(e.length){for(const t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,t){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e),removedIds:t})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e){var r=this;return function(n){r._checkLoaded();var i=r.serialize();if((n=(e=n.transformStyle?n.transformStyle(i,e):e,null==(n=n.validate)||n))&&Xe(r,t.validateStyle(e)))return!1;if((e=t.clone$1(e)).layers=t.derefLayers(e.layers),n=t.diffStyles(i,e),0<(i=r._getOperationsToPerform(n)).unimplemented.length)throw new Error(`Unimplemented: ${i.unimplemented.join(", ")}.`);if(0===i.operations.length)return!1;for(const e of i.operations)e();return r.stylesheet=e,!(r._serializedLayers=null)}(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}_getOperationsToPerform(e){var t=[],r=[];for(const n of e)switch(n.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":t.push((()=>this.addLayer.apply(this,n.args)));break;case"removeLayer":t.push((()=>this.removeLayer.apply(this,n.args)));break;case"setPaintProperty":t.push((()=>this.setPaintProperty.apply(this,n.args)));break;case"setLayoutProperty":t.push((()=>this.setLayoutProperty.apply(this,n.args)));break;case"setFilter":t.push((()=>this.setFilter.apply(this,n.args)));break;case"addSource":t.push((()=>this.addSource.apply(this,n.args)));break;case"removeSource":t.push((()=>this.removeSource.apply(this,n.args)));break;case"setLayerZoomRange":t.push((()=>this.setLayerZoomRange.apply(this,n.args)));break;case"setLight":t.push((()=>this.setLight.apply(this,n.args)));break;case"setGeoJSONSourceData":t.push((()=>this.setGeoJSONSourceData.apply(this,n.args)));break;case"setGlyphs":t.push((()=>this.setGlyphs.apply(this,n.args)));break;case"setSprite":t.push((()=>this.setSprite.apply(this,n.args)));break;case"setTerrain":t.push((()=>this.map.setTerrain.apply(this,n.args)));break;case"setTransition":t.push((()=>{}));break;default:r.push(n.command)}return{operations:t,unimplemented:r}}addImage(e,r){if(this.getImage(e))return this.fire(new t.ErrorEvent(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,r),this._afterImageUpdated(e)}updateImage(e,t){this.imageManager.updateImage(e,t)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new t.ErrorEvent(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new t.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,r){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this._checkLoaded(),void 0!==this.sourceCaches[e])throw new Error(`Source "${e}" already exists.`);if(!r.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(r).join(", ")}.`);if(!(0<=["vector","raster","geojson","video","image"].indexOf(r.type))||!this._validate(t.validateStyle.source,"sources."+e,r,null,n)){this.map&&this.map._collectResourceTiming&&(r.collectResourceTiming=!0);const t=this.sourceCaches[e]=new ne(e,r,this.dispatcher);t.style=this,t.setEventedParent(this,(()=>({isSourceLoaded:t.loaded(),source:t.serialize(),sourceId:e}))),t.onAdd(this.map),this._changed=!0}}removeSource(e){if(this._checkLoaded(),void 0===this.sourceCaches[e])throw new Error("There is no source with this ID");for(const n in this._layers)if(this._layers[n].source===e)return this.fire(new t.ErrorEvent(new Error(`Source "${e}" cannot be removed while layer "${n}" is using it.`)));var r=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],r.fire(new t.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),r.setEventedParent(null),r.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,t){if(this._checkLoaded(),void 0===this.sourceCaches[e])throw new Error("There is no source with this ID="+e);if("geojson"!==(e=this.sourceCaches[e].getSource()).type)throw new Error(`geojsonSource.type is ${e.type}, which is !== 'geojson`);e.setData(t),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,r){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._checkLoaded();var i=e.id;if(this.getLayer(i))this.fire(new t.ErrorEvent(new Error(`Layer "${i}" already exists on this map.`)));else{let o;if("custom"===e.type){if(Xe(this,t.validateCustomStyleLayer(e)))return;o=t.createStyleLayer(e)}else{if("source"in e&&"object"==typeof e.source&&(this.addSource(i,e.source),e=t.clone$1(e),e=t.extend(e,{source:i})),this._validate(t.validateStyle.layer,"layers."+i,e,{arrayIndex:-1},n))return;o=t.createStyleLayer(e),this._validateLayer(o),o.setEventedParent(this,{layer:{id:i}})}n=r?this._order.indexOf(r):this._order.length,r&&-1===n?this.fire(new t.ErrorEvent(new Error(`Cannot add layer "${i}" before non-existing layer "${r}".`))):(this._order.splice(n,0,i),this._layerOrderChanged=!0,this._layers[i]=o,this._removedLayers[i]&&o.source&&"custom"!==o.type&&(e=this._removedLayers[i],delete this._removedLayers[i],e.type!==o.type?this._updatedSources[o.source]="clear":(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause())),this._updateLayer(o),o.onAdd&&o.onAdd(this.map))}}moveLayer(e,r){var n;this._checkLoaded(),this._changed=!0,this._layers[e]?e!==r&&(n=this._order.indexOf(e),this._order.splice(n,1),n=r?this._order.indexOf(r):this._order.length,r&&-1===n?this.fire(new t.ErrorEvent(new Error(`Cannot move layer "${e}" before non-existing layer "${r}".`))):(this._order.splice(n,0,e),this._layerOrderChanged=!0)):this.fire(new t.ErrorEvent(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)))}removeLayer(e){this._checkLoaded();var r,n=this._layers[e];n?(n.setEventedParent(null),r=this._order.indexOf(e),this._order.splice(r,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=n,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],n.onRemove&&n.onRemove(this.map)):this.fire(new t.ErrorEvent(new Error(`Cannot remove non-existing layer "${e}".`)))}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,r,n){this._checkLoaded();var i=this.getLayer(e);i?i.minzoom===r&&i.maxzoom===n||(null!=r&&(i.minzoom=r),null!=n&&(i.maxzoom=n),this._updateLayer(i)):this.fire(new t.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,r){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._checkLoaded();var i=this.getLayer(e);i?t.deepEqual(i.filter,r)||(null==r?(i.filter=void 0,this._updateLayer(i)):this._validate(t.validateStyle.filter,`layers.${i.id}.filter`,r,null,n)||(i.filter=t.clone$1(r),this._updateLayer(i))):this.fire(new t.ErrorEvent(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return t.clone$1(this.getLayer(e).filter)}setLayoutProperty(e,r,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this._checkLoaded();var o=this.getLayer(e);o?t.deepEqual(o.getLayoutProperty(r),n)||(o.setLayoutProperty(r,n,i),this._updateLayer(o)):this.fire(new t.ErrorEvent(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,r){var n=this.getLayer(e);if(n)return n.getLayoutProperty(r);this.fire(new t.ErrorEvent(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,r,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this._checkLoaded();var o=this.getLayer(e);o?t.deepEqual(o.getPaintProperty(r),n)||(o.setPaintProperty(r,n,i)&&this._updateLayer(o),this._changed=!0,this._updatedPaintProps[e]=!0):this.fire(new t.ErrorEvent(new Error(`Cannot style non-existing layer "${e}".`)))}getPaintProperty(e,t){return this.getLayer(e).getPaintProperty(t)}setFeatureState(e,r){this._checkLoaded();var n=e.source,i=e.sourceLayer,o=this.sourceCaches[n];void 0===o?this.fire(new t.ErrorEvent(new Error(`The source '${n}' does not exist in the map's style.`))):"geojson"===(n=o.getSource().type)&&i?this.fire(new t.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==n||i?(void 0===e.id&&this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided."))),o.setFeatureState(i,e.id,r)):this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,r){this._checkLoaded();var n,i=e.source,o=this.sourceCaches[i];void 0===o?this.fire(new t.ErrorEvent(new Error(`The source '${i}' does not exist in the map's style.`))):(n="vector"===(i=o.getSource().type)?e.sourceLayer:void 0,"vector"!==i||n?r&&"string"!=typeof e.id&&"number"!=typeof e.id?this.fire(new t.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):o.removeFeatureState(n,e.id,r):this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types."))))}getFeatureState(e){this._checkLoaded();var r=e.source,n=e.sourceLayer,i=this.sourceCaches[r];if(void 0===i)this.fire(new t.ErrorEvent(new Error(`The source '${r}' does not exist in the map's style.`)));else{if("vector"!==i.getSource().type||n)return void 0===e.id&&this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided."))),i.getFeatureState(n,e.id);this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}}getTransition(){return t.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){var e,r,n,i;if(this._loaded)return e=t.mapObject(this.sourceCaches,(e=>e.serialize())),r=this._serializeByIds(this._order),n=this.map.getTerrain()||void 0,i=this.stylesheet,t.filterObject({version:i.version,name:i.name,metadata:i.metadata,light:i.light,center:i.center,zoom:i.zoom,bearing:i.bearing,pitch:i.pitch,sprite:i.sprite,glyphs:i.glyphs,transition:i.transition,sources:e,layers:r,terrain:n},(e=>void 0!==e))}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&"raster"!==this.sourceCaches[e.source].getSource().type&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){var t=e=>"fill-extrusion"===this._layers[e].type,r={},n=[];for(let u=this._order.length-1;0<=u;u--){var i=this._order[u];if(t(i)){r[i]=u;for(const t of e){var o=t[i];if(o)for(const e of o)n.push(e)}}}n.sort(((e,t)=>t.intersectionZ-e.intersectionZ));var a=[];for(let u=this._order.length-1;0<=u;u--){var s=this._order[u];if(t(s))for(let e=n.length-1;0<=e;e--){var l=n[e].feature;if(r[l.layer.id]<u)break;a.push(l),n.pop()}else for(const t of e){var c=t[s];if(c)for(const e of c)a.push(e.feature)}}return a}queryRenderedFeatures(e,r,n){r&&r.filter&&this._validate(t.validateStyle.filter,"queryRenderedFeatures.filter",r.filter,null,r);var i={};if(r&&r.layers){if(!Array.isArray(r.layers))return this.fire(new t.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const e of r.layers){var o=this._layers[e];if(!o)return this.fire(new t.ErrorEvent(new Error(`The layer '${e}' does not exist in the map's style and cannot be queried for features.`))),[];i[o.source]=!0}}var a=[],s=(r.availableImages=this._availableImages,this._serializedAllLayers());for(const t in this.sourceCaches)r.layers&&!i[t]||a.push(D(this.sourceCaches[t],this._layers,s,e,r,n));return this.placement&&a.push(function(e,t,r,n,i,o,a){var s={},l=o.queryRenderedSymbols(n),c=[];for(const p of Object.keys(l).map(Number))c.push(a[p]);c.sort(N);for(const p of c){var u=p.featureIndex.lookupSymbolFeatures(l[p.bucketInstanceId],t,p.bucketIndex,p.sourceLayerIndex,i.filter,i.layers,i.availableImages,e);for(const e in u){var h=s[e]=s[e]||[],d=u[e];d.sort(((e,t)=>{var r,n=p.featureSortOrder;return n?(r=n.indexOf(e.featureIndex),n.indexOf(t.featureIndex)-r):t.featureIndex-e.featureIndex}));for(const e of d)h.push(e)}}for(const p in s)s[p].forEach((t=>{t=t.feature;var n=e[p];n=r[n.source].getFeatureState(t.layer["source-layer"],t.id),t.source=t.layer.source,t.layer["source-layer"]&&(t.sourceLayer=t.layer["source-layer"]),t.state=n}));return s}(this._layers,s,this.sourceCaches,e,r,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(a)}querySourceFeatures(e,r){return r&&r.filter&&this._validate(t.validateStyle.filter,"querySourceFeatures.filter",r.filter,null,r),(e=this.sourceCaches[e])?function(e,t){var r=e.getRenderableIds().map((t=>e.getTileByID(t))),n=[],i={};for(let s=0;s<r.length;s++){var o=r[s],a=o.tileID.canonical.key;i[a]||(i[a]=!0,o.querySourceFeatures(n,t))}return n}(e,r):[]}getLight(){return this.light.getLight()}setLight(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkLoaded();var n,i=this.light.getLight();let o=!1;for(const a in e)if(!t.deepEqual(e[a],i[a])){o=!0;break}o&&(n={now:a.now(),transition:t.extend({duration:300,delay:0},this.stylesheet.transition)},this.light.setLight(e,r),this.light.updateTransitions(n))}_validate(e,r,n,i){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return(!o||!1!==o.validate)&&Xe(this,e.call(t.validateStyle,t.extend({key:r,style:this.serialize(),value:n,styleSpec:t.v8Spec},i)))}_remove(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),J().off(Y,this._rtlPluginLoaded);for(const r in this._layers)this._layers[r].setEventedParent(null);for(const r in this.sourceCaches){var t=this.sourceCaches[r];t.setEventedParent(null),t.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(const t in this.sourceCaches)this.sourceCaches[t].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,t,r,n){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=!1,s=!1;var l={};for(const a of this._order){var c=this._layers[a];if("symbol"===c.type){if(!l[c.source]){const e=this.sourceCaches[c.source];l[c.source]=e.getRenderableIds(!0).map((t=>e.getTileByID(t))).sort(((e,t)=>t.tileID.overscaledZ-e.tileID.overscaledZ||(e.tileID.isLessThan(t.tileID)?-1:1)))}c=this.crossTileSymbolIndex.addLayer(c,l[c.source],e.center.lng),o=o||c}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((i=i||this._layerOrderChanged||0===r)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.now(),e.zoom))&&(this.pauseablePlacement=new Ge(e,this.map.terrain,this._order,i,t,r,n,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,l),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.now()),s=!0),o&&this.pauseablePlacement.placement.setStale()),s||o)for(const a of this._order){var u=this._layers[a];"symbol"===u.type&&this.placement.updateLayerOpacities(u,l[u.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.now())}_releaseSymbolFadeTiles(){for(const e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,r){return t.__awaiter(this,void 0,void 0,(function*(){var e=yield this.imageManager.getImages(r.icons),t=(this._updateTilesForChangedImages(),this.sourceCaches[r.source]);return t&&t.setDependencies(r.tileID.key,r.type,r.icons),e}))}getGlyphs(e,r){return t.__awaiter(this,void 0,void 0,(function*(){var e=yield this.glyphManager.getGlyphs(r.stacks),t=this.sourceCaches[r.source];return t&&t.setDependencies(r.tileID.key,r.type,[""]),e}))}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkLoaded(),e&&this._validate(t.validateStyle.glyphs,"glyphs",e,null,r)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,r){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0;this._checkLoaded(),e=[{id:e,url:r}],r=[...g(this.stylesheet.sprite),...e],this._validate(t.validateStyle.sprite,"sprite",r,null,n)||(this.stylesheet.sprite=r,this._loadSprite(e,!0,i))}removeSprite(e){this._checkLoaded();var r=g(this.stylesheet.sprite);if(r.find((t=>t.id===e))){if(this._spritesImagesIds[e])for(const t of this._spritesImagesIds[e])this.imageManager.removeImage(t),this._changedImages[t]=!0;r.splice(r.findIndex((t=>t.id===e)),1),this.stylesheet.sprite=0<r.length?r:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new t.Event("data",{dataType:"style"}))}else this.fire(new t.ErrorEvent(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return g(this.stylesheet.sprite)}setSprite(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;this._checkLoaded(),e&&this._validate(t.validateStyle.sprite,"sprite",e,null,r)||((this.stylesheet.sprite=e)?this._loadSprite(e,!0,n):(this._unloadSprite(),n&&n(null)))}}var et=t.createLayout([{name:"a_pos",type:"Int16",components:2}]),tt="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const rt={prelude:nt("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\n","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}\n#ifdef TERRAIN3D\nuniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;\n#endif\nconst highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {\n#ifdef TERRAIN3D\nhighp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));\n#else\nreturn 1.0;\n#endif\n}float calculate_visibility(vec4 pos) {\n#ifdef TERRAIN3D\nvec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;\n#else\nreturn 1.0;\n#endif\n}float ele(vec2 pos) {\n#ifdef TERRAIN3D\nvec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;\n#else\nreturn 0.0;\n#endif\n}float get_elevation(vec2 pos) {\n#ifdef TERRAIN3D\nvec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;\n#else\nreturn 0.0;\n#endif\n}"),background:nt("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:nt("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:nt("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),clippingMask:nt("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:nt("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),heatmapTexture:nt("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:nt("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:nt("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:nt("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:nt("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),fillOutline:nt("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillOutlinePattern:nt("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillPattern:nt("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),fillExtrusion:nt("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),fillExtrusionPattern:nt("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),hillshadePrepare:nt("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:nt("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:nt("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),lineGradient:nt("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),linePattern:nt("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),lineSDF:nt("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),raster:nt("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:nt("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}"),symbolSDF:nt("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),symbolTextAndIcon:nt("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}"),terrain:nt("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",tt),terrainDepth:nt("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",tt),terrainCoords:nt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",tt)};function nt(e,t){var r=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,n=t.match(/attribute ([\w]+) ([\w]+)/g),i=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),o=(o=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g))?o.concat(i):i;const a={};return{fragmentSource:e=e.replace(r,((e,t,r,n,i)=>(a[i]=!0,"define"===t?`\n#ifndef HAS_UNIFORM_u_${i}\nvarying ${r} ${n} ${i};\n#else\nuniform ${r} ${n} u_${i};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${i}\n    ${r} ${n} ${i} = u_${i};\n#endif\n`))),vertexSource:t=t.replace(r,((e,t,r,n,i)=>{var o="float"===n?"vec2":"vec4",s=i.match(/color/)?"color":o;return a[i]?"define"===t?`\n#ifndef HAS_UNIFORM_u_${i}\nuniform lowp float u_${i}_t;\nattribute ${r} ${o} a_${i};\nvarying ${r} ${n} ${i};\n#else\nuniform ${r} ${n} u_${i};\n#endif\n`:"vec4"==s?`\n#ifndef HAS_UNIFORM_u_${i}\n    ${i} = a_${i};\n#else\n    ${r} ${n} ${i} = u_${i};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${i}\n    ${i} = unpack_mix_${s}(a_${i}, u_${i}_t);\n#else\n    ${r} ${n} ${i} = u_${i};\n#endif\n`:"define"===t?`\n#ifndef HAS_UNIFORM_u_${i}\nuniform lowp float u_${i}_t;\nattribute ${r} ${o} a_${i};\n#else\nuniform ${r} ${n} u_${i};\n#endif\n`:"vec4"==s?`\n#ifndef HAS_UNIFORM_u_${i}\n    ${r} ${n} ${i} = a_${i};\n#else\n    ${r} ${n} ${i} = u_${i};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${i}\n    ${r} ${n} ${i} = unpack_mix_${s}(a_${i}, u_${i}_t);\n#else\n    ${r} ${n} ${i} = u_${i};\n#endif\n`})),staticAttributes:n,staticUniforms:o}}class it{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,t,r,n,i,o,a,s,l){this.context=e;let c=this.boundPaintVertexBuffers.length!==n.length;for(let u=0;!c&&u<n.length;u++)this.boundPaintVertexBuffers[u]!==n[u]&&(c=!0);!this.vao||this.boundProgram!==t||this.boundLayoutVertexBuffer!==r||c||this.boundIndexBuffer!==i||this.boundVertexOffset!==o||this.boundDynamicVertexBuffer!==a||this.boundDynamicVertexBuffer2!==s||this.boundDynamicVertexBuffer3!==l?this.freshBind(t,r,n,i,o,a,s,l):(e.bindVertexArray.set(this.vao),a&&a.bind(),i&&i.dynamicDraw&&i.bind(),s&&s.bind(),l&&l.bind())}freshBind(e,t,r,n,i,o,a,s){var l=e.numAttributes,c=this.context,u=c.gl;this.vao&&this.destroy(),this.vao=c.createVertexArray(),c.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=t,this.boundPaintVertexBuffers=r,this.boundIndexBuffer=n,this.boundVertexOffset=i,this.boundDynamicVertexBuffer=o,this.boundDynamicVertexBuffer2=a,this.boundDynamicVertexBuffer3=s,t.enableAttributes(u,e);for(const h of r)h.enableAttributes(u,e);o&&o.enableAttributes(u,e),a&&a.enableAttributes(u,e),s&&s.enableAttributes(u,e),t.bind(),t.setVertexAttribPointers(u,e,i);for(const h of r)h.bind(),h.setVertexAttribPointers(u,e,i);o&&(o.bind(),o.setVertexAttribPointers(u,e,i)),n&&n.bind(),a&&(a.bind(),a.setVertexAttribPointers(u,e,i)),s&&(s.bind(),s.setVertexAttribPointers(u,e,i)),c.currentNumAttributes=l}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function ot(e){var t,r=[];for(let n=0;n<e.length;n++)null!==e[n]&&(t=e[n].split(" "),r.push(t.pop()));return r}class at{constructor(e,r,n,i,o,a){var s=e.gl,l=(this.program=s.createProgram(),ot(r.staticAttributes)),c=n?n.getBinderAttributes():[],u=l.concat(c),h=(l=rt.prelude.staticUniforms?ot(rt.prelude.staticUniforms):[],c=r.staticUniforms?ot(r.staticUniforms):[],n?n.getBinderUniforms():[]),d=[];for(const t of l.concat(c).concat(h))d.indexOf(t)<0&&d.push(t);if(l=n?n.defines():[],o&&l.push("#define OVERDRAW_INSPECTOR;"),a&&l.push("#define TERRAIN3D;"),c=l.concat(rt.prelude.fragmentSource,r.fragmentSource).join("\n"),h=l.concat(rt.prelude.vertexSource,r.vertexSource).join("\n"),o=s.createShader(s.FRAGMENT_SHADER),s.isContextLost())this.failedToCreate=!0;else{if(s.shaderSource(o,c),s.compileShader(o),!s.getShaderParameter(o,s.COMPILE_STATUS))throw new Error("Could not compile fragment shader: "+s.getShaderInfoLog(o));if(s.attachShader(this.program,o),a=s.createShader(s.VERTEX_SHADER),s.isContextLost())this.failedToCreate=!0;else{if(s.shaderSource(a,h),s.compileShader(a),!s.getShaderParameter(a,s.COMPILE_STATUS))throw new Error("Could not compile vertex shader: "+s.getShaderInfoLog(a));s.attachShader(this.program,a),this.attributes={};var p={};this.numAttributes=u.length;for(let e=0;e<this.numAttributes;e++)u[e]&&(s.bindAttribLocation(this.program,e,u[e]),this.attributes[u[e]]=e);if(s.linkProgram(this.program),!s.getProgramParameter(this.program,s.LINK_STATUS))throw new Error("Program failed to link: "+s.getProgramInfoLog(this.program));s.deleteShader(a),s.deleteShader(o);for(let e=0;e<d.length;e++){var f,m=d[e];m&&!p[m]&&(f=s.getUniformLocation(this.program,m))&&(p[m]=f)}this.fixedUniforms=i(e,p),this.terrainUniforms=((e,r)=>({u_depth:new t.Uniform1i(e,r.u_depth),u_terrain:new t.Uniform1i(e,r.u_terrain),u_terrain_dim:new t.Uniform1f(e,r.u_terrain_dim),u_terrain_matrix:new t.UniformMatrix4f(e,r.u_terrain_matrix),u_terrain_unpack:new t.Uniform4f(e,r.u_terrain_unpack),u_terrain_exaggeration:new t.Uniform1f(e,r.u_terrain_exaggeration)}))(e,p),this.binderUniforms=n?n.getUniforms(e,p):[]}}}draw(e,t,r,n,i,o,a,s,l,c,u,h,d,p,f,m,g,y){var v=e.gl;if(!this.failedToCreate){if(e.program.set(this.program),e.setDepthMode(r),e.setStencilMode(n),e.setColorMode(i),e.setCullFace(o),s){e.activeTexture.set(v.TEXTURE2),v.bindTexture(v.TEXTURE_2D,s.depthTexture),e.activeTexture.set(v.TEXTURE3),v.bindTexture(v.TEXTURE_2D,s.texture);for(const e in this.terrainUniforms)this.terrainUniforms[e].set(s[e])}for(const e in this.fixedUniforms)this.fixedUniforms[e].set(a[e]);f&&f.setUniforms(e,this.binderUniforms,d,{zoom:p});let b=0;switch(t){case v.LINES:b=2;break;case v.TRIANGLES:b=3;break;case v.LINE_STRIP:b=1}for(const r of h.get()){var _=r.vaos||(r.vaos={});(_[l]||(_[l]=new it)).bind(e,this,c,f?f.getPaintVertexBuffers():[],u,r.vertexOffset,m,g,y),v.drawElements(t,r.primitiveLength*b,v.UNSIGNED_SHORT,r.primitiveOffset*b*2)}}}}function st(e,t,r){var n=1/Se(r,1,t.transform.tileZoom),i=Math.pow(2,r.tileID.overscaledZ);i=(t=r.tileSize*Math.pow(2,t.transform.tileZoom)/i)*(r.tileID.canonical.x+r.tileID.wrap*i),t*=r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture.size,u_scale:[n,e.fromScale,e.toScale],u_fade:e.t,u_pixel_coord_upper:[i>>16,t>>16],u_pixel_coord_lower:[65535&i,65535&t]}}const lt=(e,r,n,i)=>{var o=r.style.light,a=[(a=o.properties.get("position")).x,a.y,a.z],s=t.create$1();"viewport"===o.properties.get("anchor")&&t.fromRotation(s,-r.transform.angle),t.transformMat3(a,a,s),r=o.properties.get("color");return{u_matrix:e,u_lightpos:a,u_lightintensity:o.properties.get("intensity"),u_lightcolor:[r.r,r.g,r.b],u_vertical_gradient:+n,u_opacity:i}},ct=(e,r,n,i,o,a,s)=>t.extend(lt(e,r,n,i),st(a,r,s),{u_height_factor:-Math.pow(2,o.overscaledZ)/s.tileSize/8}),ut=e=>({u_matrix:e}),ht=(e,r,n,i)=>t.extend(ut(e),st(n,r,i)),dt=(e,t)=>({u_matrix:e,u_world:t}),pt=(e,r,n,i,o)=>t.extend(ht(e,r,n,i),{u_world:o}),ft=(e,t,r)=>{var n=Se(r,1,t.zoom),i=Math.pow(2,t.zoom-r.tileID.overscaledZ);r=r.tileID.overscaleFactor();return{u_matrix:e,u_camera_to_center_distance:t.cameraToCenterDistance,u_pixels_to_tile_units:n,u_extrude_scale:[t.pixelsToGLUnits[0]/(n*i),t.pixelsToGLUnits[1]/(n*i)],u_overscale_factor:r}},mt=(e,t,r)=>({u_matrix:e,u_inv_matrix:t,u_camera_to_center_distance:r.cameraToCenterDistance,u_viewport_size:[r.width,r.height]}),gt=function(e,t){return{u_matrix:e,u_color:t,u_overlay:0,u_overlay_scale:arguments.length>2&&void 0!==arguments[2]?arguments[2]:1}},yt=e=>({u_matrix:e}),vt=(e,r,n,i)=>{var o=n.paint.get("hillshade-shadow-color"),a=n.paint.get("hillshade-highlight-color"),s=n.paint.get("hillshade-accent-color");let l=n.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===n.paint.get("hillshade-illumination-anchor")&&(l-=e.transform.angle);var c=!e.options.moving;return{u_matrix:i?i.posMatrix:e.transform.calculatePosMatrix(r.tileID.toUnwrapped(),c),u_image:0,u_latrange:(i=r.tileID,e=Math.pow(2,i.canonical.z),i=i.canonical.y,[new t.MercatorCoordinate(0,i/e).toLngLat().lat,new t.MercatorCoordinate(0,(i+1)/e).toLngLat().lat]),u_light:[n.paint.get("hillshade-exaggeration"),l],u_shadow:o,u_highlight:a,u_accent:s}},_t=(e,r)=>{var n=r.stride,i=t.create();return t.ortho(i,0,t.EXTENT,-t.EXTENT,0,0,1),t.translate(i,i,[0,-t.EXTENT,0]),{u_matrix:i,u_image:1,u_dimension:[n,n],u_zoom:e.overscaledZ,u_unpack:r.getUnpackVector()}},bt=(e,t,r,n)=>{var i=e.transform;return{u_matrix:xt(e,t,r,n),u_ratio:1/Se(t,1,i.zoom),u_device_pixel_ratio:e.pixelRatio,u_units_to_pixels:[1/i.pixelsToGLUnits[0],1/i.pixelsToGLUnits[1]]}};function wt(e,t){return 1/Se(e,1,t.tileZoom)}function xt(e,t,r,n){return e.translatePosMatrix((n||t.tileID).posMatrix,t,r.paint.get("line-translate"),r.paint.get("line-translate-anchor"))}const Ct=(e,t,r,n,i)=>({u_matrix:e,u_tl_parent:t,u_scale_parent:r,u_buffer_scale:1,u_fade_t:n.mix,u_opacity:n.opacity*i.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:i.paint.get("raster-brightness-min"),u_brightness_high:i.paint.get("raster-brightness-max"),u_saturation_factor:0<(e=i.paint.get("raster-saturation"))?1-1/(1.001-e):-e,u_contrast_factor:0<(t=i.paint.get("raster-contrast"))?1/(1-t):1+t,u_spin_weights:(r=i.paint.get("raster-hue-rotate"),r*=Math.PI/180,n=Math.sin(r),[(2*(r=Math.cos(r))+1)/3,(-Math.sqrt(3)*n-r+1)/3,(Math.sqrt(3)*n-r+1)/3])}),St=(e,t,r,n,i,o,a,s,l,c)=>{var u=i.transform;return{u_is_size_zoom_constant:+("constant"===e||"source"===e),u_is_size_feature_constant:+("constant"===e||"camera"===e),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:u.cameraToCenterDistance,u_pitch:u.pitch/360*2*Math.PI,u_rotate_symbol:+r,u_aspect_ratio:u.width/u.height,u_fade_change:i.options.fadeDuration?i.symbolFadeChange:1,u_matrix:o,u_label_plane_matrix:a,u_coord_matrix:s,u_is_text:+l,u_pitch_with_map:+n,u_texsize:c,u_texture:0}},Et=(e,r,n,i,o,a,s,l,c,u,h)=>{var d=o.transform;return t.extend(St(e,r,n,i,o,a,s,l,c,u),{u_gamma_scale:i?Math.cos(d._pitch)*d.cameraToCenterDistance:1,u_device_pixel_ratio:o.pixelRatio,u_is_halo:+h})},Tt=(e,r,n,i,o,a,s,l,c,u)=>t.extend(Et(e,r,n,i,o,a,s,l,!0,c,!0),{u_texsize_icon:u,u_texture_icon:1}),It=(e,r,n,i,o,a)=>t.extend(function(e,t,r,n){var i=r.imageManager.getPattern(e.from.toString()),{width:o,height:a}=(e=r.imageManager.getPattern(e.to.toString()),r.imageManager.getPixelSize()),s=Math.pow(2,n.tileID.overscaledZ),l=(s=(l=n.tileSize*Math.pow(2,r.transform.tileZoom)/s)*(n.tileID.canonical.x+n.tileID.wrap*s),l*n.tileID.canonical.y);return{u_image:0,u_pattern_tl_a:i.tl,u_pattern_br_a:i.br,u_pattern_tl_b:e.tl,u_pattern_br_b:e.br,u_texsize:[o,a],u_mix:t.t,u_pattern_size_a:i.displaySize,u_pattern_size_b:e.displaySize,u_scale_a:t.fromScale,u_scale_b:t.toScale,u_tile_units_to_pixels:1/Se(n,1,r.transform.tileZoom),u_pixel_coord_upper:[s>>16,l>>16],u_pixel_coord_lower:[65535&s,65535&l]}}(i,a,n,o),{u_matrix:e,u_opacity:r}),kt={fillExtrusion:(e,r)=>({u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_lightpos:new t.Uniform3f(e,r.u_lightpos),u_lightintensity:new t.Uniform1f(e,r.u_lightintensity),u_lightcolor:new t.Uniform3f(e,r.u_lightcolor),u_vertical_gradient:new t.Uniform1f(e,r.u_vertical_gradient),u_opacity:new t.Uniform1f(e,r.u_opacity)}),fillExtrusionPattern:(e,r)=>({u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_lightpos:new t.Uniform3f(e,r.u_lightpos),u_lightintensity:new t.Uniform1f(e,r.u_lightintensity),u_lightcolor:new t.Uniform3f(e,r.u_lightcolor),u_vertical_gradient:new t.Uniform1f(e,r.u_vertical_gradient),u_height_factor:new t.Uniform1f(e,r.u_height_factor),u_image:new t.Uniform1i(e,r.u_image),u_texsize:new t.Uniform2f(e,r.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,r.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,r.u_pixel_coord_lower),u_scale:new t.Uniform3f(e,r.u_scale),u_fade:new t.Uniform1f(e,r.u_fade),u_opacity:new t.Uniform1f(e,r.u_opacity)}),fill:(e,r)=>({u_matrix:new t.UniformMatrix4f(e,r.u_matrix)}),fillPattern:(e,r)=>({u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_image:new t.Uniform1i(e,r.u_image),u_texsize:new t.Uniform2f(e,r.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,r.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,r.u_pixel_coord_lower),u_scale:new t.Uniform3f(e,r.u_scale),u_fade:new t.Uniform1f(e,r.u_fade)}),fillOutline:(e,r)=>({u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_world:new t.Uniform2f(e,r.u_world)}),fillOutlinePattern:(e,r)=>({u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_world:new t.Uniform2f(e,r.u_world),u_image:new t.Uniform1i(e,r.u_image),u_texsize:new t.Uniform2f(e,r.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,r.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,r.u_pixel_coord_lower),u_scale:new t.Uniform3f(e,r.u_scale),u_fade:new t.Uniform1f(e,r.u_fade)}),circle:(e,r)=>({u_camera_to_center_distance:new t.Uniform1f(e,r.u_camera_to_center_distance),u_scale_with_map:new t.Uniform1i(e,r.u_scale_with_map),u_pitch_with_map:new t.Uniform1i(e,r.u_pitch_with_map),u_extrude_scale:new t.Uniform2f(e,r.u_extrude_scale),u_device_pixel_ratio:new t.Uniform1f(e,r.u_device_pixel_ratio),u_matrix:new t.UniformMatrix4f(e,r.u_matrix)}),collisionBox:(e,r)=>({u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_camera_to_center_distance:new t.Uniform1f(e,r.u_camera_to_center_distance),u_pixels_to_tile_units:new t.Uniform1f(e,r.u_pixels_to_tile_units),u_extrude_scale:new t.Uniform2f(e,r.u_extrude_scale),u_overscale_factor:new t.Uniform1f(e,r.u_overscale_factor)}),collisionCircle:(e,r)=>({u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_inv_matrix:new t.UniformMatrix4f(e,r.u_inv_matrix),u_camera_to_center_distance:new t.Uniform1f(e,r.u_camera_to_center_distance),u_viewport_size:new t.Uniform2f(e,r.u_viewport_size)}),debug:(e,r)=>({u_color:new t.UniformColor(e,r.u_color),u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_overlay:new t.Uniform1i(e,r.u_overlay),u_overlay_scale:new t.Uniform1f(e,r.u_overlay_scale)}),clippingMask:(e,r)=>({u_matrix:new t.UniformMatrix4f(e,r.u_matrix)}),heatmap:(e,r)=>({u_extrude_scale:new t.Uniform1f(e,r.u_extrude_scale),u_intensity:new t.Uniform1f(e,r.u_intensity),u_matrix:new t.UniformMatrix4f(e,r.u_matrix)}),heatmapTexture:(e,r)=>({u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_world:new t.Uniform2f(e,r.u_world),u_image:new t.Uniform1i(e,r.u_image),u_color_ramp:new t.Uniform1i(e,r.u_color_ramp),u_opacity:new t.Uniform1f(e,r.u_opacity)}),hillshade:(e,r)=>({u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_image:new t.Uniform1i(e,r.u_image),u_latrange:new t.Uniform2f(e,r.u_latrange),u_light:new t.Uniform2f(e,r.u_light),u_shadow:new t.UniformColor(e,r.u_shadow),u_highlight:new t.UniformColor(e,r.u_highlight),u_accent:new t.UniformColor(e,r.u_accent)}),hillshadePrepare:(e,r)=>({u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_image:new t.Uniform1i(e,r.u_image),u_dimension:new t.Uniform2f(e,r.u_dimension),u_zoom:new t.Uniform1f(e,r.u_zoom),u_unpack:new t.Uniform4f(e,r.u_unpack)}),line:(e,r)=>({u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_ratio:new t.Uniform1f(e,r.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,r.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(e,r.u_units_to_pixels)}),lineGradient:(e,r)=>({u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_ratio:new t.Uniform1f(e,r.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,r.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(e,r.u_units_to_pixels),u_image:new t.Uniform1i(e,r.u_image),u_image_height:new t.Uniform1f(e,r.u_image_height)}),linePattern:(e,r)=>({u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_texsize:new t.Uniform2f(e,r.u_texsize),u_ratio:new t.Uniform1f(e,r.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,r.u_device_pixel_ratio),u_image:new t.Uniform1i(e,r.u_image),u_units_to_pixels:new t.Uniform2f(e,r.u_units_to_pixels),u_scale:new t.Uniform3f(e,r.u_scale),u_fade:new t.Uniform1f(e,r.u_fade)}),lineSDF:(e,r)=>({u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_ratio:new t.Uniform1f(e,r.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,r.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(e,r.u_units_to_pixels),u_patternscale_a:new t.Uniform2f(e,r.u_patternscale_a),u_patternscale_b:new t.Uniform2f(e,r.u_patternscale_b),u_sdfgamma:new t.Uniform1f(e,r.u_sdfgamma),u_image:new t.Uniform1i(e,r.u_image),u_tex_y_a:new t.Uniform1f(e,r.u_tex_y_a),u_tex_y_b:new t.Uniform1f(e,r.u_tex_y_b),u_mix:new t.Uniform1f(e,r.u_mix)}),raster:(e,r)=>({u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_tl_parent:new t.Uniform2f(e,r.u_tl_parent),u_scale_parent:new t.Uniform1f(e,r.u_scale_parent),u_buffer_scale:new t.Uniform1f(e,r.u_buffer_scale),u_fade_t:new t.Uniform1f(e,r.u_fade_t),u_opacity:new t.Uniform1f(e,r.u_opacity),u_image0:new t.Uniform1i(e,r.u_image0),u_image1:new t.Uniform1i(e,r.u_image1),u_brightness_low:new t.Uniform1f(e,r.u_brightness_low),u_brightness_high:new t.Uniform1f(e,r.u_brightness_high),u_saturation_factor:new t.Uniform1f(e,r.u_saturation_factor),u_contrast_factor:new t.Uniform1f(e,r.u_contrast_factor),u_spin_weights:new t.Uniform3f(e,r.u_spin_weights)}),symbolIcon:(e,r)=>({u_is_size_zoom_constant:new t.Uniform1i(e,r.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,r.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,r.u_size_t),u_size:new t.Uniform1f(e,r.u_size),u_camera_to_center_distance:new t.Uniform1f(e,r.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,r.u_pitch),u_rotate_symbol:new t.Uniform1i(e,r.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,r.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,r.u_fade_change),u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,r.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,r.u_coord_matrix),u_is_text:new t.Uniform1i(e,r.u_is_text),u_pitch_with_map:new t.Uniform1i(e,r.u_pitch_with_map),u_texsize:new t.Uniform2f(e,r.u_texsize),u_texture:new t.Uniform1i(e,r.u_texture)}),symbolSDF:(e,r)=>({u_is_size_zoom_constant:new t.Uniform1i(e,r.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,r.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,r.u_size_t),u_size:new t.Uniform1f(e,r.u_size),u_camera_to_center_distance:new t.Uniform1f(e,r.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,r.u_pitch),u_rotate_symbol:new t.Uniform1i(e,r.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,r.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,r.u_fade_change),u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,r.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,r.u_coord_matrix),u_is_text:new t.Uniform1i(e,r.u_is_text),u_pitch_with_map:new t.Uniform1i(e,r.u_pitch_with_map),u_texsize:new t.Uniform2f(e,r.u_texsize),u_texture:new t.Uniform1i(e,r.u_texture),u_gamma_scale:new t.Uniform1f(e,r.u_gamma_scale),u_device_pixel_ratio:new t.Uniform1f(e,r.u_device_pixel_ratio),u_is_halo:new t.Uniform1i(e,r.u_is_halo)}),symbolTextAndIcon:(e,r)=>({u_is_size_zoom_constant:new t.Uniform1i(e,r.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,r.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,r.u_size_t),u_size:new t.Uniform1f(e,r.u_size),u_camera_to_center_distance:new t.Uniform1f(e,r.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,r.u_pitch),u_rotate_symbol:new t.Uniform1i(e,r.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,r.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,r.u_fade_change),u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,r.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,r.u_coord_matrix),u_is_text:new t.Uniform1i(e,r.u_is_text),u_pitch_with_map:new t.Uniform1i(e,r.u_pitch_with_map),u_texsize:new t.Uniform2f(e,r.u_texsize),u_texsize_icon:new t.Uniform2f(e,r.u_texsize_icon),u_texture:new t.Uniform1i(e,r.u_texture),u_texture_icon:new t.Uniform1i(e,r.u_texture_icon),u_gamma_scale:new t.Uniform1f(e,r.u_gamma_scale),u_device_pixel_ratio:new t.Uniform1f(e,r.u_device_pixel_ratio),u_is_halo:new t.Uniform1i(e,r.u_is_halo)}),background:(e,r)=>({u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_opacity:new t.Uniform1f(e,r.u_opacity),u_color:new t.UniformColor(e,r.u_color)}),backgroundPattern:(e,r)=>({u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_opacity:new t.Uniform1f(e,r.u_opacity),u_image:new t.Uniform1i(e,r.u_image),u_pattern_tl_a:new t.Uniform2f(e,r.u_pattern_tl_a),u_pattern_br_a:new t.Uniform2f(e,r.u_pattern_br_a),u_pattern_tl_b:new t.Uniform2f(e,r.u_pattern_tl_b),u_pattern_br_b:new t.Uniform2f(e,r.u_pattern_br_b),u_texsize:new t.Uniform2f(e,r.u_texsize),u_mix:new t.Uniform1f(e,r.u_mix),u_pattern_size_a:new t.Uniform2f(e,r.u_pattern_size_a),u_pattern_size_b:new t.Uniform2f(e,r.u_pattern_size_b),u_scale_a:new t.Uniform1f(e,r.u_scale_a),u_scale_b:new t.Uniform1f(e,r.u_scale_b),u_pixel_coord_upper:new t.Uniform2f(e,r.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,r.u_pixel_coord_lower),u_tile_units_to_pixels:new t.Uniform1f(e,r.u_tile_units_to_pixels)}),terrain:(e,r)=>({u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_texture:new t.Uniform1i(e,r.u_texture),u_ele_delta:new t.Uniform1f(e,r.u_ele_delta)}),terrainDepth:(e,r)=>({u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_ele_delta:new t.Uniform1f(e,r.u_ele_delta)}),terrainCoords:(e,r)=>({u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_texture:new t.Uniform1i(e,r.u_texture),u_terrain_coords_id:new t.Uniform1f(e,r.u_terrain_coords_id),u_ele_delta:new t.Uniform1f(e,r.u_ele_delta)})};class At{constructor(e,t,r){var n=(this.context=e).gl;this.buffer=n.createBuffer(),this.dynamicDraw=Boolean(r),this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),n.bufferData(n.ELEMENT_ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?n.DYNAMIC_DRAW:n.STATIC_DRAW),this.dynamicDraw||delete t.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){var t=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),t.bufferSubData(t.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){var e=this.context.gl;this.buffer&&(e.deleteBuffer(this.buffer),delete this.buffer)}}const Pt={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Mt{constructor(e,t,r,n){this.length=t.length,this.attributes=r,this.itemSize=t.bytesPerElement,this.dynamicDraw=n,r=(this.context=e).gl,this.buffer=r.createBuffer(),e.bindVertexBuffer.set(this.buffer),r.bufferData(r.ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?r.DYNAMIC_DRAW:r.STATIC_DRAW),this.dynamicDraw||delete t.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of `+this.length);var t=this.context.gl;this.bind(),t.bufferSubData(t.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,t){for(let n=0;n<this.attributes.length;n++){var r=this.attributes[n];void 0!==(r=t.attributes[r.name])&&e.enableVertexAttribArray(r)}}setVertexAttribPointers(e,t,r){for(let o=0;o<this.attributes.length;o++){var n=this.attributes[o],i=t.attributes[n.name];void 0!==i&&e.vertexAttribPointer(i,n.components,e[Pt[n.type]],!1,this.itemSize,n.offset+this.itemSize*(r||0))}}destroy(){var e=this.context.gl;this.buffer&&(e.deleteBuffer(this.buffer),delete this.buffer)}}const Rt=new WeakMap;function Ot(e){var t;return Rt.has(e)?Rt.get(e):(t=null==(t=e.getParameter(e.VERSION))?void 0:t.startsWith("WebGL 2.0"),Rt.set(e,t),t)}class Lt{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Dt extends Lt{getDefault(){return t.Color.transparent}set(e){var t=this.current;e.r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a&&!this.dirty||(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Nt extends Lt{getDefault(){return 1}set(e){e===this.current&&!this.dirty||(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class zt extends Lt{getDefault(){return 0}set(e){e===this.current&&!this.dirty||(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class Ft extends Lt{getDefault(){return[!0,!0,!0,!0]}set(e){var t=this.current;e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&!this.dirty||(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Bt extends Lt{getDefault(){return!0}set(e){e===this.current&&!this.dirty||(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class Ut extends Lt{getDefault(){return 255}set(e){e===this.current&&!this.dirty||(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class jt extends Lt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){var t=this.current;e.func===t.func&&e.ref===t.ref&&e.mask===t.mask&&!this.dirty||(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class qt extends Lt{getDefault(){var e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){var t=this.current;e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&!this.dirty||(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class Ht extends Lt{getDefault(){return!1}set(e){var t;e===this.current&&!this.dirty||(t=this.gl,e?t.enable(t.STENCIL_TEST):t.disable(t.STENCIL_TEST),this.current=e,this.dirty=!1)}}class Vt extends Lt{getDefault(){return[0,1]}set(e){var t=this.current;e[0]===t[0]&&e[1]===t[1]&&!this.dirty||(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class Gt extends Lt{getDefault(){return!1}set(e){var t;e===this.current&&!this.dirty||(t=this.gl,e?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST),this.current=e,this.dirty=!1)}}class Kt extends Lt{getDefault(){return this.gl.LESS}set(e){e===this.current&&!this.dirty||(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class Zt extends Lt{getDefault(){return!1}set(e){var t;e===this.current&&!this.dirty||(t=this.gl,e?t.enable(t.BLEND):t.disable(t.BLEND),this.current=e,this.dirty=!1)}}class Wt extends Lt{getDefault(){var e=this.gl;return[e.ONE,e.ZERO]}set(e){var t=this.current;e[0]===t[0]&&e[1]===t[1]&&!this.dirty||(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class $t extends Lt{getDefault(){return t.Color.transparent}set(e){var t=this.current;e.r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a&&!this.dirty||(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Yt extends Lt{getDefault(){return this.gl.FUNC_ADD}set(e){e===this.current&&!this.dirty||(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class Xt extends Lt{getDefault(){return!1}set(e){var t;e===this.current&&!this.dirty||(t=this.gl,e?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE),this.current=e,this.dirty=!1)}}class Qt extends Lt{getDefault(){return this.gl.BACK}set(e){e===this.current&&!this.dirty||(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class Jt extends Lt{getDefault(){return this.gl.CCW}set(e){e===this.current&&!this.dirty||(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class er extends Lt{getDefault(){return null}set(e){e===this.current&&!this.dirty||(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class tr extends Lt{getDefault(){return this.gl.TEXTURE0}set(e){e===this.current&&!this.dirty||(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class rr extends Lt{getDefault(){var e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){var t=this.current;e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&!this.dirty||(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class nr extends Lt{getDefault(){return null}set(e){var t;e===this.current&&!this.dirty||((t=this.gl).bindFramebuffer(t.FRAMEBUFFER,e),this.current=e,this.dirty=!1)}}class ir extends Lt{getDefault(){return null}set(e){var t;e===this.current&&!this.dirty||((t=this.gl).bindRenderbuffer(t.RENDERBUFFER,e),this.current=e,this.dirty=!1)}}class or extends Lt{getDefault(){return null}set(e){var t;e===this.current&&!this.dirty||((t=this.gl).bindTexture(t.TEXTURE_2D,e),this.current=e,this.dirty=!1)}}class ar extends Lt{getDefault(){return null}set(e){var t;e===this.current&&!this.dirty||((t=this.gl).bindBuffer(t.ARRAY_BUFFER,e),this.current=e,this.dirty=!1)}}class sr extends Lt{getDefault(){return null}set(e){var t=this.gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class lr extends Lt{getDefault(){return null}set(e){var t;e===this.current&&!this.dirty||(Ot(t=this.gl)?t.bindVertexArray(e):null!=(t=t.getExtension("OES_vertex_array_object"))&&t.bindVertexArrayOES(e),this.current=e,this.dirty=!1)}}class cr extends Lt{getDefault(){return 4}set(e){var t;e===this.current&&!this.dirty||((t=this.gl).pixelStorei(t.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1)}}class ur extends Lt{getDefault(){return!1}set(e){var t;e===this.current&&!this.dirty||((t=this.gl).pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1)}}class hr extends Lt{getDefault(){return!1}set(e){var t;e===this.current&&!this.dirty||((t=this.gl).pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1)}}class dr extends Lt{constructor(e,t){super(e),this.context=e,this.parent=t}getDefault(){return null}}class pr extends dr{setDirty(){this.dirty=!0}set(e){var t;e===this.current&&!this.dirty||(this.context.bindFramebuffer.set(this.parent),(t=this.gl).framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0),this.current=e,this.dirty=!1)}}class fr extends dr{set(e){var t;e===this.current&&!this.dirty||(this.context.bindFramebuffer.set(this.parent),(t=this.gl).framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e),this.current=e,this.dirty=!1)}}class mr extends dr{set(e){var t;e===this.current&&!this.dirty||(this.context.bindFramebuffer.set(this.parent),(t=this.gl).framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,e),this.current=e,this.dirty=!1)}}class gr{constructor(e,t,r,n,i){if(this.context=e,this.width=t,this.height=r,t=e.gl,r=this.framebuffer=t.createFramebuffer(),this.colorAttachment=new pr(e,r),n)this.depthAttachment=new(i?mr:fr)(e,r);else if(i)throw new Error("Stencil cannot be set without depth");if(t.checkFramebufferStatus(t.FRAMEBUFFER)!==t.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){var e=this.context.gl,t=this.colorAttachment.get();t&&e.deleteTexture(t),this.depthAttachment&&(t=this.depthAttachment.get())&&e.deleteRenderbuffer(t),e.deleteFramebuffer(this.framebuffer)}}class yr{constructor(e,t,r){this.blendFunction=e,this.blendColor=t,this.mask=r}}yr.Replace=[1,0],yr.disabled=new yr(yr.Replace,t.Color.transparent,[!1,!1,!1,!1]),yr.unblended=new yr(yr.Replace,t.Color.transparent,[!0,!0,!0,!0]),yr.alphaBlended=new yr([1,771],t.Color.transparent,[!0,!0,!0,!0]);class vr{constructor(e){var t,r;this.gl=e,this.clearColor=new Dt(this),this.clearDepth=new Nt(this),this.clearStencil=new zt(this),this.colorMask=new Ft(this),this.depthMask=new Bt(this),this.stencilMask=new Ut(this),this.stencilFunc=new jt(this),this.stencilOp=new qt(this),this.stencilTest=new Ht(this),this.depthRange=new Vt(this),this.depthTest=new Gt(this),this.depthFunc=new Kt(this),this.blend=new Zt(this),this.blendFunc=new Wt(this),this.blendColor=new $t(this),this.blendEquation=new Yt(this),this.cullFace=new Xt(this),this.cullFaceSide=new Qt(this),this.frontFace=new Jt(this),this.program=new er(this),this.activeTexture=new tr(this),this.viewport=new rr(this),this.bindFramebuffer=new nr(this),this.bindRenderbuffer=new ir(this),this.bindTexture=new or(this),this.bindVertexBuffer=new ar(this),this.bindElementBuffer=new sr(this),this.bindVertexArray=new lr(this),this.pixelStoreUnpack=new cr(this),this.pixelStoreUnpackPremultiplyAlpha=new ur(this),this.pixelStoreUnpackFlipY=new hr(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),Ot(e)?(this.HALF_FLOAT=e.HALF_FLOAT,t=e.getExtension("EXT_color_buffer_half_float"),this.RGBA16F=null!=(r=e.RGBA16F)?r:null==t?void 0:t.RGBA16F_EXT,this.RGB16F=null!=(r=e.RGB16F)?r:null==t?void 0:t.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")):(e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear"),r=e.getExtension("OES_texture_half_float"),this.HALF_FLOAT=null==r?void 0:r.HALF_FLOAT_OES)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,t){return new At(this,e,t)}createVertexBuffer(e,t,r){return new Mt(this,e,t,r)}createRenderbuffer(e,t,r){var n=this.gl,i=n.createRenderbuffer();return this.bindRenderbuffer.set(i),n.renderbufferStorage(n.RENDERBUFFER,e,t,r),this.bindRenderbuffer.set(null),i}createFramebuffer(e,t,r,n){return new gr(this,e,t,r,n)}clear(e){let{color:t,depth:r,stencil:n}=e;var i=this.gl;let o=0;t&&(o|=i.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),void 0!==r&&(o|=i.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(r),this.depthMask.set(!0)),void 0!==n&&(o|=i.STENCIL_BUFFER_BIT,this.clearStencil.set(n),this.stencilMask.set(255)),i.clear(o)}setCullFace(e){!1===e.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){t.deepEqual(e.blendFunction,yr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return Ot(this.gl)?this.gl.createVertexArray():null==(e=this.gl.getExtension("OES_vertex_array_object"))?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var t;return Ot(this.gl)?this.gl.deleteVertexArray(e):null==(t=this.gl.getExtension("OES_vertex_array_object"))?void 0:t.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}class _r{constructor(e,t,r){this.func=e,this.mask=t,this.range=r}}_r.ReadOnly=!1,_r.ReadWrite=!0,_r.disabled=new _r(519,_r.ReadOnly,[0,1]);class br{constructor(e,t,r,n,i,o){this.test=e,this.ref=t,this.mask=r,this.fail=n,this.depthFail=i,this.pass=o}}br.disabled=new br({func:519,mask:0},0,0,7680,7680,7680);class wr{constructor(e,t,r){this.enable=e,this.mode=t,this.frontFace=r}}let xr;function Cr(e,r,n,i,o,a,s){var l=e.context,c=l.gl,u=e.useProgram("collisionBox"),h=[];let d=0,p=0;for(let P=0;P<i.length;P++){var f=i[P],m=r.getTile(f),g=m.getBucket(n);if(g){let r=f.posMatrix;0===o[0]&&0===o[1]||(r=e.translatePosMatrix(f.posMatrix,m,o,a));var y,v,_=s?g.textCollisionBox:g.iconCollisionBox,b=g.collisionCircleArray;0<b.length&&(y=t.create(),v=r,t.mul(y,g.placementInvProjMatrix,e.transform.glCoordMatrix),t.mul(y,y,g.placementViewportMatrix),h.push({circleArray:b,circleOffset:p,transform:v,invTransform:y,coord:f}),d+=b.length/4,p=d),_&&u.draw(l,c.LINES,_r.disabled,br.disabled,e.colorModeForRenderPass(),wr.disabled,ft(r,e.transform,m),e.style.map.terrain&&e.style.map.terrain.getTerrainData(f),n.id,_.layoutVertexBuffer,_.indexBuffer,_.segments,null,e.transform.zoom,null,null,_.collisionVertexBuffer)}}if(s&&h.length){var w=e.useProgram("collisionCircle"),x=new t.CollisionCircleLayoutArray;x.resize(4*d),x._trim();let r=0;for(const e of h)for(let t=0;t<e.circleArray.length/4;t++){var C=4*t,S=e.circleArray[0+C],E=e.circleArray[1+C],T=e.circleArray[2+C];C=e.circleArray[3+C];x.emplace(r++,S,E,T,C,0),x.emplace(r++,S,E,T,C,1),x.emplace(r++,S,E,T,C,2),x.emplace(r++,S,E,T,C,3)}(!xr||xr.length<2*d)&&(xr=function(e){var r=2*e,n=new t.QuadTriangleArray;n.resize(r),n._trim();for(let t=0;t<r;t++){var i=6*t;n.uint16[0+i]=4*t+0,n.uint16[1+i]=4*t+1,n.uint16[2+i]=4*t+2,n.uint16[3+i]=4*t+2,n.uint16[4+i]=4*t+3,n.uint16[5+i]=4*t+0}return n}(d));var I=l.createIndexBuffer(xr,!0),k=l.createVertexBuffer(x,t.collisionCircleLayout.members,!0);for(const i of h){var A=mt(i.transform,i.invTransform,e.transform);w.draw(l,c.TRIANGLES,_r.disabled,br.disabled,e.colorModeForRenderPass(),wr.disabled,A,e.style.map.terrain&&e.style.map.terrain.getTerrainData(i.coord),n.id,k,I,t.SegmentVector.simpleSegment(0,2*i.circleOffset,i.circleArray.length,i.circleArray.length/2),null,e.transform.zoom,null,null,null)}k.destroy(),I.destroy()}}wr.disabled=new wr(!1,1029,2305),wr.backCCW=new wr(!0,1029,2305);const Sr=t.identity(new Float32Array(16));function Er(e,r,n,i,o,a,s,l,c,u,h,d){var p=e.context,f=p.gl,m=e.transform,g="map"===l,y="map"===c,v="viewport"!==l&&"point"!==n.layout.get("symbol-placement"),_=g&&!y&&!v,b=!n.layout.get("symbol-sort-key").isConstant();let w=!1;var x=e.depthModeForSublayer(0,_r.ReadOnly),C=n._unevaluatedLayout.hasValue("text-variable-anchor")||n._unevaluatedLayout.hasValue("text-variable-anchor-offset"),S=[];for(const fe of i){var E=r.getTile(fe),T=E.getBucket(n);if(T){var I=o?T.text:T.icon;if(I&&I.segments.get().length&&I.hasVisibleVertices){var k=I.programConfigurations.get(n.id),A=o||T.sdfIcons,P=o?T.textSizeData:T.iconSizeData,M=y||0!==m.pitch,R=e.useProgram((O=A,R=o,T.iconsInText&&R?"symbolTextAndIcon":O?"symbolSDF":"symbolIcon"),k),O=t.evaluateSizeForZoom(P,m.zoom),L=e.style.map.terrain&&e.style.map.terrain.getTerrainData(fe);let r,i,l,c,h=[0,0],d=null;o?(i=E.glyphAtlasTexture,l=f.LINEAR,r=E.glyphAtlasTexture.size,T.iconsInText&&(h=E.imageAtlasTexture.size,d=E.imageAtlasTexture,k="composite"===P.kind||"camera"===P.kind,c=M||e.options.rotating||e.options.zooming||k?f.LINEAR:f.NEAREST)):(k=1!==n.layout.get("icon-size").constantOr(0)||T.iconsNeedLinear,i=E.imageAtlasTexture,l=A||e.options.rotating||e.options.zooming||k||M?f.LINEAR:f.NEAREST,r=E.imageAtlasTexture.size);k=Se(E,1,e.transform.zoom),M=ce(fe.posMatrix,y,g,e.transform,k),k=ue(fe.posMatrix,y,g,e.transform,k);var D=C&&T.hasTextData();D="none"!==n.layout.get("icon-text-fit")&&D&&T.hasIconData();if(v){var N=e.style.map.terrain?(t,r)=>e.style.map.terrain.getElevation(fe,t,r):null,z="map"===n.layout.get("text-rotation-alignment");{void 0,void 0,void 0,j=void 0,void 0,void 0,void 0,void 0,void 0,Z=void 0,void 0,void 0,void 0,X=void 0,void 0,J=void 0,void 0,ae=void 0,re=void 0,ne=void 0,te=void 0,ie=void 0,oe=void 0;var F=T,B=fe.posMatrix,U=e,j=o,q=M,H=k,V=y,G=u,K=z,Z=N,W=j?F.textSizeData:F.iconSizeData,$=t.evaluateSizeForZoom(W,U.transform.zoom),Y=[256/U.width*2+1,256/U.height*2+1],X=(j?F.text:F.icon).dynamicLayoutVertexArray,Q=(X.clear(),F.lineVertexArray),J=(j?F.text:F.icon).placedSymbolArray,ee=U.transform.width/U.transform.height;let r=!1;for(let e=0;e<J.length;e++){var te,re,ne,ie,oe,ae=J.get(e);if(ae.hidden||ae.writingMode===t.WritingMode.vertical&&!r)we(ae.numGlyphs,X);else{let e;r=!1,Z?(e=[ae.anchorX,ae.anchorY,Z(ae.anchorX,ae.anchorY),1],t.transformMat4(e,e,B)):xe(e=[ae.anchorX,ae.anchorY,0,1],e,B),re=Y,te=void 0,te=(ne=e)[0]/ne[3],ne=ne[1]/ne[3],(!(te>=-re[0]&&te<=re[0]&&ne>=-re[1]&&ne<=re[1])||(te=e[3],ne=de(U.transform.cameraToCenterDistance,te),re=t.evaluateSizeForFeature(W,$,ae),te=V?re/ne:re*ne,ne=he(re=new t.Point(ae.anchorX,ae.anchorY),q,Z).point,r=(oe=me(ae,te,!(ie={projections:{},offsets:{}}),G,B,q,H,F.glyphOffsetArray,Q,X,ne,re,ie,ee,K,Z)).useVertical,oe.notEnoughRoom)||r||oe.needsFlipping&&me(ae,te,!0,G,B,q,H,F.glyphOffsetArray,Q,X,ne,re,ie,ee,K,Z).notEnoughRoom)&&we(ae.numGlyphs,X)}}(j?F.text:F.icon).dynamicLayoutVertexBuffer.updateData(X)}}let p;z=e.translatePosMatrix(fe.posMatrix,E,a,s),N=v||o&&C||D?Sr:M,j=e.translatePosMatrix(k,E,a,s,!0),D=A&&0!==n.paint.get(o?"text-halo-width":"icon-halo-width").constantOr(1);var se={program:R,buffers:I,uniformValues:p=A?T.iconsInText?Tt(P.kind,O,_,y,e,z,N,j,r,h):Et(P.kind,O,_,y,e,z,N,j,o,r,!0):St(P.kind,O,_,y,e,z,N,j,o,r),atlasTexture:i,atlasTextureIcon:d,atlasInterpolation:l,atlasInterpolationIcon:c,isSDF:A,hasHalo:D};if(b&&T.canOverlap){w=!0;for(const e of I.segments.get())S.push({segments:new t.SegmentVector([e]),sortKey:e.sortKey,state:se,terrainData:L})}else S.push({segments:I.segments,sortKey:0,state:se,terrainData:L})}}}w&&S.sort(((e,t)=>e.sortKey-t.sortKey));for(const t of S){var le,pe=t.state;p.activeTexture.set(f.TEXTURE0),pe.atlasTexture.bind(pe.atlasInterpolation,f.CLAMP_TO_EDGE),pe.atlasTextureIcon&&(p.activeTexture.set(f.TEXTURE1),pe.atlasTextureIcon)&&pe.atlasTextureIcon.bind(pe.atlasInterpolationIcon,f.CLAMP_TO_EDGE),pe.isSDF&&(le=pe.uniformValues,pe.hasHalo&&(le.u_is_halo=1,Tr(pe.buffers,t.segments,n,e,pe.program,x,h,d,le,t.terrainData)),le.u_is_halo=0),Tr(pe.buffers,t.segments,n,e,pe.program,x,h,d,pe.uniformValues,t.terrainData)}}function Tr(e,t,r,n,i,o,a,s,l,c){var u=n.context,h=u.gl;i.draw(u,h.TRIANGLES,o,a,s,wr.disabled,l,c,r.id,e.layoutVertexBuffer,e.indexBuffer,t,r.paint,n.transform.zoom,e.programConfigurations.get(r.id),e.dynamicLayoutVertexBuffer,e.opacityVertexBuffer)}function Ir(e,r,n,i){if(0!==n.paint.get("heatmap-opacity"))if("offscreen"===e.renderPass){var o=e.context,a=o.gl,s=br.disabled,l=new yr([a.ONE,a.ONE],t.Color.transparent,[!0,!0,!0,!0]);{var c=e,u=n,h=(_=o).gl;_.activeTexture.set(h.TEXTURE1),_.viewport.set([0,0,c.width/4,c.height/4]);let t=u.heatmapFbo;t?(h.bindTexture(h.TEXTURE_2D,t.colorAttachment.get()),_.bindFramebuffer.set(t.framebuffer)):(b=h.createTexture(),h.bindTexture(h.TEXTURE_2D,b),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.LINEAR),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.LINEAR),t=u.heatmapFbo=_.createFramebuffer(c.width/4,c.height/4,!1,!1),function(e,t,r,n){var i=e.gl,o=null!=(o=e.HALF_FLOAT)?o:i.UNSIGNED_BYTE;e=null!=(e=e.RGBA16F)?e:i.RGBA;i.texImage2D(i.TEXTURE_2D,0,e,t.width/4,t.height/4,0,i.RGBA,o,null),n.colorAttachment.set(r)}(_,c,b,t))}o.clear({color:t.Color.transparent});for(let t=0;t<i.length;t++){var d,p,f,m,g,v=i[t];r.hasRenderableParent(v)||(p=(d=r.getTile(v)).getBucket(n))&&(f=p.programConfigurations.get(n.id),m=e.useProgram("heatmap",f),g=e.transform.zoom,m.draw(o,a.TRIANGLES,_r.disabled,s,l,wr.disabled,(m=v.posMatrix,v=d,d=g,g=n.paint.get("heatmap-intensity"),{u_matrix:m,u_extrude_scale:Se(v,1,d),u_intensity:g}),null,n.id,p.layoutVertexBuffer,p.indexBuffer,p.segments,n.paint,e.transform.zoom,f))}o.viewport.set([0,0,e.width,e.height])}else if("translucent"===e.renderPass){e.context.setColorMode(e.colorModeForRenderPass());u=n,c=(_=(h=e).context).gl;var _,b=u.heatmapFbo;if(b){_.activeTexture.set(c.TEXTURE0),c.bindTexture(c.TEXTURE_2D,b.colorAttachment.get()),_.activeTexture.set(c.TEXTURE1);let e=u.colorRampTexture;(e=e||(u.colorRampTexture=new y(_,u.colorRamp,c.RGBA))).bind(c.LINEAR,c.CLAMP_TO_EDGE),h.useProgram("heatmapTexture").draw(_,c.TRIANGLES,_r.disabled,br.disabled,h.colorModeForRenderPass(),wr.disabled,((e,r,n,i)=>{var o=t.create();return{u_matrix:o,u_world:[(t.ortho(o,0,e.width,e.height,0,0,1),e=e.context.gl).drawingBufferWidth,e.drawingBufferHeight],u_image:n,u_color_ramp:i,u_opacity:r.paint.get("heatmap-opacity")}})(h,u,0,1),null,u.id,h.viewportBuffer,h.quadTriangleIndexBuffer,h.viewportSegments,u.paint,h.transform.zoom)}}}function kr(e,t,r,n,i){if(r&&n&&n.imageAtlas){let o=(n=n.imageAtlas.patternPositions)[r.to.toString()],a=n[r.from.toString()];!o&&a&&(o=a),!a&&o&&(a=o),o&&a||(o=n[r=i.getPaintProperty(t)],a=n[r]),o&&a&&e.setConstantPatternPositions(o,a)}}function Ar(e,t,r,n,i,o,a){var s=e.context.gl,l="fill-pattern",c=r.paint.get(l),u=c&&c.constantOr(1),h=r.getCrossfadeParameters();let d,p,f,m,g;d=a?(p=u&&!r.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",s.LINES):(p=u?"fillPattern":"fill",s.TRIANGLES);var y=c.constantOr(null);for(const E of n){var v,_,b,w,x,C,S=t.getTile(E);u&&!S.patternsLoaded()||(v=S.getBucket(r))&&(_=v.programConfigurations.get(r.id),b=e.useProgram(p,_),w=e.style.map.terrain&&e.style.map.terrain.getTerrainData(E),u&&(e.context.activeTexture.set(s.TEXTURE0),S.imageAtlasTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE),_.updatePaintBuffers(h)),kr(_,l,y,S,r),x=((w?E:null)||E).posMatrix,x=e.translatePosMatrix(x,S,r.paint.get("fill-translate"),r.paint.get("fill-translate-anchor")),f=a?(m=v.indexBuffer2,g=v.segments2,C=[s.drawingBufferWidth,s.drawingBufferHeight],"fillOutlinePattern"===p&&u?pt(x,e,h,S,C):dt(x,C)):(m=v.indexBuffer,g=v.segments,u?ht(x,e,h,S):ut(x)),b.draw(e.context,d,i,e.stencilModeForClipping(E),o,wr.disabled,f,w,r.id,v.layoutVertexBuffer,m,g,r.paint,e.transform.zoom,_))}}function Pr(e,t,r,n,i,o,a){var s=e.context,l=s.gl,c="fill-extrusion-pattern",u=r.paint.get(c),h=u.constantOr(1),d=r.getCrossfadeParameters(),p=r.paint.get("fill-extrusion-opacity"),f=u.constantOr(null);for(const x of n){var m,g,y,v,_,b=t.getTile(x),w=b.getBucket(r);w&&(m=e.style.map.terrain&&e.style.map.terrain.getTerrainData(x),g=w.programConfigurations.get(r.id),y=e.useProgram(h?"fillExtrusionPattern":"fillExtrusion",g),h&&(e.context.activeTexture.set(l.TEXTURE0),b.imageAtlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE),g.updatePaintBuffers(d)),kr(g,c,f,b,r),v=e.translatePosMatrix(x.posMatrix,b,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),_=r.paint.get("fill-extrusion-vertical-gradient"),b=h?ct(v,e,_,p,x,d,b):lt(v,e,_,p),y.draw(s,s.gl.TRIANGLES,i,o,a,wr.backCCW,b,m,r.id,w.layoutVertexBuffer,w.indexBuffer,w.segments,r.paint,e.transform.zoom,g,e.style.map.terrain&&w.centroidVertexBuffer))}}const Mr=new t.Color(1,0,0,1),Rr=new t.Color(0,1,0,1),Or=new t.Color(0,0,1,1),Lr=new t.Color(1,0,1,1),Dr=new t.Color(0,1,1,1);function Nr(e,t,r,n){Fr(e,0,t+r/2,e.transform.width,r,n)}function zr(e,t,r,n){Fr(e,t-r/2,0,r,e.transform.height,n)}function Fr(e,t,r,n,i,o){var a=e.context,s=a.gl;s.enable(s.SCISSOR_TEST),s.scissor(t*e.pixelRatio,r*e.pixelRatio,n*e.pixelRatio,i*e.pixelRatio),a.clear({color:o}),s.disable(s.SCISSOR_TEST)}function Br(e,t,r){var n=e.context,i=n.gl,o=e.colorModeForRenderPass(),a=new _r(i.LEQUAL,_r.ReadWrite,e.depthRangeFor3D),s=e.useProgram("terrain"),l=t.getTerrainMesh();n.bindFramebuffer.set(null),n.viewport.set([0,0,e.width,e.height]);for(const h of r){var c=e.renderToTexture.getTexture(h),u=t.getTerrainData(h.tileID);c={u_matrix:c=(n.activeTexture.set(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,c.texture),e.transform.calculatePosMatrix(h.tileID.toUnwrapped())),u_texture:0,u_ele_delta:t.getMeshFrameDelta(e.transform.zoom)};s.draw(n,i.TRIANGLES,a,br.disabled,o,wr.backCCW,c,u,"terrain",l.vertexBuffer,l.indexBuffer,l.segments)}}class Ur{constructor(e,r){this.context=new vr(e),this.transform=r,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:t.identity(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=ne.maxUnderzooming+ne.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Ye}resize(e,t,r){if(this.width=Math.floor(e*r),this.height=Math.floor(t*r),this.pixelRatio=r,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const n of this.style._order)this.style._layers[n].resize()}setup(){var e,r=this.context;(e=((e=((e=((e=((e=((e=new t.PosArray).emplaceBack(0,0),e.emplaceBack(t.EXTENT,0),e.emplaceBack(0,t.EXTENT),e.emplaceBack(t.EXTENT,t.EXTENT),this.tileExtentBuffer=r.createVertexBuffer(e,et.members),this.tileExtentSegments=t.SegmentVector.simpleSegment(0,0,4,2),new t.PosArray)).emplaceBack(0,0),e.emplaceBack(t.EXTENT,0),e.emplaceBack(0,t.EXTENT),e.emplaceBack(t.EXTENT,t.EXTENT),this.debugBuffer=r.createVertexBuffer(e,et.members),this.debugSegments=t.SegmentVector.simpleSegment(0,0,4,5),new t.RasterBoundsArray)).emplaceBack(0,0,0,0),e.emplaceBack(t.EXTENT,0,t.EXTENT,0),e.emplaceBack(0,t.EXTENT,0,t.EXTENT),e.emplaceBack(t.EXTENT,t.EXTENT,t.EXTENT,t.EXTENT),this.rasterBoundsBuffer=r.createVertexBuffer(e,V.members),this.rasterBoundsSegments=t.SegmentVector.simpleSegment(0,0,4,2),new t.PosArray)).emplaceBack(0,0),e.emplaceBack(1,0),e.emplaceBack(0,1),e.emplaceBack(1,1),this.viewportBuffer=r.createVertexBuffer(e,et.members),this.viewportSegments=t.SegmentVector.simpleSegment(0,0,4,2),new t.LineStripIndexArray)).emplaceBack(0),e.emplaceBack(1),e.emplaceBack(3),e.emplaceBack(2),e.emplaceBack(0),this.tileBorderIndexBuffer=r.createIndexBuffer(e),new t.TriangleIndexArray)).emplaceBack(0,1,2),e.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=r.createIndexBuffer(e),r=this.context.gl;this.stencilClearMode=new br({func:r.ALWAYS,mask:0},0,255,r.ZERO,r.ZERO,r.ZERO)}clearStencil(){var e=this.context,r=e.gl,n=(this.nextStencilID=1,this.currentStencilSource=void 0,t.create());t.ortho(n,0,this.width,this.height,0,0,1),t.scale(n,n,[r.drawingBufferWidth,r.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(e,r.TRIANGLES,_r.disabled,this.stencilClearMode,yr.disabled,wr.disabled,yt(n),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,t){if(this.currentStencilSource!==e.source&&e.isTileClipped()&&t&&t.length){this.currentStencilSource=e.source;var r=this.context,n=r.gl,i=(256<this.nextStencilID+t.length&&this.clearStencil(),r.setColorMode(yr.disabled),r.setDepthMode(_r.disabled),this.useProgram("clippingMask"));this._tileClippingMaskIDs={};for(const e of t){var o=this._tileClippingMaskIDs[e.key]=this.nextStencilID++,a=this.style.map.terrain&&this.style.map.terrain.getTerrainData(e);i.draw(r,n.TRIANGLES,_r.disabled,new br({func:n.ALWAYS,mask:0},o,255,n.KEEP,n.KEEP,n.REPLACE),yr.disabled,wr.disabled,yt(e.posMatrix),a,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}}stencilModeFor3D(){this.currentStencilSource=void 0,256<this.nextStencilID+1&&this.clearStencil();var e=this.nextStencilID++,t=this.context.gl;return new br({func:t.NOTEQUAL,mask:255},e,255,t.KEEP,t.KEEP,t.REPLACE)}stencilModeForClipping(e){var t=this.context.gl;return new br({func:t.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,t.KEEP,t.KEEP,t.REPLACE)}stencilConfigForOverlap(e){var t=this.context.gl,r=(e=e.sort(((e,t)=>t.overscaledZ-e.overscaledZ)),e[e.length-1].overscaledZ),n=e[0].overscaledZ-r+1;if(1<n){this.currentStencilSource=void 0,256<this.nextStencilID+n&&this.clearStencil();var i={};for(let e=0;e<n;e++)i[e+r]=new br({func:t.GEQUAL,mask:255},e+this.nextStencilID,255,t.KEEP,t.KEEP,t.REPLACE);return this.nextStencilID+=n,[i,e]}return[{[r]:br.disabled},e]}colorModeForRenderPass(){var e=this.context.gl;return this._showOverdrawInspector?new yr([e.CONSTANT_COLOR,e.ONE],new t.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?yr.unblended:yr.alphaBlended}depthModeForSublayer(e,t,r){return this.opaquePassEnabledForLayer()?(e=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon,new _r(r||this.context.gl.LEQUAL,t,[e,e])):_r.disabled}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,r){this.style=e,this.options=r,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(a.now()),this.imageManager.beginFrame();var n=this.style._order,i=this.style.sourceCaches,o={},s={},l={};for(const t in i){var c=i[t];c.used&&c.prepare(this.context),o[t]=c.getVisibleCoordinates(),s[t]=o[t].slice().reverse(),l[t]=c.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let t=0;t<n.length;t++){var u=n[t];if(this.style._layers[u].is3D()){this.opaquePassCutoff=t;break}}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const t of n){var h,d=this.style._layers[t];d.hasOffscreenPass()&&!d.isHidden(this.transform.zoom)&&(h=s[d.source],"custom"===d.type||h.length)&&this.renderLayer(this,i[d.source],d,h)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:r.showOverdrawInspector?t.Color.black:t.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=r.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=n.length-1;0<=this.currentLayer;this.currentLayer--){var p=this.style._layers[n[this.currentLayer]],f=i[p.source],m=o[p.source];this._renderTileClippingMasks(p,m),this.renderLayer(this,f,p,m)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<n.length;this.currentLayer++){var g,y=this.style._layers[n[this.currentLayer]],v=i[y.source];this.renderToTexture&&this.renderToTexture.renderLayer(y)||(g=("symbol"===y.type?l:s)[y.source],this._renderTileClippingMasks(y,o[y.source]),this.renderLayer(this,v,y,g))}this.options.showTileBoundaries&&(r=function(e,t){let r=null;var n=(i=Object.values(e._layers).flatMap((r=>r.source&&!r.isHidden(t)?[e.sourceCaches[r.source]]:[]))).filter((e=>"vector"===e.getSource().type)),i=i.filter((e=>"vector"!==e.getSource().type));const o=e=>{(!r||r.getSource().maxzoom<e.getSource().maxzoom)&&(r=e)};return n.forEach((e=>o(e))),r||i.forEach((e=>o(e))),r}(this.style,this.transform.zoom))&&function(e,r,n){for(let g=0;g<n.length;g++){i=void 0,o=void 0,a=void 0,s=void 0,u=void 0,m=void 0;var i=e,o=r,a=n[g],s=i.context,l=s.gl,c=a.posMatrix,u=i.useProgram("debug"),h=_r.disabled,d=br.disabled,p=i.colorModeForRenderPass(),f=i.style.map.terrain&&i.style.map.terrain.getTerrainData(a),m=(s.activeTexture.set(l.TEXTURE0),(m=o.getTileByID(a.key).latestRawTileData)&&m.byteLength||0);m=Math.floor(m/1024),o=o.getTile(a).tileSize,o=512/Math.min(o,512)*(a.overscaledZ/i.transform.zoom)*.5;let y=a.canonical.toString();a.overscaledZ!==a.canonical.z&&(y+=" => "+a.overscaledZ),function(e,t){e.initDebugOverlayCanvas();var r=e.debugOverlayCanvas,n=e.context.gl,i=e.debugOverlayCanvas.getContext("2d");i.clearRect(0,0,r.width,r.height),i.shadowColor="white",i.shadowBlur=2,i.lineWidth=1.5,i.strokeStyle="white",i.textBaseline="top",i.font="bold 36px Open Sans, sans-serif",i.fillText(t,5,5),i.strokeText(t,5,5),e.debugOverlayTexture.update(r),e.debugOverlayTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)}(i,a=y+` ${m}kB`),u.draw(s,l.TRIANGLES,h,d,yr.alphaBlended,wr.disabled,gt(c,t.Color.transparent,o),null,"$debug",i.debugBuffer,i.quadTriangleIndexBuffer,i.debugSegments),u.draw(s,l.LINE_STRIP,h,d,p,wr.disabled,gt(c,t.Color.red),f,"$debug",i.debugBuffer,i.tileBorderIndexBuffer,i.debugSegments)}}(this,r,r.getVisibleCoordinates()),this.options.showPadding&&function(e){var t,r,n=e.transform.padding;Fr(t=e,(r=(Nr(e,e.transform.height-(n.top||0),3,Mr),Nr(e,n.bottom||0,3,Rr),zr(e,n.left||0,3,Or),zr(e,e.transform.width-(n.right||0),3,Lr),n=e.transform.centerPoint).x)-1,(e=e.transform.height-n.y)-10,2,20,n=Dr),Fr(t,r-10,e-1,20,2,n)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(this.style&&this.style.map&&this.style.map.terrain){var r=this.terrainFacilitator.matrix,n=this.transform.projMatrix;let i=this.terrainFacilitator.dirty;(i=(i=i||(e?!t.exactEquals(r,n):!t.equals(r,n)))||0<this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length)&&(t.copy(r,n),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(e,r){var n=e.context,i=n.gl,o=yr.unblended,a=new _r(i.LEQUAL,_r.ReadWrite,[0,1]),s=r.getTerrainMesh(),l=r.sourceCache.getRenderableTiles(),c=e.useProgram("terrainDepth");n.bindFramebuffer.set(r.getFramebuffer("depth").framebuffer),n.viewport.set([0,0,e.width/devicePixelRatio,e.height/devicePixelRatio]),n.clear({color:t.Color.transparent,depth:1});for(const t of l){var u=r.getTerrainData(t.tileID),h={u_matrix:e.transform.calculatePosMatrix(t.tileID.toUnwrapped()),u_ele_delta:r.getMeshFrameDelta(e.transform.zoom)};c.draw(n,i.TRIANGLES,a,br.disabled,o,wr.backCCW,h,u,"terrain",s.vertexBuffer,s.indexBuffer,s.segments)}n.bindFramebuffer.set(null),n.viewport.set([0,0,e.width,e.height])}(this,this.style.map.terrain),function(e,r){var n=e.context,i=n.gl,o=yr.unblended,a=new _r(i.LEQUAL,_r.ReadWrite,[0,1]),s=r.getTerrainMesh(),l=r.getCoordsTexture(),c=r.sourceCache.getRenderableTiles(),u=e.useProgram("terrainCoords");n.bindFramebuffer.set(r.getFramebuffer("coords").framebuffer),n.viewport.set([0,0,e.width/devicePixelRatio,e.height/devicePixelRatio]),n.clear({color:t.Color.transparent,depth:1}),r.coordsIndex=[];for(const t of c){var h=r.getTerrainData(t.tileID),d={u_matrix:(n.activeTexture.set(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,l.texture),d=e.transform.calculatePosMatrix(t.tileID.toUnwrapped())),u_terrain_coords_id:(255-r.coordsIndex.length)/255,u_texture:0,u_ele_delta:r.getMeshFrameDelta(e.transform.zoom)};u.draw(n,i.TRIANGLES,a,br.disabled,o,wr.backCCW,d,h,"terrain",s.vertexBuffer,s.indexBuffer,s.segments),r.coordsIndex.push(t.tileID.key)}n.bindFramebuffer.set(null),n.viewport.set([0,0,e.width,e.height])}(this,this.style.map.terrain))}}renderLayer(e,r,n,i){if(!n.isHidden(this.transform.zoom)&&("background"===n.type||"custom"===n.type||(i||[]).length))switch(this.id=n.id,n.type){case"symbol":!function(e,r,n,i,o){if("translucent"===e.renderPass){var a=br.disabled,s=e.colorModeForRenderPass();if(n._unevaluatedLayout.hasValue("text-variable-anchor")||n._unevaluatedLayout.hasValue("text-variable-anchor-offset")){var l=i,c=e,u=n,h=r,d=n.layout.get("text-rotation-alignment"),p=n.layout.get("text-pitch-alignment"),f=o,m=c.transform,g="map"===d,y="map"===p;for(const e of l){var v,_,b,w,x=h.getTile(e),C=x.getBucket(u);C&&C.text&&C.text.segments.get().length&&(v=C.textSizeData,v=t.evaluateSizeForZoom(v,m.zoom),_=Se(x,1,c.transform.zoom),_=ce(e.posMatrix,y,g,c.transform,_),b="none"!==u.layout.get("icon-text-fit")&&C.hasIconData(),v)&&(x=Math.pow(2,m.zoom-x.tileID.overscaledZ),w=c.style.map.terrain?(t,r)=>c.style.map.terrain.getElevation(e,t,r):null,function(e,r,n,i,o,a,s,l,c,u,h){var d=e.text.placedSymbolArray,p=e.text.dynamicLayoutVertexArray,f=e.icon.dynamicLayoutVertexArray,m={};p.clear();for(let A=0;A<d.length;A++){var g=d.get(A),y=e.allowVerticalPlacement&&!g.placedOrientation;if(y=g.hidden||!g.crossTileID||y?null:i[g.crossTileID]){var v=new t.Point(g.anchorX,g.anchorY),_=he(v,n?s:a,h),b=de(o.cameraToCenterDistance,_.signedDistanceFromCamera);let i=t.evaluateSizeForFeature(e.textSizeData,c,g)*b/t.ONE_EM;n&&(i*=e.tilePixelRatio/l);var{width:b,height:y,anchor:w,textOffset:x,textBoxScale:C}=y,w=function(e,r,n,i,o,a){var{horizontalAlign:e,verticalAlign:s}=t.getAnchorAlignment(e);return e=-(e-.5)*r,r=-(s-.5)*n,new t.Point((e/o+i[0])*a,(r/o+i[1])*a)}(w,b,y,x,C,i),S=n?he(v.add(w),a,h).point:_.point.add(r?w.rotate(-o.angle):w),E=e.allowVerticalPlacement&&g.placedOrientation===t.WritingMode.vertical?Math.PI/2:0;for(let e=0;e<g.numGlyphs;e++)t.addDynamicAttributes(p,S,E);u&&0<=g.associatedIconIndex&&(m[g.associatedIconIndex]={shiftedAnchor:S,angle:E})}else we(g.numGlyphs,p)}if(u){f.clear();var T=e.icon.placedSymbolArray;for(let e=0;e<T.length;e++){var I=T.get(e);if(I.hidden)we(I.numGlyphs,f);else{var k=m[e];if(k)for(let e=0;e<I.numGlyphs;e++)t.addDynamicAttributes(f,k.shiftedAnchor,k.angle);else we(I.numGlyphs,f)}}e.icon.dynamicLayoutVertexBuffer.updateData(f)}e.text.dynamicLayoutVertexBuffer.updateData(p)}(C,g,y,f,m,_,e.posMatrix,x,v,b,w))}}0!==n.paint.get("icon-opacity").constantOr(1)&&Er(e,r,n,i,!1,n.paint.get("icon-translate"),n.paint.get("icon-translate-anchor"),n.layout.get("icon-rotation-alignment"),n.layout.get("icon-pitch-alignment"),n.layout.get("icon-keep-upright"),a,s),0!==n.paint.get("text-opacity").constantOr(1)&&Er(e,r,n,i,!0,n.paint.get("text-translate"),n.paint.get("text-translate-anchor"),n.layout.get("text-rotation-alignment"),n.layout.get("text-pitch-alignment"),n.layout.get("text-keep-upright"),a,s),r.map.showCollisionBoxes&&(Cr(e,r,n,i,n.paint.get("text-translate"),n.paint.get("text-translate-anchor"),!0),Cr(e,r,n,i,n.paint.get("icon-translate"),n.paint.get("icon-translate-anchor"),!1))}}(e,r,n,i,this.style.placement.variableOffsets);break;case"circle":!function(e,r,n,i){if("translucent"===e.renderPass){var o=n.paint.get("circle-opacity"),a=n.paint.get("circle-stroke-width"),s=n.paint.get("circle-stroke-opacity"),l=!n.layout.get("circle-sort-key").isConstant();if(0!==o.constantOr(1)||0!==a.constantOr(1)&&0!==s.constantOr(1)){var c=e.context,u=c.gl,h=e.depthModeForSublayer(0,_r.ReadOnly),d=br.disabled,p=e.colorModeForRenderPass(),f=[];for(let o=0;o<i.length;o++){var m=i[o],g=r.getTile(m),y=g.getBucket(n);if(y){var v=y.programConfigurations.get(n.id),_=e.useProgram("circle",v),b=y.layoutVertexBuffer,w=y.indexBuffer,x=e.style.map.terrain&&e.style.map.terrain.getTerrainData(m),C={programConfiguration:v,program:_,layoutVertexBuffer:b,indexBuffer:w,uniformValues:((e,t,r,n)=>{var i,o=e.transform;let a,s;return s="map"===n.paint.get("circle-pitch-alignment")?(a=!0,[i=Se(r,1,o.zoom),i]):(a=!1,o.pixelsToGLUnits),{u_camera_to_center_distance:o.cameraToCenterDistance,u_scale_with_map:+("map"===n.paint.get("circle-pitch-scale")),u_matrix:e.translatePosMatrix(t.posMatrix,r,n.paint.get("circle-translate"),n.paint.get("circle-translate-anchor")),u_pitch_with_map:+a,u_device_pixel_ratio:e.pixelRatio,u_extrude_scale:s}})(e,m,g,n),terrainData:x};if(l)for(const e of y.segments.get())f.push({segments:new t.SegmentVector([e]),sortKey:e.sortKey,state:C});else f.push({segments:y.segments,sortKey:0,state:C})}}l&&f.sort(((e,t)=>e.sortKey-t.sortKey));for(const t of f){var{programConfiguration:S,program:E,layoutVertexBuffer:T,indexBuffer:I,uniformValues:k,terrainData:A}=t.state,P=t.segments;E.draw(c,u.TRIANGLES,h,d,p,wr.disabled,k,A,n.id,T,I,P,n.paint,e.transform.zoom,S)}}}}(e,r,n,i);break;case"heatmap":Ir(e,r,n,i);break;case"line":!function(e,r,n,i){if("translucent"===e.renderPass){var o=n.paint.get("line-opacity"),a=n.paint.get("line-width");if(0!==o.constantOr(1)&&0!==a.constantOr(1)){var s,l,c,u,h,d,p,f,m,g,v=e.depthModeForSublayer(0,_r.ReadOnly),_=e.colorModeForRenderPass(),b=n.paint.get("line-dasharray"),w=n.paint.get("line-pattern"),x=w.constantOr(1),C=n.paint.get("line-gradient"),S=n.getCrossfadeParameters(),E=x?"linePattern":b?"lineSDF":C?"lineGradient":"line",T=e.context,I=T.gl;let o=!0;for(const a of i){var k=r.getTile(a);if(!x||k.patternsLoaded()){var A=k.getBucket(n);if(A){var P,M,R=A.programConfigurations.get(n.id),O=e.context.program.get(),L=e.useProgram(E,R),D=(O=o||L.program!==O,e.style.map.terrain&&e.style.map.terrain.getTerrainData(a)),N=((N=w.constantOr(null))&&k.imageAtlas&&(P=(M=k.imageAtlas).patternPositions[N.to.toString()],M=M.patternPositions[N.from.toString()],P)&&M&&R.setConstantPatternPositions(P,M),D?a:null),z=x?(M=n,p=S,f=N,g=m=void 0,g=wt(P=k,m=(d=e).transform),{u_matrix:xt(d,P,M,f),u_texsize:P.imageAtlasTexture.size,u_ratio:1/Se(P,1,m.zoom),u_device_pixel_ratio:d.pixelRatio,u_image:0,u_scale:[g,p.fromScale,p.toScale],u_fade:p.t,u_units_to_pixels:[1/m.pixelsToGLUnits[0],1/m.pixelsToGLUnits[1]]}):b?(f=k,d=n,g=b,p=S,m=N,h=u=z=u=l=c=l=void 0,l=(s=e).transform,c=s.lineAtlas,l=wt(f,l),u="round"===d.layout.get("line-cap"),z=c.getDash(g.from,u),g=c.getDash(g.to,u),u=z.width*p.fromScale,h=g.width*p.toScale,t.extend(bt(s,f,d,m),{u_patternscale_a:[l/u,-z.height/2],u_patternscale_b:[l/h,-g.height/2],u_sdfgamma:c.width/(256*Math.min(u,h)*s.pixelRatio)/2,u_image:0,u_tex_y_a:z.y,u_tex_y_b:g.y,u_mix:p.t})):C?(l=e,c=k,u=n,h=A.lineClipsArray.length,s=N,t.extend(bt(l,c,u,s),{u_image:0,u_image_height:h})):bt(e,k,n,N);if(x)T.activeTexture.set(I.TEXTURE0),k.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),R.updatePaintBuffers(S);else if(b&&(O||e.lineAtlas.dirty))T.activeTexture.set(I.TEXTURE0),e.lineAtlas.bind(T);else if(C){let i=(N=A.gradients[n.id]).texture;if(n.gradientVersion!==N.version){let o=256;n.stepInterpolant&&(k=r.getSource().maxzoom,O=a.canonical.z===k?Math.ceil(1<<e.transform.maxZoom-a.canonical.z):1,k=A.maxLineLength/t.EXTENT,o=t.clamp(t.nextPowerOfTwo(1024*k*O),256,T.maxTextureSize)),N.gradient=t.renderColorRamp({expression:n.gradientExpression(),evaluationKey:"lineProgress",resolution:o,image:N.gradient||void 0,clips:A.lineClipsArray}),N.texture?N.texture.update(N.gradient):N.texture=new y(T,N.gradient,I.RGBA),N.version=n.gradientVersion,i=N.texture}T.activeTexture.set(I.TEXTURE0),i.bind(n.stepInterpolant?I.NEAREST:I.LINEAR,I.CLAMP_TO_EDGE)}L.draw(T,I.TRIANGLES,v,e.stencilModeForClipping(a),_,wr.disabled,z,D,n.id,A.layoutVertexBuffer,A.indexBuffer,A.segments,n.paint,e.transform.zoom,R,A.layoutVertexBuffer2),o=!1}}}}}}(e,r,n,i);break;case"fill":!function(e,r,n,i){var o,a,s=n.paint.get("fill-color"),l=n.paint.get("fill-opacity");0!==l.constantOr(1)&&(o=e.colorModeForRenderPass(),a=n.paint.get("fill-pattern"),a=e.opaquePassEnabledForLayer()&&!a.constantOr(1)&&1===s.constantOr(t.Color.transparent).a&&1===l.constantOr(0)?"opaque":"translucent",e.renderPass===a&&(s=e.depthModeForSublayer(1,"opaque"===e.renderPass?_r.ReadWrite:_r.ReadOnly),Ar(e,r,n,i,s,o,!1)),"translucent"===e.renderPass)&&n.paint.get("fill-antialias")&&(l=e.depthModeForSublayer(n.getPaintProperty("fill-outline-color")?2:0,_r.ReadOnly),Ar(e,r,n,i,l,o,!0))}(e,r,n,i);break;case"fill-extrusion":!function(e,t,r,n){var i,o=r.paint.get("fill-extrusion-opacity");0!==o&&"translucent"===e.renderPass&&(i=new _r(e.context.gl.LEQUAL,_r.ReadWrite,e.depthRangeFor3D),1!==o||r.paint.get("fill-extrusion-pattern").constantOr(1)?(Pr(e,t,r,n,i,br.disabled,yr.disabled),Pr(e,t,r,n,i,e.stencilModeFor3D(),e.colorModeForRenderPass())):(o=e.colorModeForRenderPass(),Pr(e,t,r,n,i,br.disabled,o)))}(e,r,n,i);break;case"hillshade":!function(e,t,r,n){if("offscreen"===e.renderPass||"translucent"===e.renderPass){var i=e.context,o=e.depthModeForSublayer(0,_r.ReadOnly),a=e.colorModeForRenderPass(),[s,n]="translucent"===e.renderPass?e.stencilConfigForOverlap(n):[{},n];for(const i of n){var l=t.getTile(i);if(void 0!==l.needsHillshadePrepare&&l.needsHillshadePrepare&&"offscreen"===e.renderPass){w=b=_=v=g=m=f=p=d=h=u=c=void 0;var c=e,u=l,h=r,d=o,p=br.disabled,f=a,m=c.context,g=m.gl,v=u.dem;if(v&&v.data){var _=v.dim,b=v.stride,w=v.getPixels();m.activeTexture.set(g.TEXTURE1),m.pixelStoreUnpackPremultiplyAlpha.set(!1),u.demTexture=u.demTexture||c.getTileTexture(b),(u.demTexture?((b=u.demTexture).update(w,{premultiply:!1}),b):(u.demTexture=new y(m,w,g.RGBA,{premultiply:!1}),u.demTexture)).bind(g.NEAREST,g.CLAMP_TO_EDGE),m.activeTexture.set(g.TEXTURE0);let e=u.fbo;e||((b=new y(m,{width:_,height:_,data:null},g.RGBA)).bind(g.LINEAR,g.CLAMP_TO_EDGE),(e=u.fbo=m.createFramebuffer(_,_,!0,!1)).colorAttachment.set(b.texture)),m.bindFramebuffer.set(e.framebuffer),m.viewport.set([0,0,_,_]),c.useProgram("hillshadePrepare").draw(m,g.TRIANGLES,d,p,f,wr.disabled,_t(u.tileID,v),null,h.id,c.rasterBoundsBuffer,c.quadTriangleIndexBuffer,c.rasterBoundsSegments),u.needsHillshadePrepare=!1}}else"translucent"===e.renderPass&&(w=e,b=i,_=l,m=r,g=o,d=s[i.overscaledZ],p=a,u=c=h=v=f=void 0,v=(f=w.context).gl,h=_.fbo)&&(c=w.useProgram("hillshade"),u=w.style.map.terrain&&w.style.map.terrain.getTerrainData(b),f.activeTexture.set(v.TEXTURE0),v.bindTexture(v.TEXTURE_2D,h.colorAttachment.get()),h=u?b:null,c.draw(f,v.TRIANGLES,g,d,p,wr.disabled,vt(w,_,m,h),u,m.id,w.rasterBoundsBuffer,w.quadTriangleIndexBuffer,w.rasterBoundsSegments))}i.viewport.set([0,0,e.width,e.height])}}(e,r,n,i);break;case"raster":!function(e,r,n,i){if("translucent"===e.renderPass&&0!==n.paint.get("raster-opacity")&&i.length){var o=e.context,s=o.gl,l=r.getSource(),c=e.useProgram("raster"),u=e.colorModeForRenderPass(),[h,i]=l instanceof G?[{},i]:e.stencilConfigForOverlap(i),d=i[i.length-1].overscaledZ,p=!e.options.moving;for(const _ of i){var f=e.depthModeForSublayer(_.overscaledZ-d,1===n.paint.get("raster-opacity")?_r.ReadWrite:_r.ReadOnly,s.LESS),m=((v=r.getTile(_)).registerFadeDuration(n.paint.get("raster-fade-duration")),r.findLoadedParent(_,0)),g=function(e,r,n,i,o,s){var l;return i=i.paint.get("raster-fade-duration"),!s&&0<i?(l=((s=a.now())-e.timeAdded)/i,s=r?(s-r.timeAdded)/i:-1,i=n.getSource(),n=o.coveringZoomLevel({tileSize:i.tileSize,roundZoom:i.roundZoom}),i=(o=!r||Math.abs(r.tileID.overscaledZ-n)>Math.abs(e.tileID.overscaledZ-n))&&e.refreshedUponExpiration?1:t.clamp(o?l:1-s,0,1),e.refreshedUponExpiration&&1<=l&&(e.refreshedUponExpiration=!1),r?{opacity:1,mix:1-i}:{opacity:i,mix:0}):{opacity:1,mix:0}}(v,m,r,n,e.transform,e.style.map.terrain);let i,b;var y="nearest"===n.paint.get("raster-resampling")?s.NEAREST:s.LINEAR,v=(o.activeTexture.set(s.TEXTURE0),v.texture.bind(y,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST),o.activeTexture.set(s.TEXTURE1),m?(m.texture.bind(y,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST),i=Math.pow(2,m.tileID.overscaledZ-v.tileID.overscaledZ),b=[v.tileID.canonical.x*i%1,v.tileID.canonical.y*i%1]):v.texture.bind(y,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST),y=(v=(m=e.style.map.terrain&&e.style.map.terrain.getTerrainData(_))?_:null)?v.posMatrix:e.transform.calculatePosMatrix(_.toUnwrapped(),p),Ct(y,b||[0,0],i||1,g,n));l instanceof G?c.draw(o,s.TRIANGLES,f,br.disabled,u,wr.disabled,v,m,n.id,l.boundsBuffer,e.quadTriangleIndexBuffer,l.boundsSegments):c.draw(o,s.TRIANGLES,f,h[_.overscaledZ],u,wr.disabled,v,m,n.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments)}}}(e,r,n,i);break;case"background":!function(e,t,r,n){var i=r.paint.get("background-color"),o=r.paint.get("background-opacity");if(0!==o){var a=e.context,s=a.gl,l=e.transform,c=l.tileSize,u=r.paint.get("background-pattern");if(!e.isPatternMissing(u)){var h=!u&&1===i.a&&1===o&&e.opaquePassEnabledForLayer()?"opaque":"translucent";if(e.renderPass===h){var d=br.disabled,p=e.depthModeForSublayer(0,"opaque"==h?_r.ReadWrite:_r.ReadOnly),f=e.colorModeForRenderPass(),m=e.useProgram(u?"backgroundPattern":"background"),g=(h=n||l.coveringTiles({tileSize:c,terrain:e.style.map.terrain}),u&&(a.activeTexture.set(s.TEXTURE0),e.imageManager.bind(e.context)),r.getCrossfadeParameters());for(const t of h){var y=n?t.posMatrix:e.transform.calculatePosMatrix(t.toUnwrapped()),v=(y=u?It(y,o,e,u,{tileID:t,tileSize:c},g):{u_matrix:y,u_opacity:o,u_color:i},e.style.map.terrain&&e.style.map.terrain.getTerrainData(t));m.draw(a,s.TRIANGLES,p,d,f,wr.disabled,y,v,r.id,e.tileExtentBuffer,e.quadTriangleIndexBuffer,e.tileExtentSegments)}}}}}(e,0,n,i);break;case"custom":!function(e,t,r){var n,i=e.context;r=r.implementation,"offscreen"===e.renderPass?(n=r.prerender)&&(e.setCustomLayerDefaults(),i.setColorMode(e.colorModeForRenderPass()),n.call(r,i.gl,e.transform.customLayerMatrix()),i.setDirty(),e.setBaseState()):"translucent"===e.renderPass&&(e.setCustomLayerDefaults(),i.setColorMode(e.colorModeForRenderPass()),i.setStencilMode(br.disabled),n="3d"===r.renderingMode?new _r(e.context.gl.LEQUAL,_r.ReadWrite,e.depthRangeFor3D):e.depthModeForSublayer(0,_r.ReadOnly),i.setDepthMode(n),r.render(i.gl,e.transform.customLayerMatrix()),i.setDirty(),e.setBaseState(),i.bindFramebuffer.set(null))}(e,0,n)}}translatePosMatrix(e,r,n,i,o){var a;return n[0]||n[1]?((i=o?"map"===i?this.transform.angle:0:"viewport"===i?-this.transform.angle:0)&&(a=Math.sin(i),i=Math.cos(i),n=[n[0]*i-n[1]*a,n[0]*a+n[1]*i]),a=[o?n[0]:Se(r,n[0],this.transform.zoom),o?n[1]:Se(r,n[1],this.transform.zoom),0],i=new Float32Array(16),t.translate(i,e,a),i):e}saveTileTexture(e){var t=this._tileTextures[e.size[0]];t?t.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){return(e=this._tileTextures[e])&&0<e.length?e.pop():null}isPatternMissing(e){var t;return!(!e||e.from&&e.to&&(t=this.imageManager.getPattern(e.from.toString()),e=this.imageManager.getPattern(e.to.toString()),t)&&e)}useProgram(e,t){this.cache=this.cache||{};var r=e+(t?t.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[r]||(this.cache[r]=new at(this.context,rt[e],t,kt[e],this._showOverdrawInspector,this.style.map.terrain)),this.cache[r]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){var e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){var e;null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,e=this.context.gl,this.debugOverlayTexture=new y(this.context,this.debugOverlayCanvas,e.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){var{drawingBufferWidth:e,drawingBufferHeight:t}=this.context.gl;return this.width!==e||this.height!==t}}class jr{constructor(e,t){this.points=e,this.planes=t}static fromInvProjectionMatrix(e,r,n){const i=Math.pow(2,n),o=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((n=>{var o=1/(n=t.transformMat4([],n,e))[3]/r*i;return t.mul$1(n,n,[o,o,1/n[3],o])}));return n=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((e=>{var r=t.sub([],o[e[0]],o[e[1]]),n=t.sub([],o[e[2]],o[e[1]]);r=t.normalize([],t.cross([],r,n)),n=-t.dot(r,o[e[1]]);return r.concat(n)})),new jr(o,n)}}class qr{constructor(e,r){this.min=e,this.max=r,this.center=t.scale$1([],t.add([],this.min,this.max),.5)}quadrant(e){var r=[e%2==0,e<2],n=t.clone$2(this.min),i=t.clone$2(this.max);for(let t=0;t<r.length;t++)n[t]=(r[t]?this.min:this.center)[t],i[t]=(r[t]?this.center:this.max)[t];return i[2]=this.max[2],new qr(n,i)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersects(e){var r=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let n=!0;for(let a=0;a<e.planes.length;a++){var i=e.planes[a];let o=0;for(let e=0;e<r.length;e++)0<=t.dot$1(i,r[e])&&o++;if(0===o)return 0;o!==r.length&&(n=!1)}if(n)return 2;for(let t=0;t<3;t++){let r=Number.MAX_VALUE,n=-Number.MAX_VALUE;for(let i=0;i<e.points.length;i++){var o=e.points[i][t]-this.min[t];r=Math.min(r,o),n=Math.max(n,o)}if(n<0||r>this.max[t]-this.min[t])return 0}return 1}}class Hr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(isNaN(e)||e<0||isNaN(t)||t<0||isNaN(r)||r<0||isNaN(n)||n<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=t,this.left=r,this.right=n}interpolate(e,r,n){return null!=r.top&&null!=e.top&&(this.top=t.interpolate.number(e.top,r.top,n)),null!=r.bottom&&null!=e.bottom&&(this.bottom=t.interpolate.number(e.bottom,r.bottom,n)),null!=r.left&&null!=e.left&&(this.left=t.interpolate.number(e.left,r.left,n)),null!=r.right&&null!=e.right&&(this.right=t.interpolate.number(e.right,r.right,n)),this}getCenter(e,r){return e=t.clamp((this.left+e-this.right)/2,0,e),r=t.clamp((this.top+r-this.bottom)/2,0,r),new t.Point(e,r)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new Hr(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const Vr=85.051129;class Gr{constructor(e,r,n,i,o){this.tileSize=512,this._renderWorldCopies=void 0===o||!!o,this._minZoom=e||0,this._maxZoom=r||22,this._minPitch=null==n?0:n,this._maxPitch=null==i?60:i,this.setMaxBounds(),this.width=0,this.height=0,this._center=new t.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Hr,this._posMatrixCache={},this._alignedPosMatrixCache={},this.minElevationForCurrentTile=0}clone(){var e=new Gr(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return e.apply(this),e}apply(e){this.tileSize=e.tileSize,this.latRange=e.latRange,this.width=e.width,this.height=e.height,this._center=e._center,this._elevation=e._elevation,this.minElevationForCurrentTile=e.minElevationForCurrentTile,this.zoom=e.zoom,this.angle=e.angle,this._fov=e._fov,this._pitch=e._pitch,this._unmodified=e._unmodified,this._edgeInsets=e._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(e){this._minZoom!==e&&(this._minZoom=e,this.zoom=Math.max(this.zoom,e))}get maxZoom(){return this._maxZoom}set maxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.zoom=Math.min(this.zoom,e))}get minPitch(){return this._minPitch}set minPitch(e){this._minPitch!==e&&(this._minPitch=e,this.pitch=Math.max(this.pitch,e))}get maxPitch(){return this._maxPitch}set maxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.pitch=Math.min(this.pitch,e))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(e){void 0===e?e=!0:null===e&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new t.Point(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(e){e=-t.wrap(e,-180,180)*Math.PI/180,this.angle!==e&&(this._unmodified=!1,this.angle=e,this._calcMatrices(),this.rotationMatrix=t.create$2(),t.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(e){e=t.clamp(e,this.minPitch,this.maxPitch)/180*Math.PI,this._pitch!==e&&(this._unmodified=!1,this._pitch=e,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(e){e=Math.max(.01,Math.min(60,e)),this._fov!==e&&(this._unmodified=!1,this._fov=e/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(e){e=Math.min(Math.max(e,this.minZoom),this.maxZoom),this._zoom!==e&&(this._unmodified=!1,this._zoom=e,this.tileZoom=Math.max(0,Math.floor(e)),this.scale=this.zoomScale(e),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,t,r){this._unmodified=!1,this._edgeInsets.interpolate(e,t,r),this._constrain(),this._calcMatrices()}coveringZoomLevel(e){return e=(e.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/e.tileSize)),Math.max(0,e)}getVisibleUnwrappedCoordinates(e){var r=[new t.UnwrappedTileID(0,e)];if(this._renderWorldCopies){var n=this.pointCoordinate(new t.Point(0,0)),i=this.pointCoordinate(new t.Point(this.width,0)),o=this.pointCoordinate(new t.Point(this.width,this.height)),a=this.pointCoordinate(new t.Point(0,this.height)),s=Math.floor(Math.min(n.x,i.x,o.x,a.x)),l=Math.floor(Math.max(n.x,i.x,o.x,a.x));for(let n=s-1;n<=l+1;n++)0!==n&&r.push(new t.UnwrappedTileID(n,e))}return r}coveringTiles(e){let r=this.coveringZoomLevel(e);var n=r;if(void 0!==e.minzoom&&r<e.minzoom)return[];void 0!==e.maxzoom&&r>e.maxzoom&&(r=e.maxzoom);var i=this.pointCoordinate(this.getCameraPoint()),o=t.MercatorCoordinate.fromLngLat(this.center);const a=Math.pow(2,r);var s=[a*i.x,a*i.y,0],l=[a*o.x,a*o.y,0],c=jr.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,r);let u=e.minzoom||0;!e.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(u=r);var h=e.terrain?2/Math.min(this.tileSize,e.tileSize)*this.tileSize:3,d=e=>({aabb:new qr([e*a,0,0],[(e+1)*a,a,0]),zoom:0,x:0,y:0,wrap:e,fullyVisible:!1}),p=[],f=[],m=r,g=e.reparseOverscaled?n:r;if(this._renderWorldCopies)for(let t=1;t<=3;t++)p.push(d(-t)),p.push(d(t));for(p.push(d(0));0<p.length;){var y=p.pop(),v=y.x,_=y.y;let r=y.fullyVisible;if(!r){if(0===(b=y.aabb.intersects(c)))continue;r=2===b}var b=e.terrain?s:l,w=y.aabb.distanceX(b),x=y.aabb.distanceY(b);w=Math.max(Math.abs(w),Math.abs(x)),x=h+(1<<m-y.zoom)-2;if(y.zoom===m||x<w&&y.zoom>=u)x=m-y.zoom,w=s[0]-.5-(v<<x),x=s[1]-.5-(_<<x),f.push({tileID:new t.OverscaledTileID(y.zoom===m?g:y.zoom,y.wrap,y.zoom,v,_),distanceSq:t.sqrLen([l[0]-.5-v,l[1]-.5-_]),tileDistanceToCamera:Math.sqrt(w*w+x*x)});else for(let n=0;n<4;n++){var C,S,E=(v<<1)+n%2,T=(_<<1)+(n>>1),I=y.zoom+1;let i=y.aabb.quadrant(n);e.terrain&&(S=new t.OverscaledTileID(I,y.wrap,I,E,T),C=null!=(C=(S=e.terrain.getMinMaxElevation(S)).minElevation)?C:this.elevation,S=null!=(S=S.maxElevation)?S:this.elevation,i=new qr([i.min[0],i.min[1],C],[i.max[0],i.max[1],S])),p.push({aabb:i,zoom:I,x:E,y:T,wrap:y.wrap,fullyVisible:r})}}return f.sort(((e,t)=>e.distanceSq-t.distanceSq)).map((e=>e.tileID))}resize(e,t){this.width=e,this.height=t,this.pixelsToGLUnits=[2/e,-2/t],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(e){return Math.pow(2,e)}scaleZoom(e){return Math.log(e)/Math.LN2}project(e){var r=t.clamp(e.lat,-Vr,Vr);return new t.Point(t.mercatorXfromLng(e.lng)*this.worldSize,t.mercatorYfromLat(r)*this.worldSize)}unproject(e){return new t.MercatorCoordinate(e.x/this.worldSize,e.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(e){var r=this.elevation,n=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,i=this.pointLocation(this.centerPoint,e);e=e.getElevationForLngLatZoom(i,this.tileZoom);this.elevation-e&&(n=n+r-e,r=Math.cos(this._pitch)*this.cameraToCenterDistance/n/t.mercatorZfromAltitude(1,i.lat)/this.tileSize,n=this.scaleZoom(r),this._elevation=e,this._center=i,this.zoom=n)}setLocationAtPoint(e,r){r=this.pointCoordinate(r);var n=this.pointCoordinate(this.centerPoint);e=this.locationCoordinate(e),e=new t.MercatorCoordinate(e.x-(r.x-n.x),e.y-(r.y-n.y));this.center=this.coordinateLocation(e),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(e,t){return t?this.coordinatePoint(this.locationCoordinate(e),t.getElevationForLngLatZoom(e,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(e))}pointLocation(e,t){return this.coordinateLocation(this.pointCoordinate(e,t))}locationCoordinate(e){return t.MercatorCoordinate.fromLngLat(e)}coordinateLocation(e){return e&&e.toLngLat()}pointCoordinate(e,r){if(r&&null!=(r=r.pointCoordinate(e)))return r;r=[e.x,e.y,0,1],e=[e.x,e.y,1,1];var n=(t.transformMat4(r,r,this.pixelMatrixInverse),t.transformMat4(e,e,this.pixelMatrixInverse),r[3]),i=e[3],o=r[1]/n,a=e[1]/i,s=r[2]/n,l=s==(l=e[2]/i)?0:(0-s)/(l-s);return new t.MercatorCoordinate(t.interpolate.number(r[0]/n,e[0]/i,l)/this.worldSize,t.interpolate.number(o,a,l)/this.worldSize)}coordinatePoint(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.pixelMatrix;return e=[e.x*this.worldSize,e.y*this.worldSize,r,1],t.transformMat4(e,e,n),new t.Point(e[0]/e[3],e[1]/e[3])}getBounds(){var e=Math.max(0,this.height/2-this.getHorizon());return(new F).extend(this.pointLocation(new t.Point(0,e))).extend(this.pointLocation(new t.Point(this.width,e))).extend(this.pointLocation(new t.Point(this.width,this.height))).extend(this.pointLocation(new t.Point(0,this.height)))}getMaxBounds(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new F([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(e){e?(this.lngRange=[e.getWest(),e.getEast()],this.latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-Vr,Vr])}calculatePosMatrix(e){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];var n,i,o,a=e.key,s=r?this._alignedPosMatrixCache:this._posMatrixCache;return s[a]||(n=e.canonical,i=this.worldSize/this.zoomScale(n.z),e=n.x+Math.pow(2,n.z)*e.wrap,o=t.identity(new Float64Array(16)),t.translate(o,o,[e*i,n.y*i,0]),t.scale(o,o,[i/t.EXTENT,i/t.EXTENT,1]),t.multiply(o,r?this.alignedProjMatrix:this.projMatrix,o),s[a]=new Float32Array(o)),s[a]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(e,r){r=t.clamp(+r,this.minZoom,this.maxZoom),r={center:new t.LngLat(e.lng,e.lat),zoom:r};let n=this.lngRange;this._renderWorldCopies||null!==n||(n=[-(180-1e-10),180-1e-10]);var i=this.tileSize*this.zoomScale(r.zoom);let o=0,a=i,s=0,l=i,c=0,u=0;var{x:h,y:d}=this.size,{x:p,y:e}=(this.latRange&&(p=this.latRange,o=t.mercatorYfromLat(p[1])*i,(a=t.mercatorYfromLat(p[0])*i)-o<d)&&(c=d/(a-o)),n&&(s=t.wrap(t.mercatorXfromLng(n[0])*i,0,i),(l=t.wrap(t.mercatorXfromLng(n[1])*i,0,i))<s&&(l+=i),l-s<h)&&(u=h/(l-s)),this.project.call({worldSize:i},e));let f,m;var g,y=Math.max(u||0,c||0);if(y)g=new t.Point(u?(l+s)/2:p,c?(a+o)/2:e),r.center=this.unproject.call({worldSize:i},g).wrap(),r.zoom+=this.scaleZoom(y);else{if(this.latRange&&(e-(g=d/2)<o&&(m=o+g),e+g>a)&&(m=a-g),n){y=(s+l)/2;let e=p;d=h/2,(e=this._renderWorldCopies?t.wrap(p,y-i/2,y+i/2):e)-d<s&&(f=s+d),e+d>l&&(f=l-d)}void 0===f&&void 0===m||(g=new t.Point(null!==f&&void 0!==f?f:p,null!==m&&void 0!==m?m:e),r.center=this.unproject.call({worldSize:i},g).wrap())}return r}_constrain(){var e,t,r;this.center&&this.width&&this.height&&!this._constraining&&(this._constraining=!0,e=this._unmodified,({center:t,zoom:r}=this.getConstrained(this.center,this.zoom)),this.center=t,this.zoom=r,this._unmodified=e,this._constraining=!1)}_calcMatrices(){if(this.height){var e=this._fov/2,r=this.centerOffset,n=this.point.x,i=this.point.y;this.cameraToCenterDistance=.5/Math.tan(e)*this.height,this._pixelPerMeter=t.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let l=t.identity(new Float64Array(16));t.scale(l,l,[this.width/2,-this.height/2,1]),t.translate(l,l,[1,-1,0]),this.labelPlaneMatrix=l,l=t.identity(new Float64Array(16)),t.scale(l,l,[1,-1,1]),t.translate(l,l,[-1,-1,0]),t.scale(l,l,[2/this.width,2/this.height,1]),this.glCoordMatrix=l;var o=(e=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch))-(a=Math.min(this.elevation,this.minElevationForCurrentTile))*this._pixelPerMeter/Math.cos(this._pitch),a=a<0?o:e,s=(o=Math.PI/2+this._pitch,e=this._fov*(.5+r.y/this.height),e=Math.sin(e)*a/Math.sin(t.clamp(Math.PI-o-e,.01,Math.PI-.01)),this.getHorizon());s=2*Math.atan(s/this.cameraToCenterDistance)*(.5+r.y/(2*s)),o=Math.sin(s)*a/Math.sin(t.clamp(Math.PI-o-s,.01,Math.PI-.01)),s=Math.min(e,o),e=1.01*(Math.cos(Math.PI/2-this._pitch)*s+a),o=this.height/50,s=(l=new Float64Array(16),t.perspective(l,this._fov,this.width/this.height,o,e),l[8]=2*-r.x/this.width,l[9]=2*r.y/this.height,t.scale(l,l,[1,-1,1]),t.translate(l,l,[0,0,-this.cameraToCenterDistance]),t.rotateX(l,l,this._pitch),t.rotateZ(l,l,this.angle),t.translate(l,l,[-n,-i,0]),this.mercatorMatrix=t.scale([],l,[this.worldSize,this.worldSize,this.worldSize]),t.scale(l,l,[1,1,this._pixelPerMeter]),this.pixelMatrix=t.multiply(new Float64Array(16),this.labelPlaneMatrix,l),t.translate(l,l,[0,0,-this.elevation]),this.projMatrix=l,this.invProjMatrix=t.invert([],l),this.pixelMatrix3D=t.multiply(new Float64Array(16),this.labelPlaneMatrix,l),this.width%2/2),a=this.height%2/2,o=Math.cos(this.angle),e=Math.sin(this.angle),r=n-Math.round(n)+o*s+e*a,n=i-Math.round(i)+o*a+e*s,i=new Float64Array(l);if(t.translate(i,i,[.5<r?r-1:r,.5<n?n-1:n,0]),this.alignedProjMatrix=i,!(l=t.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=l,this._posMatrixCache={},this._alignedPosMatrixCache={}}}maxPitchScaleFactor(){var e;return this.pixelMatrixInverse?(e=[(e=this.pointCoordinate(new t.Point(0,0))).x*this.worldSize,e.y*this.worldSize,0,1],t.transformMat4(e,e,this.pixelMatrix)[3]/this.cameraToCenterDistance):1}getCameraPoint(){var e=this._pitch;e=Math.tan(e)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new t.Point(0,e))}getCameraQueryGeometry(e){var r=this.getCameraPoint();if(1===e.length)return[e[0],r];{let n=r.x,i=r.y,o=r.x,a=r.y;for(const t of e)n=Math.min(n,t.x),i=Math.min(i,t.y),o=Math.max(o,t.x),a=Math.max(a,t.y);return[new t.Point(n,i),new t.Point(o,i),new t.Point(o,a),new t.Point(n,a),new t.Point(n,i)]}}lngLatToCameraDepth(e,r){return e=[(e=this.locationCoordinate(e)).x*this.worldSize,e.y*this.worldSize,r,1],t.transformMat4(e,e,this.projMatrix),e[2]/e[3]}}function Kr(e,t){var r=this;let n,i,o=!1,a=null;const s=()=>{a=null,o&&(e.apply(n,i),a=setTimeout(s,t),o=!1)};return function(){for(var e=arguments.length,t=new Array(e),l=0;l<e;l++)t[l]=arguments[l];return o=!0,n=r,i=t,a||s(),a}}class Zr{constructor(e){this._getCurrentHash=()=>{var e=window.location.hash.replace("#","");if(this._hashName){let t;return e.split("&").map((e=>e.split("="))).forEach((e=>{e[0]===this._hashName&&(t=e)})),(t&&t[1]||"").split("/")}return e.split("/")},this._onHashChange=()=>{var e,t=this._getCurrentHash();return 3<=t.length&&!t.some((e=>isNaN(e)))&&(e=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(t[3]||0):this._map.getBearing(),this._map.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:e,pitch:+(t[4]||0)}),!0)},this._updateHashUnthrottled=()=>{var e=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,e)}catch(e){}},this._updateHash=Kr(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(e){var t=this._map.getCenter(),r=Math.round(100*this._map.getZoom())/100,n=Math.ceil((r*Math.LN2+Math.log(512/360/.5))/Math.LN10),i=(n=Math.pow(10,n),Math.round(t.lng*n)/n),o=(t=Math.round(t.lat*n)/n,n=this._map.getBearing(),this._map.getPitch());let a="";if(a+=e?`/${i}/${t}/`+r:r+`/${t}/`+i,(n||o)&&(a+="/"+Math.round(10*n)/10),o&&(a+="/"+Math.round(o)),this._hashName){const t=this._hashName;let r=!1;return e=window.location.hash.slice(1).split("&").map((e=>{var n=e.split("=")[0];return n===t?(r=!0,n+"="+a):e})).filter((e=>e)),r||e.push(t+"="+a),"#"+e.join("&")}return"#"+a}}tt={linearity:.3,easing:t.bezier(0,0,.3,1)};const Wr=t.extend({deceleration:2500,maxSpeed:1400},tt),$r=t.extend({deceleration:20,maxSpeed:1400},tt),Yr=t.extend({deceleration:1e3,maxSpeed:360},tt),Xr=t.extend({deceleration:1e3,maxSpeed:90},tt);class Qr{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.now(),settings:e})}_drainInertiaBuffer(){for(var e=this._inertiaBuffer,t=a.now();0<e.length&&160<t-e[0].time;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){var r,n={zoom:0,bearing:0,pitch:0,pan:new t.Point(0,0),pinchAround:void 0,around:void 0};for({settings:r}of this._inertiaBuffer)n.zoom+=r.zoomDelta||0,n.bearing+=r.bearingDelta||0,n.pitch+=r.pitchDelta||0,r.panDelta&&n.pan._add(r.panDelta),r.around&&(n.around=r.around),r.pinchAround&&(n.pinchAround=r.pinchAround);var i=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,o={};return n.pan.mag()&&(e=en(n.pan.mag(),i,t.extend({},Wr,e||{})),o.offset=n.pan.mult(e.amount/n.pan.mag()),o.center=this._map.transform.center,Jr(o,e)),n.zoom&&(e=en(n.zoom,i,$r),o.zoom=this._map.transform.zoom+e.amount,Jr(o,e)),n.bearing&&(e=en(n.bearing,i,Yr),o.bearing=this._map.transform.bearing+t.clamp(e.amount,-179,179),Jr(o,e)),n.pitch&&(e=en(n.pitch,i,Xr),o.pitch=this._map.transform.pitch+e.amount,Jr(o,e)),(o.zoom||o.bearing)&&(o.around=(i=void 0===n.pinchAround?n.around:n.pinchAround)?this._map.unproject(i):this._map.getCenter()),this.clear(),t.extend(o,{noMoveStart:!0})}}}function Jr(e,t){(!e.duration||e.duration<t.duration)&&(e.duration=t.duration,e.easing=t.easing)}function en(e,r,n){var{maxSpeed:i,linearity:o,deceleration:a}=n;e=t.clamp(e*o/(r/1e3),-i,i),r=Math.abs(e)/(a*o);return{easing:n.easing,duration:1e3*r,amount:e*(r/2)}}class tn extends t.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var o=s.mousePos(r.getCanvas(),n),a=r.unproject(o);super(e,t.extend({point:o,lngLat:a,originalEvent:n},i)),this._defaultPrevented=!1,this.target=r}}class rn extends t.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,n){var i="touchend"===e?n.changedTouches:n.touches,o=(i=s.touchPos(r.getCanvasContainer(),i)).map((e=>r.unproject(e))),a=i.reduce(((e,t,r,n)=>e.add(t.div(n.length))),new t.Point(0,0));super(e,{points:i,point:a,lngLats:o,lngLat:r.unproject(a),originalEvent:n}),this._defaultPrevented=!1}}class nn extends t.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,t,r){super(e,{originalEvent:r}),this._defaultPrevented=!1}}class on{constructor(e,t){this._map=e,this._clickTolerance=t.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new nn(e.type,this._map,e))}mousedown(e,t){return this._mousedownPos=t,this._firePreventable(new tn(e.type,this._map,e))}mouseup(e){this._map.fire(new tn(e.type,this._map,e))}click(e,t){this._mousedownPos&&this._mousedownPos.dist(t)>=this._clickTolerance||this._map.fire(new tn(e.type,this._map,e))}dblclick(e){return this._firePreventable(new tn(e.type,this._map,e))}mouseover(e){this._map.fire(new tn(e.type,this._map,e))}mouseout(e){this._map.fire(new tn(e.type,this._map,e))}touchstart(e){return this._firePreventable(new rn(e.type,this._map,e))}touchmove(e){this._map.fire(new rn(e.type,this._map,e))}touchend(e){this._map.fire(new rn(e.type,this._map,e))}touchcancel(e){this._map.fire(new rn(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class an{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new tn(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new tn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new tn(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class sn{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.pointLocation(t.Point.convert(e),this._map.terrain)}}class ln{constructor(e,t){this._map=e,this._tr=new sn(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=t.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,t){this.isEnabled()&&e.shiftKey&&0===e.button&&(s.disableDrag(),this._startPos=this._lastPos=t,this._active=!0)}mousemoveWindow(e,t){var r,n,i;!this._active||this._lastPos.equals(t)||!this._box&&t.dist(this._startPos)<this._clickTolerance||(i=this._startPos,this._lastPos=t,this._box||(this._box=s.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e)),e=Math.min(i.x,t.x),r=Math.max(i.x,t.x),n=Math.min(i.y,t.y),i=Math.max(i.y,t.y),s.setTransform(this._box,`translate(${e}px,${n}px)`),this._box.style.width=r-e+"px",this._box.style.height=i-n+"px")}mouseupWindow(e,r){if(this._active&&0===e.button){const n=this._startPos,i=r;if(this.reset(),s.suppressClick(),n.x!==i.x||n.y!==i.y)return this._map.fire(new t.Event("boxzoomend",{originalEvent:e})),{cameraAnimation:e=>e.fitScreenCoordinates(n,i,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}}keydown(e){this._active&&27===e.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(s.remove(this._box),this._box=null),s.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,r){return this._map.fire(new t.Event(e,{originalEvent:r}))}}function cn(e,t){if(e.length!==t.length)throw new Error(`The number of touches and points are not equal - touches ${e.length}, points `+t.length);var r={};for(let n=0;n<e.length;n++)r[e[n].identifier]=t[n];return r}class un{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,r,n){(this.centroid||n.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=e.timeStamp),n.length===this.numTouches&&(this.centroid=function(e){var r=new t.Point(0,0);for(const t of e)r._add(t);return r.div(e.length)}(r),this.touches=cn(n,r)))}touchmove(e,t,r){if(!this.aborted&&this.centroid){var n=cn(r,t);for(const e in this.touches){var i=this.touches[e],o=n[e];(!o||30<o.dist(i))&&(this.aborted=!0)}}}touchend(e,t,r){if((!this.centroid||500<e.timeStamp-this.startTime)&&(this.aborted=!0),0===r.length&&(e=!this.aborted&&this.centroid,this.reset(),e))return e}}class hn{constructor(e){this.singleTap=new un(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,t,r){this.singleTap.touchstart(e,t,r)}touchmove(e,t,r){this.singleTap.touchmove(e,t,r)}touchend(e,t,r){if(t=this.singleTap.touchend(e,t,r)){r=e.timeStamp-this.lastTime<500;var n=!this.lastTap||this.lastTap.dist(t)<30;if(r&&n||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=t,this.count===this.numTaps)return this.reset(),t}}}class dn{constructor(e){this._tr=new sn(e),this._zoomIn=new hn({numTouches:1,numTaps:2}),this._zoomOut=new hn({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,t,r){this._zoomIn.touchstart(e,t,r),this._zoomOut.touchstart(e,t,r)}touchmove(e,t,r){this._zoomIn.touchmove(e,t,r),this._zoomOut.touchmove(e,t,r)}touchend(e,t,r){const n=this._zoomIn.touchend(e,t,r),i=this._zoomOut.touchend(e,t,r),o=this._tr;return n?(this._active=!0,e.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:t=>t.easeTo({duration:300,zoom:o.zoom+1,around:o.unproject(n)},{originalEvent:e})}):i?(this._active=!0,e.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:t=>t.easeTo({duration:300,zoom:o.zoom-1,around:o.unproject(i)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class pn{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if((t=this._moveFunction(...t)).bearingDelta||t.pitchDelta||t.around||t.panDelta)return this._active=!0,t}dragStart(e,t){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=t.length?t[0]:t,this._activateOnStart)&&this._lastPoint&&(this._active=!0)}dragMove(e,t){if(this.isEnabled()){var r=this._lastPoint;if(r)if(e.preventDefault(),this._moveStateManager.isValidMoveEvent(e)){if(t=t.length?t[0]:t,this._moved||!(t.dist(r)<this._clickTolerance))return this._moved=!0,this._lastPoint=t,this._move(r,t)}else this.reset(e)}}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&s.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const fn={0:1,2:2};class mn{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){e=s.mouseButton(e),this._eventButton=e}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!function(e,t){return t=fn[t],void 0===e.buttons||(e.buttons&t)!==t}(e,this._eventButton)}isValidEndEvent(e){return s.mouseButton(e)===this._eventButton}}class gn{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return 1===e.targetTouches.length}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){e=e.targetTouches[0].identifier,this._firstTouch=e}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}const yn=e=>{e.mousedown=e.dragStart,e.mousemoveWindow=e.dragMove,e.mouseup=e.dragEnd,e.contextmenu=function(e){e.preventDefault()}},vn=e=>{let{enable:t,clickTolerance:r,bearingDegreesPerPixelMoved:n=.8}=e;var i=new mn({checkCorrectEvent:e=>0===s.mouseButton(e)&&e.ctrlKey||2===s.mouseButton(e)});return new pn({clickTolerance:r,move:(e,t)=>({bearingDelta:(t.x-e.x)*n}),moveStateManager:i,enable:t,assignEvents:yn})},_n=e=>{let{enable:t,clickTolerance:r,pitchDegreesPerPixelMoved:n=-.5}=e;var i=new mn({checkCorrectEvent:e=>0===s.mouseButton(e)&&e.ctrlKey||2===s.mouseButton(e)});return new pn({clickTolerance:r,move:(e,t)=>({pitchDelta:(t.y-e.y)*n}),moveStateManager:i,enable:t,assignEvents:yn})};class bn{constructor(e,t){this._clickTolerance=e.clickTolerance||1,this._map=t,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new t.Point(0,0)}minTouchs(){return this._map.cooperativeGestures.isEnabled()?2:1}touchstart(e,t,r){return this._calculateTransform(e,t,r)}touchmove(e,t,r){if(this._active&&!(r.length<this.minTouchs()))return e.preventDefault(),this._calculateTransform(e,t,r)}touchend(e,t,r){this._calculateTransform(e,t,r),this._active&&r.length<this.minTouchs()&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,r,n){0<n.length&&(this._active=!0);var i=cn(n,r),o=new t.Point(0,0),a=new t.Point(0,0);let s=0;for(const t in i){var l=i[t],c=this._touches[t];c&&(o._add(l),a._add(l.sub(c)),s++,i[t]=l)}if(this._touches=i,!(s<this.minTouchs())&&a.mag()&&(n=a.div(s),this._sum._add(n),!(this._sum.mag()<this._clickTolerance)))return{around:o.div(s),panDelta:n}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class wn{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,t,r){this._firstTwoTouches||r.length<2||(this._firstTwoTouches=[r[0].identifier,r[1].identifier],this._start([t[0],t[1]]))}touchmove(e,t,r){if(this._firstTwoTouches){e.preventDefault();var[n,i]=this._firstTwoTouches,n=xn(r,t,n);r=xn(r,t,i);if(n&&r)return t=this._aroundCenter?null:n.add(r).div(2),this._move([n,r],t,e)}}touchend(e,t,r){var n,i;this._firstTwoTouches&&([i,n]=this._firstTwoTouches,i=xn(r,t,i),r=xn(r,t,n),i&&r||(this._active&&s.suppressClick(),this.reset()))}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function xn(e,t,r){for(let n=0;n<e.length;n++)if(e[n].identifier===r)return t[n]}function Cn(e,t){return Math.log(e/t)/Math.LN2}class Sn extends wn{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,t){var r=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(Cn(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Cn(this._distance,r),pinchAround:t}}}function En(e,t){return 180*e.angleWith(t)/Math.PI}class Tn extends wn{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,t,r){var n=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:En(this._vector,n),pinchAround:t}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());var t=25/(Math.PI*this._minDiameter)*360;e=En(e,this._startVector);return Math.abs(e)<t}}function In(e){return Math.abs(e.y)>Math.abs(e.x)}class kn extends wn{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,t,r){super.touchstart(e,t,r),this._currentTouchCount=r.length}_start(e){In((this._lastPoints=e)[0].sub(e[1]))&&(this._valid=!1)}_move(e,t,r){if(!(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)){var n=e[0].sub(this._lastPoints[0]),i=e[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(n,i,r.timeStamp),this._valid)return this._lastPoints=e,this._active=!0,{pitchDelta:(n.y+i.y)/2*-.5}}}gestureBeginsVertically(e,t,r){var n,i;return void 0!==this._valid?this._valid:(i=2<=e.mag(),n=2<=t.mag(),i||n?i&&n?(i=0<e.y==0<t.y,In(e)&&In(t)&&i):(void 0===this._firstMove&&(this._firstMove=r),r-this._firstMove<100&&void 0):void 0)}}const An={panStep:100,bearingStep:15,pitchStep:10};class Pn{constructor(e){this._tr=new sn(e),e=An,this._panStep=e.panStep,this._bearingStep=e.bearingStep,this._pitchStep=e.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(!(e.altKey||e.ctrlKey||e.metaKey)){let t=0,r=0,n=0,i=0,o=0;switch(e.keyCode){case 61:case 107:case 171:case 187:t=1;break;case 189:case 109:case 173:t=-1;break;case 37:e.shiftKey?r=-1:(e.preventDefault(),i=-1);break;case 39:e.shiftKey?r=1:(e.preventDefault(),i=1);break;case 38:e.shiftKey?n=1:(e.preventDefault(),o=-1);break;case 40:e.shiftKey?n=-1:(e.preventDefault(),o=1);break;default:return}return this._rotationDisabled&&(r=0,n=0),{cameraAnimation:a=>{var s=this._tr;a.easeTo({duration:300,easeId:"keyboardHandler",easing:Mn,zoom:t?Math.round(s.zoom)+t*(e.shiftKey?2:1):s.zoom,bearing:s.bearing+r*this._bearingStep,pitch:s.pitch+n*this._pitchStep,offset:[-i*this._panStep,-o*this._panStep],center:s.center},{originalEvent:e})}}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Mn(e){return e*(2-e)}const Rn=4.000244140625;class On{constructor(e,t){this._onTimeout=e=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(e)},this._map=e,this._tr=new sn(e),this._triggerRenderFrame=t,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around)}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(e){if(this.isEnabled()&&(!this._map.cooperativeGestures.isEnabled()||e[this._map.cooperativeGestures._bypassKey])){let n=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;var t=a.now(),r=t-(this._lastWheelEventTime||0);this._lastWheelEventTime=t,0!==n&&n%Rn==0?this._type="wheel":0!==n&&Math.abs(n)<4?this._type="trackpad":400<r?(this._type=null,this._lastValue=n,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(r*n)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,n+=this._lastValue)),e.shiftKey&&n&&(n/=4),this._type&&(this._lastWheelEvent=e,this._delta-=n,this._active||this._start(e)),e.preventDefault()}}_start(e){var r;this._delta&&(this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout),e=s.mousePos(this._map.getCanvas(),e),r=this._tr,e.y>r.transform.height/2-r.transform.getHorizon()?this._around=t.LngLat.convert(this._aroundCenter?r.center:r.unproject(e)):this._around=t.LngLat.convert(r.center),this._aroundPoint=r.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame()))}renderFrame(){if(this._frameId&&(this._frameId=null,this.isActive())){var e=this._tr.transform;if(0!==this._delta){var r="wheel"===this._type&&Math.abs(this._delta)>Rn?this._wheelZoomRate:this._defaultZoomRate;let t=2/(1+Math.exp(-Math.abs(this._delta*r)));this._delta<0&&0!==t&&(t=1/t),r="number"==typeof this._targetZoom?e.zoomScale(this._targetZoom):e.scale,this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,e.scaleZoom(r*t))),"wheel"===this._type&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}r="number"==typeof this._targetZoom?this._targetZoom:e.zoom;var n,i=this._startZoom,o=this._easing;let s,l=!1;return"wheel"===this._type&&i&&o?(n=o(o=Math.min((a.now()-this._lastWheelEventTime)/200,1)),s=t.interpolate.number(i,r,n),o<1?this._frameId||(this._frameId=!0):l=!0):(s=r,l=!0),this._active=!0,l&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout}),200)),{noInertia:!0,needsRenderFrame:!l,zoomDelta:s-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}}_smoothOutEasing(e){let r=t.defaultEasing;var n,i;return this._prevEase&&(i=this._prevEase,n=(a.now()-i.start)/i.duration,i=i.easing(.01+n)-i.easing(n),n=.27/Math.sqrt(i*i+1e-4)*.01,i=Math.sqrt(.0729-n*n),r=t.bezier(n,i,.25,1)),this._prevEase={start:a.now(),duration:e,easing:r},r}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Ln{constructor(e,t){this._clickZoom=e,this._tapZoom=t}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Dn{constructor(e){this._tr=new sn(e),this.reset()}reset(){this._active=!1}dblclick(e,t){return e.preventDefault(),{cameraAnimation:r=>{r.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(t)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Nn{constructor(){this._tap=new hn({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,t,r){var n,i,o;this._swipePoint||(this._tapTime?(n=t[0],i=e.timeStamp-this._tapTime<500,o=this._tapPoint.dist(n)<30,i&&o?0<r.length&&(this._swipePoint=n,this._swipeTouch=r[0].identifier):this.reset()):this._tap.touchstart(e,t,r))}touchmove(e,t,r){var n,i;if(this._tapTime){if(this._swipePoint&&r[0].identifier===this._swipeTouch)return i=(n=t[0]).y-this._swipePoint.y,this._swipePoint=n,e.preventDefault(),this._active=!0,{zoomDelta:i/128}}else this._tap.touchmove(e,t,r)}touchend(e,t,r){this._tapTime?this._swipePoint&&0===r.length&&this.reset():(t=this._tap.touchend(e,t,r))&&(this._tapTime=e.timeStamp,this._tapPoint=t)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class zn{constructor(e,t,r){this._el=e,this._mousePan=t,this._touchPan=r}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Fn{constructor(e,t,r){this._pitchWithRotate=e.pitchWithRotate,this._mouseRotate=t,this._mousePitch=r}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Bn{constructor(e,t,r,n){this._el=e,this._touchZoom=t,this._touchRotate=r,this._tapDragZoom=n,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Un{constructor(e,t){this._bypassKey=-1!==navigator.userAgent.indexOf("Mac")?"metaKey":"ctrlKey",this._map=e,this._options=t,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(!this._container){(t=this._map.getCanvasContainer()).classList.add("maplibregl-cooperative-gestures"),this._container=s.create("div","maplibregl-cooperative-gesture-screen",t);let r=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");"metaKey"===this._bypassKey&&(r=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));var e,t=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText");(e=((e=document.createElement("div")).className="maplibregl-desktop-message",e.textContent=r,this._container.appendChild(e),document.createElement("div"))).className="maplibregl-mobile-message",e.textContent=t,this._container.appendChild(e),this._container.setAttribute("aria-hidden","true")}}_destoryUI(){this._container&&(s.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destoryUI()}isEnabled(){return this._enabled}touchmove(e){this._onCooperativeGesture(1===e.touches.length)}wheel(e){this._map.scrollZoom.isEnabled()&&this._onCooperativeGesture(!e[this._bypassKey])}_onCooperativeGesture(e){this._enabled&&e&&(this._container.classList.add("maplibregl-show"),setTimeout((()=>{this._container.classList.remove("maplibregl-show")}),100))}}const jn=e=>e.zoom||e.drag||e.pitch||e.rotate;class qn extends t.Event{}function Hn(e){return e.panDelta&&e.panDelta.mag()||e.zoomDelta||e.bearingDelta||e.pitchDelta}class Vn{constructor(e,t){this.handleWindowEvent=e=>{this.handleEvent(e,e.type+"Window")},this.handleEvent=(e,t)=>{if("blur"===e.type)this.stop(!0);else{this._updatingCamera=!0;var r,n,i,o="renderFrame"===e.type?void 0:e,a={needsRenderFrame:!1},l={},c={},u=e.touches,h=u?this._getMapTouches(u):void 0,d=h?s.touchPos(this._map.getCanvas(),h):s.mousePos(this._map.getCanvas(),e);for({handlerName:r,handler:n,allowed:i}of this._handlers)if(n.isEnabled()){let s;this._blockedByActive(c,i,r)?n.reset():n[t||e.type]&&(s=n[t||e.type](e,d,h),this.mergeHandlerResult(a,l,s,r,o),s)&&s.needsRenderFrame&&this._triggerRenderFrame(),(s||n.isActive())&&(c[r]=n)}var p={};for(const e in this._previousActiveHandlers)c[e]||(p[e]=o);this._previousActiveHandlers=c,(Object.keys(p).length||Hn(a))&&(this._changes.push([a,l,p]),this._triggerRenderFrame()),(Object.keys(c).length||Hn(a))&&this._map._stop(!0),this._updatingCamera=!1,(u=a.cameraAnimation)&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],u(this._map))}},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Qr(e),this._bearingSnap=t.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(t);var r,n,i;e=this._el;for([r,n,i]of(this._listeners=[[e,"touchstart",{passive:!0}],[e,"touchmove",{passive:!1}],[e,"touchend",void 0],[e,"touchcancel",void 0],[e,"mousedown",void 0],[e,"mousemove",void 0],[e,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[e,"mouseover",void 0],[e,"mouseout",void 0],[e,"dblclick",void 0],[e,"click",void 0],[e,"keydown",{capture:!1}],[e,"keyup",void 0],[e,"wheel",{passive:!1}],[e,"contextmenu",void 0],[window,"blur",void 0]],this._listeners))s.addEventListener(r,n,r===document?this.handleWindowEvent:this.handleEvent,i)}destroy(){for(var[e,t,r]of this._listeners)s.removeEventListener(e,t,e===document?this.handleWindowEvent:this.handleEvent,r)}_addDefaultHandlers(e){var t=this._map,r=t.getCanvasContainer(),n=(this._add("mapEvent",new on(t,e)),t.boxZoom=new ln(t,e)),i=(n=(this._add("boxZoom",n),e.interactive&&e.boxZoom&&n.enable(),t.cooperativeGestures=new Un(t,e.cooperativeGestures)),n=(this._add("cooperativeGestures",n),e.cooperativeGestures&&n.enable(),new dn(t)),new Dn(t)),o=(n=(t.doubleClickZoom=new Ln(i,n),this._add("tapZoom",n),this._add("clickZoom",i),e.interactive&&e.doubleClickZoom&&t.doubleClickZoom.enable(),new Nn),i=(this._add("tapDragZoom",n),t.touchPitch=new kn(t)),i=(this._add("touchPitch",i),e.interactive&&e.touchPitch&&t.touchPitch.enable(e.touchPitch),vn(e)),_n(e));t.dragRotate=new Fn(e,i,o),this._add("mouseRotate",i,["mousePitch"]),this._add("mousePitch",o,["mouseRotate"]),e.interactive&&e.dragRotate&&t.dragRotate.enable(),i=(e=>{let{enable:t,clickTolerance:r}=e;var n=new mn({checkCorrectEvent:e=>0===s.mouseButton(e)&&!e.ctrlKey});return new pn({clickTolerance:r,move:(e,t)=>({around:t,panDelta:t.sub(e)}),activateOnStart:!0,moveStateManager:n,enable:t,assignEvents:yn})})(e),o=new bn(e,t),t.dragPan=new zn(r,i,o),this._add("mousePan",i),this._add("touchPan",o,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&t.dragPan.enable(e.dragPan),i=new Tn,o=new Sn,t.touchZoomRotate=new Bn(r,o,i,n),this._add("touchRotate",i,["touchPan","touchZoom"]),this._add("touchZoom",o,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&t.touchZoomRotate.enable(e.touchZoomRotate),r=t.scrollZoom=new On(t,(()=>this._triggerRenderFrame())),this._add("scrollZoom",r,["mousePan"]),e.interactive&&e.scrollZoom&&t.scrollZoom.enable(e.scrollZoom),n=t.keyboard=new Pn(t);this._add("keyboard",n),e.interactive&&e.keyboard&&t.keyboard.enable(),this._add("blockableMapEvent",new an(t))}_add(e,t,r){this._handlers.push({handlerName:e,handler:t,allowed:r}),this._handlersById[e]=t}stop(e){if(!this._updatingCamera){for(var{handler:t}of this._handlers)t.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(var{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(jn(this._eventsInProgress))||this.isZooming()}_blockedByActive(e,t,r){for(const n in e)if(n!==r&&(!t||t.indexOf(n)<0))return!0;return!1}_getMapTouches(e){var t=[];for(const n of e){var r=n.target;this._el.contains(r)&&t.push(n)}return t}mergeHandlerResult(e,r,n,i,o){n&&(t.extend(e,n),e={handlerName:i,originalEvent:n.originalEvent||o},void 0!==n.zoomDelta&&(r.zoom=e),void 0!==n.panDelta&&(r.drag=e),void 0!==n.pitchDelta&&(r.pitch=e),void 0!==n.bearingDelta)&&(r.rotate=e)}_applyChanges(){var e,r,n,i={},o={},a={};for([e,r,n]of this._changes)e.panDelta&&(i.panDelta=(i.panDelta||new t.Point(0,0))._add(e.panDelta)),e.zoomDelta&&(i.zoomDelta=(i.zoomDelta||0)+e.zoomDelta),e.bearingDelta&&(i.bearingDelta=(i.bearingDelta||0)+e.bearingDelta),e.pitchDelta&&(i.pitchDelta=(i.pitchDelta||0)+e.pitchDelta),void 0!==e.around&&(i.around=e.around),void 0!==e.pinchAround&&(i.pinchAround=e.pinchAround),e.noInertia&&(i.noInertia=e.noInertia),t.extend(o,r),t.extend(a,n);this._updateMapTransform(i,o,a),this._changes=[]}_updateMapTransform(e,t,r){const n=this._map,i=n._getTransformForUpdate();var o=n.terrain;if(!(Hn(e)||o&&this._terrainMovement))return this._fireEvents(t,r,!0);let{panDelta:a,zoomDelta:s,bearingDelta:l,pitchDelta:c,around:u,pinchAround:h}=e;void 0!==h&&(u=h),n._stop(!0),u=u||n.transform.centerPoint;var d=i.pointLocation(a?u.sub(a):u);l&&(i.bearing+=l),c&&(i.pitch+=c),s&&(i.zoom+=s),o?this._terrainMovement||!t.drag&&!t.zoom?t.drag&&this._terrainMovement?i.center=i.pointLocation(i.centerPoint.sub(a)):i.setLocationAtPoint(d,u):(this._terrainMovement=!0,this._map._elevationFreeze=!0,i.setLocationAtPoint(d,u),this._map.once("moveend",(()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,i.recalculateZoom(n.terrain)}))):i.setLocationAtPoint(d,u),n._applyUpdatedTransform(i),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(t,r,!0)}_fireEvents(e,r,n){var i=jn(this._eventsInProgress),o=jn(e),s={};for(const t in e){var l=e[t].originalEvent;this._eventsInProgress[t]||(s[t+"start"]=l),this._eventsInProgress[t]=e[t]}!i&&o&&this._fireEvent("movestart",o.originalEvent);for(const t in s)this._fireEvent(t,s[t]);o&&this._fireEvent("move",o.originalEvent);for(const t in e){var c=e[t].originalEvent;this._fireEvent(t,c)}var u={};let h;for(const t in this._eventsInProgress){var{handlerName:d,originalEvent:p}=this._eventsInProgress[t];this._handlersById[d].isActive()||(delete this._eventsInProgress[t],h=r[d]||p,u[t+"end"]=h)}for(const t in u)this._fireEvent(t,u[t]);var f=jn(this._eventsInProgress);n&&(i||o)&&!f&&(this._updatingCamera=!0,n=e=>0!==e&&-this._bearingSnap<e&&e<this._bearingSnap,!(i=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions))||!i.essential&&a.prefersReducedMotion?(this._map.fire(new t.Event("moveend",{originalEvent:h})),n(this._map.getBearing())&&this._map.resetNorth()):(n(i.bearing||this._map.getBearing())&&(i.bearing=0),i.freezeElevation=!0,this._map.easeTo(i,{originalEvent:h})),this._updatingCamera=!1)}_fireEvent(e,r){this._map.fire(new t.Event(e,r?{originalEvent:r}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((e=>{delete this._frameId,this.handleEvent(new qn("renderFrame",{timeStamp:e})),this._applyChanges()}))}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}class Gn extends t.Evented{constructor(e,t){super(),this._renderFrameCallback=()=>{var e=Math.min((a.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(e)),e<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=t.bearingSnap,this.on("moveend",(()=>{delete this._requestedCameraState}))}getCenter(){return new t.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(e,t){return this.jumpTo({center:e},t)}panBy(e,r,n){return e=t.Point.convert(e).mult(-1),this.panTo(this.transform.center,t.extend({offset:e},r),n)}panTo(e,r,n){return this.easeTo(t.extend({center:e},r),n)}getZoom(){return this.transform.zoom}setZoom(e,t){return this.jumpTo({zoom:e},t),this}zoomTo(e,r,n){return this.easeTo(t.extend({zoom:e},r),n)}zoomIn(e,t){return this.zoomTo(this.getZoom()+1,e,t),this}zoomOut(e,t){return this.zoomTo(this.getZoom()-1,e,t),this}getBearing(){return this.transform.bearing}setBearing(e,t){return this.jumpTo({bearing:e},t),this}getPadding(){return this.transform.padding}setPadding(e,t){return this.jumpTo({padding:e},t),this}rotateTo(e,r,n){return this.easeTo(t.extend({bearing:e},r),n)}resetNorth(e,r){return this.rotateTo(0,t.extend({duration:1e3},e),r),this}resetNorthPitch(e,r){return this.easeTo(t.extend({bearing:0,pitch:0,duration:1e3},e),r),this}snapToNorth(e,t){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,t):this}getPitch(){return this.transform.pitch}setPitch(e,t){return this.jumpTo({pitch:e},t),this}cameraForBounds(e,t){e=F.convert(e);var r=t&&t.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),r,t)}_cameraForBoxAndBearing(e,r,n,i){var o={top:0,bottom:0,right:0,left:0},a=("number"==typeof(i=t.extend({padding:o,offset:[0,0],maxZoom:this.transform.maxZoom},i)).padding&&(a=i.padding,i.padding={top:a,bottom:a,right:a,left:a}),i.padding=t.extend(o,i.padding),this.transform),s=(o=a.padding,e=new F(e,r),r=a.project(e.getNorthWest()),a.project(e.getNorthEast())),l=a.project(e.getSouthEast()),c=(e=a.project(e.getSouthWest()),t.degreesToRadians(-n)),u=r.rotate(c),h=(s=s.rotate(c),l.rotate(c));e=e.rotate(c),c=new t.Point(Math.max(u.x,s.x,e.x,h.x),Math.max(u.y,s.y,e.y,h.y)),u=new t.Point(Math.min(u.x,s.x,e.x,h.x),Math.min(u.y,s.y,e.y,h.y)),s=c.sub(u),e=(a.width-(o.left+o.right+i.padding.left+i.padding.right))/s.x;if(!((h=(a.height-(o.top+o.bottom+i.padding.top+i.padding.bottom))/s.y)<0||e<0))return c=Math.min(a.scaleZoom(a.scale*Math.min(e,h)),i.maxZoom),u=t.Point.convert(i.offset),o=(i.padding.left-i.padding.right)/2,s=(i.padding.top-i.padding.bottom)/2,e=new t.Point(o,s).rotate(t.degreesToRadians(n)),h=u.add(e).mult(a.scale/a.zoomScale(c)),{center:a.unproject(r.add(l).div(2).sub(h)),zoom:c,bearing:n};t.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}fitBounds(e,t,r){return this._fitInternal(this.cameraForBounds(e,t),t,r)}fitScreenCoordinates(e,r,n,i,o){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(t.Point.convert(e)),this.transform.pointLocation(t.Point.convert(r)),n,i),i,o)}_fitInternal(e,r,n){return e?(delete(r=t.extend(e,r)).padding,r.linear?this.easeTo(r,n):this.flyTo(r,n)):this}jumpTo(e,r){this.stop();var n=this._getTransformForUpdate();let i=!1,o=!1,a=!1;return"zoom"in e&&n.zoom!==+e.zoom&&(i=!0,n.zoom=+e.zoom),void 0!==e.center&&(n.center=t.LngLat.convert(e.center)),"bearing"in e&&n.bearing!==+e.bearing&&(o=!0,n.bearing=+e.bearing),"pitch"in e&&n.pitch!==+e.pitch&&(a=!0,n.pitch=+e.pitch),null==e.padding||n.isPaddingEqual(e.padding)||(n.padding=e.padding),this._applyUpdatedTransform(n),this.fire(new t.Event("movestart",r)).fire(new t.Event("move",r)),i&&this.fire(new t.Event("zoomstart",r)).fire(new t.Event("zoom",r)).fire(new t.Event("zoomend",r)),o&&this.fire(new t.Event("rotatestart",r)).fire(new t.Event("rotate",r)).fire(new t.Event("rotateend",r)),a&&this.fire(new t.Event("pitchstart",r)).fire(new t.Event("pitch",r)).fire(new t.Event("pitchend",r)),this.fire(new t.Event("moveend",r))}calculateCameraOptionsFromTo(e,r,n){var i=this;return function(e,r,n,o){e=t.MercatorCoordinate.fromLngLat(e,r),n=(r=t.MercatorCoordinate.fromLngLat(n,o)).x-e.x,o=r.y-e.y,e=r.z-e.z;var a=Math.hypot(n,o,e);if(0===a)throw new Error("Can't calculate camera options with same From and To");var s=Math.hypot(n,o),l=i.transform.scaleZoom(i.transform.cameraToCenterDistance/a/i.transform.tileSize);n=180*Math.atan2(n,-o)/Math.PI,o=180*Math.acos(s/a)/Math.PI,o=e<0?90-o:90+o;return{center:r.toLngLat(),zoom:l,pitch:o,bearing:n}}(e,r,n,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0)}easeTo(e,r){this._stop(!1,e.easeId),(!1===(e=t.extend({offset:[0,0],duration:500,easing:t.defaultEasing},e)).animate||!e.essential&&a.prefersReducedMotion)&&(e.duration=0);const n=this._getTransformForUpdate(),i=this.getZoom(),o=this.getBearing(),s=this.getPitch(),l=this.getPadding(),c="bearing"in e?this._normalizeBearing(e.bearing,o):o,u="pitch"in e?+e.pitch:s,h=("padding"in e?e:n).padding,d=t.Point.convert(e.offset);let p=n.centerPoint.add(d);var f=n.pointLocation(p);const{center:m,zoom:g}=n.getConstrained(t.LngLat.convert(e.center||f),null!=(x=e.zoom)?x:i),y=(this._normalizeCenter(m),n.project(f)),v=n.project(m).sub(y),_=n.zoomScale(g-i);let b,w;e.around&&(b=t.LngLat.convert(e.around),w=n.locationPoint(b));var x={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||g!==i,this._rotating=this._rotating||o!==c,this._pitching=this._pitching||u!==s,this._padding=!n.isPaddingEqual(h),this._easeId=e.easeId,this._prepareEase(r,e.noMoveStart,x),this.terrain&&this._prepareElevation(m),this._ease((a=>{var f,m;this._zooming&&(n.zoom=t.interpolate.number(i,g,a)),this._rotating&&(n.bearing=t.interpolate.number(o,c,a)),this._pitching&&(n.pitch=t.interpolate.number(s,u,a)),this._padding&&(n.interpolatePadding(l,h,a),p=n.centerPoint.add(d)),this.terrain&&!e.freezeElevation&&this._updateElevation(a),b?n.setLocationAtPoint(b,w):(f=n.zoomScale(n.zoom-i),m=g>i?Math.min(2,_):Math.max(.5,_),m=Math.pow(m,1-a),a=n.unproject(y.add(v.mult(a*m)).mult(f)),n.setLocationAtPoint(n.renderWorldCopies?a.wrap():a,p)),this._applyUpdatedTransform(n),this._fireMoveEvents(r)}),(e=>{this.terrain&&this._finalizeElevation(),this._afterEase(r,e)}),e),this}_prepareEase(e,r){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._moving=!0,r||n.moving||this.fire(new t.Event("movestart",e)),this._zooming&&!n.zooming&&this.fire(new t.Event("zoomstart",e)),this._rotating&&!n.rotating&&this.fire(new t.Event("rotatestart",e)),this._pitching&&!n.pitching&&this.fire(new t.Event("pitchstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);var r,n,i=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);e<1&&i!==this._elevationTarget&&(n=(i-((r=this._elevationTarget-this._elevationStart)*e+this._elevationStart))/(1-e),this._elevationStart+=e*(r-n),this._elevationTarget=i),this.transform.elevation=t.interpolate.number(this._elevationStart,this._elevationTarget,e)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(e){var t,r,n,i,o;this.transformCameraUpdate&&(e=e.clone(),({center:t,zoom:r,pitch:n,bearing:i,elevation:o}=this.transformCameraUpdate(e)),t&&(e.center=t),void 0!==r&&(e.zoom=r),void 0!==n&&(e.pitch=n),void 0!==i&&(e.bearing=i),void 0!==o&&(e.elevation=o),this.transform.apply(e))}_fireMoveEvents(e){this.fire(new t.Event("move",e)),this._zooming&&this.fire(new t.Event("zoom",e)),this._rotating&&this.fire(new t.Event("rotate",e)),this._pitching&&this.fire(new t.Event("pitch",e))}_afterEase(e,r){var n,i;this._easeId&&r&&this._easeId===r||(delete this._easeId,this.fire(new t.Event("freezeElevation",{freeze:!1})),r=this._zooming,n=this._rotating,i=this._pitching,this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,r&&this.fire(new t.Event("zoomend",e)),n&&this.fire(new t.Event("rotateend",e)),i&&this.fire(new t.Event("pitchend",e)),this.fire(new t.Event("moveend",e)))}flyTo(e,r){if(!e.essential&&a.prefersReducedMotion)return f=t.pick(e,["center","zoom","bearing","pitch","around"]),this.jumpTo(f,r);this.stop(),e=t.extend({offset:[0,0],speed:1.2,curve:1.42,easing:t.defaultEasing},e);const n=this._getTransformForUpdate(),i=this.getZoom(),o=this.getBearing(),s=this.getPitch(),l=this.getPadding(),c="bearing"in e?this._normalizeBearing(e.bearing,o):o,u="pitch"in e?+e.pitch:s,h=("padding"in e?e:n).padding,d=t.Point.convert(e.offset);let p=n.centerPoint.add(d);var f=n.pointLocation(p);const{center:m,zoom:g}=n.getConstrained(t.LngLat.convert(e.center||f),null!=(y=e.zoom)?y:i);this._normalizeCenter(m);var y=n.zoomScale(g-i);const v=n.project(f),_=n.project(m).sub(v);let b=e.curve;const w=Math.max(n.width,n.height),x=w/y,C=_.mag(),S=("minZoom"in e&&(f=t.clamp(Math.min(e.minZoom,i,g),n.minZoom,n.maxZoom),y=w/n.zoomScale(f-i),b=Math.sqrt(y/C*2)),b*b);function E(e){return e=(x*x-w*w+(e?-1:1)*S*S*C*C)/(2*(e?x:w)*S*C),Math.log(Math.sqrt(e*e+1)-e)}function T(e){return(Math.exp(e)-Math.exp(-e))/2}function I(e){return(Math.exp(e)+Math.exp(-e))/2}const k=E(!1);let A=function(e){return I(k)/I(k+b*e)},P=function(e){return w*((I(k)*(T(e=k+b*e)/I(e))-T(k))/S)/C},M=(E(!0)-k)/b;if(Math.abs(C)<1e-6||!isFinite(M)){if(Math.abs(w-x)<1e-6)return this.easeTo(e,r);const t=x<w?-1:1;M=Math.abs(Math.log(x/w))/b,P=function(){return 0},A=function(e){return Math.exp(t*b*e)}}return"duration"in e?e.duration=+e.duration:(f="screenSpeed"in e?+e.screenSpeed/b:+e.speed,e.duration=1e3*M/f),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=o!==c,this._pitching=u!==s,this._padding=!n.isPaddingEqual(h),this._prepareEase(r,!1),this.terrain&&this._prepareElevation(m),this._ease((a=>{var f=a*M,y=1/A(f);n.zoom=1===a?g:i+n.scaleZoom(y),this._rotating&&(n.bearing=t.interpolate.number(o,c,a)),this._pitching&&(n.pitch=t.interpolate.number(s,u,a)),this._padding&&(n.interpolatePadding(l,h,a),p=n.centerPoint.add(d)),this.terrain&&!e.freezeElevation&&this._updateElevation(a),a=1===a?m:n.unproject(v.add(_.mult(P(f))).mult(y));n.setLocationAtPoint(n.renderWorldCopies?a.wrap():a,p),this._applyUpdatedTransform(n),this._fireMoveEvents(r)}),(()=>{this.terrain&&this._finalizeElevation(),this._afterEase(r)}),e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,t){var r;return this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd&&(r=this._onEaseEnd,delete this._onEaseEnd,r.call(this,t)),e||(r=this.handlers)&&r.stop(!1),this}_ease(e,t,r){!1===r.animate||0===r.duration?(e(1),t()):(this._easeStart=a.now(),this._easeOptions=r,this._onEaseFrame=e,this._onEaseEnd=t,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,r){e=t.wrap(e,-180,180);var n=Math.abs(e-r);return Math.abs(e-360-r)<n&&(e-=360),Math.abs(e+360-r)<n&&(e+=360),e}_normalizeCenter(e){var t=this.transform;t.renderWorldCopies&&!t.lngRange&&(t=e.lng-t.center.lng,e.lng+=180<t?-360:t<-180?360:0)}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(t.LngLat.convert(e),this.transform.tileZoom)-this.transform.elevation:null}}const Kn={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Zn{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Kn;this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=e=>{!e||"metadata"!==e.sourceDataType&&"visibility"!==e.sourceDataType&&"style"!==e.dataType&&"terrain"!==e.type||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1===this._compact?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=s.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=s.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=s.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){s.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,t){t=this._map._getUIString("AttributionControl."+t),e.title=t,e.setAttribute("aria-label",t)}_updateAttributions(){if(this._map.style){let n=[];this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=n.concat(this.options.customAttribution.map((e=>"string"!=typeof e?"":e))):"string"==typeof this.options.customAttribution&&n.push(this.options.customAttribution)),this._map.style.stylesheet&&(r=this._map.style.stylesheet,this.styleOwner=r.owner,this.styleId=r.id);var e=this._map.style.sourceCaches;for(const r in e){var t=e[r];(t.used||t.usedForTerrain)&&(t=t.getSource()).attribution&&n.indexOf(t.attribution)<0&&n.push(t.attribution)}(n=n.filter((e=>String(e).trim()))).sort(((e,t)=>e.length-t.length));var r=(n=n.filter(((e,t)=>{for(let r=t+1;r<n.length;r++)if(0<=n[r].indexOf(e))return!1;return!0}))).join(" | ");r!==this._attribHTML&&(this._attribHTML=r,n.length?(this._innerContainer.innerHTML=r,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}}class Wn{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._updateCompact=()=>{var e=this._container.children;e.length&&(e=e[0],this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1!==this._compact&&e.classList.add("maplibregl-compact"):e.classList.remove("maplibregl-compact"))},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){return this._map=e,this._compact=this.options&&this.options.compact,this._container=s.create("div","maplibregl-ctrl"),(e=s.create("a","maplibregl-ctrl-logo")).target="_blank",e.rel="noopener nofollow",e.href="https://maplibre.org/",e.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),e.setAttribute("rel","noopener nofollow"),this._container.appendChild(e),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){s.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class $n{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){var t=++this._id;return this._queue.push({callback:e,id:t,cancelled:!1}),t}remove(e){var t=this._currentlyRunning;for(const r of t?this._queue.concat(t):this._queue)if(r.id===e)return void(r.cancelled=!0)}run(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");var t=this._currentlyRunning=this._queue;this._queue=[];for(const r of t)if(!r.cancelled&&(r.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Yn=t.createLayout([{name:"a_pos3d",type:"Int16",components:3}]);class Xn extends t.Evented{constructor(e){super(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,e.usedForTerrain=!0,e.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,r){this.sourceCache.update(e,r),this._renderableTilesKeys=[];var n={};for(const i of e.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:r}))n[i.key]=!0,this._renderableTilesKeys.push(i.key),this._tiles[i.key]||(i.posMatrix=new Float64Array(16),t.ortho(i.posMatrix,0,t.EXTENT,0,t.EXTENT,0,1),this._tiles[i.key]=new ee(i,this.tileSize));for(const t in this._tiles)n[t]||delete this._tiles[t]}freeRtt(e){for(const r in this._tiles){var t=this._tiles[r];(!e||t.tileID.equals(e)||t.tileID.isChildOf(e)||e.isChildOf(t.tileID))&&(t.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((e=>this.getTileByID(e)))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e){var r={};for(const c of this._renderableTilesKeys){var n,i,o,a,s,l=this._tiles[c].tileID;l.canonical.equals(e.canonical)?((n=e.clone()).posMatrix=new Float64Array(16),t.ortho(n.posMatrix,0,t.EXTENT,0,t.EXTENT,0,1),r[c]=n):l.canonical.isChildOf(e.canonical)?((n=e.clone()).posMatrix=new Float64Array(16),a=l.canonical.z-e.canonical.z,i=l.canonical.x-(l.canonical.x>>a<<a),o=l.canonical.y-(l.canonical.y>>a<<a),a=t.EXTENT>>a,t.ortho(n.posMatrix,0,a,0,a,0,1),t.translate(n.posMatrix,n.posMatrix,[-i*a,-o*a,0]),r[c]=n):e.canonical.isChildOf(l.canonical)&&((i=e.clone()).posMatrix=new Float64Array(16),o=e.canonical.z-l.canonical.z,a=e.canonical.x-(e.canonical.x>>o<<o),l=e.canonical.y-(e.canonical.y>>o<<o),s=t.EXTENT>>o,t.ortho(i.posMatrix,0,t.EXTENT,0,t.EXTENT,0,1),t.translate(i.posMatrix,i.posMatrix,[a*s,l*s,0]),t.scale(i.posMatrix,i.posMatrix,[1/2**o,1/2**o,0]),r[c]=i)}return r}getSourceTile(e,t){var r=this.sourceCache._source;let n=e.overscaledZ-this.deltaZoom;if((n=n>r.maxzoom?r.maxzoom:n)<r.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(n).key);let i=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!i||!i.dem)&&t)for(;n>=r.minzoom&&(!i||!i.dem);)i=this.sourceCache.getTileByID(e.scaledTo(n--).key);return i}tilesAfterTime(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();return Object.values(this._tiles).filter((t=>t.timeAdded>=e))}}class Qn{constructor(e,t,r){this.painter=e,this.sourceCache=new Xn(t),this.options=r,this.exaggeration="number"==typeof r.exaggeration?r.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,r,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.EXTENT;var o;return 0<=r&&r<i&&0<=n&&n<i&&(o=null==(o=(e=this.getTerrainData(e)).tile)?void 0:o.dem)?(n=[(r=t.transformMat4$1([],[r/i*t.EXTENT,n/i*t.EXTENT],e.u_terrain_matrix))[0]*o.dim,r[1]*o.dim],i=Math.floor(n[0]),e=Math.floor(n[1]),r=n[0]-i,n=n[1]-e,o.get(i,e)*(1-r)*(1-n)+o.get(i+1,e)*r*(1-n)+o.get(i,e+1)*(1-r)*n+o.get(i+1,e+1)*r*n):0}getElevationForLngLatZoom(e,r){var{tileID:e,mercatorX:r,mercatorY:n}=this._getOverscaledTileIDFromLngLatZoom(e,r);return this.getElevation(e,r%t.EXTENT,n%t.EXTENT,t.EXTENT)}getElevation(e,r,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.EXTENT;return this.getDEMElevation(e,r,n,i)*this.exaggeration}getTerrainData(e){this._emptyDemTexture||(n=this.painter.context,r=new t.RGBAImage({width:1,height:1},new Uint8Array(4)),this._emptyDepthTexture=new y(n,r,n.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new y(n,new t.RGBAImage({width:1,height:1}),n.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(n.gl.NEAREST,n.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=t.identity([]));var r=this.sourceCache.getSourceTile(e,!0),n=(r&&r.dem&&(!r.demTexture||r.needsTerrainPrepare)&&(n=this.painter.context,r.demTexture=this.painter.getTileTexture(r.dem.stride),r.demTexture?r.demTexture.update(r.dem.getPixels(),{premultiply:!1}):r.demTexture=new y(n,r.dem.getPixels(),n.gl.RGBA,{premultiply:!1}),r.demTexture.bind(n.gl.NEAREST,n.gl.CLAMP_TO_EDGE),r.needsTerrainPrepare=!1),r&&r+r.tileID.key+e.key);if(n&&!this._demMatrixCache[n]){var i=this.sourceCache.sourceCache._source.maxzoom;let n=e.canonical.z-r.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=i?n=e.canonical.z-i:t.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));i=e.canonical.x-(e.canonical.x>>n<<n);var o=e.canonical.y-(e.canonical.y>>n<<n),a=t.fromScaling(new Float64Array(16),[1/(t.EXTENT<<n),1/(t.EXTENT<<n),0]);t.translate(a,a,[i*t.EXTENT,o*t.EXTENT,0]),this._demMatrixCache[e.key]={matrix:a,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:r&&r.dem&&r.dem.dim||1,u_terrain_matrix:n?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:r&&r.dem&&r.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(r&&r.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:r}}getFramebuffer(e){var t=this.painter,r=t.width/devicePixelRatio,n=t.height/devicePixelRatio;return!this._fbo||this._fbo.width===r&&this._fbo.height===n||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new y(t.context,{width:r,height:n,data:null},t.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(t.context.gl.NEAREST,t.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new y(t.context,{width:r,height:n,data:null},t.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(t.context.gl.NEAREST,t.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=t.context.createFramebuffer(r,n,!0,!1),this._fbo.depthAttachment.set(t.context.createRenderbuffer(t.context.gl.DEPTH_COMPONENT16,r,n))),this._fbo.colorAttachment.set(("coords"===e?this._fboCoordsTexture:this._fboDepthTexture).texture),this._fbo}getCoordsTexture(){var e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;var r=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let t=0,i=0;t<this._coordsTextureSize;t++)for(let e=0;e<this._coordsTextureSize;e++,i+=4)r[i+0]=255&e,r[i+1]=255&t,r[i+2]=e>>8<<4|t>>8,r[i+3]=0;var n=new t.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(r.buffer));return(n=new y(e,n,e.gl.RGBA,{premultiply:!1})).bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=n}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);var r=new Uint8Array(4),n=this.painter.context,i=n.gl,o=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),a=(e=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),Math.round(this.painter.height/devicePixelRatio));n.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),i.readPixels(o,a-e-1,1,1,i.RGBA,i.UNSIGNED_BYTE,r),n.bindFramebuffer.set(null),o=r[0]+(r[2]>>4<<8),a=r[1]+((15&r[2])<<8);return(i=(e=this.coordsIndex[255-r[3]])&&this.sourceCache.getTileByID(e))?(n=this._coordsTextureSize,r=(1<<i.tileID.canonical.z)*n,new t.MercatorCoordinate((i.tileID.canonical.x*n+o)/r+i.tileID.wrap,(i.tileID.canonical.y*n+a)/r,this.getElevation(i.tileID,o,a,n))):null}depthAtPoint(e){var t=new Uint8Array(4),r=this.painter.context,n=r.gl;return e=(r.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),n.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,n.RGBA,n.UNSIGNED_BYTE,t),r.bindFramebuffer.set(null),(t[0]/16777216+t[1]/65536+t[2]/256+t[3])/256)}getTerrainMesh(){if(!this._mesh){var e=this.painter.context,r=new t.Pos3dArray,n=new t.TriangleIndexArray,i=this.meshSize,o=t.EXTENT/i,a=i*i;for(let e=0;e<=i;e++)for(let t=0;t<=i;t++)r.emplaceBack(t*o,e*o,0);for(let e=0;e<a;e+=i+1)for(let t=0;t<i;t++)n.emplaceBack(t+e,i+t+e+1,i+t+e+2),n.emplaceBack(t+e,i+t+e+2,t+e+1);var s=r.length,l=s+2*(i+1);for(const e of[0,1])for(let n=0;n<=i;n++)for(const i of[0,1])r.emplaceBack(n*o,e*t.EXTENT,i);for(let e=0;e<2*i;e+=2)n.emplaceBack(l+e,l+e+1,l+e+3),n.emplaceBack(l+e,l+e+3,l+e+2),n.emplaceBack(s+e,s+e+3,s+e+1),n.emplaceBack(s+e,s+e+2,s+e+3);var c=r.length,u=c+2*(i+1);for(const e of[0,1])for(let n=0;n<=i;n++)for(const i of[0,1])r.emplaceBack(e*t.EXTENT,n*o,i);for(let e=0;e<2*i;e+=2)n.emplaceBack(c+e,c+e+1,c+e+3),n.emplaceBack(c+e,c+e+3,c+e+2),n.emplaceBack(u+e,u+e+3,u+e+1),n.emplaceBack(u+e,u+e+2,u+e+3);this._mesh={indexBuffer:e.createIndexBuffer(n),vertexBuffer:e.createVertexBuffer(r,Yn.members),segments:t.SegmentVector.simpleSegment(0,0,r.length,n.length)}}return this._mesh}getMeshFrameDelta(e){return 2*Math.PI*t.earthRadius/Math.pow(2,e)/5}getMinTileElevationForLngLatZoom(e,t){return e=this._getOverscaledTileIDFromLngLatZoom(e,t).tileID,null!=(t=this.getMinMaxElevation(e).minElevation)?t:0}getMinMaxElevation(e){var t={minElevation:null,maxElevation:null};return(e=this.getTerrainData(e).tile)&&e.dem&&(t.minElevation=e.dem.min*this.exaggeration,t.maxElevation=e.dem.max*this.exaggeration),t}_getOverscaledTileIDFromLngLatZoom(e,r){e=t.MercatorCoordinate.fromLngLat(e.wrap());var n=(1<<r)*t.EXTENT,i=e.x*n,o=(e=e.y*n,n=Math.floor(i/t.EXTENT),Math.floor(e/t.EXTENT));return{tileID:new t.OverscaledTileID(r,0,r,n,o),mercatorX:i,mercatorY:e}}}class Jn{constructor(e,t,r){this._context=e,this._size=t,this._tileSize=r,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){var t=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),r=new y(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return r.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),t.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),t.colorAttachment.set(r.texture),{id:e,fbo:t,texture:r,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((t=>e.id!==t)),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const t of this._recentlyUsed)if(!this._objects[t].inUse)return this._objects[t];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");var e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&!1===this._objects.some((e=>!e.inUse))}}const ei={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class ti{constructor(e,t){this.painter=e,this.terrain=t,this.pool=new Jn(e.context,30,t.sourceCache.tileSize*t.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,t){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter((r=>!e._layers[r].isHidden(t))),this._coordsDescendingInv={};for(const a in e.sourceCaches){this._coordsDescendingInv[a]={};for(const t of e.sourceCaches[a].getVisibleCoordinates()){var r=this.terrain.sourceCache.getTerrainCoords(t);for(const e in r)this._coordsDescendingInv[a][e]||(this._coordsDescendingInv[a][e]=[]),this._coordsDescendingInv[a][e].push(r[e])}}this._coordsDescendingInvStr={};for(const a of e._order){var n=e._layers[a],i=n.source;if(ei[n.type]&&!this._coordsDescendingInvStr[i]){this._coordsDescendingInvStr[i]={};for(const e in this._coordsDescendingInv[i])this._coordsDescendingInvStr[i][e]=this._coordsDescendingInv[i][e].map((e=>e.key)).sort().join()}}for(const a of this._renderableTiles)for(const e in this._coordsDescendingInvStr){var o=this._coordsDescendingInvStr[e][a.tileID.key];o&&o!==a.rttCoords[e]&&(a.rtt=[])}}renderLayer(e){if(!e.isHidden(this.painter.transform.zoom)){var r=e.type,n=this.painter,i=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(ei[r]&&(this._prevType&&ei[this._prevType]||this._stacks.push([]),this._prevType=r,this._stacks[this._stacks.length-1].push(e.id),!i))return!0;if(ei[this._prevType]||ei[r]&&i){this._prevType=r;var o=this._stacks.length-1,a=this._stacks[o]||[];for(const e of this._renderableTiles){if(this.pool.isFull()&&(Br(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(e),e.rtt[o]){var s=this.pool.getObjectForId(e.rtt[o].id);if(s.stamp===e.rtt[o].stamp){this.pool.useObject(s);continue}}var l=this.pool.getOrCreateFreeObject();this.pool.useObject(l),this.pool.stampObject(l),e.rtt[o]={id:l.id,stamp:l.stamp},n.context.bindFramebuffer.set(l.fbo.framebuffer),n.context.clear({color:t.Color.transparent,stencil:0}),n.currentStencilSource=void 0;for(let t=0;t<a.length;t++){const r=n.style._layers[a[t]];var c=r.source?this._coordsDescendingInv[r.source][e.tileID.key]:[e.tileID];n.context.viewport.set([0,0,l.fbo.width,l.fbo.height]),n._renderTileClippingMasks(r,c),n.renderLayer(n,n.style.sourceCaches[r.source],r,c),r.source&&(e.rttCoords[r.source]=this._coordsDescendingInvStr[r.source][e.tileID.key])}}return Br(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),ei[r]}}return!1}}const ri={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use \u2318 + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},ni=n,ii={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:Kn,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:t.config.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]};tt=class extends Gn{constructor(e){if(t.PerformanceUtils.mark(t.PerformanceMarkers.create),null!=(e=t.extend({},ii,e)).minZoom&&null!=e.maxZoom&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=e.minPitch&&null!=e.maxPitch&&e.minPitch>e.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=e.minPitch&&e.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=e.maxPitch&&85<e.maxPitch)throw new Error("maxPitch must be less than or equal to 85");if(super(new Gr(e.minZoom,e.maxZoom,e.minPitch,e.maxPitch,e.renderWorldCopies),{bearingSnap:e.bearingSnap}),this._contextLost=e=>{e.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new t.Event("webglcontextlost",{originalEvent:e}))},this._contextRestored=e=>{this._setupPainter(),this.resize(),this._update(),this.fire(new t.Event("webglcontextrestored",{originalEvent:e}))},this._onMapScroll=e=>{if(e.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=e.interactive,this._maxTileCacheSize=e.maxTileCacheSize,this._maxTileCacheZoomLevels=e.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=e.preserveDrawingBuffer,this._antialias=e.antialias,this._trackResize=e.trackResize,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles,this._fadeDuration=e.fadeDuration,this._crossSourceCollisions=e.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=e.collectResourceTiming,this._renderTaskQueue=new $n,this._controls=[],this._mapId=t.uniqueId(),this._locale=t.extend({},ri,e.locale),this._clickTolerance=e.clickTolerance,this._overridePixelRatio=e.pixelRatio,this._maxCanvasSize=e.maxCanvasSize,this.transformCameraUpdate=e.transformCameraUpdate,this._imageQueueHandle=r.addThrottleControl((()=>this.isMoving())),this._requestManager=new f(e.transformRequest),"string"==typeof e.container){if(this._container=document.getElementById(e.container),!this._container)throw new Error(`Container '${e.container}' not found.`)}else{if(!(e.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=e.container}if(e.maxBounds&&this.setMaxBounds(e.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this.on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})),this.once("idle",(()=>{this._idleTriggered=!0})),"undefined"!=typeof window){addEventListener("online",this._onWindowOnline,!1);let e=!1;const t=Kr((e=>{this._trackResize&&!this._removed&&this.resize(e)._update()}),50);this._resizeObserver=new ResizeObserver((r=>{e?t(r):e=!0})),this._resizeObserver.observe(this._container)}this.handlers=new Vn(this,e);var n="string"==typeof e.hash&&e.hash||void 0;this._hash=e.hash&&new Zr(n).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}),e.bounds&&(this.resize(),this.fitBounds(e.bounds,t.extend({},e.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=e.localIdeographFontFamily,this._validateStyle=e.validateStyle,e.style&&this.setStyle(e.style,{localIdeographFontFamily:e.localIdeographFontFamily}),e.attributionControl&&this.addControl(new Zn("boolean"==typeof e.attributionControl?void 0:e.attributionControl)),e.maplibreLogo&&this.addControl(new Wn,e.logoPosition),this.on("style.load",(()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)})),this.on("data",(e=>{this._update("style"===e.dataType),this.fire(new t.Event(e.dataType+"data",e))})),this.on("dataloading",(e=>{this.fire(new t.Event(e.dataType+"dataloading",e))})),this.on("dataabort",(e=>{this.fire(new t.Event("sourcedataabort",e))}))}_getMapId(){return this._mapId}addControl(e,r){var n;return void 0===r&&(r=e.getDefaultPosition?e.getDefaultPosition():"top-right"),e&&e.onAdd?(n=e.onAdd(this),this._controls.push(e),e=this._controlPositions[r],-1!==r.indexOf("bottom")?e.insertBefore(n,e.firstChild):e.appendChild(n),this):this.fire(new t.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")))}removeControl(e){var r;return e&&e.onRemove?(-1<(r=this._controls.indexOf(e))&&this._controls.splice(r,1),e.onRemove(this),this):this.fire(new t.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")))}hasControl(e){return-1<this._controls.indexOf(e)}calculateCameraOptionsFromTo(e,t,r,n){return null==n&&this.terrain&&(n=this.terrain.getElevationForLngLatZoom(r,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(e,t,r,n)}resize(e){var r=(n=this._containerDimensions())[0],n=n[1];const i=this._getClampedPixelRatio(r,n);if(this._resizeCanvas(r,n,i),this.painter.resize(r,n,i),this.painter.overLimit()){var o=this.painter.context.gl;this._maxCanvasSize=[o.drawingBufferWidth,o.drawingBufferHeight];const e=this._getClampedPixelRatio(r,n);this._resizeCanvas(r,n,e),this.painter.resize(r,n,e)}return this.transform.resize(r,n),null!=(o=this._requestedCameraState)&&o.resize(r,n),(o=!this._moving)&&(this.stop(),this.fire(new t.Event("movestart",e)).fire(new t.Event("move",e))),this.fire(new t.Event("resize",e)),o&&this.fire(new t.Event("moveend",e)),this}_getClampedPixelRatio(e,t){var{0:r,1:n}=this._maxCanvasSize,i=this.getPixelRatio();e*=i,t*=i;return Math.min(r<e?r/e:1,n<t?n/t:1)*i}getPixelRatio(){var e;return null!=(e=this._overridePixelRatio)?e:devicePixelRatio}setPixelRatio(e){this._overridePixelRatio=e,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(e){return this.transform.setMaxBounds(F.convert(e)),this._update()}setMinZoom(e){if(-2<=(e=null==e?-2:e)&&e<=this.transform.maxZoom)return this.transform.minZoom=e,this._update(),this.getZoom()<e&&this.setZoom(e),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(e){if((e=null==e?22:e)>=this.transform.minZoom)return this.transform.maxZoom=e,this._update(),this.getZoom()>e&&this.setZoom(e),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(e){if((e=null==e?0:e)<0)throw new Error("minPitch must be greater than or equal to 0");if(0<=e&&e<=this.transform.maxPitch)return this.transform.minPitch=e,this._update(),this.getPitch()<e&&this.setPitch(e),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(e){if(85<(e=null==e?60:e))throw new Error("maxPitch must be less than or equal to 85");if(e>=this.transform.minPitch)return this.transform.maxPitch=e,this._update(),this.getPitch()>e&&this.setPitch(e),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(e){return this.transform.renderWorldCopies=e,this._update()}project(e){return this.transform.locationPoint(t.LngLat.convert(e),this.style&&this.terrain)}unproject(e){return this.transform.pointLocation(t.Point.convert(e),this.terrain)}isMoving(){var e;return this._moving||(null==(e=this.handlers)?void 0:e.isMoving())}isZooming(){var e;return this._zooming||(null==(e=this.handlers)?void 0:e.isZooming())}isRotating(){var e;return this._rotating||(null==(e=this.handlers)?void 0:e.isRotating())}_createDelegatedListener(e,t,r){if("mouseenter"===e||"mouseover"===e){let n=!1;return{layer:t,listener:r,delegates:{mousemove:i=>{var o=this.getLayer(t)?this.queryRenderedFeatures(i.point,{layers:[t]}):[];o.length?n||(n=!0,r.call(this,new tn(e,this,i.originalEvent,{features:o}))):n=!1},mouseout:()=>{n=!1}}}}if("mouseleave"!==e&&"mouseout"!==e)return{layer:t,listener:r,delegates:{[e]:e=>{var n=this.getLayer(t)?this.queryRenderedFeatures(e.point,{layers:[t]}):[];n.length&&(e.features=n,r.call(this,e),delete e.features)}}};{let n=!1;return{layer:t,listener:r,delegates:{mousemove:i=>{(this.getLayer(t)?this.queryRenderedFeatures(i.point,{layers:[t]}):[]).length?n=!0:n&&(n=!1,r.call(this,new tn(e,this,i.originalEvent)))},mouseout:t=>{n&&(n=!1,r.call(this,new tn(e,this,t.originalEvent)))}}}}}on(e,t,r){if(void 0===r)return super.on(e,t);var n=this._createDelegatedListener(e,t,r);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[e]=this._delegatedListeners[e]||[],this._delegatedListeners[e].push(n);for(const i in n.delegates)this.on(i,n.delegates[i]);return this}once(e,t,r){if(void 0===r)return super.once(e,t);var n=this._createDelegatedListener(e,t,r);for(const i in n.delegates)this.once(i,n.delegates[i]);return this}off(e,t,r){return void 0===r?super.off(e,t):(this._delegatedListeners&&this._delegatedListeners[e]&&(()=>{var n=this._delegatedListeners[e];for(let e=0;e<n.length;e++){var i=n[e];if(i.layer===t&&i.listener===r){for(const e in i.delegates)this.off(e,i.delegates[e]);return n.splice(e,1),this}}})(),this)}queryRenderedFeatures(e,r){if(!this.style)return[];let n;var i=e instanceof t.Point||Array.isArray(e),o=i?e:[[0,0],[this.transform.width,this.transform.height]];return r=r||(i?{}:e)||{},n=o instanceof t.Point||"number"==typeof o[0]?[t.Point.convert(o)]:(i=t.Point.convert(o[0]),e=t.Point.convert(o[1]),[i,new t.Point(e.x,i.y),e,new t.Point(i.x,e.y),i]),this.style.queryRenderedFeatures(n,r,this.transform)}querySourceFeatures(e,t){return this.style.querySourceFeatures(e,t)}setStyle(e,r){return!1!==(r=t.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},r)).diff&&r.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&e?(this._diffStyle(e,r),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._updateStyle(e,r))}setTransformRequest(e){return this._requestManager.setTransformRequest(e),this}_getUIString(e){var t=this._locale[e];if(null==t)throw new Error(`Missing UI string '${e}'`);return t}_updateStyle(e,t){var r;if(!t.transformStyle||!this.style||this.style._loaded)return r=this.style&&t.transformStyle?this.style.serialize():void 0,this.style&&(this.style.setEventedParent(null),this.style._remove(!e)),e?(this.style=new Je(this,t||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof e?this.style.loadURL(e,t,r):this.style.loadJSON(e,t,r)):delete this.style,this;this.style.once("style.load",(()=>this._updateStyle(e,t)))}_lazyInitEmptyStyle(){this.style||(this.style=new Je(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(e,r){var n;"string"==typeof e?(n=this._requestManager.transformRequest(e,"Style"),t.getJSON(n,new AbortController).then((e=>{this._updateDiff(e.data,r)})).catch((e=>{e&&this.fire(new t.ErrorEvent(e))}))):"object"==typeof e&&this._updateDiff(e,r)}_updateDiff(r,n){try{this.style.setState(r,n)&&this._update(!0)}catch(e){t.warnOnce(`Unable to perform style diff: ${e.message||e.error||e}.  Rebuilding the style from scratch.`),this._updateStyle(r,n)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():t.warnOnce("There is no style added to the map.")}addSource(e,t){return this._lazyInitEmptyStyle(),this.style.addSource(e,t),this._update(!0)}isSourceLoaded(e){var r=this.style&&this.style.sourceCaches[e];if(void 0!==r)return r.loaded();this.fire(new t.ErrorEvent(new Error(`There is no source with ID '${e}'`)))}setTerrain(e){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),e){var r=this.style.sourceCaches[e.source];if(!r)throw new Error("cannot load terrain, because there exists no source with ID: "+e.source);null===this.terrain&&r.reload();for(const r in this.style._layers){var n=this.style._layers[r];"hillshade"===n.type&&n.source===e.source&&t.warnOnce("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Qn(this.painter,r,e),this.painter.renderToTexture=new ti(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=t=>{"style"===t.dataType?this.terrain.sourceCache.freeRtt():"source"===t.dataType&&t.tile&&(t.sourceId!==e.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(t.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new t.Event("terrain",{terrain:e})),this}getTerrain(){var e;return null!=(e=null==(e=this.terrain)?void 0:e.options)?e:null}areTilesLoaded(){var e=this.style&&this.style.sourceCaches;for(const n in e){var t=e[n]._tiles;for(const e in t){var r=t[e];if("loaded"!==r.state&&"errored"!==r.state)return!1}}return!0}removeSource(e){return this.style.removeSource(e),this._update(!0)}getSource(e){return this.style.getSource(e)}addImage(e,r){var n=this;return function(i){var o,s,l,c,{pixelRatio:i=1,sdf:u=!1,stretchX:h,stretchY:d,content:p,contentMatch:f}=i;if(n._lazyInitEmptyStyle(),!(r instanceof HTMLImageElement||t.isImageBitmap(r)))return void 0===r.width||void 0===r.height?n.fire(new t.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):(({width:o,height:s,data:l}=r),c=r,n.style.addImage(e,{data:new t.RGBAImage({width:o,height:s},new Uint8Array(l)),pixelRatio:i,stretchX:h,stretchY:d,content:p,contentMatch:f,sdf:u,version:0,userImage:c}),c.onAdd&&c.onAdd(n,e),n);({width:o,height:s,data:l}=a.getImageData(r)),n.style.addImage(e,{data:new t.RGBAImage({width:o,height:s},l),pixelRatio:i,stretchX:h,stretchY:d,content:p,contentMatch:f,sdf:u,version:0})}(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})}updateImage(e,r){var n,i,o,s=this.style.getImage(e);return s?(({width:o,height:n,data:i}=r instanceof HTMLImageElement||t.isImageBitmap(r)?a.getImageData(r):r),void 0===o||void 0===n?this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):o!==s.data.width||n!==s.data.height?this.fire(new t.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(o=!(r instanceof HTMLImageElement||t.isImageBitmap(r)),s.data.replace(i,o),this.style.updateImage(e,s),this)):this.fire(new t.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")))}getImage(e){return this.style.getImage(e)}hasImage(e){return e?!!this.style.getImage(e):(this.fire(new t.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(e){this.style.removeImage(e)}loadImage(e){return r.getImage(this._requestManager.transformRequest(e,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(e,t){return this._lazyInitEmptyStyle(),this.style.addLayer(e,t),this._update(!0)}moveLayer(e,t){return this.style.moveLayer(e,t),this._update(!0)}removeLayer(e){return this.style.removeLayer(e),this._update(!0)}getLayer(e){return this.style.getLayer(e)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(e,t,r){return this.style.setLayerZoomRange(e,t,r),this._update(!0)}setFilter(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.style.setFilter(e,t,r),this._update(!0)}getFilter(e){return this.style.getFilter(e)}setPaintProperty(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.style.setPaintProperty(e,t,r,n),this._update(!0)}getPaintProperty(e,t){return this.style.getPaintProperty(e,t)}setLayoutProperty(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.style.setLayoutProperty(e,t,r,n),this._update(!0)}getLayoutProperty(e,t){return this.style.getLayoutProperty(e,t)}setGlyphs(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._lazyInitEmptyStyle(),this.style.setGlyphs(e,t),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._lazyInitEmptyStyle(),this.style.addSprite(e,t,r,(e=>{e||this._update(!0)})),this}removeSprite(e){return this._lazyInitEmptyStyle(),this.style.removeSprite(e),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._lazyInitEmptyStyle(),this.style.setSprite(e,t,(e=>{e||this._update(!0)})),this}setLight(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._lazyInitEmptyStyle(),this.style.setLight(e,t),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(e,t){return this.style.setFeatureState(e,t),this._update()}removeFeatureState(e,t){return this.style.removeFeatureState(e,t),this._update()}getFeatureState(e){return this.style.getFeatureState(e)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let e=0,t=0;return this._container&&(e=this._container.clientWidth||400,t=this._container.clientHeight||300),[e,t]}_setupContainer(){var e=this._container,t=(e.classList.add("maplibregl-map"),this._canvasContainer=s.create("div","maplibregl-canvas-container",e)),r=(t=(this._interactive&&t.classList.add("maplibregl-interactive"),this._canvas=s.create("canvas","maplibregl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region"),this._containerDimensions()),this._getClampedPixelRatio(t[0],t[1]));this._resizeCanvas(t[0],t[1],r);const n=this._controlContainer=s.create("div","maplibregl-control-container",e),i=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((e=>{i[e]=s.create("div",`maplibregl-ctrl-${e} `,n)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(e,t,r){this._canvas.width=Math.floor(r*e),this._canvas.height=Math.floor(r*t),this._canvas.style.width=e+"px",this._canvas.style.height=t+"px"}_setupPainter(){const e={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let t=null;this._canvas.addEventListener("webglcontextcreationerror",(r=>{t={requestedAttributes:e},r&&(t.statusMessage=r.statusMessage,t.type=r.type)}),{once:!0});var r,n=this._canvas.getContext("webgl2",e)||this._canvas.getContext("webgl",e);if(!n)throw r="Failed to initialize WebGL",t?(t.message=r,new Error(JSON.stringify(t))):new Error(r);this.painter=new Ur(n,this.transform),l.testSupport(n)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(e){return this.style&&this.style._loaded&&(this._styleDirty=this._styleDirty||e,this._sourcesDirty=!0,this.triggerRepaint()),this}_requestRenderFrame(e){return this._update(),this._renderTaskQueue.add(e)}_cancelRenderFrame(e){this._renderTaskQueue.remove(e)}_render(e){var r=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(e),!this._removed){let i=!1;this.style&&this._styleDirty&&(this._styleDirty=!1,e=this.transform.zoom,n=a.now(),this.style.zoomHistory.update(e,n),1===(n=(e=new t.EvaluationParameters(e,{now:n,fadeDuration:r,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()})).crossFadingFactor())&&n===this._crossFadingFactor||(i=!0,this._crossFadingFactor=n),this.style.update(e)),this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,r,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:r,showPadding:this.showPadding}),this.fire(new t.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,t.PerformanceUtils.mark(t.PerformanceMarkers.load),this.fire(new t.Event("load"))),this.style&&(this.style.hasTransitions()||i)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();var n=this._sourcesDirty||this._styleDirty||this._placementDirty;return n||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new t.Event("idle")),!this._loaded||this._fullyLoaded||n||(this._fullyLoaded=!0,t.PerformanceUtils.mark(t.PerformanceMarkers.fullLoad)),this}}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){this._hash&&this._hash.remove();for(const t of this._controls)t.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),"undefined"!=typeof window&&removeEventListener("online",this._onWindowOnline,!1),r.removeThrottleControl(this._imageQueueHandle),null!=(e=this._resizeObserver)&&e.disconnect();var e=this.painter.context.gl.getExtension("WEBGL_lose_context");e&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),s.remove(this._canvasContainer),s.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),t.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new t.Event("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,a.frameAsync(this._frameRequest).then((e=>{t.PerformanceUtils.frame(e),this._frameRequest=null,this._render(e)})).catch((()=>{})))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(e){this._showTileBoundaries!==e&&(this._showTileBoundaries=e,this._update())}get showPadding(){return!!this._showPadding}set showPadding(e){this._showPadding!==e&&(this._showPadding=e,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(e){this._showCollisionBoxes!==e&&((this._showCollisionBoxes=e)?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(e){this._showOverdrawInspector!==e&&(this._showOverdrawInspector=e,this._update())}get repaint(){return!!this._repaint}set repaint(e){this._repaint!==e&&(this._repaint=e,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(e){this._vertices=e,this._update()}get version(){return ni}getCameraTargetElevation(){return this.transform.elevation}};const oi=e=>{e.touchstart=e.dragStart,e.touchmoveWindow=e.dragMove,e.touchend=e.dragEnd},ai={showCompass:!0,showZoom:!0,visualizePitch:!1};class si{constructor(e,r){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.mousedown=e=>{this.startMouse(t.extend({},e,{ctrlKey:!0,preventDefault:()=>e.preventDefault()}),s.mousePos(this.element,e)),s.addEventListener(window,"mousemove",this.mousemove),s.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=e=>{this.moveMouse(e,s.mousePos(this.element,e))},this.mouseup=e=>{this.mouseRotate.dragEnd(e),this.mousePitch&&this.mousePitch.dragEnd(e),this.offTemp()},this.touchstart=e=>{1!==e.targetTouches.length?this.reset():(this._startPos=this._lastPos=s.touchPos(this.element,e.targetTouches)[0],this.startTouch(e,this._startPos),s.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),s.addEventListener(window,"touchend",this.touchend))},this.touchmove=e=>{1!==e.targetTouches.length?this.reset():(this._lastPos=s.touchPos(this.element,e.targetTouches)[0],this.moveTouch(e,this._lastPos))},this.touchend=e=>{0===e.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;var i=e.dragRotate._mouseRotate.getClickTolerance(),o=e.dragRotate._mousePitch.getClickTolerance();this.element=r,this.mouseRotate=vn({clickTolerance:i,enable:!0}),this.touchRotate=(e=>{let{enable:t,clickTolerance:r,bearingDegreesPerPixelMoved:n=.8}=e;var i=new gn;return new pn({clickTolerance:r,move:(e,t)=>({bearingDelta:(t.x-e.x)*n}),moveStateManager:i,enable:t,assignEvents:oi})})({clickTolerance:i,enable:!0}),this.map=e,n&&(this.mousePitch=_n({clickTolerance:o,enable:!0}),this.touchPitch=(e=>{let{enable:t,clickTolerance:r,pitchDegreesPerPixelMoved:n=-.5}=e;var i=new gn;return new pn({clickTolerance:r,move:(e,t)=>({pitchDelta:(t.y-e.y)*n}),moveStateManager:i,enable:t,assignEvents:oi})})({clickTolerance:o,enable:!0})),s.addEventListener(r,"mousedown",this.mousedown),s.addEventListener(r,"touchstart",this.touchstart,{passive:!1}),s.addEventListener(r,"touchcancel",this.reset)}startMouse(e,t){this.mouseRotate.dragStart(e,t),this.mousePitch&&this.mousePitch.dragStart(e,t),s.disableDrag()}startTouch(e,t){this.touchRotate.dragStart(e,t),this.touchPitch&&this.touchPitch.dragStart(e,t),s.disableDrag()}moveMouse(e,t){var r=this.map,n=(this.mouseRotate.dragMove(e,t)||{}).bearingDelta;n&&r.setBearing(r.getBearing()+n),this.mousePitch&&(n=(this.mousePitch.dragMove(e,t)||{}).pitchDelta)&&r.setPitch(r.getPitch()+n)}moveTouch(e,t){var r=this.map,n=(this.touchRotate.dragMove(e,t)||{}).bearingDelta;n&&r.setBearing(r.getBearing()+n),this.touchPitch&&(n=(this.touchPitch.dragMove(e,t)||{}).pitchDelta)&&r.setPitch(r.getPitch()+n)}off(){var e=this.element;s.removeEventListener(e,"mousedown",this.mousedown),s.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),s.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),s.removeEventListener(window,"touchend",this.touchend),s.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){s.enableDrag(),s.removeEventListener(window,"mousemove",this.mousemove),s.removeEventListener(window,"mouseup",this.mouseup),s.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),s.removeEventListener(window,"touchend",this.touchend)}}let li;function ci(e,r,n){var i,o,a,s=new t.LngLat(e.lng,e.lat);for(e=new t.LngLat(e.lng,e.lat),r&&(i=new t.LngLat(e.lng-360,e.lat),o=new t.LngLat(e.lng+360,e.lat),a=n.locationPoint(e).distSqr(r),n.locationPoint(i).distSqr(r)<a?e=i:n.locationPoint(o).distSqr(r)<a&&(e=o));180<Math.abs(e.lng-n.center.lng);){var l=n.locationPoint(e);if(0<=l.x&&0<=l.y&&l.x<=n.width&&l.y<=n.height)break;e.lng>n.center.lng?e.lng-=360:e.lng+=360}return e.lng!==s.lng&&n.locationPoint(e).y>n.height/2-n.getHorizon()?e:s}const ui={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function hi(e,t,r){var n=e.classList;for(const i in ui)n.remove(`maplibregl-${r}-anchor-`+i);n.add(`maplibregl-${r}-anchor-`+t)}class di extends t.Evented{constructor(e){if(super(),this._onKeyPress=e=>{var t=e.code;e=e.charCode||e.keyCode;"Space"!==t&&"Enter"!==t&&32!==e&&13!==e||this.togglePopup()},this._onMapClick=e=>{e=e.originalEvent.target;var t=this._element;this._popup&&(e===t||t.contains(e))&&this.togglePopup()},this._update=e=>{if(this._map){var t=this._map.loaded()&&!this._map.isMoving();"terrain"!==(null==e?void 0:e.type)&&("render"!==(null==e?void 0:e.type)||t)||this._map.once("render",this._update),this._map.transform.renderWorldCopies?this._lngLat=ci(this._lngLat,this._flatPos,this._map.transform):this._lngLat=null==(t=this._lngLat)?void 0:t.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let r="",n=("viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?r=`rotateZ(${this._rotation}deg)`:"map"===this._rotationAlignment&&(r=`rotateZ(${this._rotation-this._map.getBearing()}deg)`),"");"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?n="rotateX(0deg)":"map"===this._pitchAlignment&&(n=`rotateX(${this._map.getPitch()}deg)`),e&&"moveend"!==e.type||(this._pos=this._pos.round()),s.setTransform(this._element,`${ui[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${n} `+r),a.frameAsync(new AbortController).then((()=>{this._updateOpacity(e&&"moveend"===e.type)})).catch((()=>{}))}},this._onMove=e=>{var r;this._isDragging||(r=this._clickTolerance||this._map._clickTolerance,this._isDragging=e.point.dist(this._pointerdownPos)>=r),this._isDragging&&(this._pos=e.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new t.Event("dragstart"))),this.fire(new t.Event("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new t.Event("dragend")),this._state="inactive"},this._addDragHandler=e=>{this._element.contains(e.originalEvent.target)&&(e.preventDefault(),this._positionDelta=e.point.sub(this._pos).add(this._offset),this._pointerdownPos=e.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&"auto"!==e.pitchAlignment?e.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(null==e?void 0:e.opacity,null==e?void 0:e.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=t.Point.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=s.create("div"),this._element.setAttribute("aria-label","Map marker");var r,n=s.createNS("http://www.w3.org/2000/svg","svg"),i=((r=((r=(n.setAttributeNS(null,"display","block"),n.setAttributeNS(null,"height","41px"),n.setAttributeNS(null,"width","27px"),n.setAttributeNS(null,"viewBox","0 0 27 41"),s.createNS("http://www.w3.org/2000/svg","g"))).setAttributeNS(null,"stroke","none"),r.setAttributeNS(null,"stroke-width","1"),r.setAttributeNS(null,"fill","none"),r.setAttributeNS(null,"fill-rule","evenodd"),s.createNS("http://www.w3.org/2000/svg","g"))).setAttributeNS(null,"fill-rule","nonzero"),s.createNS("http://www.w3.org/2000/svg","g")),o=(i.setAttributeNS(null,"transform","translate(3.0, 29.0)"),i.setAttributeNS(null,"fill","#000000"),[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}]);for(const e of o){var l=s.createNS("http://www.w3.org/2000/svg","ellipse");l.setAttributeNS(null,"opacity","0.04"),l.setAttributeNS(null,"cx","10.5"),l.setAttributeNS(null,"cy","5.80029008"),l.setAttributeNS(null,"rx",e.rx),l.setAttributeNS(null,"ry",e.ry),i.appendChild(l)}var c,u,h=((u=((u=((c=((c=((o=s.createNS("http://www.w3.org/2000/svg","g")).setAttributeNS(null,"fill",this._color),s.createNS("http://www.w3.org/2000/svg","path"))).setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),o.appendChild(c),s.createNS("http://www.w3.org/2000/svg","g"))).setAttributeNS(null,"opacity","0.25"),c.setAttributeNS(null,"fill","#000000"),s.createNS("http://www.w3.org/2000/svg","path"))).setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),c.appendChild(u),s.createNS("http://www.w3.org/2000/svg","g"))).setAttributeNS(null,"transform","translate(6.0, 7.0)"),u.setAttributeNS(null,"fill","#FFFFFF"),s.createNS("http://www.w3.org/2000/svg","g")),d=(h.setAttributeNS(null,"transform","translate(8.0, 8.0)"),s.createNS("http://www.w3.org/2000/svg","circle")),p=(d.setAttributeNS(null,"fill","#000000"),d.setAttributeNS(null,"opacity","0.25"),d.setAttributeNS(null,"cx","5.5"),d.setAttributeNS(null,"cy","5.5"),d.setAttributeNS(null,"r","5.4999962"),s.createNS("http://www.w3.org/2000/svg","circle"));p.setAttributeNS(null,"fill","#FFFFFF"),p.setAttributeNS(null,"cx","5.5"),p.setAttributeNS(null,"cy","5.5"),p.setAttributeNS(null,"r","5.4999962"),h.appendChild(d),h.appendChild(p),r.appendChild(i),r.appendChild(o),r.appendChild(c),r.appendChild(u),r.appendChild(h),n.appendChild(r),n.setAttributeNS(null,"height",41*this._scale+"px"),n.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(n),this._offset=t.Point.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(e=>{e.preventDefault()})),this._element.addEventListener("mousedown",(e=>{e.preventDefault()})),hi(this._element,this._anchor,"marker"),e&&e.className)for(const t of e.className.split(" "))this._element.classList.add(t);this._popup=null}addTo(e){return this.remove(),(this._map=e).getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),s.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=t.LngLat.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){var t;return this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e&&("offset"in e.options||(t=Math.abs(13.5)/Math.SQRT2,e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[t,-1*(24.6+t)],"bottom-right":[-t,-1*(24.6+t)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset),this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)),this}getPopup(){return this._popup}togglePopup(){var e=this._popup;return this._element.style.opacity!==this._opacityWhenCovered&&e&&(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map))),this}_updateOpacity(){var e=this;return function(r){if(null==(i=e._map)?void 0:i.terrain){if(r)e._opacityTimeout=null;else{if(e._opacityTimeout)return;e._opacityTimeout=setTimeout((()=>{e._opacityTimeout=null}),100)}var n,i=e._map,o=(r=i.terrain.depthAtPoint(e._pos),i.terrain.getElevationForLngLatZoom(e._lngLat,i.transform.tileZoom));i.transform.lngLatToCameraDepth(e._lngLat,o)-r<.006?e._element.style.opacity=e._opacity:(r=-e._offset.y/i.transform._pixelPerMeter,r=Math.sin(i.getPitch()*Math.PI/180)*r,n=i.terrain.depthAtPoint(new t.Point(e._pos.x,e._pos.y-e._offset.y)),i=.006<i.transform.lngLatToCameraDepth(e._lngLat,o+r)-n,null!=(o=e._popup)&&o.isOpen()&&i&&e._popup.remove(),e._element.style.opacity=i?e._opacityWhenCovered:e._opacity)}else e._element.style.opacity!==e._opacity&&(e._element.style.opacity=e._opacity)}(arguments.length>0&&void 0!==arguments[0]&&arguments[0])}getOffset(){return this._offset}setOffset(e){return this._offset=t.Point.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&"auto"!==e?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,t){return void 0===e&&void 0===t&&(this._opacity="1",this._opacityWhenCovered="0.2"),void 0!==e&&(this._opacity=e),void 0!==t&&(this._opacityWhenCovered=t),this._map&&this._updateOpacity(!0),this}}const pi={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let fi=0,mi=!1;class gi extends t.Evented{constructor(e){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))this._setErrorState(),this.fire(new t.Event("outofmaxbounds",e)),this._updateMarker();else{if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error("Unexpected watchState "+this._watchState)}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(e),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new t.Event("geolocate",e))}this._finish()}},this._updateCamera=e=>{var r=new t.LngLat(e.coords.longitude,e.coords.latitude),n=(e=e.coords.accuracy,this._map.getBearing());n=t.extend({bearing:n},this.options.fitBoundsOptions),r=F.fromLngLat(r,e);this._map.fitBounds(r,n,{geolocateSource:!0})},this._updateMarker=e=>{var r;e?(r=new t.LngLat(e.coords.longitude,e.coords.latitude),this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()):(this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove())},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=e=>{if(this._map){if(this.options.trackUserLocation)if(1===e.code){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===e.code&&mi)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new t.Event("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=e=>{this._map&&(this._container.addEventListener("contextmenu",(e=>e.preventDefault())),this._geolocateButton=s.create("button","maplibregl-ctrl-geolocate",this._container),s.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),!(this._geolocateButton.type="button")===e?(t.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled."),e=this._map._getUIString("GeolocateControl.LocationNotAvailable"),this._geolocateButton.disabled=!0,this._geolocateButton.title=e,this._geolocateButton.setAttribute("aria-label",e)):(e=this._map._getUIString("GeolocateControl.FindMyLocation"),this._geolocateButton.title=e,this._geolocateButton.setAttribute("aria-label",e)),this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=s.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new di({element:this._dotElement}),this._circleElement=s.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new di({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",(()=>this.trigger())),this._setup=!0,this.options.trackUserLocation)&&this._map.on("movestart",(e=>{var r=e.originalEvent&&"resize"===e.originalEvent.type;e.geolocateSource||"ACTIVE_LOCK"!==this._watchState||r||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new t.Event("trackuserlocationend")))}))},this.options=t.extend({},pi,e)}onAdd(e){return this._map=e,this._container=s.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(){return t.__awaiter(this,arguments,void 0,(function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function*(){if(void 0===li||e){if(void 0===window.navigator.permissions)return li=!!window.navigator.geolocation;try{var t=yield window.navigator.permissions.query({name:"geolocation"});li="denied"!==t.state}catch(e){li=!!window.navigator.geolocation}}return li}()}))}().then((e=>this._setupUI(e))),this._container}onRemove(){void 0!==this._geolocationWatchID&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),s.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,fi=0,mi=!1}_isOutOfMapMaxBounds(e){var t=this._map.getMaxBounds();e=e.coords;return t&&(e.longitude<t.getWest()||e.longitude>t.getEast()||e.latitude<t.getSouth()||e.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error("Unexpected watchState "+this._watchState)}}_updateCircleRadius(){var e=(t=this._map.getBounds()).getSouthEast(),t=t.getNorthEast();e=e.distanceTo(t),t=this._map._container.clientHeight,e=Math.ceil(this._accuracy/(e/t)*2);this._circleElement.style.width=e+"px",this._circleElement.style.height=e+"px"}trigger(){if(!this._setup)return t.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new t.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":fi--,mi=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new t.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new t.Event("trackuserlocationstart"));break;default:throw new Error("Unexpected watchState "+this._watchState)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error("Unexpected watchState "+this._watchState)}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let e;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),fi++,mi=1<fi?(e={maximumAge:6e5,timeout:0},!0):(e=this.options.positionOptions,!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,e)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}}const yi={maxWidth:100,unit:"metric"};function vi(e,t,r){var n=r&&r.maxWidth||100,i=e._container.clientHeight/2,o=e.unproject([0,i]);i=e.unproject([n,i]),o=o.distanceTo(i);r&&"imperial"===r.unit?5280<(i=3.2808*o)?_i(t,n,i/5280,e._getUIString("ScaleControl.Miles")):_i(t,n,i,e._getUIString("ScaleControl.Feet")):r&&"nautical"===r.unit?_i(t,n,o/1852,e._getUIString("ScaleControl.NauticalMiles")):1e3<=o?_i(t,n,o/1e3,e._getUIString("ScaleControl.Kilometers")):_i(t,n,o,e._getUIString("ScaleControl.Meters"))}function _i(e,t,r,n){var i=function(e){var t=Math.pow(10,(""+Math.floor(e)).length-1);return e=10<=(e/=t)?10:5<=e?5:3<=e?3:2<=e?2:1<=e?1:function(e){var t=Math.pow(10,Math.ceil(-Math.log(e)/Math.LN10));return Math.round(e*t)/t}(e),t*e}(r);e.style.width=t*(i/r)+"px",e.innerHTML=i+"&nbsp;"+n}class bi extends t.Evented{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this._onFullscreenChange=()=>{var e;let t=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;null!=(e=null===t||void 0===t?void 0:t.shadowRoot)&&e.fullscreenElement;)t=t.shadowRoot.fullscreenElement;t===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,e&&e.container&&(e.container instanceof HTMLElement?this._container=e.container:t.warnOnce("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(e){return this._map=e,this._container||(this._container=this._map.getContainer()),this._controlContainer=s.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){s.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){var e=this._fullscreenButton=s.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);s.create("span","maplibregl-ctrl-icon",e).setAttribute("aria-hidden","true"),e.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){var e=this._getTitle();this._fullscreenButton.setAttribute("aria-label",e),this._fullscreenButton.title=e}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new t.Event("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new t.Event("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}}const wi={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},xi=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");class Ci extends t.Evented{constructor(e){super(),this.remove=()=>(this._content&&s.remove(this._content),this._container&&(s.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new t.Event("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{var t=this._lngLat||this._trackPointer;if(this._map&&t&&this._content){if(!this._container){if(this._container=s.create("div","maplibregl-popup",this._map.getContainer()),this._tip=s.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const e of this.options.className.split(" "))this._container.classList.add(e);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer?this._lngLat=ci(this._lngLat,this._flatPos,this._map.transform):this._lngLat=null==(t=this._lngLat)?void 0:t.wrap(),!this._trackPointer||e){t=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat),this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationPoint(this._lngLat));let i=this.options.anchor;if(e=Si(this.options.offset),!i){var r=this._container.offsetWidth,n=this._container.offsetHeight;let o;o=t.y+e.bottom.y<n?["top"]:t.y>this._map.transform.height-n?["bottom"]:[],t.x<r/2?o.push("left"):t.x>this._map.transform.width-r/2&&o.push("right"),i=0===o.length?"bottom":o.join("-")}let o=t.add(e[i]);this.options.subpixelPositioning||(o=o.round()),s.setTransform(this._container,`${ui[i]} translate(${o.x}px,${o.y}px)`),hi(this._container,i,"popup")}}},this._onClose=()=>{this.remove()},this.options=t.extend(Object.create(wi),e)}addTo(e){return this._map&&this.remove(),this._map=e,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new t.Event("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=t.LngLat.convert(e),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(e){return this.setDOMContent(document.createTextNode(e))}setHTML(e){var t,r=document.createDocumentFragment(),n=document.createElement("body");for(n.innerHTML=e;t=n.firstChild;)r.appendChild(t);return this.setDOMContent(r)}getMaxWidth(){var e;return null==(e=this._container)?void 0:e.style.maxWidth}setMaxWidth(e){return this.options.maxWidth=e,this._update(),this}setDOMContent(e){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=s.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(e),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(e){this._container&&this._container.classList.add(e)}removeClassName(e){this._container&&this._container.classList.remove(e)}setOffset(e){return this.options.offset=e,this._update(),this}toggleClassName(e){if(this._container)return this._container.classList.toggle(e)}setSubpixelPositioning(e){this.options.subpixelPositioning=e}_createCloseButton(){this.options.closeButton&&(this._closeButton=s.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){var e;this.options.focusAfterOpen&&this._container&&(e=this._container.querySelector(xi))&&e.focus()}}function Si(e){var r;return e?"number"==typeof e?(r=Math.round(Math.abs(e)/Math.SQRT2),{center:new t.Point(0,0),top:new t.Point(0,e),"top-left":new t.Point(r,r),"top-right":new t.Point(-r,r),bottom:new t.Point(0,-e),"bottom-left":new t.Point(r,-r),"bottom-right":new t.Point(-r,-r),left:new t.Point(e,0),right:new t.Point(-e,0)}):e instanceof t.Point||Array.isArray(e)?{center:r=t.Point.convert(e),top:r,"top-left":r,"top-right":r,bottom:r,"bottom-left":r,"bottom-right":r,left:r,right:r}:{center:t.Point.convert(e.center||[0,0]),top:t.Point.convert(e.top||[0,0]),"top-left":t.Point.convert(e["top-left"]||[0,0]),"top-right":t.Point.convert(e["top-right"]||[0,0]),bottom:t.Point.convert(e.bottom||[0,0]),"bottom-left":t.Point.convert(e["bottom-left"]||[0,0]),"bottom-right":t.Point.convert(e["bottom-right"]||[0,0]),left:t.Point.convert(e.left||[0,0]),right:t.Point.convert(e.right||[0,0])}:Si(new t.Point(0,0))}const Ei=n;e.AJAXError=t.AJAXError,e.Evented=t.Evented,e.LngLat=t.LngLat,e.MercatorCoordinate=t.MercatorCoordinate,e.Point=t.Point,e.addProtocol=t.addProtocol,e.config=t.config,e.removeProtocol=t.removeProtocol,e.AttributionControl=Zn,e.BoxZoomHandler=ln,e.CanvasSource=Z,e.CooperativeGesturesHandler=Un,e.DoubleClickZoomHandler=Ln,e.DragPanHandler=zn,e.DragRotateHandler=Fn,e.EdgeInsets=Hr,e.FullscreenControl=bi,e.GeoJSONSource=H,e.GeolocateControl=gi,e.Hash=Zr,e.ImageSource=G,e.KeyboardHandler=Pn,e.LngLatBounds=F,e.LogoControl=Wn,e.Map=tt,e.MapMouseEvent=tn,e.MapTouchEvent=rn,e.MapWheelEvent=nn,e.Marker=di,e.NavigationControl=class{constructor(e){this._updateZoomButtons=()=>{var e=(t=this._map.getZoom())===this._map.getMaxZoom(),t=t===this._map.getMinZoom();this._zoomInButton.disabled=e,this._zoomOutButton.disabled=t,this._zoomInButton.setAttribute("aria-disabled",e.toString()),this._zoomOutButton.setAttribute("aria-disabled",t.toString())},this._rotateCompassArrow=()=>{var e=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=e},this._setButtonTitle=(e,t)=>{t=this._map._getUIString("NavigationControl."+t),e.title=t,e.setAttribute("aria-label",t)},this.options=t.extend({},ai,e),this._container=s.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(e=>e.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(e=>this._map.zoomIn({},{originalEvent:e}))),s.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(e=>this._map.zoomOut({},{originalEvent:e}))),s.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})})),this._compassIcon=s.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(e){return this._map=e,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new si(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){s.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(e,t){return(e=s.create("button",e,this._container)).type="button",e.addEventListener("click",t),e}},e.Popup=Ci,e.RasterDEMTileSource=q,e.RasterTileSource=j,e.ScaleControl=class{constructor(e){this._onMove=()=>{vi(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,vi(this._map,this._container,this.options)},this.options=t.extend({},yi,e)}getDefaultPosition(){return"bottom-left"}onAdd(e){return this._map=e,this._container=s.create("div","maplibregl-ctrl maplibregl-ctrl-scale",e.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){s.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},e.ScrollZoomHandler=On,e.Style=Je,e.TerrainControl=class{constructor(e){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=e}onAdd(e){return this._map=e,this._container=s.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=s.create("button","maplibregl-ctrl-terrain",this._container),s.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){s.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},e.TwoFingersTouchPitchHandler=kn,e.TwoFingersTouchRotateHandler=Tn,e.TwoFingersTouchZoomHandler=Sn,e.TwoFingersTouchZoomRotateHandler=Bn,e.VectorTileSource=U,e.VideoSource=K,e.addSourceType=(e,r)=>t.__awaiter(void 0,void 0,void 0,(function*(){if($(e))throw new Error(`A source type called "${e}" already exists.`);var t;t=r,W[e]=t})),e.clearPrewarmedResources=function(){var e=P;e&&(e.isPreloaded()&&1===e.numActive()?(e.release(k),P=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},e.getMaxParallelImageRequests=function(){return t.config.MAX_PARALLEL_IMAGE_REQUESTS},e.getRTLTextPluginStatus=function(){return J().getRTLTextPluginStatus()},e.getVersion=function(){return Ei},e.getWorkerCount=function(){return A.workerCount},e.getWorkerUrl=function(){return t.config.WORKER_URL},e.importScriptInWorkers=function(e){return L().broadcast("IS",e)},e.prewarm=function(){R().acquire(k)},e.setMaxParallelImageRequests=function(e){t.config.MAX_PARALLEL_IMAGE_REQUESTS=e},e.setRTLTextPlugin=function(e,t){return J().setRTLTextPlugin(e,t)},e.setWorkerCount=function(e){A.workerCount=e},e.setWorkerUrl=function(e){t.config.WORKER_URL=e}})),e},or.exports=e()}(),or.exports),sr=ir(ar);var lr,cr={exports:{}},ur=function(e){var t,r;return e.__esModule?e:("function"==typeof(t=e.default)?(r=function e(){return this instanceof e?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)}).prototype=t.prototype:r={},Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach((function(t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})})),r)}(Object.freeze({__proto__:null,default:{}})),hr=(function(e){for(var t,r,n=0,i=[],o=0;o<256;o++)i[o]=(o+256).toString(16).substr(1);function a(){e=16,(!t||s.BUFFER_SIZE<n+e)&&(n=0,t=s.randomBytes(s.BUFFER_SIZE));var e=t.slice(n,n+=e);return e[6]=15&e[6]|64,e[8]=63&e[8]|128,e}function s(){var e=a();return i[e[0]]+i[e[1]]+i[e[2]]+i[e[3]]+"-"+i[e[4]]+i[e[5]]+"-"+i[e[6]]+i[e[7]]+"-"+i[e[8]]+i[e[9]]+"-"+i[e[10]]+i[e[11]]+i[e[12]]+i[e[13]]+i[e[14]]+i[e[15]]}s.BUFFER_SIZE=4096,s.bin=a,s.clearBuffer=function(){t=null,n=0},s.test=function(e){return"string"==typeof e&&/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},"undefined"!=typeof crypto?r=crypto:"undefined"!=typeof window&&void 0!==window.msCrypto&&(r=window.msCrypto),r=r||ur,e.exports=s,s.randomBytes=function(){if(r){if(r.randomBytes)return r.randomBytes;if(r.getRandomValues)return"function"!=typeof Uint8Array.prototype.slice?function(e){return e=new Uint8Array(e),r.getRandomValues(e),Array.from(e)}:function(e){return e=new Uint8Array(e),r.getRandomValues(e),e}}return function(e){for(var t=[],r=0;r<e;r++)t.push(Math.floor(256*Math.random()));return t}}()}(cr),cr.exports),dr=ir(hr),pr="atlas.microsoft.com",fr="atlas.microsoft.com",mr="styling",gr="2023-01-01",yr="e96cb745-c6f5-409c-a775-c4313e468c1d",vr="https://login.microsoftonline.com/",_r="api-version",br="Authorization",wr="Bearer ",xr="jwt-sas ",Cr="{{azMapsDomain}}",Sr="{azMapsDomain}",Er="{{azMapsView}}",Tr="view",Ir="{{azMapsLanguage}}",kr="{{azMapsStylingPath}}",Ar="{{azMapsStylePath}}",Pr="styling",Mr="styles",Rr="2.0",Or="Map-Agent",Lr="x-ms-client-id",Dr="Ms-Am-Request-Origin",Nr="MapControl",zr="https://atlas.microsoft.com/.default",Fr="Session-Id",Br=window&&window.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Ur=function(){function e(){}return e.prototype.merge=function(){for(var t,r,n,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];try{for(var a=Br(i),s=a.next();!s.done;s=a.next()){var l=s.value;if(l)for(var c in l)l.hasOwnProperty(c)&&this.hasOwnProperty(c)&&(void 0!==l[c]&&null!=l[c]?this[c]instanceof e?this[c].merge(l[c]):this[c]=l[c]:(n=n||new(Object.getPrototypeOf(this).constructor),this[c]=n[c]))}}catch(r){t={error:r}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}return this},e}(),jr=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),qr=window&&window.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=o.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a},Hr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.domain=void 0,t.headers={},t.path="",t.protocol="https",t.queryParams={},t.subdomain="",t}return jr(t,e),t}(Ur),Vr=function(){function e(e){this.options=(new Hr).merge(e)}return e.prototype.get=function(){return fetch(this.toString(),{method:"GET",mode:"cors",headers:new Headers(this.options.headers)}).then((function(e){if(e.ok)return e.json();throw new Error("HTTP ".concat(e.status,": ").concat(e.statusText))}))},e.prototype.toString=function(){var t=Object.entries(this.options.queryParams).map((function(e){var t=(e=qr(e,2))[0];e=e[1];return"".concat(t,"=").concat(e)})).join("&"),r=[],n=this.options.path||"";return e.protoRegEx.test(n)?r.push(n):(this.options.domain&&(e.protoRegEx.test(this.options.domain)||(r.push("".concat(this.options.protocol,"://")),r.push(this.options.subdomain?"".concat(this.options.subdomain,"."):"")),r.push(this.options.domain)),r.push(this.options.path?"/".concat(n):"")),r.push(t?"?".concat(t):""),r.join("")},e.protoRegEx=new RegExp(/^(((file|http|https):\/\/)|blob:)/i),e}(),Gr=function(){function e(){}return e.parse=function(e){var t=(e=e.toLowerCase()).lastIndexOf("-");return-1!==t?{code:e,language:e.substring(0,t),region:e.substring(t+1)}:{code:e,language:e}},e}(),Kr={localizationsPath:"locs/mapcontrol/2019-3-12",sensitiveUserRegions:["il","kr","pk","in","cn","ar","bh","eg","jo","sa","kw","om","qa","ma","ae"],locales:{defaultLanguage:{defaultRegion:{code:"NGT",strings:"en/resource.json"},latn:{code:"NGT-Latn",strings:"en/resource.json"}},ar:{defaultRegion:{code:"ar",strings:"ar-sa/resource.json"}},bg:{defaultRegion:{code:"bg-BG",strings:"bg-bg/resource.json"}},cs:{defaultRegion:{code:"cs-CZ",strings:"cs-cz/resource.json"}},da:{defaultRegion:{code:"da-DK",strings:"da-dk/resource.json"}},de:{defaultRegion:{code:"de-DE",strings:"de-de/resource.json"}},el:{defaultRegion:{code:"el-GR",strings:"el-gr/resource.json"}},en:{defaultRegion:{code:"en",strings:"en/resource.json"},us:{code:"en-US",strings:"en/resource.json"},au:{code:"en-AU",strings:"en/resource.json"},gb:{code:"en-GB",strings:"en/resource.json"},nz:{code:"en-NZ",strings:"en/resource.json"}},es:{defaultRegion:{code:"es-ES",strings:"es-es/resource.json"},mx:{code:"es-MX",strings:"es-mx/resource.json"}},fi:{defaultRegion:{code:"fi-FI",strings:"fi-fi/resource.json"}},fr:{defaultRegion:{code:"fr-FR",strings:"fr-fr/resource.json"}},hu:{defaultRegion:{code:"hu-HU",strings:"hu-hu/resource.json"}},id:{defaultRegion:{code:"id-ID",strings:"id-id/resource.json"}},it:{defaultRegion:{code:"it-IT",strings:"it-it/resource.json"}},ko:{defaultRegion:{code:"ko-KR",strings:"ko-kr/resource.json"}},lt:{defaultRegion:{code:"lt-LT",strings:"lt-lt/resource.json"}},ms:{defaultRegion:{code:"ms-MY",strings:"ms-my/resource.json"}},nb:{defaultRegion:{code:"nb-NO",strings:"nb-no/resource.json"}},nl:{defaultRegion:{code:"nl-NL",strings:"nl-nl/resource.json"}},pl:{defaultRegion:{code:"pl-PL",strings:"pl-pl/resource.json"}},pt:{defaultRegion:{code:"pt-PT",strings:"pt-pt/resource.json"},br:{code:"pt-BR",strings:"pt-br/resource.json"}},ru:{defaultRegion:{code:"ru-RU",strings:"ru-ru/resource.json"}},sk:{defaultRegion:{code:"sk-SK",strings:"sk-sk/resource.json"}},sl:{defaultRegion:{code:"sl-SL",strings:"sl-sl/resource.json"}},sv:{defaultRegion:{code:"sv-SE",strings:"sv-se/resource.json"}},th:{defaultRegion:{code:"th-TH",strings:"th-th/resource.json"}},tr:{defaultRegion:{code:"tr-TR",strings:"tr-tr/resource.json"}},zh:{defaultRegion:{code:"zh",strings:"en/resource.json"}},"zh-hans":{defaultRegion:{code:"zh-Hans",strings:"zh-cn/resource.json"},cn:{code:"zh-Hans-CN",strings:"zh-cn/resource.json"}},"zh-hant":{defaultRegion:{code:"zh-Hant",strings:"en/resource.json"},tw:{code:"zh-Hant-TW",strings:"zh-tw/resource.json"}}}},Zr=function(){this.Unknown="Unknown",this.Accident="Accident",this.Fog="Fog",this.Danger="Danger",this.Rain="Rain",this.Ice="Ice",this.Jam="Jam",this.LaneClosed="Lane Closed",this.RoadClosed="Road Closed",this.RoadWorks="Road Works",this.Wind="Wind",this.Flood="Flood",this.Detour="Detour"},Wr=function(){function e(){}return e.getCode=function(e){var t=Gr.parse(e);return-1===Kr.sensitiveUserRegions.indexOf(t.region)?this.getLocaleData(t).code:e},e.getStrings=function(e){return e=this.getLocaleData(e),Kr.locales.defaultLanguage.defaultRegion.code===e.code?new Promise((function(e){e(new Zr)})):new Vr({domain:fr,path:"".concat(Kr.localizationsPath,"/").concat(e.strings)}).get().then((function(e){return e}),(function(){return new Zr}))},e.getLocaleData=function(e){if("string"==typeof e&&(e=Gr.parse(e)),Kr.locales[e.code])return Kr.locales[e.code].defaultRegion;var t;if(Kr.locales[e.language])t=Kr.locales[e.language];else{if(-1!==e.language.indexOf("-"))return this.getLocaleData(e.language);t=Kr.locales.defaultLanguage}return e.region&&t[e.region]?t[e.region]:t.defaultRegion},e}(),$r=function(){function e(){}return e.getEdgeOrIEVersion=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");return 0<t?parseInt(e.substring(t+5,e.indexOf(".",t)),10):0<e.indexOf("Trident/")?(t=e.indexOf("rv:"),parseInt(e.substring(t+3,e.indexOf(".",t)),10)):0<(t=e.indexOf("Edge/"))?parseInt(e.substring(t+5,e.indexOf(".",t)),10):-1},e.isEdgeOrIE=function(){return-1!==this.getEdgeOrIEVersion()},e.isIE=function(){var e=this.getEdgeOrIEVersion();return-1!==e&&e<=11},e}(),Yr="3.5.0",Xr=function(){function e(){}return e.getFullVersion=function(){return Yr},e.getEndpointVersion=function(){var e=Yr.indexOf(".");return-1===(e=Yr.indexOf(".",e+1))?Yr:Yr.substring(0,e)},e}(),Qr=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Jr=window&&window.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=o.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a},en=window&&window.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||((n=n||Array.prototype.slice.call(t,0,i))[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},tn=(function(e){e.subscriptionKey="subscriptionKey",e.aad="aad",e.anonymous="anonymous",e.sas="sas"}(lr=lr||{}),function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.authType=void 0,t.subscriptionKey=void 0,t.clientId=void 0,t.aadAppId=void 0,t.aadTenant=void 0,t.aadInstance=void 0,t.getToken=void 0,t.sasToken=void 0,t.authContext=void 0,t}return Qr(t,e),t.prototype.setSubscriptionKey=function(e){this.authType=lr.subscriptionKey,this.subscriptionKey=e},t.prototype.setAadProperties=function(e,t,r,n,i){this.authType=lr.aad,this.authContext=i||this.authContext,this.aadInstance=n||this.aadInstance,this.clientId=e,this.aadAppId=t,this.aadTenant=r},t.prototype.setTokenCallbackFunction=function(e){this.authType=lr.anonymous,this.getToken=e},t.prototype.setSasCallbackFunction=function(e){this.authType=lr.sas,this.getToken=e},t.prototype.merge=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=e.prototype.merge.apply(this,en([],Jr(t),!1));return n.authType===lr.subscriptionKey?n.authContext=n.aadAppId=n.getToken=void 0:n.authType===lr.aad?n.subscriptionKey=n.getToken=void 0:n.authType===lr.anonymous?n.subscriptionKey=n.authContext=n.aadAppId=void 0:n.authType===lr.sas&&(n.authContext=n.subscriptionKey=n.aadAppId=void 0),n},t}(Ur)),rn=nn;function nn(e){return!function(e){return"undefined"!=typeof window&&"undefined"!=typeof document?Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var e,t,r=new Blob([""],{type:"text/javascript"});r=URL.createObjectURL(r);try{t=new Worker(r),e=!0}catch(t){e=!1}return t&&t.terminate(),URL.revokeObjectURL(r),e}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var e=document.createElement("canvas"),t=(e.width=e.height=1,e.getContext("2d"));return!!t&&(t=t.getImageData(0,0,1,1))&&t.width===e.width}()?function(e){return void 0===an[e]&&(an[e]=function(e){var t;e=function(e){var t=document.createElement("canvas"),r=Object.create(nn.webGLContextAttributes);return r.failIfMajorPerformanceCaveat=e,t.getContext("webgl",r)||t.getContext("experimental-webgl",r)}(e);if(!e)return!1;try{t=e.createShader(e.VERTEX_SHADER)}catch(e){return!1}return!(!t||e.isContextLost())&&(e.shaderSource(t,"void main() {}"),e.compileShader(t),!0===e.getShaderParameter(t,e.COMPILE_STATUS))}(e)),an[e]}(e&&e.failIfMajorPerformanceCaveat)?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support":"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support":"not a browser"}(e)}var on,an={};nn.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};var sn="NGT",ln=dr(),cn=pr,un=fr,hn=mr,dn=gr,pn=Rr,fn=new tn,mn=!1,gn=!1,yn=!1,vn=!1,_n=!1,bn=!1,wn=!1,xn=!1,Cn=!1;function Sn(){return Object.assign({},fn)}function En(){return un}function Tn(){return cn}function In(){return hn}function kn(){return dn}function An(){return pn}function Pn(){return sr.getWorkerCount()}function Mn(){return sr.getMaxParallelImageRequests()}function Rn(){return sn}function On(){return ln}function Ln(){return fn.authType===lr.subscriptionKey?fn.subscriptionKey:void 0}function Dn(){return on}function Nn(e){fn=(new tn).merge(fn,e),Cn=!0}function zn(e){cn=e,gn=!0}function Fn(e){hn=e,yn=!0}function Bn(e){0<e&&(sr.setWorkerCount(e),_n=!0)}function Un(e){0<e&&(sr.setMaxParallelImageRequests(e),bn=!0)}function jn(e){sn=Wr.getCode(e),wn=!0}function qn(e){ln=e,xn=!0}function Hn(e){fn.setSubscriptionKey(e),Cn=!0}function Vn(e){on=e,mn=!0}function Gn(e,t){if(t=Math.abs(t||1),"string"==typeof e&&ni[e.toLowerCase()]){for(var r=ni[e.toLowerCase()],n=/calc\(([0-9.]+)[px]*\s*\*\s*\{scale\}\)/gi,i=r,o=n.exec(r);o;)i=i.replace(o[0],parseFloat(o[1])*t+""),o=n.exec(r);return i.replace("{scale}",t+"")}throw new Error("Invalid templateName.")}function Kn(){return Cn}function Zn(){return gn}function Wn(){return yn}function $n(){return _n}function Yn(){return bn}function Xn(){return wn}function Qn(){return xn}function Jn(){return mn}function ei(){var e=new Vr({domain:fr,path:"sdk/javascript/mapcontrol/".concat(Xr.getEndpointVersion(),"/mapbox-gl-rtl-text.min.js")});sr.setRTLTextPlugin(e.toString(),!0).catch((function(e){e&&console.warn(e)}))}var ti,ri,ni={marker:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(27 * {scale})" height="calc(39 * {scale})" viewBox="-1 -1 26 38"><path d="M12.25.25a12.254 12.254 0 0 0-12 12.494c0 6.444 6.488 12.109 11.059 22.564.549 1.256 1.333 1.256 1.882 0C17.762 24.853 24.25 19.186 24.25 12.744A12.254 12.254 0 0 0 12.25.25Z" style="fill:{color};stroke:{secondaryColor};stroke-width:1"/><text x="12.5" y="17.5" style="font-size:14px;fill:#fff;text-anchor:middle">{text}</text></svg>',"marker-thick":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(28 * {scale})" height="calc(39 * {scale})" viewBox="-1 -1 27 38"><path d="M12.25.25a12.254 12.254 0 0 0-12 12.494c0 6.444 6.488 12.109 11.059 22.564.549 1.256 1.333 1.256 1.882 0C17.762 24.853 24.25 19.186 24.25 12.744A12.254 12.254 0 0 0 12.25.25Z" style="fill:{color};stroke:{secondaryColor};stroke-width:2"/><text x="12.5" y="18.5" style="font-size:14px;fill:#fff;text-anchor:middle">{text}</text></svg>',"marker-circle":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(28 * {scale})" height="calc(39 * {scale})" viewBox="-1 -1 27 38"><path d="M12.25.25a12.254 12.254 0 0 0-12 12.494c0 6.444 6.488 12.109 11.059 22.564.549 1.256 1.333 1.256 1.882 0C17.762 24.853 24.25 19.186 24.25 12.744A12.254 12.254 0 0 0 12.25.25Z" style="fill:{color};stroke:{secondaryColor};stroke-width:1"/><circle cx="12.5" cy="12.5" r="9" fill="{secondaryColor}"/><text x="12" y="17.5" style="font-size:14px;fill:#000;text-anchor:middle">{text}</text></svg>',pin:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(24 * {scale})" height="calc(28 * {scale})" viewBox="0 0 24 28"><path d="m11.988 16.615a5.15 5.15 0 0 1-2.268-.525 4.909 4.909 0 0 1-2.805-4.442 5.019 5.019 0 0 1 5.072-4.936h.012a5.03 5.03 0 0 1 5.085 4.961 4.907 4.907 0 0 1-.549 2.224 5.114 5.114 0 0 1-4.548 2.718zm0-8.06a3.173 3.173 0 0 0-3.226 3.099 3.081 3.081 0 0 0 1.77 2.782 3.299 3.299 0 0 0 4.365-1.386 3.049 3.049 0 0 0 .342-1.381 3.184 3.184 0 0 0-3.239-3.114h-.012z" fill="{secondaryColor}"/><path d="m11.999.922a10.908 10.908 0 0 0-11.076 10.732 10.639 10.639 0 0 0 4.418 8.598l6.658 6.464 6.658-6.463a10.537 10.537 0 0 0 2.198-15.041 11.182 11.182 0 0 0-8.856-4.289zm1.873 14.341a4.221 4.221 0 0 1-5.589-1.789 3.945 3.945 0 0 1-.445-1.8 4.164 4.164 0 0 1 8.323-.037 4.028 4.028 0 0 1-2.289 3.626Z" fill="{color}"/><path d="m11.999 28-7.256-7.044a11.611 11.611 0 0 1-4.743-9.303 11.844 11.844 0 0 1 11.988-11.652.102 .102 0 0 1 .02 0 12.164 12.164 0 0 1 9.577 4.647 11.357 11.357 0 0 1 2.299 8.614 11.521 11.521 0 0 1-4.63 7.695zm-.01-26.157a9.997 9.997 0 0 0-10.143 9.812 9.769 9.769 0 0 0 4.04 7.853l.099.083 6.014 5.838 6.113-5.922a9.7 9.7 0 0 0 3.945-6.505 9.533 9.533 0 0 0-1.933-7.229 10.305 10.305 0 0 0-8.116-3.931h-.021zm.021 14.772a5.11 5.11 0 0 1-4.547-2.718 4.868 4.868 0 0 1 .932-5.743 5.118 5.118 0 0 1 3.58-1.46h.024a5.031 5.031 0 0 1 5.084 4.938 4.92 4.92 0 0 1-2.805 4.457h0a5.152 5.152 0 0 1-2.269.525zm-.011-8.079h-.015a3.277 3.277 0 0 0-2.295.933 3.029 3.029 0 0 0-.587 3.58 3.297 3.297 0 0 0 4.364 1.386h0a3.092 3.092 0 0 0 1.772-2.795 3.185 3.185 0 0 0-3.239-3.105z" fill="{secondaryColor}"/><text x="12" y="17" style="font-size:14px;fill:#000;text-anchor:middle">{text}</text></svg>',"pin-round":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(25 * {scale})" height="calc(25 * {scale})" viewBox="0 0 25 25"><g transform="translate(0 1)"><circle cx="12.25" cy="11.5833" r="11" fill="{color}"/><path d="m12.25 23.583a12 12 0 1 1 12-12 12 12 0 0 1-12 12zm0-22a10 10 0 1 0 10 10 10 10 0 0 0-10-10z" fill="{secondaryColor}"/><circle cx="12.25" cy="11.5833" r="4.2386" fill="{secondaryColor}"/></g><text x="12.5" y="17" style="font-size:14px;fill:#000;text-anchor:middle">{text}</text></svg>',"marker-flat":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(27 * {scale})" height="calc(42.8 * {scale})"  viewBox="0 0 1600 2570"><g fill="{color}"><path d="M691 2419c-409-575-641-1086-683-1504-10-106-10-136 5-224 31-188 105-330 241-458 129-124 270-190 453-214 69-9 113-10 182-1 373 46 655 326 703 698 40 308-120 801-424 1309-134 224-348 535-369 535-4 0-53-63-108-141z"/></g><g fill="rgba(0,0,0,0.15)" style="transform:scale(-1,1);transform-origin:center"><path d="M691 2419c-407-571-639-1083-682-1498-14-139-3-249 37-371 69-208 254-402 459-481 68-27 217-59 271-59h24v160 180 940 635c0 349-2 635-5 635-2 0-49-63-104-141z"/></g><circle cx="800" cy="800" r="600" fill="{secondaryColor}"/><text x="800" y="1100" style="font-size:800px;fill:#000;text-anchor:middle">{text}</text></svg>',"marker-arrow":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(25.47 * {scale})" height="calc(35.18 * {scale})" viewBox="0 0 4330 5980"><g fill="{color}"><path d="m2080 5969c-49-20-93-63-115-113-25-55-1928-5486-1953-5573-40-138 67-282 210-283 36 0 246 73 987 345 518 190 947 345 955 345 8 0 438-155 955-345 615-226 954-345 979-345 87 0 165 47 204 123 46 91 107-95-957 2942-537 1535-986 2805-997 2823-11 18-43 46-72 62-41 24-62 30-111 29-33 0-71-5-85-10z"/></g><g fill="{secondaryColor}"><path d="m2200 1600c-36 10-83 2-484-84-243-53-451-94-461-91-11 4-22 18-25 31-5 19 114 371 436 1292 244 697 448 1273 454 1281 19 24 50 30 71 12z"/><path d="m2200 1600c-36 10-83 2-484-84-243-53-451-94-461-91-11 4-22 18-25 31-5 19 114 371 436 1292 244 697 448 1273 454 1281 19 24 50 30 71 12z" style="transform:scale(-1,1);transform-origin:center"/></g><g fill="rgba(0,0,0,0.2)" ><path d="m2165 685c8 0 438-155 955-345 615-226 954-345 979-345 87 0 165 47 204 123 46 91 107-95-957 2942-537 1535-986 2805-997 2823-11 18-43 46-72 62-41 24-62 30-111 29z"/></g><text x="2165" y="3300" style="font-size:2500px;fill:#fff;text-anchor:middle">{text}</text></svg>',"marker-ball-pin":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(15.67 * {scale})" height="calc(33.33 * {scale})" viewBox="0 0 235 452"><g transform="translate(-135 10)"><path fill="{secondaryColor}" d="m256 442 0 0c-13 0-18-11-18-24l-6-323c0-13 11-24 24-24h0c13 0 24 11 24 24l-6 323c0 13-5 24-18 24z"/><circle style="fill:{color};stroke-width:10;stroke:{secondaryColor}" cx="256" cy="112" r="111"/><ellipse transform="matrix(0.834 0.5518 -0.5518 0.834 65.7916 -97.18)" fill="rgba(255,255,255,0.3)" cx="194.399" cy="60.749" rx="19.076" ry="32.428"/></g><text x="117.5" y="160" style="font-size:160px;fill:#fff;text-anchor:middle">{text}</text></svg>',"marker-square":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(26.67 * {scale})" height="calc(32.27 * {scale})" viewBox="0 0 2000 2420"><g transform="translate(100 100)" style="stroke:{secondaryColor};stroke-width:100;fill:{color}"><path d="M845 2152c-22-37-58-95-80-129-22-35-62-99-90-143l-50-80-312 0-313 0 0-900 0-900 900 0 900 0 0 900 0 900-313 0-313 0-34 58c-19 31-38 59-42 60-5 2-8 8-8 12 0 9-69 123-88 145-5 6-11 15-13 21-16 39-77 123-89 124-8 0-33-31-55-68z"/></g><text x="1000" y="1300" style="font-size:1000px;fill:#fff;text-anchor:middle">{text}</text></svg>',"marker-square-cluster":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(33.33 * {scale})" height="calc(38.8 * {scale})" viewBox="0 0 2500 2910"><g transform="translate(100 100)" style="stroke:{secondaryColor};stroke-width:100;fill:{color}"><path d="m866 2652c-17-31-37-68-46-82-9-14-32-54-51-90-19-36-50-92-70-125l-36-60-332-3-331-2 0-905 0-905 660 0 660 0 0-38c0-71 50-196 102-258 71-85 189-164 244-164 12 0 26-4 29-10 8-13 222-13 230 0 3 6 17 10 30 10 25 0 117 45 154 76 130 107 191 232 191 392 0 155-63 284-190 386-36 29-129 76-150 76-11 0-22 5-25 10-3 6-31 10-61 10l-54 0 0 660 0 660-332 2-332 3-29 50c-17 28-48 84-70 125-22 41-47 86-56 100-9 14-30 51-46 83-17 32-36 57-45 57-8 0-28-25-44-58z"/></g><text x="1650" y="900" style="font-size:1000px;fill:#fff">+</text><text x="1000" y="1800" style="font-size:1000px;fill:#fff;text-anchor:middle">{text}</text></svg>',"marker-square-rounded":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(26.8 * {scale})" height="calc(32.27 * {scale})" viewBox="0 0 2010 2410"><g transform="translate(100 100)" style="stroke:{secondaryColor};stroke-width:100;fill:{color}"><path d="M856 2155c-20-30-36-59-36-65 0-5-4-10-10-10-5 0-10-5-10-11 0-5-18-37-40-69-22-32-40-64-40-69 0-6-4-11-10-11-5 0-10-5-10-10 0-6-15-33-32-60l-33-50-127 0c-74 0-129-4-133-10-3-5-17-10-30-10-25 0-116-45-155-76-87-69-142-151-178-265-15-46-17-1075-2-1084 5-3 10-17 10-30 0-13 5-27 10-30 6-3 10-13 10-22 0-22 83-135 122-168 57-46 62-50 112-75l50-25 585 0 586 0 63 34c84 46 169 133 212 218l35 68 0 565 0 565-28 59c-32 69-100 157-139 180-15 9-33 22-40 29-23 22-99 57-123 57-13 0-27 5-30 10-4 6-60 10-135 10l-128 0-128 205c-84 136-133 205-144 205-10 0-33-24-54-55z"/></g><text x="1000" y="1300" style="font-size:1000px;fill:#fff;text-anchor:middle">{text}</text></svg>',"marker-square-rounded-cluster":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(33.33 * {scale})" height="calc(32.13 * {scale})" viewBox="0 0 2500 2900"><g transform="translate(100 100)" style="stroke:{secondaryColor};stroke-width:100;fill:{color}"><path d="m874 2669c-9-18-26-49-37-68-11-20-30-55-43-78-13-24-36-64-51-90-14-27-38-69-52-95l-26-48-142 0c-84 0-144-4-148-10-3-5-17-10-30-10-25 0-118-46-154-76-91-76-136-142-175-254-13-38-16-119-16-554 0-358 3-520 12-545 40-125 106-219 195-278 127-84 116-83 646-83l467 0 0-42c0-46 11-87 45-163 54-121 169-220 306-264 46-14 232-14 278 0 165 53 284 175 340 350 19 61 14 204-10 273-32 91-94 178-169 240-38 31-130 76-155 76-13 0-27 5-30 10-3 6-28 10-56 10l-49 0 0 462c0 446-1 464-21 522-32 91-94 178-169 240-38 31-130 76-155 76-13 0-27 5-30 10-4 6-65 10-149 10-138 0-143 1-154 23-12 23-62 114-112 202-16 28-44 79-63 115-42 77-67 88-93 39z"/></g><text x="1650" y="900" style="font-size:1000px;fill:#fff">+</text><text x="1000" y="1800" style="font-size:1000px;fill:#fff;text-anchor:middle">{text}</text></svg>',flag:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(23.5 * {scale})" height="calc(40 * {scale})" viewBox="34 28 198 308"><path style="stroke:{secondaryColor};stroke-width:15;stroke-linecap:round;" d="M42 327l0 -291"/><path style="fill:{color};stroke:{secondaryColor};stroke-width:10;stroke-linejoin:round;" d="M49 50c70 30 104 28 178 2-21 42-21 74 0 116-72 25-101 25-178 0l0-118z"/><text x="130" y="165" style="font-size:100px;fill:#fff;text-anchor:middle">{text}</text></svg>',"flag-triangle":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(27 * {scale})" height="calc(35.33 * {scale})" viewBox="0 0 40.5 53"><g transform="translate(-31 -20)"><path fill="{secondaryColor}" d="M34.7,73.3V48.4l34.6-10.1c0.7-0.2,1.2-0.8,1.2-1.5s-0.4-1.4-1-1.7L33.7,20.5c-0.5-0.2-1.1-0.2-1.6,0.2 c-0.5,0.3-0.7,0.8-0.7,1.4v51.2H34.7z"/><polygon points="34.7,24.5 66,36.5 34.7,45 34.7,10" fill="{color}"/></g><text x="11" y="21" style="font-size:14px;fill:#fff;text-anchor:middle">{text}</text></svg>',"rounded-square":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(34 * {scale})" height="calc(34 * {scale})" viewBox="0 0 34 34"><g transform="translate(2 2)"><rect x="0" y="0" rx="8" ry="8" width="30" height="30" style="stroke:{secondaryColor};stroke-width:2;fill:{color}"/></g><text x="17" y="22" style="font-size:14px;fill:#fff;text-anchor:middle">{text}</text></svg>',"rounded-square-thick":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(38 * {scale})" height="calc(38 * {scale})" viewBox="0 0 38 38"><g transform="translate(4 4)"><rect x="0" y="0" rx="8" ry="8" width="30" height="30" style="stroke:{secondaryColor};stroke-width:4;fill:{color}"/></g><text x="19" y="24" style="font-size:14px;fill:#fff;text-anchor:middle">{text}</text></svg>',triangle:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(36 * {scale})" height="calc(36 * {scale})" viewBox="0 0 36 36"><g transform="translate(2 2)"><polygon points="16,0 32,32 0,32 16,0" style="stroke:{secondaryColor};stroke-width:2;fill:{color}"/></g><text x="17.5" y="30" style="font-size:12px;fill:#fff;text-anchor:middle">{text}</text></svg>',"triangle-thick":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(40 * {scale})" height="calc(40 * {scale})" viewBox="0 0 40 40"><g transform="translate(4 4)"><polygon points="16,0 32,32 0,32 16,0" style="stroke:{secondaryColor};stroke-width:4;fill:{color}"/></g><text x="19.5" y="32" style="font-size:12px;fill:#fff;text-anchor:middle">{text}</text></svg>',hexagon:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(35 * {scale})" height="calc(40 * {scale})" viewBox="0 0 35 40"><g transform="translate(2 2)"><path d="M31 9 15.5 0 0 9 0 27 15.5 36 31 27 31 9Z" style="stroke:{secondaryColor};stroke-width:2;fill:{color}"/></g><text x="17.5" y="25" style="font-size:14px;fill:#fff;text-anchor:middle">{text}</text></svg>',"hexagon-thick":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(39 * {scale})" height="calc(44 * {scale})" viewBox="0 0 39 44"><g transform="translate(4 4)"><path d="M31 9 15.5 0 0 9 0 27 15.5 36 31 27 31 9Z" style="stroke:{secondaryColor};stroke-width:4;fill:{color}"/></g><text x="19.5" y="27" style="font-size:14px;fill:#fff;text-anchor:middle">{text}</text></svg>',"hexagon-rounded":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(40 * {scale})" height="calc(40 * {scale})" viewBox="0 0 1100 1100"><g transform="translate(50 50)"><path style="stroke:{secondaryColor};stroke-width:50;fill:{color}" d="M881 210 561 25c-33-19-88-19-121 0L119 210c-33 19-61 67-61 105v370c0 39 27 86 61 105l321 185c33 19 88 19 122 0l321-185c33-19 61-67 61-105V315C942 276 915 229 881 210z"/></g><text x="550" y="700" style="font-size:400px;fill:#fff;text-anchor:middle">{text}</text></svg>',"hexagon-rounded-thick":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(40 * {scale})" height="calc(40 * {scale})" viewBox="0 0 1200 1200"><g transform="translate(100 100)"><path style="stroke:{secondaryColor};stroke-width:100;fill:{color}" d="M881 210 561 25c-33-19-88-19-121 0L119 210c-33 19-61 67-61 105v370c0 39 27 86 61 105l321 185c33 19 88 19 122 0l321-185c33-19 61-67 61-105V315C942 276 915 229 881 210z"/></g><text x="600" y="750" style="font-size:400px;fill:#fff;text-anchor:middle">{text}</text></svg>',"triangle-arrow-up":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(28 * {scale})" height="calc(28 * {scale})" viewBox="0 0 28 28"><g transform="translate(2 2)"><polygon points="12,0 0,24 12,17 24,24" stroke-width="2" stroke="{secondaryColor}" fill="{color}"/></g><text x="14" y="17" style="font-size:8px;fill:#fff;text-anchor:middle">{text}</text></svg>',"triangle-arrow-left":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(28 * {scale})" height="calc(28 * {scale})" viewBox="0 0 28 28"><g transform="translate(2 2)"><polygon points="24,12 0,0 7,12 0,24" stroke-width="2" stroke="{secondaryColor}" fill="{color}"/></g><text x="14" y="16.5" style="font-size:8px;fill:#fff;text-anchor:middle">{text}</text></svg>',"arrow-up":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(12.16 * {scale})" height="calc(30.1 * {scale})" viewBox="0 0 902 364"><g fill="{color}" transform="matrix(0,2.4,-2.4,0,897,-930)"><polygon points="902,222 233,222 233,364 0,182 233,0 233,141 902,141 902,222"/></g><text x="450" y="700" style="font-size:900px;fill:#000;text-anchor:middle">{text}</text></svg>',"arrow-up-thin":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(16 * {scale})" height="calc(33.33 * {scale})" viewBox="0 0 12 25"><g transform="translate(-136.91823 -751.91998)"><path fill="{color}" d="m148.271 760.71c-1.641-.547-3.186-1.47-4.633-2.769l0 18.07-1.675 0 0-18.07c-1.447 1.299-2.986 2.222-4.616 2.769l0-1.231c2.325-1.596 4.006-3.812 5.043-6.65l.838 0c1.037 2.838 2.718 5.055 5.043 6.65l0 1.231z"/></g><text x="6" y="20" style="font-size:10px;fill:#000;text-anchor:middle">{text}</text></svg>',car:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(21.93 * {scale})" height="calc(40.9 * {scale})" viewBox="0 0 6580 12270"><g transform="translate(0 12270) rotate(-90)"><path fill="{secondaryColor}" d="M7045 6566c-42-13-105-44-105-51 0-2 23-105 50-228 28-123 50-230 50-236 0-8-241-11-907-11-855 0-1145 6-1513 30-85 6-189 13-230 15-41 3-133 10-205 15-286 21-430 32-705 50-953 63-1459 18-2335-205-304-77-746-209-799-238-131-72-221-408-285-1062-34-345-42-532-48-1130-16-1557 108-2532 336-2649 32-17 469-149 676-205 409-110 819-191 1205-238 116-14 224-18 540-18 395 1 494 5 1140 50 1124 79 1224 82 2496 78l641-3-53-237c-29-131-52-238-51-239 1-1 31-14 66-29 56-23 76-26 142-23 67 3 83 7 120 33 23 17 50 41 61 55 10 14 51 117 91 230l73 205 674 3 675 2 90-39c98-43 198-72 315-93 122-21 829-18 990 5 321 45 626 143 849 270 293 168 516 378 704 662 266 402 416 893 467 1527 15 174 8 882-9 998-6 41-18 127-27 190-69 502-253 969-523 1325-79 105-262 284-381 374-189 142-355 229-574 300-336 110-526 139-952 148-457 9-685-23-887-124l-47-24-678-6-678-6-64 179c-79 224-92 253-121 284-67 70-177 97-274 66zm-2752-5073c-23-2-64-2-90 0-26 2-7 3 42 3 50 0 71-1 48-3zm395 0c-21-2-55-2-75 0-21 2-4 4 37 4 41 0 58-2 38-4z"/><path fill="{color}" d="M7043 6498c-13-6-23-19-23-28 0-9 23-117 50-240 28-123 50-230 50-237 0-22-2126-13-2465 10-132 10-400 28-595 42-661 47-824 55-1160 62-435 7-656-8-1040-73-415-70-865-183-1447-365-168-53-272-556-325-1569-16-319-16-1311 0-1630 45-872 129-1366 257-1518 22-26 51-39 172-77 557-177 1122-310 1563-369 271-36 351-40 690-40 361 1 463 6 1165 54 1122 78 1288 83 2337 79 460-2 840-7 843-11 4-4-17-117-47-252l-55-245 39-16c76-30 180-8 224 47 10 13 54 124 98 246l79 222 709 0 709 0 47-24c74-37 219-83 322-101 122-22 606-32 802-16 374 29 658 102 933 238 124 62 271 155 361 230l61 51 6 100c19 278 103 497 247 643 88 89 173 136 278 152l70 11 41 131c116 369 159 673 168 1170 10 584-38 984-167 1397l-40 126-70 12c-193 33-348 175-441 405-56 139-89 302-89 445 0 43-3 47-58 91-290 235-644 384-1068 450-191 29-796 39-974 16-135-18-263-54-368-102l-75-35-701 0-701 0-79 223c-82 232-102 267-163 293-38 16-138 17-170 2zm-2023-820c332-15 1155-12 1835 6 308 8 563 12 566 8 4-4 10-21 13-38 7-30 6-31-92-77-518-244-1197-396-2112-474-295-25-1282-25-1579 0-231 20-473 46-479 51-6 7 49 110 93 171 160 226 416 335 855 365 142 10 539 5 900-12zm3304-263c525-111 899-887 934-1935 19-557-37-1023-172-1435-186-563-521-900-896-899-81 0-158 14-525 92-426 91-431 92-540 146-195 96-287 207-306 368-12 104-11 2985 1 3078 22 170 135 291 365 389 49 21 191 55 480 115 226 47 419 87 430 89 45 10 164 6 229-8zm-5570-485c112-43 197-156 216-291 12-83 13-2623 1-2706-23-158-125-273-270-304-44-9-100-1-542 75-272 47-514 91-539 98-266 68-487 424-594 958-56 280-70 548-40 800 56 484 207 878 414 1081 115 114 122 116 702 218 277 49 524 90 550 90 26 1 72-8 102-19zm2111-3440c1023-44 1884-213 2462-486l113-53-7-33c-3-18-8-35-10-37-2-3-236 1-521 7-993 24-1271 26-1708 11-541-18-1128-18-1249-1-377 56-588 181-734 437-32 55-41 79-32 84 12 8 246 32 491 51 356 28 815 36 1195 20z"/></g><text x="3250" y="8250" style="font-size:3000px;fill:#fff;text-anchor:middle">{text}</text></svg>',checker:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(16 * {scale})" height="calc(16 * {scale})" viewBox="0 0 16 16"><pattern id="p" x="0" y="0" width="16" height="16" patternUnits="userSpaceOnUse"><rect fill="{color}" x="0" width="8" height="8" y="0"/><rect fill="{color}" x="8" width="8" height="8" y="8"/></pattern><rect x="0" y="0" width="16" height="16" fill="{secondaryColor}"/><rect x="0" y="0" width="16" height="16" fill="url(#p)"/></svg>',"checker-rotated":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(16 * {scale})" height="calc(16 * {scale})" viewBox="0 0 60 60"><rect width="60" height="60" fill="{secondaryColor}"/><rect width="42.42" height="42.42" transform="translate(30 0) rotate(45)" fill="{color}"/></svg>',"zig-zag":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(15 * {scale})" height="calc(15 * {scale})" viewBox="0 0 120 120"><rect x="0" y="0" width="120" height="120" fill="{secondaryColor}"/><polygon fill="{color}" points="120 120 60 120 90 90 120 60 120 0 120 0 60 60 0 0 0 60 30 90 60 120 120 120"/></svg>',"zig-zag-vertical":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(15 * {scale})" height="calc(15 * {scale})" viewBox="0 0 120 120"><rect x="0" y="0" width="120" height="120" fill="{secondaryColor}"/><polygon fill="{color}" points="120 0 120 60 90 30 60 0 0 0 0 0 60 60 0 120 60 120 90 90 120 60 120 0"/></svg>',"circles-spaced":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(20 * {scale})" height="calc(20 * {scale})" viewBox="0 0 20 20"><defs><pattern id="p" x="0" y="0" width="20" height="20" patternUnits="userSpaceOnUse"><circle cx="10" cy="10" r="2" stroke="none" fill="{color}"/></pattern></defs><rect x="0" y="0" width="20" height="20" fill="{secondaryColor}"/><rect x="0" y="0" width="100" height="100" fill="url(#p)"/></svg>',circles:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(7 * {scale})" height="calc(7 * {scale})" viewBox="0 0 20 20"><defs><pattern id="p" x="0" y="0" width="20" height="20" patternUnits="userSpaceOnUse"><circle cx="10" cy="10" r="6" stroke="none" fill="{color}"/></pattern></defs><rect x="0" y="0" width="20" height="20" fill="{secondaryColor}"/><rect x="0" y="0" width="100" height="100" fill="url(#p)"/></svg>',"diagonal-lines-up":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(18 * {scale})" height="calc(18 * {scale})" viewBox="0 0 6 6"><rect x="0" y="0" width="6" height="6" fill="{secondaryColor}"/><g fill="{color}"><path d="M5 0h1L0 6V5zM6 5v1H5z"/></g></svg>',"diagonal-lines-down":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(18 * {scale})" height="calc(18 * {scale})" viewBox="0 0 6 6"><rect x="0" y="0" width="6" height="6" fill="{secondaryColor}"/><g transform="rotate(90 3 3)" fill="{color}"><path d="M5 0h1L0 6V5zM6 5v1H5z"/></g></svg>',"diagonal-stripes-up":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(20 * {scale})" height="calc(20 * {scale})" viewBox="0 0 40 40"><rect x="0" y="0" width="40" height="40" fill="{secondaryColor}"/><g fill="{color}"><path d="M0 40L40 0H20L0 20M40 40V20L20 40"/></g></svg>',"diagonal-stripes-down":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(20 * {scale})" height="calc(20 * {scale})" viewBox="0 0 40 40"><rect x="0" y="0" width="40" height="40" fill="{secondaryColor}"/><g transform="rotate(90 20 20)" fill="{color}"><path d="M0 40L40 0H20L0 20M40 40V20L20 40"/></g></svg>',"grid-lines":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(14 * {scale})" height="calc(14 * {scale})" viewBox="0 0 6 6"><rect x="0" y="0" width="6" height="6" fill="{secondaryColor}"/><g transform="rotate(45 3 3)" fill="{color}"><path d="M5 0h1L0 6V5zM6 5v1H5z"/></g><g fill="{color}" transform="rotate(-45 3 3)"><path d="M5 0h1L0 6V5zM6 5v1H5z"/></g></svg>',"rotated-grid-lines":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(18 * {scale})" height="calc(18 * {scale})" viewBox="0 0 6 6"><rect x="0" y="0" width="6" height="6" fill="{secondaryColor}"/><g transform="rotate(90 3 3)" fill="{color}"><path d="M5 0h1L0 6V5zM6 5v1H5z"/></g><g fill="{color}"><path d="M5 0h1L0 6V5zM6 5v1H5z"/></g></svg>',"rotated-grid-stripes":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(20 * {scale})" height="calc(20 * {scale})" viewBox="0 0 40 40"><rect x="0" y="0" width="40" height="40" fill="{secondaryColor}"/><g transform="rotate(90 20 20)" fill="{color}"><path d="M0 40L40 0H20L0 20M40 40V20L20 40"/></g><g fill="{color}"><path d="M0 40L40 0H20L0 20M40 40V20L20 40"/></g></svg>',"x-fill":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(40 * {scale})" height="calc(40 * {scale})" viewBox="0 0 40 40"><rect x="0" y="0" width="45.3" height="45.3" fill="{secondaryColor}"/><g fill="{color}"><path d="M0 38.59l2.83-2.83 1.41 1.41L1.41 40H0v-1.41zM0 1.4l2.83 2.83 1.41-1.41L1.41 0H0v1.41zM38.59 40l-2.83-2.83 1.41-1.41L40 38.59V40h-1.41zM40 1.41l-2.83 2.83-1.41-1.41L38.59 0H40v1.41zM20 18.6l2.83-2.83 1.41 1.41L21.41 20l2.83 2.83-1.41 1.41L20 21.41l-2.83 2.83-1.41-1.41L18.59 20l-2.83-2.83 1.41-1.41L20 18.59z"/></g></svg>',dots:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(13 * {scale})" height="calc(13 * {scale})" viewBox="0 0 20 20"><rect x="0" y="0" width="20" height="20" fill="{secondaryColor}"/><g fill="{color}"><circle cx="3" cy="3" r="3"/><circle cx="13" cy="13" r="3"/></g></svg>'},ii=function(e){var t=document.createElement("span");return t.innerText=e,t.classList.add("tooltiptext"),-1!=navigator.userAgent.indexOf("Edg")?t.classList.add("edge"):-1!=navigator.userAgent.indexOf("Chrome")?t.classList.add("chrome"):-1!=navigator.userAgent.indexOf("Safari")?t.classList.add("safari"):-1!=navigator.userAgent.indexOf("Firefox")&&t.classList.add("firefox"),-1!=navigator.userAgent.indexOf("Windows")?t.classList.add("win"):-1!=navigator.userAgent.indexOf("Macintosh")&&t.classList.add("mac"),t},oi=function(e,t,r){function n(n){var i=t.getBoundingClientRect(),o=e.getBoundingClientRect(),a=i.x+o.width>window.innerWidth?window.innerWidth-o.width:i.x;o=i.y+i.height+o.height+4>window.innerHeight?i.y-o.height-4:i.y+i.height+4;r&&t.parentElement&&(i=t.parentElement?t.parentElement.getBoundingClientRect():null,e.style.position="absolute",a-=i.x,o-=i.y),e.style.transform="translate(".concat(a,"px, ").concat(o,"px)"),e.style.display="block"}void 0===r&&(r=!1),t.addEventListener("mouseover",n),t.addEventListener("focusin",n),t.addEventListener("keydown",(function(t){"Escape"!==t.key&&"Esc"!==t.key||"block"!==e.style.display||(t.stopPropagation(),e.style.display="none")}))},ai=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),si=(function(e){e.TopLeft="top-left",e.TopRight="top-right",e.BottomLeft="bottom-left",e.BottomRight="bottom-right",e.NonFixed="non-fixed"}(ti=ti||{}),function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.position=ti.NonFixed,t}return ai(t,e),t}(Ur)),li=function(){function e(e){var t;e&&(t=void 0,3<=(t="string"==typeof e?this.getRBGA(e):e).length)&&(this.r=t[0],this.g=t[1],this.b=t[2],3<t.length)&&(this.a=t[3])}return e.prototype.getLuminosity=function(){for(var e=[this.r,this.g,this.b],t=[],r=0;r<e.length;r++){var n=e[r]/255;t[r]=n<=.03928?n/12.92:Math.pow((.055+n)/1.055,2.4)}return.2126*t[0]+.7152*t[1]+.0722*t[2]},e.prototype.getRBGA=function(e){var t=document.createElement("canvas").getContext("2d");return[(e=(t.globalAlpha=1,t.fillStyle=e,t.fillRect(0,0,1,1),t.getImageData(0,0,1,1).data))[0],e[1],e[2],e[3]]},e}(),ci=(function(e){e.light="light",e.dark="dark",e.auto="auto"}(ri=ri||{}),Map),ui=function(){function e(){this.listeners=new ci}return e.prototype._addEventListener=function(e,t,r){this.listeners.has(e)||this.listeners.set(e,new ci),this.listeners.get(e).set(t,r)},e.prototype._removeEventListener=function(e,t){this.listeners.has(e)&&this.listeners.get(e).delete(t)},e.prototype._invokeEvent=function(e,t){var r=this;this.listeners.has(e)&&this.listeners.get(e).forEach((function(n,i){n&&r._removeEventListener(e,i);try{i(t)}catch(n){console.error(n)}}))},e}(),hi=Object.freeze({__proto__:null,EventEmitter:ui}),di=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),pi=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onStyleChange=function(){t._map.getStyle().style.toLowerCase().startsWith("blank")?t._observer||(t._onBackgroundChange(),t._observer=new MutationObserver(t._onBackgroundChange),t._observer.observe(t._map.getMapContainer(),{attributes:!0,attributeFilter:["style"]})):(t._observer&&(t._observer.disconnect(),delete t._observer),t._map.styles.getThemeAsync(t._map.getStyle()).then((function(e){t._setTheme(e)})))},t._onBackgroundChange=function(){var e=new li(t._map.getMapContainer().style.backgroundColor).getLuminosity();e=isNaN(e)||.5<e?ri.light:ri.dark;t._setTheme(e)},t}return di(t,e),t.prototype.onRemove=function(){this._container&&(this._container.remove(),delete this._container),this._map&&(this._map.events.remove("stylechanged",this._onStyleChange),delete this._map),this._observer&&(this._observer.disconnect(),delete this._observer),delete this._theme},t.prototype.buildContainer=function(e,t,r,n){return this._map=e,this._container=document.createElement(n||"div"),this._container.classList.add("azure-maps-control-container"),"string"==typeof r&&this._container.setAttribute("aria-label",r),t.toLowerCase()===ri.auto?this._map&&this._map.events.add("stylechanged",this._onStyleChange):this._container.classList.add(t),this._container},t.prototype._setTheme=function(e){this._theme!==e&&(this._container.classList.remove(this._theme),this._container.classList.add(e),this._theme=e)},t.activateClickDelay=100,t}(ui),fi=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),mi=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rotationDegreesDelta=15,t.style=ri.light,t.inverted=!1,t}return fi(t,e),t}(Ur),gi=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),yi=function(e){function t(t){var r=e.call(this)||this;return r.hasMouse=!1,r.hasFocus=!1,r.options=(new mi).merge(t),r}return gi(t,e),t.prototype.onAdd=function(e,r){function n(e){e?(o.classList.add("in-use"),s.setAttribute("aria-hidden","false"),s.classList.remove("hidden-accessible-element")):(o.classList.remove("in-use"),s.setAttribute("aria-hidden","true"),s.classList.add("hidden-accessible-element"))}var i=this,o=this.buildContainer(e,this.options.style,"Rotation Control"),a=this.constructRotationButton(e),s=this.constructRotationGrid(e,r),l=ii("Reset to Default Rotation");return o.addEventListener("mouseover",(function(e){i.lastActiveTime=i.lastActiveTime||e.timeStamp,i.hasMouse=!0,n(!0)})),o.addEventListener("focusin",(function(e){i.lastActiveTime=i.lastActiveTime||e.timeStamp,i.hasFocus=!0,n(!0)})),o.addEventListener("mouseleave",(function(){i.hasMouse=!1,i.hasFocus||(delete i.lastActiveTime,n(!1))})),o.addEventListener("focusout",(function(e){e.relatedTarget instanceof Node&&o.contains(e.relatedTarget)||(i.hasFocus=!1,i.hasMouse)||(delete i.lastActiveTime,n(!1))})),s.addEventListener("keydown",(function(e){"Escape"!==e.key&&"Esc"!==e.key||(e.stopPropagation(),a.focus(),n(!1))})),a.addEventListener("keydown",(function(e){"Escape"!==e.key&&"Esc"!==e.key||null==o||!o.classList.contains("in-use")||"none"!==(null==l?void 0:l.style.display)||(e.stopPropagation(),n(!1))})),r&&t.InvertOrderPositions.includes(r.position)?(o.appendChild(s),o.appendChild(a),o.appendChild(l),oi(l,a)):(o.appendChild(a),o.appendChild(l),oi(l,a),o.appendChild(s)),o},t.prototype.constructRotationGrid=function(e,r){var n=document.createElement("div"),i=(n.classList.add("sub-container"),n.classList.add("hidden-accessible-element"),n.setAttribute("aria-hidden","true"),this.constructRightRotationButton(e)),o=(e=this.constructLeftRotationButton(e),ii("Rotate Left")),a=ii("Rotate Right");return r&&t.InvertOrderPositions.includes(r.position)?(n.appendChild(i),n.appendChild(a),oi(a,i),n.appendChild(e),n.appendChild(o),oi(o,e)):(n.appendChild(e),n.appendChild(o),oi(o,e),n.appendChild(i),n.appendChild(a),oi(a,i)),n},t.prototype.constructRotationButton=function(e){var r=this,n=document.createElement("button"),i=(n.classList.add("azure-maps-control-button"),n.classList.add("rotation"),n.setAttribute("aria-label","Reset to Default Rotation"),n.setAttribute("alt","Reset to Default Rotation"),n.setAttribute("type","button"),document.createElement("div"));return n.appendChild(i),n.addEventListener("click",(function(n){n.timeStamp-r.lastActiveTime>pi.activateClickDelay&&e.setCamera({bearing:t.DefaultRotation},!0)})),e.events.add("rotate",(function(e){i.style.transform="rotate(".concat(-e.map.getCamera().bearing,"deg)")})),n},t.prototype.constructRightRotationButton=function(e){var r=this,n=document.createElement("button");return n.classList.add("azure-maps-control-button"),n.classList.add("rotation-right"),n.setAttribute("aria-label","Rotate Right"),n.setAttribute("alt","Rotate Right"),n.setAttribute("type","button"),n.addEventListener("click",(function(){e.setCamera({bearing:e.getCamera().bearing-(r.options.inverted?-1:1)*r.options.rotationDegreesDelta,duration:t.RotationDuration,type:"ease"},!0)})),n},t.prototype.constructLeftRotationButton=function(e){var r=this,n=document.createElement("button");return n.classList.add("azure-maps-control-button"),n.classList.add("rotation-left"),n.setAttribute("aria-label","Rotate Left"),n.setAttribute("alt","Rotate Left"),n.setAttribute("type","button"),n.addEventListener("click",(function(){e.setCamera({bearing:e.getCamera().bearing+(r.options.inverted?-1:1)*r.options.rotationDegreesDelta,duration:t.RotationDuration,type:"ease"},!0)})),n},t.DefaultRotation=0,t.RotationDuration=100,t.InvertOrderPositions=[ti.BottomRight,ti.TopRight],t}(pi),vi=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),_i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.pitchDegreesDelta=10,t.style=ri.light,t.inverted=!1,t}return vi(t,e),t}(Ur),bi=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),wi=function(e){function t(t){var r=e.call(this)||this;return r.container=null,r.map=null,r.pitchButton=null,r.pitchIncrementButton=null,r.pitchDecrementButton=null,r.hasMouse=!1,r.hasFocus=!1,r.pitchChanged=function(e){return r.updatePitchButtonsState()},r.updatePitchButtonsState=function(){var e=r.map.getCamera().pitch<=0,t=60<=r.map.getCamera().pitch;r.hasFocus&&r.pitchButton&&(e||t)&&r.pitchButton.focus(),r.options.inverted?(r.pitchIncrementButton&&r.pitchIncrementButton.disabled!=e&&(r.pitchIncrementButton.disabled=e),r.pitchDecrementButton&&r.pitchDecrementButton.disabled!=t&&(r.pitchDecrementButton.disabled=t)):(r.pitchIncrementButton&&r.pitchIncrementButton.disabled!=t&&(r.pitchIncrementButton.disabled=t),r.pitchDecrementButton&&r.pitchDecrementButton.disabled!=e&&(r.pitchDecrementButton.disabled=e))},r.options=(new _i).merge(t),r}return bi(t,e),t.prototype.onAdd=function(e,r){function n(e){e?(o.classList.add("in-use"),s.setAttribute("aria-hidden","false"),s.classList.remove("hidden-accessible-element")):(o.classList.remove("in-use"),s.setAttribute("aria-hidden","true"),s.classList.add("hidden-accessible-element"))}var i=this,o=this.buildContainer(e,this.options.style,"Pitch Control"),a=this.constructPitchButton(e),s=this.constructPitchGrid(e,r),l=ii("Reset to Default Pitch");return o.addEventListener("mouseover",(function(e){i.lastActiveTime=i.lastActiveTime||e.timeStamp,i.hasMouse=!0,n(!0)})),o.addEventListener("focusin",(function(e){i.lastActiveTime=i.lastActiveTime||e.timeStamp,i.hasFocus=!0,n(!0)})),o.addEventListener("mouseleave",(function(){i.hasMouse=!1,i.hasFocus||(delete i.lastActiveTime,n(!1))})),o.addEventListener("focusout",(function(e){e.relatedTarget instanceof Node&&o.contains(e.relatedTarget)||(i.hasFocus=!1,i.hasMouse)||(delete i.lastActiveTime,n(!1))})),s.addEventListener("keydown",(function(e){"Escape"!==e.key&&"Esc"!==e.key||(e.stopPropagation(),a.focus(),n(!1))})),a.addEventListener("keydown",(function(e){"Escape"!==e.key&&"Esc"!==e.key||null==o||!o.classList.contains("in-use")||"none"!==(null==l?void 0:l.style.display)||(e.stopPropagation(),n(!1))})),r&&t.INVERT_ORDER_POSITIONS.includes(r.position)?(o.appendChild(s),o.appendChild(a),o.appendChild(l),oi(l,o)):(o.appendChild(a),o.appendChild(l),oi(l,o),o.appendChild(s)),this.map=e,this.container=o,this.pitchButton=a,e.events.add("pitch",this.pitchChanged),this.updatePitchButtonsState(),o},t.prototype.onRemove=function(){this.container&&(this.container.remove(),this.container=null,this.pitchButton=null,this.pitchIncrementButton=null,this.pitchDecrementButton=null),this.map&&(this.map.events.remove("pitch",this.pitchChanged),this.map=null)},t.prototype.constructPitchGrid=function(e,r){var n=document.createElement("div"),i=(e=(n.classList.add("sub-container"),n.classList.add("hidden-accessible-element"),n.setAttribute("aria-hidden","true"),this.pitchIncrementButton=this.constructPitchIncrementButton(e),this.pitchDecrementButton=this.constructPitchDecrementButton(e),ii("Increase Pitch")),ii("Decrease Pitch"));return r&&t.INVERT_ORDER_POSITIONS.includes(r.position)?(n.appendChild(this.pitchDecrementButton),n.appendChild(i),oi(i,this.pitchDecrementButton),n.appendChild(this.pitchIncrementButton),n.appendChild(e),oi(e,this.pitchIncrementButton)):(n.appendChild(this.pitchIncrementButton),n.appendChild(e),oi(e,this.pitchIncrementButton),n.appendChild(this.pitchDecrementButton),n.appendChild(i),oi(i,this.pitchDecrementButton)),n},t.prototype.constructPitchButton=function(e){var r=this,n=document.createElement("button");return n.classList.add("azure-maps-control-button"),n.classList.add("pitch"),n.setAttribute("aria-label","Reset to Default Pitch"),n.setAttribute("alt","Reset to Default Pitch"),n.setAttribute("type","button"),n.addEventListener("click",(function(){event.timeStamp-r.lastActiveTime>pi.activateClickDelay&&e.setCamera({pitch:t.DEFAULT_PITCH},!0)})),n},t.prototype.constructPitchDecrementButton=function(e){var r=this,n=document.createElement("button");return n.classList.add("azure-maps-control-button"),n.classList.add("pitch-down"),n.setAttribute("aria-label","Decrease Pitch"),n.setAttribute("alt","Decrease Pitch"),n.setAttribute("type","button"),n.addEventListener("click",(function(){e.setCamera({pitch:e.getCamera().pitch-(r.options.inverted?-1:1)*r.options.pitchDegreesDelta,duration:t.PITCH_DURATION_MS,type:"ease"},!0)})),n},t.prototype.constructPitchIncrementButton=function(e){var r=this,n=document.createElement("button");return n.classList.add("azure-maps-control-button"),n.classList.add("pitch-up"),n.setAttribute("aria-label","Increase Pitch"),n.setAttribute("alt","Increase Pitch"),n.setAttribute("type","button"),n.addEventListener("click",(function(){e.setCamera({pitch:e.getCamera().pitch+(r.options.inverted?-1:1)*r.options.pitchDegreesDelta,duration:t.PITCH_DURATION_MS,type:"ease"},!0)})),n},t.PITCH_DURATION_MS=100,t.DEFAULT_PITCH=0,t.INVERT_ORDER_POSITIONS=[ti.BottomRight,ti.TopRight],t}(pi),xi=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ci=function(e){function t(t){var r=e.call(this)||this;return r.map=null,r.control=new sr.ScaleControl({maxWidth:null==t?void 0:t.maxWidth,unit:null==t?void 0:t.unit}),r}return xi(t,e),t.prototype.onAdd=function(e,t){this.map=e,null!=(r=null==(r=this.map)?void 0:r._getMap())&&r.addControl(this.control);var r=this.buildContainer(e,ri.auto,"Scale Bar");return r.appendChild(null==(e=this.control)?void 0:e._container),r},t.prototype.onRemove=function(){var t;e.prototype.onRemove.call(this),null!=(t=null==(t=this.map)?void 0:t._getMap())&&t.removeControl(this.control),this.map=null},t.prototype.setUnit=function(e){var t;null!=(t=this.control)&&t.setUnit(e)},t}(pi);var Si=function(){this.__data__=[],this.size=0};var Ei=function(e,t){return e===t||e!=e&&t!=t},Ti=Ei;var Ii=function(e,t){for(var r=e.length;r--;)if(Ti(e[r][0],t))return r;return-1},ki=Ii,Ai=Array.prototype.splice;function Pi(e){var t=this.__data__;return!((e=ki(t,e))<0||(e==t.length-1?t.pop():Ai.call(t,e,1),--this.size,0))}var Mi=Ii;function Ri(e){var t=this.__data__;return(e=Mi(t,e))<0?void 0:t[e][1]}var Oi=Ii;function Li(e){return-1<Oi(this.__data__,e)}var Di=Ii;function Ni(e,t){var r=this.__data__,n=Di(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var zi=Si,Fi=Pi,Bi=Ri,Ui=Li,ji=Ni;function qi(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}qi.prototype.clear=zi,qi.prototype.delete=Fi,qi.prototype.get=Bi,qi.prototype.has=Ui,qi.prototype.set=ji;var Hi=qi,Vi=Hi;var Gi=function(){this.__data__=new Vi,this.size=0};var Ki=function(e){var t=this.__data__;return e=t.delete(e),this.size=t.size,e};var Zi=function(e){return this.__data__.get(e)};var Wi=function(e){return this.__data__.has(e)},$i="object"==typeof nr&&nr&&nr.Object===Object&&nr,Yi=$i,Xi="object"==typeof self&&self&&self.Object===Object&&self,Qi=Yi||Xi||Function("return this")(),Ji=Qi.Symbol,eo=Ji,to=Object.prototype,ro=to.hasOwnProperty,no=to.toString,io=eo?eo.toStringTag:void 0;var oo=function(e){var t=ro.call(e,io),r=e[io];try{var n=!(e[io]=void 0)}catch(e){}var i=no.call(e);return n&&(t?e[io]=r:delete e[io]),i},ao=Object.prototype.toString;function so(e){return ao.call(e)}var lo=oo,co=so,uo=Ji?Ji.toStringTag:void 0;var ho=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":(uo&&uo in Object(e)?lo:co)(e)};var po=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},fo=ho,mo=po;var go=function(e){return!!mo(e)&&("[object Function]"==(e=fo(e))||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e)},yo=Qi["__core-js_shared__"],vo=yo,_o=function(){var e=/[^.]+$/.exec(vo&&vo.keys&&vo.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();var bo=function(e){return!!_o&&_o in e},wo=Function.prototype.toString;var xo=function(e){if(null!=e){try{return wo.call(e)}catch(e){}try{return e+""}catch(e){}}return""},Co=go,So=bo,Eo=po,To=xo,Io=/^\[object .+?Constructor\]$/,ko=Function.prototype,Ao=Object.prototype,Po=ko.toString,Mo=Ao.hasOwnProperty,Ro=RegExp("^"+Po.call(Mo).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Oo(e){return!(!Eo(e)||So(e))&&(Co(e)?Ro:Io).test(To(e))}function Lo(e,t){return null==e?void 0:e[t]}var Do=Oo,No=Lo;var zo=function(e,t){return e=No(e,t),Do(e)?e:void 0},Fo=zo(Qi,"Map"),Bo=zo(Object,"create"),Uo=Bo;var jo=function(){this.__data__=Uo?Uo(null):{},this.size=0};var qo=function(e){return e=this.has(e)&&delete this.__data__[e],this.size-=e?1:0,e},Ho=Bo,Vo=Object.prototype.hasOwnProperty;var Go=function(e){var t,r=this.__data__;return Ho?"__lodash_hash_undefined__"===(t=r[e])?void 0:t:Vo.call(r,e)?r[e]:void 0},Ko=Bo,Zo=Object.prototype.hasOwnProperty;function Wo(e){var t=this.__data__;return Ko?void 0!==t[e]:Zo.call(t,e)}var $o=Bo;function Yo(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=$o&&void 0===t?"__lodash_hash_undefined__":t,this}var Xo=jo,Qo=qo,Jo=Go,ea=Wo,ta=Yo;function ra(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}ra.prototype.clear=Xo,ra.prototype.delete=Qo,ra.prototype.get=Jo,ra.prototype.has=ea,ra.prototype.set=ta;var na=ra,ia=Hi,oa=Fo;function aa(){this.size=0,this.__data__={hash:new na,map:new(oa||ia),string:new na}}function sa(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}var la=sa;function ca(e,t){return e=e.__data__,la(t)?e["string"==typeof t?"string":"hash"]:e.map}var ua=ca;function ha(e){return e=ua(this,e).delete(e),this.size-=e?1:0,e}var da=ca;function pa(e){return da(this,e).get(e)}var fa=ca;function ma(e){return fa(this,e).has(e)}var ga=ca;function ya(e,t){var r=ga(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var va=aa,_a=ha,ba=pa,wa=ma,xa=ya;function Ca(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Ca.prototype.clear=va,Ca.prototype.delete=_a,Ca.prototype.get=ba,Ca.prototype.has=wa,Ca.prototype.set=xa;var Sa=Ca,Ea=Hi,Ta=Fo,Ia=Sa;function ka(e,t){var r=this.__data__;if(r instanceof Ea){var n=r.__data__;if(!Ta||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Ia(n)}return r.set(e,t),this.size=r.size,this}var Aa=Hi,Pa=Gi,Ma=Ki,Ra=Zi,Oa=Wi,La=ka;function Da(e){e=this.__data__=new Aa(e),this.size=e.size}Da.prototype.clear=Pa,Da.prototype.delete=Ma,Da.prototype.get=Ra,Da.prototype.has=Oa,Da.prototype.set=La;var Na=Da;var za=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e},Fa=zo,Ba=function(){try{var e=Fa(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),Ua=Ba,ja=Ua;var qa=function(e,t,r){"__proto__"==t&&ja?ja(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r},Ha=qa,Va=Ei,Ga=Object.prototype.hasOwnProperty;var Ka=function(e,t,r){var n=e[t];Ga.call(e,t)&&Va(n,r)&&(void 0!==r||t in e)||Ha(e,t,r)},Za=Ka,Wa=qa;var $a=function(e,t,r,n){for(var i=!r,o=(r=r||{},-1),a=t.length;++o<a;){var s=t[o],l=n?n(r[s],e[s],s,r,e):void 0;void 0===l&&(l=e[s]),(i?Wa:Za)(r,s,l)}return r};var Ya=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n};var Xa=function(e){return null!=e&&"object"==typeof e},Qa=ho,Ja=Xa;function es(e){return Ja(e)&&"[object Arguments]"==Qa(e)}var ts=es,rs=Xa,ns=Object.prototype,is=ns.hasOwnProperty,os=ns.propertyIsEnumerable,as=ts(function(){return arguments}())?ts:function(e){return rs(e)&&is.call(e,"callee")&&!os.call(e,"callee")},ss=as,ls=Array.isArray,cs={exports:{}};var us=function(){return!1},hs=(function(e,t){var r;t=(r=(r=(t=t&&!t.nodeType&&t)&&e&&!e.nodeType&&e)&&r.exports===t?Qi.Buffer:void 0)?r.isBuffer:void 0;e.exports=t||us}(cs,cs.exports),cs.exports),ds=/^(?:0|[1-9]\d*)$/;var ps=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&ds.test(e))&&-1<e&&e%1==0&&e<t};var fs=function(e){return"number"==typeof e&&-1<e&&e%1==0&&e<=9007199254740991},ms=ho,gs=fs,ys=Xa,vs={};vs["[object Float32Array]"]=vs["[object Float64Array]"]=vs["[object Int8Array]"]=vs["[object Int16Array]"]=vs["[object Int32Array]"]=vs["[object Uint8Array]"]=vs["[object Uint8ClampedArray]"]=vs["[object Uint16Array]"]=vs["[object Uint32Array]"]=!0,vs["[object Arguments]"]=vs["[object Array]"]=vs["[object ArrayBuffer]"]=vs["[object Boolean]"]=vs["[object DataView]"]=vs["[object Date]"]=vs["[object Error]"]=vs["[object Function]"]=vs["[object Map]"]=vs["[object Number]"]=vs["[object Object]"]=vs["[object RegExp]"]=vs["[object Set]"]=vs["[object String]"]=vs["[object WeakMap]"]=!1;var _s=function(e){return ys(e)&&gs(e.length)&&!!vs[ms(e)]};var bs=function(e){return function(t){return e(t)}},ws={exports:{}},xs=(function(e,t){var r=(t=t&&!t.nodeType&&t)&&e&&!e.nodeType&&e,n=r&&r.exports===t&&$i.process;t=function(){try{var e=r&&r.require&&r.require("util").types;return e||n&&n.binding&&n.binding("util")}catch(e){}}();e.exports=t}(ws,ws.exports),ws.exports),Cs=_s,Ss=bs,Es=xs&&xs.isTypedArray,Ts=Es?Ss(Es):Cs,Is=Ya,ks=ss,As=ls,Ps=hs,Ms=ps,Rs=Ts,Os=Object.prototype.hasOwnProperty;var Ls=function(e,t){var r,n=As(e),i=!n&&ks(e),o=!n&&!i&&Ps(e),a=!n&&!i&&!o&&Rs(e),s=n||i||o||a,l=s?Is(e.length,String):[],c=l.length;for(r in e)!t&&!Os.call(e,r)||s&&("length"==r||o&&("offset"==r||"parent"==r)||a&&("buffer"==r||"byteLength"==r||"byteOffset"==r)||Ms(r,c))||l.push(r);return l},Ds=Object.prototype;var Ns=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Ds)};var zs=function(e,t){return function(r){return e(t(r))}},Fs=zs(Object.keys,Object),Bs=Ns,Us=Fs,js=Object.prototype.hasOwnProperty;function qs(e){if(!Bs(e))return Us(e);var t,r=[];for(t in Object(e))js.call(e,t)&&"constructor"!=t&&r.push(t);return r}var Hs=go,Vs=fs;var Gs=function(e){return null!=e&&Vs(e.length)&&!Hs(e)},Ks=Ls,Zs=qs,Ws=Gs;var $s=function(e){return(Ws(e)?Ks:Zs)(e)},Ys=$a,Xs=$s;var Qs=function(e,t){return e&&Ys(t,Xs(t),e)};function Js(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}var el=po,tl=Ns,rl=Js,nl=Object.prototype.hasOwnProperty;function il(e){if(!el(e))return rl(e);var t,r=tl(e),n=[];for(t in e)("constructor"!=t||!r&&nl.call(e,t))&&n.push(t);return n}var ol=Ls,al=il,sl=Gs;var ll=function(e){return sl(e)?ol(e,!0):al(e)},cl=$a,ul=ll;var hl=function(e,t){return e&&cl(t,ul(t),e)},dl={exports:{}},pl=(function(e,t){var r,n=(r=(r=(t=t&&!t.nodeType&&t)&&e&&!e.nodeType&&e)&&r.exports===t?Qi.Buffer:void 0)?r.allocUnsafe:void 0;e.exports=function(e,t){return t?e.slice():(t=e.length,t=n?n(t):new e.constructor(t),e.copy(t),t)}}(dl,dl.exports),dl.exports);var fl=function(e,t){var r=-1,n=e.length;for(t=t||Array(n);++r<n;)t[r]=e[r];return t};function ml(e,t){for(var r=-1,n=null==e?0:e.length,i=0,o=[];++r<n;){var a=e[r];t(a,r,e)&&(o[i++]=a)}return o}var gl=function(){return[]},yl=ml,vl=gl,_l=Object.prototype.propertyIsEnumerable,bl=Object.getOwnPropertySymbols,wl=bl?function(e){return null==e?[]:(e=Object(e),yl(bl(e),(function(t){return _l.call(e,t)})))}:vl,xl=wl,Cl=$a,Sl=xl;var El=function(e,t){return Cl(e,Sl(e),t)};var Tl=function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e},Il=zs(Object.getPrototypeOf,Object),kl=Tl,Al=Il,Pl=xl,Ml=gl,Rl=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)kl(t,Pl(e)),e=Al(e);return t}:Ml,Ol=$a,Ll=Rl;var Dl=function(e,t){return Ol(e,Ll(e),t)},Nl=Tl,zl=ls;function Fl(e,t,r){return t=t(e),zl(e)?t:Nl(t,r(e))}var Bl=Fl,Ul=xl,jl=$s;var ql=function(e){return Bl(e,jl,Ul)},Hl=Fl,Vl=Rl,Gl=ll;var Kl=function(e){return Hl(e,Gl,Vl)},Zl=zo(Qi,"DataView"),Wl=zo(Qi,"Promise"),$l=zo(Qi,"Set"),Yl=zo(Qi,"WeakMap"),Xl=Zl,Ql=Fo,Jl=Wl,ec=$l,tc=Yl,rc=ho,nc=xo,ic="[object Map]",oc="[object Promise]",ac="[object Set]",sc="[object WeakMap]",lc="[object DataView]",cc=nc(Xl),uc=nc(Ql),hc=nc(Jl),dc=nc(ec),pc=nc(tc),fc=rc,mc=fc=Xl&&fc(new Xl(new ArrayBuffer(1)))!=lc||Ql&&fc(new Ql)!=ic||Jl&&fc(Jl.resolve())!=oc||ec&&fc(new ec)!=ac||tc&&fc(new tc)!=sc?function(e){var t=rc(e);if(e=(e="[object Object]"==t?e.constructor:void 0)?nc(e):"")switch(e){case cc:return lc;case uc:return ic;case hc:return oc;case dc:return ac;case pc:return sc}return t}:fc,gc=Object.prototype.hasOwnProperty;var yc=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&gc.call(e,"index")&&(r.index=e.index,r.input=e.input),r},vc=Qi.Uint8Array,_c=vc;var bc=function(e){var t=new e.constructor(e.byteLength);return new _c(t).set(new _c(e)),t},wc=bc;var xc=function(e,t){return t=t?wc(e.buffer):e.buffer,new e.constructor(t,e.byteOffset,e.byteLength)},Cc=/\w*$/;var Sc=function(e){var t=new e.constructor(e.source,Cc.exec(e));return t.lastIndex=e.lastIndex,t},Ec=Ji?Ji.prototype:void 0,Tc=Ec?Ec.valueOf:void 0;function Ic(e){return Tc?Object(Tc.call(e)):{}}var kc=bc;var Ac=function(e,t){return t=t?kc(e.buffer):e.buffer,new e.constructor(t,e.byteOffset,e.length)},Pc=bc,Mc=xc,Rc=Sc,Oc=Ic,Lc=Ac;var Dc=function(e,t,r){var n=e.constructor;switch(t){case"[object ArrayBuffer]":return Pc(e);case"[object Boolean]":case"[object Date]":return new n(+e);case"[object DataView]":return Mc(e,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return Lc(e,r);case"[object Map]":case"[object Set]":return new n;case"[object Number]":case"[object String]":return new n(e);case"[object RegExp]":return Rc(e);case"[object Symbol]":return Oc(e)}},Nc=po,zc=Object.create,Fc=function(){function e(){}return function(t){return Nc(t)?zc?zc(t):(e.prototype=t,t=new e,e.prototype=void 0,t):{}}}(),Bc=Fc,Uc=Il,jc=Ns;var qc=function(e){return"function"!=typeof e.constructor||jc(e)?{}:Bc(Uc(e))},Hc=mc,Vc=Xa;function Gc(e){return Vc(e)&&"[object Map]"==Hc(e)}var Kc=Gc,Zc=bs,Wc=xs&&xs.isMap,$c=Wc?Zc(Wc):Kc,Yc=mc,Xc=Xa;function Qc(e){return Xc(e)&&"[object Set]"==Yc(e)}var Jc=Qc,eu=bs,tu=xs&&xs.isSet,ru=tu?eu(tu):Jc,nu=Na,iu=za,ou=Ka,au=Qs,su=hl,lu=pl,cu=fl,uu=El,hu=Dl,du=ql,pu=Kl,fu=mc,mu=yc,gu=Dc,yu=qc,vu=ls,_u=hs,bu=$c,wu=po,xu=ru,Cu=$s,Su=ll,Eu="[object Arguments]",Tu="[object Function]",Iu="[object Object]",ku={};ku[Eu]=ku["[object Array]"]=ku["[object ArrayBuffer]"]=ku["[object DataView]"]=ku["[object Boolean]"]=ku["[object Date]"]=ku["[object Float32Array]"]=ku["[object Float64Array]"]=ku["[object Int8Array]"]=ku["[object Int16Array]"]=ku["[object Int32Array]"]=ku["[object Map]"]=ku["[object Number]"]=ku[Iu]=ku["[object RegExp]"]=ku["[object Set]"]=ku["[object String]"]=ku["[object Symbol]"]=ku["[object Uint8Array]"]=ku["[object Uint8ClampedArray]"]=ku["[object Uint16Array]"]=ku["[object Uint32Array]"]=!0,ku["[object Error]"]=ku[Tu]=ku["[object WeakMap]"]=!1;var Au=function e(t,r,n,i,o,a){var s,l=1&r,c=2&r,u=4&r;if(void 0===(s=n?o?n(t,i,o,a):n(t):s)){if(!wu(t))return t;if(i=vu(t)){if(s=mu(t),!l)return cu(t,s)}else{var h=fu(t),d=h==Tu||"[object GeneratorFunction]"==h;if(_u(t))return lu(t,l);if(h==Iu||h==Eu||d&&!o){if(s=c||d?{}:yu(t),!l)return c?hu(t,su(s,t)):uu(t,au(s,t))}else{if(!ku[h])return o?t:{};s=gu(t,h,l)}}if(d=(a=a||new nu).get(t))return d;a.set(t,s),xu(t)?t.forEach((function(i){s.add(e(i,r,n,i,t,a))})):bu(t)&&t.forEach((function(i,o){s.set(o,e(i,r,n,o,t,a))}));var p=i?void 0:(u?c?pu:du:c?Su:Cu)(t);iu(p||t,(function(i,o){p&&(i=t[o=i]),ou(s,o,e(i,r,n,o,t,a))}))}return s},Pu=Au;function Mu(e){return Pu(e,5)}var Ru=ir(Mu),Ou=qa,Lu=Ei;var Du=function(e,t,r){(void 0===r||Lu(e[t],r))&&(void 0!==r||t in e)||Ou(e,t,r)};function Nu(e){return function(t,r,n){for(var i=-1,o=Object(t),a=n(t),s=a.length;s--;){var l=a[e?s:++i];if(!1===r(o[l],l,o))break}return t}}var zu=Nu(),Fu=Gs,Bu=Xa;var Uu=function(e){return Bu(e)&&Fu(e)},ju=ho,qu=Il,Hu=Xa,Vu=Function.prototype,Gu=Object.prototype,Ku=Vu.toString,Zu=Gu.hasOwnProperty,Wu=Ku.call(Object);var $u=function(e){return!(!Hu(e)||"[object Object]"!=ju(e))&&(null===(e=qu(e))||"function"==typeof(e=Zu.call(e,"constructor")&&e.constructor)&&e instanceof e&&Ku.call(e)==Wu)};function Yu(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var Xu=$a,Qu=ll;function Ju(e){return Xu(e,Qu(e))}var eh=Du,th=pl,rh=Ac,nh=fl,ih=qc,oh=ss,ah=ls,sh=Uu,lh=hs,ch=go,uh=po,hh=$u,dh=Ts,ph=Yu,fh=Ju;function mh(e,t,r,n,i,o,a){var s,l,c,u=ph(e,r),h=ph(t,r),d=a.get(h);d||((t=void 0===(d=o?o(u,h,r+"",e,t,a):void 0))&&(l=!(s=ah(h))&&lh(h),c=!s&&!l&&dh(h),d=h,s||l||c?d=ah(u)?u:sh(u)?nh(u):l?th(h,!(t=!1)):c?rh(h,!(t=!1)):[]:hh(h)||oh(h)?oh(d=u)?d=fh(u):uh(u)&&!ch(u)||(d=ih(h)):t=!1),t&&(a.set(h,d),i(d,h,n,o,a),a.delete(h))),eh(e,r,d)}var gh=Na,yh=Du,vh=zu,_h=mh,bh=po,wh=ll,xh=Yu;var Ch=function e(t,r,n,i,o){t!==r&&vh(r,(function(a,s){var l;o=o||new gh,bh(a)?_h(t,r,s,n,e,i,o):(l=i?i(xh(t,s),a,s+"",t,r,o):void 0,yh(t,s,l=void 0===l?a:l))}),wh)};var Sh=function(e){return e};function Eh(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var Th=Eh,Ih=Math.max;var kh=function(e,t,r){return t=Ih(void 0===t?e.length-1:t,0),function(){for(var n=arguments,i=-1,o=Ih(n.length-t,0),a=Array(o);++i<o;)a[i]=n[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=n[i];return s[t]=r(a),Th(e,this,s)}};function Ah(e){return function(){return e}}var Ph=Ah,Mh=Ua,Rh=Mh?function(e,t){return Mh(e,"toString",{configurable:!0,enumerable:!1,value:Ph(t),writable:!0})}:Sh,Oh=Rh,Lh=Date.now;function Dh(e){var t=0,r=0;return function(){var n=Lh(),i=16-(n-r);if(r=n,0<i){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var Nh=Dh(Oh),zh=Sh,Fh=kh,Bh=Nh;function Uh(e,t){return Bh(Fh(e,t,zh),e+"")}var jh=Ei,qh=Gs,Hh=ps,Vh=po;function Gh(e,t,r){var n;return!!Vh(r)&&!!("number"==(n=typeof t)?qh(r)&&Hh(t,r.length):"string"==n&&t in r)&&jh(r[t],e)}var Kh=Uh,Zh=Gh;function Wh(e){return Kh((function(t,r){var n=-1,i=r.length,o=1<i?r[i-1]:void 0,a=2<i?r[2]:void 0;o=3<e.length&&"function"==typeof o?(i--,o):void 0;for(a&&Zh(r[0],r[1],a)&&(o=i<3?void 0:o,i=1),t=Object(t);++n<i;){var s=r[n];s&&e(t,s,n,o)}return t}))}var $h=Ch,Yh=Wh((function(e,t,r){$h(e,t,r)})),Xh=ir(Yh),Qh=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Jh=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.layout="icons",t.mapStyles=["road","grayscale_light","grayscale_dark","night","road_shaded_relief"],t.style=ri.light,t.autoSelectionMode=!0,t}return Qh(t,e),t}(Ur),ed=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),td=window&&window.__awaiter||function(e,t,r,n){return new(r=r||Promise)((function(i,o){function a(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))},rd=window&&window.__generator||function(e,t){var r,n,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a={next:s(0),throw:s(1),return:s(2)};return"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(r)throw new TypeError("Generator is already executing.");for(;o=a&&c[a=0]?0:o;)try{if(r=1,n&&(i=2&c[0]?n.return:c[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,c[1])).done)return i;switch(n=0,(c=i?[2&c[0],i.value]:c)[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=0<(i=o.trys).length&&i[i.length-1])&&(6===c[0]||2===c[0])){o=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3]))o.label=c[1];else if(6===c[0]&&o.label<i[1])o.label=i[1],i=c;else{if(!(i&&o.label<i[2])){i[2]&&o.ops.pop(),o.trys.pop();continue}o.label=i[2],o.ops.push(c)}}c=t.call(e,o)}catch(l){c=[6,l],n=0}finally{r=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}},nd=window&&window.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=o.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a},id=function(e){function t(t){var r=e.call(this)||this;return r.styleOpsGrid=null,r.hasMouse=!1,r.hasFocus=!1,r.styleButtons=new ci,r.styleIcons=new ci,r.thumbnailCache={assumedConfiguration:void 0,response:new ci,blob:new ci},r.onStyleChange=function(){var e;r.options.autoSelectionMode&&(e=r.map.getStyle().style,r.setSelectedStyle(e))},r.onMapConfigurationChange=function(e){!r.styleOpsGrid||0<r.styleOpsGrid.children.length&&r.thumbnailCache.assumedConfiguration===e||(r.thumbnailCache.assumedConfiguration=e,Array.from(r.styleOpsGrid.children).forEach((function(e){return e.remove()})),r.styleButtons.clear(),r.populateOpsGridFromDefinitions(e))},r.mapToFriendlyStyleName=function(e,t){return(null==(t=t.configurations.find((function(t){return t.name===e})))?void 0:t.displayName)||e},r.options=(new Jh).merge(Ru(t)),r}return ed(t,e),t.prototype.onAdd=function(e,r){function n(e){e?(o.classList.add(t.Css.inUse),a.setAttribute("aria-hidden","false"),a.classList.remove("hidden-accessible-element")):(o.classList.remove(t.Css.inUse),a.setAttribute("aria-hidden","true"),a.classList.add("hidden-accessible-element"))}var i=this,o=(this.map=e,this.buildContainer(e,this.options.style,"Map Style Control")),a=this.buildStyleOpsGrid(),s=(this.styleOpsGrid=a,this.buildCurrStyleBtn());e=ii("Select Style");return a.classList.add(r&&r.position||"top-right"),o.addEventListener("mouseover",(function(){i.hasMouse=!0,n(!0)})),o.addEventListener("focusin",(function(){i.hasFocus=!0,n(!0)})),o.addEventListener("mouseleave",(function(){i.hasMouse=!1,i.hasFocus||n(!1)})),o.addEventListener("focusout",(function(e){e.target===s&&Array.from(a.children).forEach((function(e){return e.removeAttribute("tabIndex")})),e.relatedTarget instanceof Node&&o.contains(e.relatedTarget)||(i.hasFocus=!1,i.hasMouse)||n(!1)})),a.addEventListener("keydown",(function(e){27===e.keyCode&&(e.stopPropagation(),s.focus(),Array.from(a.children).forEach((function(e){return e.setAttribute("tabIndex","-1")})),o.classList.contains(t.Css.inUse))&&n(!1)})),s.addEventListener("click",(function(e){o.classList.contains(t.Css.inUse)?n(!1):(n(!0),a.firstElementChild&&a.firstElementChild.focus())})),r&&t.InvertOrderPositions.includes(r.position)?(o.appendChild(a),o.appendChild(s),o.appendChild(e),oi(e,s)):(o.appendChild(s),o.appendChild(e),oi(e,s),o.appendChild(a)),o},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.styleOpsGrid=null,this.styleButtons.clear(),this.thumbnailCache.response.clear(),this.thumbnailCache.blob.clear(),this.thumbnailCache.assumedConfiguration=void 0,this.map.events.remove("stylechanged",this.onStyleChange),this.map.events.remove("mapconfigurationchanged",this.onMapConfigurationChange)},t.prototype.setSelectedStyle=function(e){var t,r,n=this;this.styleIcons.has(e)&&(t=this.currStyleImage,r=this.styleIcons.get(e),t.src!==r&&(t.src=r),Object.entries(this.styleButtons).forEach((function(t){var r=(t=nd(t,2))[0];return t[1].setAttribute("aria-current",r===e?"true":"false")})),this.map.styles.definitions().then((function(r){r=n.mapToFriendlyStyleName(e,r),t.alt!==r&&(t.alt=r),t.parentElement.lastChild instanceof Text&&(t.parentElement.lastChild.textContent=r)})))},t.prototype.disableStyle=function(e){(e=this.styleButtons[e])&&e.setAttribute("disabled","true")},t.prototype.enableStyle=function(e){(e=this.styleButtons[e])&&e.removeAttribute("disabled")},t.prototype.buildSelectStyleBtn=function(e,r,n){var i=this,o=document.createElement("button"),a=this.mapToFriendlyStyleName(e,r),s=(o.setAttribute("aria-label",a),o.setAttribute("type","button"),new Image);n.then((function(e){var t;return i.thumbnailCache.blob.has(e.url)?i.thumbnailCache.blob.get(e.url):(t=e.clone().blob(),i.thumbnailCache.blob.set(e.url,t),t)})).then((function(t){t=URL.createObjectURL(t),s.src=t,e===i.map.getStyle().style&&(i.currStyleImage.src=t,i.currStyleImage.alt=a,i.currStyleImage.parentElement.lastChild.nodeType==Node.TEXT_NODE?i.currStyleImage.parentElement.lastChild.textContent=a:i.currStyleImage.parentElement.appendChild(document.createTextNode(a))),i.styleIcons.set(e,t)})),s.setAttribute("aria-hidden","true"),o.appendChild(s),"icons"===this.options.layout?o.classList.add(t.Css.button):(o.classList.add(t.Css.listButton),o.classList.add(t.Css.expanded),o.appendChild(document.createTextNode(a))),o.addEventListener("click",(function(){i.hasMouse=!1,i.hasFocus=!1;var t=i.styleButtons[e];t&&!t.hasAttribute("disabled")&&(i._invokeEvent("styleselected",e),i.options.autoSelectionMode&&i.map.setStyle({style:e}),Object.entries(i.styleButtons).forEach((function(t){var r=(t=nd(t,2))[0];return t[1].setAttribute("aria-current",r===e?"true":"false")})))})),r=document.createElement("div");return r.classList.add("selected-icon"),o.appendChild(r),o},t.prototype.buildCurrStyleBtn=function(){var e=document.createElement("button"),r=("icons"==this.options.layout?e.classList.add(t.Css.button):e.classList.add(t.Css.listButton),e.classList.add(t.Css.currentStyle),e.setAttribute("aria-label","Select Style"),e.setAttribute("tabindex","-1"),this.currStyleImage=new Image,e.appendChild(this.currStyleImage),document.createElement("div"));return r.classList.add("icon"),e.appendChild(r),e},t.prototype.buildStyleOpsGrid=function(){var e=this,r=document.createElement("div");return r.classList.add(t.Css.styleOptions),"icons"===this.options.layout?r.classList.add(this.options.layout):r.classList.add(t.Css.dropdown),r.setAttribute("aria-label","Style Options"),r.classList.add("hidden-accessible-element"),r.setAttribute("aria-hidden","true"),this.map.styles.definitions().then((function(t){return td(e,void 0,void 0,(function(){return rd(this,(function(e){return this.onMapConfigurationChange(t),this.map.events.add("stylechanged",this.onStyleChange),[2]}))}))})),this.map.events.add("mapconfigurationchanged",this.onMapConfigurationChange),r},t.prototype.populateOpsGridFromDefinitions=function(e){var t,r,n=this;this.styleOpsGrid&&(t=e.configurations,(t=Array.isArray(this.options.mapStyles)?t.filter((function(e){return n.options.mapStyles.includes(e.name.split("_indoor")[0])})):t).forEach((function(t){var r,i={url:t.thumbnail},o=((o=(t.thumbnail&&n.map.styles._transformStyleRequest(t.thumbnail,i),n.map.getServiceOptions())).transformRequest&&Xh(i,o.transformRequest(i.url,"Thumbnail")),n.thumbnailCache.response.has(i.url)?r=Promise.resolve(n.thumbnailCache.response.get(i.url)):(r=fetch(i.url,{headers:i.headers}),n.thumbnailCache.response.set(i.url,r)),n.buildSelectStyleBtn(t.name,e,r));n.styleOpsGrid.appendChild(o),n.styleButtons[t.name]=o,"icons"===n.options.layout&&(i=ii(n.mapToFriendlyStyleName(t.name,e)),n.styleOpsGrid.appendChild(i),oi(i,o))})),r=this.map.getStyle().style,Object.entries(this.styleButtons).forEach((function(e){var t=(e=nd(e,2))[0];return e[1].setAttribute("aria-current",t===r?"true":"false")})))},t.InvertOrderPositions=[ti.TopRight,ti.BottomRight],t.Css={button:"azure-maps-control-button",listButton:"azure-maps-control-list-button",expanded:"expanded",currentStyle:"curr-style",inUse:"in-use",styleOptions:"style-options",dropdown:"azure-maps-control-dropdown"},t}(pi),od=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ad=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.flow="none",t.incidents=!1,t}return od(t,e),t}(Ur),sd=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ld=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isActive=!1,t.style=ri.light,t}return sd(t,e),t}(ad),cd=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ud=function(e){function t(t){var r,n=this;return(n=e.call(this)||this).hasMouse=!1,n.hasFocus=!1,n.options=(new ad).merge({flow:"relative",incidents:!0}),n.style=ri.light,n.container=null,n.trafficButton=null,n.map=null,t&&(n.initIsActive=null!=(r=t.isActive)&&r,n.options.flow=t.flow||"relative",n.options.incidents=null==(r=t.incidents)||r,n.style=t.style||ri.light),n}return cd(t,e),Object.defineProperty(t.prototype,"isActive",{get:function(){var e;return!!this.map&&("none"!==(e=this.map.getTraffic()).flow||e.incidents)},set:function(e){this.map&&this.map.setTraffic({flow:e?this.options.flow:"none",incidents:!!e&&this.options.incidents})},enumerable:!1,configurable:!0}),t.prototype.onAdd=function(e){(this.map=e).getTraffic(),void 0!==this.initIsActive&&(this.isActive=this.initIsActive),this.container=this.buildContainer(e,this.style,"Traffic Control"),this.container.style.flexDirection="column";e=this.constructTrafficButton(e);var t=(this.container.appendChild(e),ii("Toggle Traffic Display"));return this.container.appendChild(t),oi(t,e),this.container},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.map=null},t.prototype.getOptions=function(){return(new ld).merge({isActive:this.isActive,flow:this.options.flow,incidents:this.options.incidents,style:this.style})},t.prototype.updateButtonState=function(){this.trafficButton&&(this.isActive?(this.container.classList.add("in-use"),this.trafficButton.setAttribute("aria-description","Traffic is displayed")):(this.container.classList.remove("in-use"),this.trafficButton.removeAttribute("aria-description")),this.trafficButton.setAttribute("aria-pressed",this.isActive?"true":"false"))},t.prototype.constructTrafficButton=function(e){var t=this,r=document.createElement("button");return r.classList.add("azure-maps-control-button"),r.classList.add("traffic"),r.setAttribute("aria-label","Toggle Traffic Display"),r.setAttribute("alt","Toggle Traffic Display"),r.setAttribute("type","button"),this.trafficButton=r,this.updateButtonState(),r.addEventListener("click",(function(){t.isActive=!t.isActive})),r},t}(pi),hd=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),dd=window&&window.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},pd=function(e){function t(){var t=e.call(this)||this;return t.table=["Fast",["green","yellow","red","dark-red"],"Slow"],t.map=null,t.syncHiddenState=null,t}return hd(t,e),t.prototype.onAdd=function(e){this.map=e;var t=this.buildContainer(e,ri.auto,"Traffic Legend");e=this.buildTrafficLegendDiv(e);return t.setAttribute("role","definition"),t.appendChild(e),t},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.syncHiddenState&&(this.map.events.remove("styledata",this.syncHiddenState),this.syncHiddenState=null),this.map=null},t.prototype.buildTrafficLegendDiv=function(e){var t,r,n,i,o=document.createElement("div"),a=(o.classList.add("traffic-legend","hidden"),o.setAttribute("alt","Traffic Legend"),document.createElement("table")),s=document.createElement("tr"),l=document.createElement("td"),c=(l.setAttribute("alt","Traffic"),l.appendChild(document.createTextNode("Traffic")),ii("Traffic")),u=(l.classList.add("traffic-legend-title"),l.colSpan=6,s.appendChild(l),s.appendChild(c),oi(c,l),a.appendChild(s),document.createElement("tr"));try{for(var h=dd(this.table),d=h.next();!d.done;d=h.next()){var p=d.value,f=document.createElement("td");if("Fast"===p||"Slow"===p)f.setAttribute("alt",p),f.appendChild(document.createTextNode(p)),f.classList.add("traffic-legend-text");else{f.classList.add("traffic-legend-colors"),f.setAttribute("aria-label","Traffic Legend"),f.setAttribute("role","img");try{n=void 0;for(var m=dd(p),g=m.next();!g.done;g=m.next()){var y=g.value,v=document.createElement("div");v.classList.add(y),f.appendChild(v)}}catch(r){n={error:r}}finally{try{g&&!g.done&&(i=m.return)&&i.call(m)}finally{if(n)throw n.error}}}u.appendChild(f);var _=ii(p instanceof Array?"Traffic Legend":p);u.appendChild(_),oi(_,f)}}catch(r){t={error:r}}finally{try{d&&!d.done&&(r=h.return)&&r.call(h)}finally{if(t)throw t.error}}return a.appendChild(u),o.appendChild(a),this.syncHiddenState=function(t){"style"===t.dataType&&((t=e.getTraffic()).flow&&"none"!==t.flow?o.classList.remove("hidden"):o.classList.add("hidden"))},this.syncHiddenState({dataType:"style"}),e.events.add("styledata",this.syncHiddenState),o},t}(pi);function fd(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}function md(e){return this.__data__.has(e)}var gd=Sa,yd=fd,vd=md;function _d(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new gd;++t<r;)this.add(e[t])}_d.prototype.add=_d.prototype.push=yd,_d.prototype.has=vd;function bd(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}function wd(e,t){return e.has(t)}var xd=_d,Cd=bd,Sd=wd;var Ed=function(e,t,r,n,i,o){var a=1&r,s=e.length;if(s!=(l=t.length)&&!(a&&s<l))return!1;var l=o.get(e),c=o.get(t);if(l&&c)return l==t&&c==e;var u=-1,h=!0,d=2&r?new xd:void 0;for(o.set(e,t),o.set(t,e);++u<s;){var p,f=e[u],m=t[u];if(void 0!==(p=n?a?n(m,f,u,t,e,o):n(f,m,u,e,t,o):p)){if(p)continue;h=!1;break}if(d){if(!Cd(t,(function(e,t){if(!Sd(d,t)&&(f===e||i(f,e,r,n,o)))return d.push(t)}))){h=!1;break}}else if(f!==m&&!i(f,m,r,n,o)){h=!1;break}}return o.delete(e),o.delete(t),h};function Td(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}function Id(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}var kd=vc,Ad=Ei,Pd=Ed,Md=Td,Rd=Id,Od=Ji?Ji.prototype:void 0,Ld=Od?Od.valueOf:void 0;var Dd=function(e,t,r,n,i,o,a){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!o(new kd(e),new kd(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Ad(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var s=Md;case"[object Set]":if(s=s||Rd,e.size!=t.size&&!(1&n))return!1;var l=a.get(e);return l?l==t:(n|=2,a.set(e,t),l=Pd(s(e),s(t),n,i,o,a),a.delete(e),l);case"[object Symbol]":if(Ld)return Ld.call(e)==Ld.call(t)}return!1},Nd=ql,zd=Object.prototype.hasOwnProperty;function Fd(e,t,r,n,i,o){var a=1&r,s=Nd(e),l=s.length;if(l!=Nd(t).length&&!a)return!1;for(var c=l;c--;){var u=s[c];if(!(a?u in t:zd.call(t,u)))return!1}var h=o.get(e),d=o.get(t);if(h&&d)return h==t&&d==e;for(var p=!0,f=(o.set(e,t),o.set(t,e),a);++c<l;){var m,g=e[u=s[c]],y=t[u];if(!(void 0===(m=n?a?n(y,g,u,t,e,o):n(g,y,u,e,t,o):m)?g===y||i(g,y,r,n,o):m)){p=!1;break}f=f||"constructor"==u}return p&&!f&&(h=e.constructor)!=(d=t.constructor)&&"constructor"in e&&"constructor"in t&&!("function"==typeof h&&h instanceof h&&"function"==typeof d&&d instanceof d)&&(p=!1),o.delete(e),o.delete(t),p}var Bd=Na,Ud=Ed,jd=Dd,qd=Fd,Hd=mc,Vd=ls,Gd=hs,Kd=Ts,Zd="[object Arguments]",Wd="[object Array]",$d="[object Object]",Yd=Object.prototype.hasOwnProperty;function Xd(e,t,r,n,i,o){var a=Vd(e),s=Vd(t),l=a?Wd:Hd(e),c=(s=s?Wd:Hd(t),(l=l==Zd?$d:l)==$d),u=(s=s==Zd?$d:s)==$d;if((s=l==s)&&Gd(e)){if(!Gd(t))return!1;c=!(a=!0)}return s&&!c?(o=o||new Bd,a||Kd(e)?Ud(e,t,r,n,i,o):jd(e,t,l,r,n,i,o)):1&r||(a=c&&Yd.call(e,"__wrapped__"),l=u&&Yd.call(t,"__wrapped__"),!a&&!l)?s&&(o=o||new Bd,qd(e,t,r,n,i,o)):i(a?e.value():e,l?t.value():t,r,n,o=o||new Bd)}var Qd=Xd,Jd=Xa;function ep(e,t,r,n,i){return e===t||(null==e||null==t||!Jd(e)&&!Jd(t)?e!=e&&t!=t:Qd(e,t,r,n,ep,i))}var tp=ep;function rp(e,t){return tp(e,t)}var np,ip,op,ap,sp,lp=ir(rp),cp=function(){function e(t,r,n,i){this.type="Feature",this.type=e.TYPE,this.properties=r||{},this.id=n,this.geometry=t,this.bbox=i}return e.TYPE="Feature",e}(),up=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),hp=function(e){function t(t,r){return e.call(this,t,r)||this}return up(t,e),t.fromData=function(e){var r=NaN,n=NaN,i=new Set(["y"]),o=new Set(["x"]);return Object.keys(e).forEach((function(t){var a=t.toLowerCase();isNaN(r)&&i.has(a)&&"number"==typeof e[t]?r=e[t]:isNaN(n)&&o.has(a)&&"number"==typeof e[t]&&(n=e[t])})),isNaN(r)||isNaN(n)?null:new t(r,n)},t.getX=function(e){return 0<e.length?e[0]:NaN},t.getY=function(e){return 1<e.length?e[1]:NaN},t.getDestination=function(e,r,n){return new t(t.getX(e)+n*Math.cos((r+270)*Math.PI/180),t.getY(e)+n*Math.sin((r+270)*Math.PI/180))},t.getDistance=function(e,r){var n=t.getX(e)-t.getX(r);e=t.getY(e)-t.getY(r);return Math.sqrt(n*n+e*e)},t.getHeading=function(e,r){var n=t.getX(r)-t.getX(e);e=t.getY(e)-t.getY(r);return 180*(2.5*Math.PI-Math.atan2(e,n))/Math.PI%360},t}(Array),dp=function(){function e(t){this.type="Point",this.type=e.TYPE,this.coordinates=t}return e.TYPE="Point",e}(),pp=window&&window.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=o.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a},fp=window&&window.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},mp=6378137,gp=Math.PI/180,yp=180/Math.PI,vp=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9],_p=85.0511;function bp(e){return e*gp}function wp(e){return e*yp}function xp(e,t,r){return Math.min(Math.max(e,t),r)}function Cp(e,t){var r=bp(t[1]-e[1]),n=bp(t[0]-e[0]);r=Math.pow(Math.sin(r/2),2)+Math.cos(bp(e[1]))*Math.cos(bp(t[1]))*Math.pow(Math.sin(n/2),2),e=2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r));return Math.round(mp*e*100)/100}function Sp(e){if(e)switch(e.toLowerCase()){case"feet":case"foot":case"ft":return ip.feet;case"kilometers":case"kilometer":case"kilometres":case"kilometre":case"km":case"kms":return ip.kilometers;case"miles":case"mile":case"mi":return ip.miles;case"nauticalmiles":case"nauticalmile":case"nms":case"nm":return ip.nauticalMiles;case"yards":case"yard":case"yds":case"yrd":case"yrds":return ip.yards;default:return ip.meters}return ip.meters}function Ep(e){if(e)switch(e.toLowerCase()){case"milespersecondsquared":case"milepersecondsquared":case"mi/s^2":case"mi/s2":return sp.milesPerSecondSquared;case"kilometerspersecondsquared":case"kilometrespersecondsquared":case"kilometerpersecondsquared":case"kilometrepersecondsquared":case"km/s^2":case"km/s2":return sp.kilometersPerSecondSquared;case"knotspersecond":case"knotpersecond":case"knts/s":case"kn/s":case"kt/s":return sp.knotsPerSecond;case"standardgravity":case"g":return sp.standardGravity;case"feetpersecondsquared":case"footpersecondsquared":case"ft/s^2":case"ft/s2":return sp.feetPerSecondSquared;case"yardspersecondsquared":case"yardpersecondsquared":case"yds/s^2":case"yds/s2":case"yd/s^2":case"yd/s2":return sp.yardsPerSecondSquared;case"milesperhoursecond":case"mileperhoursecond":case"milesperhourseconds":case"mileperhourseconds":case"mi/h/s":return sp.milesPerHourSecond;case"kilometersperhoursecond":case"kilometrespersoursecond":case"kilometerperhoursecond":case"kilometrepersoursecond":case"kilometersperhourssecond":case"kilometrespersourssecond":case"kilometerperhourssecond":case"kilometrepersourssecond":case"kmhs":case"km/h/s":return sp.kilometersPerHourSecond;default:return sp.metersPerSecondSquared}return sp.metersPerSecondSquared}function Tp(e){if(e)switch(e){case"acres":case"ac":return np.acres;case"hectares":case"ha":return np.hectares;case"squareFeet":case"ft^2":case"ft2":return np.squareFeet;case"squareYards":case"squareYard":case"yds^2":case"yds2":case"yd^2":case"yd2":return np.squareYards;case"squareKilometers":case"squareKilometres":case"squareKilometer":case"squareKilometre":case"km^2":case"km2":return np.squareKilometers;case"squareMiles":case"squareMile":case"mi^2":case"mi2":return np.squareMiles;default:return np.squareMeters}return np.squareMeters}function Ip(e){if(e)switch(e.toLowerCase()){case"feetpersecond":case"footsecond":case"ftps":case"ft/s":return ap.feetPerSecond;case"milesperhour":case"mileperhour":case"mph":case"mi/hr":case"mi/h":return ap.milesPerHour;case"knots":case"knot":case"knts":case"knt":case"kn":case"kt":return ap.knots;case"mach":case"m":return ap.mach;case"kilometersperhour":case"kilometresperhour":case"kmperhour":case"kmph":case"km/hr":case"km/h":return ap.kilometersPerHour;default:return ap.metersPerSecond}return ap.metersPerSecond}function kp(e){if(e)switch(e.toLowerCase()){case"milliseconds":case"ms":return op.ms;case"minutes":case"minute":case"mins":case"min":return op.minutes;case"hours":case"hour":case"hr":case"h":return op.hours;case"days":case"day":case"d":return op.days;default:return op.seconds}return op.seconds}function Ap(e){var t=0;if(e&&0<e.length){t=Math.abs(Pp(e[0]));for(var r=1,n=e.length;r<n;r++)t-=Math.abs(Pp(e[r]))}return t}function Pp(e){var t=0;if(3<=e.length){for(var r=void 0,n=void 0,i=0,o=e.length;i<o;i++)t+=(bp(e[i===o-2?(r=o-2,n=o-1,0):i===o-1?(r=o-1,n=0,1):(n=(r=i)+1,i+2)][0])-bp(e[r][0]))*Math.sin(bp(e[n][1]));t=t*mp*mp/2}return t}function Mp(e,t,r){return(e[0]-r[0])*(t[1]-r[1])-(e[1]-r[1])*(t[0]-r[0])}function Rp(e,t,r){if(2<=r.length){for(var n,i,o,a=1/0,s=null,l=Qp(r,22),c=0,u=l.length-1;c<u;c++)i=Op(t,l[c],l[c+1]),(n=hp.getDistance(t,i))<a&&(a=n,s=i);if(s)return o=Xp([s],22)[0],new cp(new dp(o),{distance:zp(e,o)})}else if(1===r.length)return new cp(new dp(r[0]),{distance:zp(e,r[0])});return null}function Op(e,t,r){var n,i;return t[0]===r[0]&&t[1]===r[1]||(i=e[0]-t[0],e=e[1]-t[1],(e=((n=r[0]-t[0])*i+(i=r[1]-t[1])*e)/(n*n+i*i))<0)?t:1<e?r:[t[0]+n*e,t[1]+i*e]}function Lp(e,t){var r;return!isNaN(e)&&"number"==typeof t&&0<=t&&(void 0,r=t<vp.length?vp[t]:Math.pow(10,t),e=Math.round(e*r)/r),e}function Dp(e,t,r,n){switch(Sp(t)){case ip.meters:e/=1e3;break;case ip.feet:e/=3280.8399;break;case ip.miles:e/=.62137119;break;case ip.yards:e/=1093.6133;break;case ip.nauticalMiles:e/=.5399568;case ip.kilometers:}switch(Sp(r)){case ip.meters:e*=1e3;break;case ip.feet:e*=3280.8399;break;case ip.miles:e*=.62137119;break;case ip.yards:e*=1093.6133;break;case ip.nauticalMiles:e*=.5399568;case ip.kilometers:}return"number"==typeof n&&0<=n&&(t=Math.pow(10,n),e=Math.round(e*t)/t),e}function Np(e,t,r,n){n=n||"meters",e=cf(e);n=Fp(n);var i=bp(e[1]);e=bp(e[0]),t=bp(t),r/=n,n=Math.asin(Math.sin(i)*Math.cos(r)+Math.cos(i)*Math.sin(r)*Math.cos(t)),e+=Math.atan2(Math.sin(t)*Math.sin(r)*Math.cos(i),Math.cos(r)-Math.sin(i)*Math.sin(n)),t=xp(Wp(wp(n)),-85,85);return[$p(wp(e)),t]}function zp(e,t,r){return e=Cp(e=cf(e),t=cf(t)),"meters"===r?e:Dp(e,"meters",r||"meters")}function Fp(e){return e=Sp(e),Dp(mp,ip.meters,e)}function Bp(e,t,r){for(var n=[],i=bp(e[1]),o=bp(e[0]),a=bp(t[1]),s=bp(t[0]),l=2*Math.asin(Math.sqrt(Math.pow(Math.sin((i-a)/2),2)+Math.cos(i)*Math.cos(a)*Math.pow(Math.sin((o-s)/2),2))),c=0;c<=r;c++){var u=c/r,h=Math.sin((1-u)*l)/Math.sin(l),d=(u=Math.sin(u*l)/Math.sin(l),h*Math.cos(i)*Math.cos(o)+u*Math.cos(a)*Math.cos(s)),p=h*Math.cos(i)*Math.sin(o)+u*Math.cos(a)*Math.sin(s);h=h*Math.sin(i)+u*Math.sin(a),u=Math.atan2(h,Math.sqrt(Math.pow(d,2)+Math.pow(p,2))),h=Math.atan2(p,d),u=xp(wp(u),-85,85),h=wp(h);n.push([h,u])}return n}function Up(e){return(Array.isArray(e)?e:e.coordinates).reduce((function(e,t){var r=0<e.length?e[e.length-1]:null;return r&&180<Math.abs(t[0]-r[0])?(r=r[0]<0?t[0]-360:t[0]+360,e.push([r,t[1]])):e.push(t),e}),[])}function jp(e){for(var t,r,n,i,o,a=Array.isArray(e)?e:e.coordinates,s=[],l=[],c=0;c<a.length;c++)s.push(a[c]),c+1>=a.length||(t=(r=pp(a[c],2))[0],r=r[1],i=(o=pp(a[c+1],2))[0],o=o[1],180<Math.abs(i-t)&&(n=0<t?180:-180,i=Math.abs((0<t?i+360:i-360)-t),o=r+(o-r)*(Math.abs(n-t)/i),s.push([n,o]),l.push(s),s=[[-n,o]]));return l.push(s),l}function qp(e,t){var r,n;return e=cf(e),t=cf(t),e&&2<=e.length&&t&&2<=t.length?(n=bp(e[1]),r=bp(t[1]),t=bp(t[0]-e[0]),e=Math.sin(t)*Math.cos(r),n=Math.cos(n)*Math.sin(r)-Math.sin(n)*Math.cos(r)*Math.cos(t),(wp(Math.atan2(e,n))+360)%360):NaN}function Hp(e,t){var r,n=0;Array.isArray(e)?r=e:e.type&&"LineString"===e.type&&(r=e.coordinates);for(var i=0,o=r.length-1;i<o;i++)n+=Cp(r[i],r[i+1]);return Dp(n,"meters",t||"meters")}function Vp(e,t,r){r=r||"meters";var n,i=0;if(Array.isArray(e)?n=e:e.type&&"LineString"===e.type&&(n=e.coordinates),2<=n.length){for(var o,a,s=n.length,l=1;l<s;l++){if(t<=i+(a=zp(n[l-1],n[l],r)))return o=qp(n[l-1],n[l]),Np(n[l-1],o,t-i,r);i+=a}return i<=t?n[s-1]:n[0]}return null}function Gp(e,t,r,n,i){n=n||"meters",i=i||0,e=cf(e);for(var o=[],a=360/r,s=0;s<=r;s++)o.push(Np(e,(s*a+i)%360,t,n));return o}function Kp(e,t,r,n,i){return Up(Gp(e,t,r,n,i))}function Zp(e,t,r){r=void 0===r?.5:r;var n=zp(e=cf(e),t=cf(t),"kilometers");return Np(e,qp(e,t),n*r,"kilometers")}function Wp(e){return 90<e?180<(e=(e+90)%360)?90-(e-180):e-90:e<-90?(e=(e-90)%360)<-180?-90-(e+180):e+90:e}function $p(e){return 180<e?(e+180)%360-180:e<-180?(e-180)%360+180:e}function Yp(e,t,r){if(0===r)return Object.assign({},e);t=cf(t);for(var n,i,o=[],a=0,s=e.length;a<s;a++)n=zp(t,e[a]),i=qp(t,e[a]),o.push(Np(t,i+r,n));return o}function Xp(e,t){for(var r,n,i=512*Math.pow(2,t),o=[],a=0,s=e.length;a<s;a++)r=e[a][0]/i-.5,n=.5-e[a][1]/i,o.push([360*r,90-360*Math.atan(Math.exp(2*-n*Math.PI))/Math.PI]);return o}function Qp(e,t){for(var r,n,i=512*Math.pow(2,t),o=[],a=0,s=e.length;a<s;a++)n=Math.sin(e[a][1]*Math.PI/180),r=(e[a][0]+180)/360,n=.5-Math.log((1+n)/(1-n))/(4*Math.PI),o.push([Math.round(r*i),Math.round(n*i)]);return o}function Jp(e,t,r,n){switch(Ep(t)){case sp.kilometersPerHourSecond:e/=3.6;break;case sp.milesPerHourSecond:e/=2.236936292054;break;case sp.knotsPerSecond:e/=1.943844492441;break;case sp.standardGravity:e/=.1019716212978;break;case sp.kilometersPerSecondSquared:e/=.001;break;case sp.milesPerSecondSquared:e/=.000621371192;break;case sp.feetPerSecondSquared:e/=3.280839895012;break;case sp.yardsPerSecondSquared:e/=1.093613298338;case sp.metersPerSecondSquared:}switch(Ep(r)){case sp.kilometersPerHourSecond:e*=3.6;break;case sp.milesPerHourSecond:e*=2.236936292054;break;case sp.knotsPerSecond:e*=1.943844492441;break;case sp.standardGravity:e*=.1019716212978;break;case sp.kilometersPerSecondSquared:e*=.001;break;case sp.milesPerSecondSquared:e*=.000621371192;break;case sp.feetPerSecondSquared:e*=3.280839895012;break;case sp.yardsPerSecondSquared:e*=1.093613298338;case sp.metersPerSecondSquared:}return Lp(e,n)}function ef(e,t,r,n){switch(Tp(t)){case np.acres:e*=4046.8564224;break;case np.hectares:e*=1e4;break;case np.squareFeet:e*=.09290304;break;case np.squareKilometers:e*=1e6;break;case np.squareMiles:e*=259e4;break;case np.squareYards:e*=.83612736;case np.squareMeters:}switch(Tp(r)){case np.acres:e/=4046.8564224;break;case np.hectares:e/=1e4;break;case np.squareFeet:e/=.09290304;break;case np.squareKilometers:e/=1e6;break;case np.squareMiles:e/=259e4;break;case np.squareYards:e/=.83612736;case np.squareMeters:}return Lp(e,n)}function tf(e,t,r,n){switch(Ip(t)){case ap.feetPerSecond:e*=1.09728;break;case ap.milesPerHour:e*=1.6093;break;case ap.knots:e*=1.852;break;case ap.metersPerSecond:e*=3.6;break;case ap.mach:e*=1234.8;case ap.kilometersPerHour:}switch(Ip(r)){case ap.feetPerSecond:e/=1.09728;break;case ap.milesPerHour:e/=1.6093;break;case ap.knots:e/=1.852;break;case ap.metersPerSecond:e/=3.6;break;case ap.mach:e/=1234.8;case ap.kilometersPerHour:}return Lp(e,n)}function rf(e,t,r,n){switch(kp(t)){case op.ms:e/=1e3;break;case op.hours:e*=3600;break;case op.minutes:e*=60;break;case op.days:e*=86400;case op.seconds:}switch(kp(r)){case op.ms:e*=1e3;break;case op.hours:e/=3600;break;case op.minutes:e/=60;break;case op.days:e/=86400;case op.seconds:}return Lp(e,n)}function nf(e,t,r,n,i,o,a,s){return t=Dp(t,i,ip.meters),i=rf(r,o,op.seconds),Jp(2*(t-tf(e,n,ap.metersPerSecond)*i)/(i*i),sp.metersPerSecondSquared,a,s)}function of(e,t,r,n,i,o,a){return e=tf(e,n,ap.metersPerSecond),Jp((tf(t,n,ap.metersPerSecond)-e)/rf(r,i,op.seconds),sp.metersPerSecondSquared,o,a)}function af(e,t,r,n){return e=sf(e),t=sf(t),null!=e&&null!=t?rf(t.getTime()-e.getTime(),op.ms,r,n):NaN}function sf(e){if("[object Date]"===Object.prototype.toString.call(e))return e;if("string"==typeof e){var t=Date.parse(e);if(!isNaN(t))return new Date(t);if(0<=e.indexOf("Date("))return t=(t=0)<(e=e.replace("/Date(","").replace(")/","")).indexOf("+")?parseInt(e.substr(0,e.indexOf("+")),10):0<e.indexOf("-")?parseInt(e.substr(0,e.indexOf("-")),10):parseInt(e,10),new Date(t)}else if("number"==typeof e)return new Date(e);return null}function lf(e){var t=[],r=null,n=null;if(Array.isArray(e)&&0<e.length)if(Array.isArray(e[0])&&"number"==typeof e[0][0])t=e;else for(var i=e.length,o=0;o<i;o++)t=t.concat(lf(e[o]));else if(e.type)switch(e.type){case"Point":t=[e.coordinates];break;case"LineString":case"MultiPoint":t=e.coordinates;break;case"Polygon":case"MultiLineString":r=e.coordinates;break;case"MultiPolygon":n=e.coordinates;break;case"Feature":var a=e;t=yf._isCircle(a)?yf._getCirclePositions(a):lf(a.geometry);break;case"FeatureCollection":t=lf(e.features);break;case"GeometryCollection":t=lf(e.geometries)}else if(e instanceof yf)return lf(e.toJson());if(r)for(i=r.length,o=0;o<i;o++)t=t.concat(r[o]);else if(n){var s=n.length;for(o=0;o<s;o++)for(var l=n[o].length,c=0;c<l;c++)t=t.concat(n[o][c])}return t}function cf(e){if(Array.isArray(e)&&"number"==typeof e[0])return e;if(e.type){if("Point"===e.type)return e.coordinates;if("Feature"===e.type&&"Point"===e.geometry.type)return e.geometry.coordinates}else if(e instanceof yf&&"Point"===e.getType())return e.getCoordinates();return null}function uf(e,t,r){r=r||"meters";var n,i=0;if(Array.isArray(e)?n=e:e.type&&"LineString"===e.type&&(n=e.coordinates),2<=n.length){for(var o,a,s,l=n.length,c=1;c<l;c++){if(t<=i+(s=zp(n[c-1],n[c],r)))return o=qp(n[c-1],n[c]),a=Np(n[c-1],o,t-i,r),new cp(new dp(a),{heading:o});i+=s}return i<=t?new cp(new dp(n[l-1]),{heading:qp(n[l-2],n[l-1])}):new cp(new dp(n[0]),{heading:qp(n[0],n[1])})}return null}function hf(e,t,r,n){var i=cf(e),o=Qp([i],22)[0],a=null,s=1/0;switch((t=t instanceof yf?t.toJson():t).type){case"Feature":return hf(e,t.geometry,r);case"Point":p=[[t.coordinates]];break;case"MultiPoint":for(var l,c=t.coordinates,u=0,h=c.length;u<h;u++)(l=zp(i,c[u]))<s&&(s=l,a=new cp(new dp(c[u]),{distance:l}));break;case"LineString":p=[t.coordinates];break;case"Polygon":case"MultiLineString":p=t.coordinates;break;case"MultiPolygon":var d=t.coordinates;if(0<d.length){var p=d[0];for(u=1,h=d.length;u<h;u++)p=p.concat(d[u])}}if(p){var f;for(u=0,h=p.length;u<h;u++)(f=Rp(i,o,p[u]))&&f.properties.distance<s&&(s=f.properties.distance,a=f)}return a&&(a.properties.distance=Dp(a.properties.distance,"meters",r,n)),a}!function(e){e.squareMeters="squareMeters",e.acres="acres",e.hectares="hectares",e.squareFeet="squareFeet",e.squareKilometers="squareKilometers",e.squareMiles="squareMiles",e.squareYards="squareYards"}(np=np||{}),function(e){e.meters="meters",e.kilometers="kilometers",e.feet="feet",e.miles="miles",e.nauticalMiles="nauticalMiles",e.yards="yards"}(ip=ip||{}),function(e){e.seconds="seconds",e.hours="hours",e.ms="ms",e.minutes="minutes",e.days="days"}(op=op||{}),function(e){e.metersPerSecond="metersPerSecond",e.kilometersPerHour="kilometersPerHour",e.feetPerSecond="feetPerSecond",e.milesPerHour="milesPerHour",e.knots="knots",e.mach="mach"}(ap=ap||{}),function(e){e.milesPerSecondSquared="milesPerSecondSquared",e.kilometersPerSecondSquared="kilometersPerSecondSquared",e.knotsPerSecond="knotsPerSecond",e.standardGravity="standardGravity",e.feetPerSecondSquared="feetPerSecondSquared",e.yardsPerSecondSquared="yardsPerSecondSquared",e.milesPerHourSecond="milesPerHourSecond",e.kilometersPerHourSecond="kilometersPerHourSecond",e.metersPerSecondSquared="metersPerSecondSquared"}(sp=sp||{});var df=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),pf=function(e){function t(t,r,n){return n?e.call(this,t,r,n)||this:e.call(this,t,r)||this}return df(t,e),t.fromPosition=function(e){return 2===e.length?new t(e[0],e[1]):2<e.length?new t(e[0],e[1],e[2]):null},t.areEqual=function(e,t,r){var n,i;return void 0===r&&(r=6),!!(e&&2<=e.length&&t&&2<=t.length)&&(r=Math.pow(10,r),i=Wp(e[1]),n=Wp(t[1]),e=$p(e[0]),t=$p(t[0]),0==Math.round((i-n)*r)/r)&&(0==(i=Math.round((e-t)*r)/r)||360==i)},t.fromLatLng=function(e,t,r){var n,i,o,a,s,l,c=[];return"number"==typeof e?("number"==typeof t&&c.push(t),c.push(e),"number"==typeof r&&c.push(r)):Array.isArray(e)?2<=e.length&&"number"==typeof e[0]&&"number"==typeof e[1]&&(3<=e.length&&"number"==typeof e[2]?c.push(e[1],e[0],e[2]):c.push(e[1],e[0])):"object"==typeof e&&(n=["lat","latitude","y"],i=["lng","longitude","lon","x"],o=["elv","elevation","alt","altitude","z"],l=s=a=NaN,Object.keys(e).forEach((function(t,r,c){var u=t.toLowerCase();isNaN(a)&&0<=n.indexOf(u)&&"number"==typeof e[t]?a=e[t]:isNaN(s)&&0<=i.indexOf(u)&&"number"==typeof e[t]?s=e[t]:isNaN(l)&&0<=o.indexOf(u)&&"number"==typeof e[t]&&(l=e[t])})),isNaN(a)||isNaN(s)||(c.push(s,a),isNaN(l))||c.push(l)),2<=c.length?c:null},t.fromLatLngs=function(e){var r=[];if(Array.isArray(e))for(var n=0,i=e.length;n<i;n++){var o=t.fromLatLng(e[n]);o&&r.push(o)}return r},t._getDimensions=function(e){for(var t=0;Array.isArray(e);)e=e[0],t++;return"number"==typeof e&&t--,t},t}(Array),ff=function(){function e(t,r){this.type="Polygon",this.type=e.TYPE,1===pf._getDimensions(t)?this.coordinates=[t]:this.coordinates=t,this.bbox=r}return e.TYPE="Polygon",e}(),mf=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),gf=window&&window.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},yf=function(e){function t(r,n,i){var o,a,s=e.call(this)||this;return"Feature"===r.type?(a=Ru((o=r).geometry),i=o.properties?Ru(o.properties):{},n=null==o.id||""===o.id?dr():o.id):(a=Ru(r),n=null==n||""===n?dr():n,i=i?Ru(i):{}),i[t._shapeIdPropName]=n,s.data=new cp(a,i,n),s._handleCircle(),s}return mf(t,e),t.prototype.addProperty=function(e,t){lp(this.data.properties[e],t)||(this.data.properties[e]=Ru(t),"subType"!==e&&"radius"!==e||this._handleCircle(),this.dataSource&&this.dataSource._updateSource(),this._invokeEvent("shapechanged",this))},t.prototype.getBounds=function(){var e,t,r,n,i,o=this.getCoordinates(),a=this.getType();if("Point"===a)i=this.circlePolygon?(s=this.circlePolygon.geometry.coordinates,bf.fromPositions(s[0])):new bf(s=o,s);else if("MultiPoint"===a||"LineString"===a){var s=o;i=bf.fromPositions(s)}else if("Polygon"===a)s=o,i=bf.fromPositions(s[0]);else if("MultiLineString"===a){s=o;try{for(var l=gf(s),c=l.next();!c.done;c=l.next()){var u=c.value;i=bf.merge(i,bf.fromPositions(u))}}catch(t){e={error:t}}finally{try{c&&!c.done&&(t=l.return)&&t.call(l)}finally{if(e)throw e.error}}}else if("MultiPolygon"===a){s=o;try{for(var h=gf(s),d=h.next();!d.done;d=h.next()){var p=d.value;i=bf.merge(i,bf.fromPositions(p[0]))}}catch(t){r={error:t}}finally{try{d&&!d.done&&(n=h.return)&&n.call(h)}finally{if(r)throw r.error}}}return i},t.prototype.getCoordinates=function(){return Ru(this.data.geometry.coordinates)},t.prototype.getCircleCoordinates=function(){return this.circlePolygon?Ru(this.circlePolygon.geometry.coordinates[0]):null},t.prototype.getId=function(){return this.data.id},t.prototype.getProperties=function(){return Ru(this.data.properties)},t.prototype.getType=function(){return this.data.geometry.type},t.prototype.isCircle=function(){return t._isCircle(this.data)},t.prototype.isRectangle=function(){return t._isRectangle(this.data)},t.prototype.setCoordinates=function(e){e="Polygon"===this.getType()&&1===pf._getDimensions(e)?[e]:e,lp(this.data.geometry.coordinates,e)||(this.data.geometry.coordinates=Ru(e),this._handleCircle(),this.dataSource&&this.dataSource._updateSource(),this._invokeEvent("shapechanged",this))},t.prototype.setProperties=function(e){e[t._shapeIdPropName]=this.data.id,lp(this.data.properties,e)||(this.data.properties=Ru(e),this._handleCircle(),this.dataSource&&this.dataSource._updateSource(),this._invokeEvent("shapechanged",this))},t.prototype.toJson=function(){return JSON.parse(JSON.stringify(this.data))},t.prototype._toJson=function(){return this.circlePolygon||this.data},t.prototype._setDataSource=function(e){void 0===e||null==e?delete this.dataSource:this.dataSource=e},t.prototype._handleCircle=function(){var e;this.isCircle()?(e=t._getCirclePositions(this.data),this.circlePolygon=new cp(new ff([e]),this.data.properties,this.data.id),this.data.properties.subType="Circle"):delete this.circlePolygon},t._isCircle=function(e){return e&&e.geometry&&"Point"===e.geometry.type&&e.geometry.coordinates&&e.properties&&"string"==typeof e.properties.subType&&"circle"===e.properties.subType.toLowerCase()&&"number"==typeof e.properties.radius},t._isRectangle=function(e){if("Polygon"===e.geometry.type&&e.geometry.coordinates&&"string"==typeof e.properties.subType&&"rectangle"===e.properties.subType.toLowerCase()&&1===(e=e.geometry.coordinates).length){if(5===(e=e[0]).length)return e[0][0]===e[4][0]&&e[0][1]===e[4][1];if(4===e.length)return!0}return!1},t._getCirclePositions=function(e){return Kp(e.geometry.coordinates,e.properties.radius,72,"meters")},t._shapeIdPropName="_azureMapsShapeId",t}(ui),vf=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),_f=window&&window.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},bf=function(e){function t(t,r){var n,i=this;return t&&r?i=(n=t)[2]&&r[2]?e.call(this,n[0],n[1],n[2]||0,r[0],r[1],r[2]||0)||this:e.call(this,n[0],n[1],r[0],r[1])||this:t&&(n=t)&&(4===n.length?i=e.call(this,n[0],n[1],n[2],n[3])||this:6<=n.length&&(i=e.call(this,n[0],n[1],n[2],n[3],n[4],n[5])||this)),i}return vf(t,e),t.fromBoundingBox=function(e){var r=t.getWest(e),n=t.getSouth(e),i=t.getEast(e);e=t.getNorth(e);return new t([r,n,i,e])},t.fromDimensions=function(e,r,n){var i=e[0],o=(e=e[1],Math.min(Math.max(e+n/2,-85.5),85.5));e=Math.min(Math.max(e-n/2,-85.5),85.5),n=$p(i+r/2);return new t([$p(i-r/2),e,n,o])},t.fromEdges=function(e,r,n,i){return new t([e,r,n,i])},t.containsPosition=function(e,r){var n=t.getCenter(e),i=Math.abs(n[1]-r[1]);180<(n=Math.abs(n[0]-r[0]))&&(n=360-n),r=t.getHeight(e),e=t.getWidth(e);return i<=r/2+1e-8&&n<=e/2+1e-8},t.containsBoundingBox=function(e,r){var n=e&&4===e.length,i=r&&4===r.length;return!(!n||!i)&&t.getWest(e)<t.getWest(r)&&t.getWest(r)<t.getEast(e)&&t.getWest(e)<t.getEast(r)&&t.getEast(r)<t.getEast(e)&&t.getSouth(e)<t.getSouth(r)&&t.getSouth(r)<t.getNorth(e)&&t.getSouth(e)<t.getNorth(r)&&t.getNorth(r)<t.getNorth(e)},t.crossesAntimeridian=function(e){return $p(t.getEast(e))-$p(t.getWest(e))<0||t.isBoundingBoxWithSixOrMoreElementsLargerThanGlobe(e)||t.isBoundingBoxWithLessThanSixElementsLargerThanGlobe(e)},t.getCenter=function(e){var r=((n=$p(t.getEast(e)))<(r=$p(t.getWest(e)))&&(n+=360),$p((r+n)/2)),n=Wp(t.getSouth(e));e=Wp(t.getNorth(e));return[r,Wp((n+e)/2)]},t.getHeight=function(e){return e=Wp(t.getNorth(e))-Wp(t.getSouth(e)),isNaN(e)?0:e},t.getWidth=function(e){return e=$p(t.getEast(e))-$p(t.getWest(e)),isNaN(e)?0:e<0?e+360:e},t.getSouthWest=function(e){var t=this.getSouth(e);e=this.getWest(e);return isNaN(t)||isNaN(e)?null:[e,t]},t.getNorthEast=function(e){var t=this.getNorth(e);e=this.getEast(e);return isNaN(t)||isNaN(e)?null:[e,t]},t.getNorthWest=function(e){var t=this.getNorth(e);e=this.getWest(e);return isNaN(t)||isNaN(e)?null:[e,t]},t.getSouthEast=function(e){var t=this.getSouth(e);e=this.getEast(e);return isNaN(t)||isNaN(e)?null:[e,t]},t.getSouth=function(e){return e&&4<=e.length?Number(e[1]):NaN},t.getWest=function(e){return e&&4<=e.length?Number(e[0]):NaN},t.getNorth=function(e){if(e){if(4===e.length)return Number(e[3]);if(6===e.length)return Number(e[4])}return NaN},t.getEast=function(e){if(e){if(4===e.length)return Number(e[2]);if(6===e.length)return Number(e[3])}return NaN},t.intersect=function(e,r){var n=t.getCenter(e),i=t.getCenter(r),o=Math.abs(n[1]-i[1]),a=(i=(180<(n=Math.abs(n[0]-i[0]))&&(n=360-n),t.getHeight(e)),e=t.getWidth(e),t.getHeight(r));r=t.getWidth(r);return o<=i/2+a/2&&n<=e/2+r/2},t.merge=function(e,r){var n=e&&4===e.length,i=r&&4===r.length;if(n&&!i)return e;if(i&&!n)return r;if(!n&&!i)return null;n=Math.max(Wp(t.getNorth(e)),Wp(t.getNorth(r))),i=Math.min(Wp(t.getSouth(e)),Wp(t.getSouth(r)));var o=[e,r],a=[],s=0;for(s=0;s<o.length;s++){var l=o[s],c=$p(t.getWest(l)),u=$p(t.getEast(l));t.crossesAntimeridian(l)?(a.push([c,180]),a.push([-180,u])):a.push([c,u])}a.sort((function(e,t){return e[0]===t[0]?e[1]-t[1]:e[0]-t[0]}));var h=[],d=a[0];for(s=1;s<a.length;){var p=a[s];d[1]>=p[0]?d[1]=Math.max(d[1],p[1]):(h.push(d),d=p),s++}h.push(d);var f=h.length,m=h[0][0]+360-h[f-1][1],g=[h[f-1][1],h[0][0]];for(s=1;s<f;s++){var y=h[s][0]-h[s-1][1];m<y&&(m=y,g=[h[s-1][1],h[s][0]])}return new t([g[1],i],[g[0],n])},t.fromPositions=function(e){for(var r,n,i=NaN,o=NaN,a=NaN,s=NaN,l=e.length,c=new Array(l),u=0;l--;)(n=e[l])&&2<=n.length&&(r=Wp(n[1]),i=isNaN(i)?r:Math.max(i,r),o=isNaN(o)?r:Math.min(o,r),c[u++]=$p(n[0]));if(u){c.length=u,c.sort((function(e,t){return e-t}));var h=c[0]+360-c[u-1],d=0;for(l=1;l<u;l++){var p=c[l]-c[l-1];h<p&&(h=p,d=l)}a=c[d],s=c[(d||u)-1]}return isNaN(a)||isNaN(o)||isNaN(s)||isNaN(i)?null:new t([a,o,s,i])},t.fromLatLngs=function(e){return t.fromPositions(pf.fromLatLngs(e))},t.fromData=function(e){var r,n,i=null;if(Array.isArray(e)&&0<e.length){try{for(var o=_f(e),a=o.next();!a.done;a=o.next()){var s,l=a.value;null!=(s=t.fromData(l))&&(i=null===i?s:t.merge(i,s))}}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i}if(e instanceof yf)return e.getBounds();if(e&&e.type){var c=e;if(c.bbox&&4===c.bbox.length)return c.bbox;switch(c.type){case"FeatureCollection":return t.fromData(c.features);case"Feature":return yf._isCircle(c)?t.fromPositions(yf._getCirclePositions(c)):t.fromData(c.geometry);case"GeometryCollection":return t.fromData(c.geometries);case"Point":var u=c.coordinates;if(u&&2<=u.length)return[u[0],u[1],u[0],u[1]];break;case"LineString":case"MultiPoint":return t.fromPositions(c.coordinates);case"Polygon":case"MultiLineString":var h=c.coordinates;if(h&&0<h.length){for(var d=0,p=h.length;d<p;d++)null!=(s=t.fromPositions(h[d]))&&(i=null===i?s:t.merge(i,s));if(null!=i)return i}break;case"MultiPolygon":var f=c.coordinates;if(f&&0<f.length){for(d=0,p=f.length;d<p;d++)for(var m=0,g=f[d].length;m<g;m++)null!=(s=t.fromPositions(f[d][m]))&&(i=null===i?s:t.merge(i,s));return i}}}return null},t.splitOnAntimeridian=function(e){var r,n,i,o,a,s,l=[];return t.isBoundingBoxWithSixOrMoreElementsLargerThanGlobe(e)?[[-180,e[1],e[2],180,e[4],e[5]]]:t.isBoundingBoxWithLessThanSixElementsLargerThanGlobe(e)?[[-180,e[1],180,e[3]]]:(t.crossesAntimeridian(e)?(r=void 0,n=$p(t.getWest(e)),i=$p(t.getEast(e)),o=Wp(t.getNorth(e)),a=Wp(t.getSouth(e)),s=6<=e.length?(r=[n,a,e[2],180,o,e[5]],[-180,a,e[2],i,o,e[5]]):(r=[n,a,180,o],[-180,a,i,o]),l.push(r,s)):l.push(e),l)},t.isBoundingBoxWithSixOrMoreElementsLargerThanGlobe=function(e){return 6<=e.length&&360<e[3]-e[0]},t.isBoundingBoxWithLessThanSixElementsLargerThanGlobe=function(e){return e.length<6&&360<e[2]-e[0]},t}(Array),wf=function(){function e(t,r){this.type="FeatureCollection",this.type=e.TYPE,this.features=t,this.bbox=r}return e.TYPE="FeatureCollection",e}(),xf=function(){function e(t){this.type="GeometryCollection",this.type=e.TYPE,this.geometries=t}return e.TYPE="GeometryCollection",e}(),Cf=function(){function e(t,r){this.type="LineString",this.type=e.TYPE,this.coordinates=t,this.bbox=r}return e.TYPE="LineString",e}(),Sf=function(){function e(t,r){this.type="MultiLineString",this.type=e.TYPE,this.coordinates=t,this.bbox=r}return e.TYPE="MultiLineString",e}(),Ef=function(){function e(t,r){this.type="MultiPoint",this.type=e.TYPE,this.coordinates=t,this.bbox=r}return e.TYPE="MultiPoint",e}(),Tf=function(){function e(t,r){this.type="MultiPolygon",this.type=e.TYPE,this.coordinates=t,this.bbox=r}return e.TYPE="MultiPolygon",e}(),If=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),kf=function(e){function t(t,r,n){return e.call(this,t,r,n||0)||this}return If(t,e),t.fromPosition=function(e){return 2<=e.length?new t((180+e[0])/360,t._latToMercatorY(e[1]),3<=e.length?t._altitudeToMercatorZ(e[2],e[1]):0):[0,0,0]},t.fromPositions=function(e){for(var t=[],r=0,n=e.length;r<n;r++)t.push(this.fromPosition(e[r]));return t},t.toFloat32Array=function(e){for(var r=new Float32Array(3*e.length),n=0,i=e.length;n<i;n++){var o=3*n,a=e[n];r[o]=(180+a[0])/360,r[1+o]=t._latToMercatorY(a[1]),r[2+o]=3<=a.length?t._altitudeToMercatorZ(a[2],a[1]):0}return r},t.toPosition=function(e){var r;return 2<=e.length?(r=360/Math.PI*Math.atan(Math.exp((180-360*e[1])*Math.PI/180))-90,new pf(360*e[0]-180,r,3<=e.length?t._mercatorZToAltitude(e[2],e[1]):0)):[0,0,0]},t.toPositions=function(e){for(var t=[],r=0,n=e.length;r<n;r++)t.push(this.toPosition(e[r]));return t},t.mercatorScale=function(e){return 1/Math.cos(e*Math.PI/180)},t.meterInMercatorUnits=function(e){return 1/t.earthCircumference*t.mercatorScale(t._latToMercatorY(e))},t._circumferenceAtLatitude=function(e){return t.earthCircumference*Math.cos(e*Math.PI/180)},t._altitudeToMercatorZ=function(e,r){return e/t._circumferenceAtLatitude(r)},t._mercatorZToAltitude=function(e,r){return e*t._circumferenceAtLatitude(t._latToMercatorY(r))},t._latToMercatorY=function(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360},t.earthCircumference=2*Math.PI*Fp(),t}(Array),Af=Object.freeze({__proto__:null,BoundingBox:bf,Feature:cp,FeatureCollection:wf,GeometryCollection:xf,LineString:Cf,MercatorPoint:kf,MultiLineString:Sf,MultiPoint:Ef,MultiPolygon:Tf,Point:dp,Polygon:ff,Position:pf});function Pf(e,t){return e*e+t*t}function Mf(e,t){return Pf(e[0]-t[0],e[1]-t[1])}function Rf(e,t,r){var n,i=t[0],o=(t=t[1],r[0]-i),a=r[1]-t;return 0==o&&0==a||(1<(n=((e[0]-i)*o+(e[1]-t)*a)/Pf(o,a))?(i=r[0],t=r[1]):0<n&&(i+=o*n,t+=a*n)),Pf(e[0]-i,e[1]-t)}function Of(e,t,r,n,i){for(var o,a=n,s=t+1;s<r;s++){var l=Rf(e[s],e[t],e[r]);a<l&&(o=s,a=l)}n<a&&(1<o-t&&Of(e,t,o,n,i),i.push(e[o]),1<r-o)&&Of(e,o,r,n,i)}function Lf(e,t){var r=e.length-1,n=[e[0]];return Of(e,0,r,t,n),n.push(e[r]),n}var Df=function(e,t,r){return void 0===t&&(t=1),void 0===r&&(r=!1),e.length<=2||(t*=t,e=Lf(e=r?e:function(e,t){for(var r,n=e[0],i=[n],o=1,a=e.length;o<a;o++)Mf(r=e[o],n)>t&&(i.push(r),n=r);return n!==r&&i.push(r),i}(e,t),t)),e};var Nf=window&&window.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},zf=function(){function e(t,r){this.M=e._calculateAffineTransform(t,r),this.inverseM=e._calculateAffineTransform(r,t)}return e.prototype.toTarget=function(e,t){return this.transformArray(e,this.M,t)},e.prototype.toSource=function(e,t){return this.transformArray(e,this.inverseM,t)},e.prototype.transformArray=function(e,t,r){var n,i;if(e&&Array.isArray(e)&&Array.isArray(e[0])){var o=[];try{for(var a=Nf(e),s=a.next();!s.done;s=a.next()){var l=s.value;o.push(this.transform(l,t,r))}}catch(e){n={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}return o}return null},e.prototype.transform=function(e,t,r){var n=e[0]*t[0][3]+e[1]*t[1][3]+t[2][3];e=e[0]*t[0][4]+e[1]*t[1][4]+t[2][4];return"number"==typeof r&&0<=r?[Lp(n,r),Lp(e,r)]:[Lp(n,6),Lp(e,6)]},e._calculateAffineTransform=function(e,t){if(e.length!==t.length||e.length<1)throw new Error("Error: source and target arrays must have the same length.");var r=Math.min(e[0].length,t[0].length),n=r+1;if(e.length<r)throw new Error("Erorr: At least "+r+" reference points required.");for(var i=[],o=[],a=0;a<n;a++){o[a]=[];for(var s=0;s<n;s++){s<r&&(i[s]=0);for(var l=o[a][s]=0;l<e.length;l++)s<r&&(i[s]+=a<r?e[l][a]*t[l][s]:t[l][s]),o[a][s]+=r<=a&&r<=s?1:r<=a?e[l][s]:r<=s?e[l][a]:e[l][a]*e[l][s]}o[a]=o[a].concat(i)}if(this._gaussJordanElimination(o))return o;throw new Error("Error: Singular matrix. Points are likely coplanar.")},e._gaussJordanElimination=function(e){for(var t,r=e.length,n=2*r-1,i=0;i<r;i++){for(var o=i,a=i+1;a<r;a++)Math.abs(e[a][i])>Math.abs(e[o][i])&&(o=a);if(t=e[o],e[o]=e[i],e[i]=t,Math.abs(e[i][i])<=1e-12)return!1;for(var s=i+1;s<r;s++)for(var l=e[s][i]/e[i][i],c=i;c<n;c++)e[s][c]-=e[i][c]*l}for(i=r-1;-1<i;i--){for(l=e[i][i],a=0;a<i;a++)for(var u=n-1;i-1<u;u--)e[a][u]-=e[i][u]*e[a][i]/l;e[i][i]/=l;for(var h=r;h<n;h++)e[i][h]/=l}return!0},e}(),Ff=Object.freeze({__proto__:null,get AccelerationUnits(){return sp},AffineTransform:zf,get AreaUnits(){return np},get DistanceUnits(){return ip},get SpeedUnits(){return ap},get TimeUnits(){return op},WEBMERCATOR_MAXLAT:_p,_precision:Lp,boundingBoxToPolygon:function(e){var t=$p(bf.getWest(e)),r=$p(bf.getEast(e)),n=Wp(bf.getNorth(e)),i=[[t,n],[t,i=Wp(bf.getSouth(e))],[(e=bf.getCenter(e))[0],i],[r,i],[r,n],[e[0],n],[t,n]];return new ff([i])},convertAcceleration:Jp,convertArea:ef,convertDistance:Dp,convertSpeed:tf,convertTimespan:rf,getAcceleration:nf,getAccelerationFromFeatures:function(e,t,r,n,i,o,a){if("string"==typeof r&&"Feature"===e.type&&"Point"===e.geometry.type&&"Feature"===t.type&&"Point"===t.geometry.type&&(r=af(e.properties[r],t.properties[r],op.seconds),!isNaN(r))){var s=0;if(n&&"string"==typeof n){var l=e.properties[n];n=t.properties[n];if("number"==typeof l&&(s=l,"number"==typeof n))return of(l,n,r,i,op.seconds,o,a)}return nf(s,zp(e.geometry.coordinates,t.geometry.coordinates,ip.meters),r,i,ip.meters,op.seconds,o,a)}return NaN},getAccelerationFromSpeeds:of,getArea:function e(t,r,n){if(t){var i=0;switch((t=t instanceof yf?t.toJson():t).type){case"Feature":var o=t;if(o.geometry)return e(o.geometry,r,n);break;case"Polygon":(o=t).coordinates&&(i=Ap(o.coordinates));break;case"MultiPolygon":var a=t;if(a.coordinates)for(var s=0,l=a.coordinates.length;s<l;s++)i+=Ap(a.coordinates[s])}return ef(i,np.squareMeters,r,n)}return 0},getCardinalSpline:function(e,t,r,n){if(!e||e.length<=2)return l;"number"!=typeof t&&(t=.5),("number"!=typeof r||r<=0)&&(r=15);var i,o,a,s=e.length,l=e.slice(0),c=(n?(pf.areEqual(l[0],l[s-1])&&(l.pop(),s--),l.unshift(e[s-1]),l.push(e[0]),l.push(e[1]),s++):(l.unshift(e[0]),l.push(e[s-1])),[]);c.push([1,0,0,0]);for(var u=1;u<r-1;u++)c.push([2*(a=(i=u/r)*(o=i*i))-3*o+1,-2*a+3*o,a-2*o+i,a-o]);c.push([0,1,0,0]);var h,d,p,f,m,g,y=[];for(u=1;u<s;u++)for(h=t*(l[u+1][0]-l[u-1][0]),d=t*(l[u+1][1]-l[u-1][1]),p=t*(l[u+2][0]-l[u][0]),f=t*(l[u+2][1]-l[u][1]),i=0;i<r;i++)g=(m=c[i])[0]*l[u][0]+m[1]*l[u+1][0]+m[2]*h+m[3]*p,m=xp(m[0]*l[u][1]+m[1]*l[u+1][1]+m[2]*d+m[3]*f,-85,85),y.push([g,m]);return y},getClosestPointOnGeometry:hf,getConvexHull:function(e){var t,r,n=lf(e).map((function(e){return[$p(e[0]),Wp(e[1])]})),i=(n.sort((function(e,t){return e[0]===t[0]?e[1]-t[1]:e[0]-t[0]})),[]);try{for(var o=fp(n),a=o.next();!a.done;a=o.next()){for(var s=a.value;2<=i.length&&Mp(i[i.length-2],i[i.length-1],s)<=0;)i.pop();i.push(s)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}for(var l=[],c=n.length-1;0<=c;c--){for(;2<=l.length&&Mp(l[l.length-2],l[l.length-1],n[c])<=0;)l.pop();l.push(n[c])}return new ff([i.concat(l)])},getDestination:Np,getDistanceTo:zp,getEarthRadius:Fp,getGeodesicPath:function(e,t){(!t||t<=0)&&(t=15),Array.isArray(e)?r=e:e.type&&"LineString"===e.type&&(r=e.coordinates);for(var r,n=r.length-1,i=[],o=0;o<n;o++)i=i.concat(Bp(r[o],r[o+1],t));return Up(i)},getGeodesicPaths:function(e,t){(!t||t<=0)&&(t=15),Array.isArray(e)?r=e:e.type&&"LineString"===e.type&&(r=e.coordinates);for(var r,n=r.length-1,i=[],o=[],a=0;a<n;a++)for(var s,l,c,u,h,d=Bp(r[a],r[a+1],t),p=0;p<d.length;p++)i.push(d[p]),p+1>=d.length||(s=(l=pp(d[p],2))[0],l=l[1],u=(h=pp(d[p+1],2))[0],h=h[1],180<Math.abs(u-s)&&(c=0<s?180:-180,u=Math.abs((0<s?u+360:u-360)-s),h=l+(h-l)*(Math.abs(c-s)/u),i.push([c,h]),o.push(i),i=[[-c,h]]));return o.push(i),o},getHeading:qp,getLengthOfPath:Hp,getPathDenormalizedAtAntimerian:Up,getPathSplitByAntimeridian:jp,getPixelHeading:function(e,t){e=cf(e),t=cf(t),t=(e=pp(Qp([e,t],21),2))[0];var r=(e=e[1])[0]-t[0];return t=t[1]-e[1],(2.5*Math.PI-Math.atan2(t,r))*yp%360},getPointWithHeadingAlongPath:uf,getPointsWithHeadingsAlongPath:function(e,t){if(t<=0)return[];for(var r=[],n=Hp(e,ip.meters)/(t-1),i=0;i<t;i++){var o=uf(e,n*i,ip.meters);null!=o&&r.push(o)}return r},getPosition:cf,getPositionAlongPath:Vp,getPositions:lf,getPositionsAlongPath:function(e,t){if(t<2)return[];for(var r=[],n=Hp(e,ip.meters)/(t-1),i=0;i<t;i++){var o=Vp(e,n*i,ip.meters);null!=o&&r.push(o)}return r},getRegularPolygonPath:Kp,getRegularPolygonPaths:function(e,t,r,n,i){return jp(Gp(e,t,r,n,i))},getSpeed:function(e,t,r,n,i,o){return e=cf(e),t=cf(t),e&&t?(r=rf(r,n,op.seconds),tf(zp(e,t,ip.meters)/r,ap.metersPerSecond,i,o)):0},getSpeedFromFeatures:function(e,t,r,n,i){return"string"!=typeof r||"Feature"!==e.type||"Point"!==e.geometry.type||"Feature"!==t.type||"Point"!==t.geometry.type||(r=af(e.properties[r],t.properties[r],op.seconds),isNaN(r))?NaN:tf(zp(e.geometry.coordinates,t.geometry.coordinates,ip.meters)/r,ap.metersPerSecond,n,i)},getTimespan:af,getTravelDistance:function(e,t,r,n,i,o,a,s){return t=rf(t,i,op.seconds),i=(r=tf(r,o,ap.metersPerSecond))*t,"number"==typeof n&&(i+=.5*Jp(n,a,sp.metersPerSecondSquared)*t*t),Dp(i,ip.meters,e,s)},interpolate:Zp,mercatorPixelsToPositions:Xp,mercatorPositionsToPixels:Qp,normalizeLatitude:Wp,normalizeLongitude:$p,parseTimestamp:sf,rotatePositions:Yp,simplify:function(e,t){return Df(e,t,!0)}}),Bf=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Uf=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.zoomDelta=1,t.style=ri.light,t}return Bf(t,e),t}(Ur),jf=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),qf=function(e){function t(t){var r=e.call(this)||this;return r.container=null,r.zoomInButton=null,r.zoomOutButton=null,r.zoomChanged=function(e){return r.updateZoomButtonsState()},r.minZoomChanged=function(e){return r.updateZoomButtonsState()},r.maxZoomChanged=function(e){return r.updateZoomButtonsState()},r.options=(new Uf).merge(t),r}return jf(t,e),t.prototype.onAdd=function(e){this.container=this.buildContainer(e,this.options.style,"Zoom Control"),this.container.style.flexDirection="column",this.zoomInButton=this.constructZoomInButton(e),this.zoomOutButton=this.constructZoomOutButton(e);var t=ii("Zoom In"),r=ii("Zoom Out");return this.container.appendChild(this.zoomInButton),this.container.appendChild(t),this.container.appendChild(this.zoomOutButton),this.container.appendChild(r),oi(t,this.zoomInButton),oi(r,this.zoomOutButton),e.events.add("zoom",this.zoomChanged),e.events.add("minzoomchanged",this.minZoomChanged),e.events.add("maxzoomchanged",this.maxZoomChanged),this.map=e,this.container},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.map&&(this.map.events.remove("zoom",this.zoomChanged),this.map.events.remove("minzoomchanged",this.minZoomChanged),this.map.events.remove("maxzoomchanged",this.maxZoomChanged),this.map=null),this.container&&(this.container.remove(),this.container=null,this.zoomInButton=null,this.zoomOutButton=null)},t.prototype.updateZoomButtonsState=function(){var e=this.map.getCamera().zoom>=this.map._getMap().getMaxZoom(),t=bf.getSouth(this.map.getCamera().bounds)<=-85.0511&&bf.getNorth(this.map.getCamera().bounds)>=_p;t=this.map.getCamera().zoom<=this.map._getMap().getMinZoom()||t;this.zoomInButton&&this.zoomInButton.disabled!=e&&(this.zoomInButton.disabled=e,this.zoomInButton.setAttribute("aria-label",e?"Zoom In disabled":"Zoom In")),this.zoomOutButton&&this.zoomOutButton.disabled!=t&&(this.zoomOutButton.disabled=t,this.zoomOutButton.setAttribute("aria-label",e?"Zoom Out disabled":"Zoom Out"))},t.prototype.constructZoomInButton=function(e){var r=this,n=document.createElement("button");return n.classList.add("azure-maps-control-button"),n.classList.add("zoom-in"),n.setAttribute("aria-label","Zoom In"),n.setAttribute("alt","Zoom In"),n.setAttribute("type","button"),n.addEventListener("click",(function(){var n;e.setCamera({maxBounds:null==(n=e._getMap().getMaxBounds())?void 0:n.toArray().flat(),zoom:e.getCamera().zoom+r.options.zoomDelta,duration:t.ZOOM_DURATION_MS,type:"ease"},!0)})),n},t.prototype.constructZoomOutButton=function(e){var r=this,n=document.createElement("button");return n.classList.add("azure-maps-control-button"),n.classList.add("zoom-out"),n.setAttribute("aria-label","Zoom Out"),n.setAttribute("alt","Zoom Out"),n.setAttribute("type","button"),n.addEventListener("click",(function(){var n;e.setCamera({maxBounds:null==(n=e._getMap().getMaxBounds())?void 0:n.toArray().flat(),zoom:e.getCamera().zoom-r.options.zoomDelta,duration:t.ZOOM_DURATION_MS,type:"ease"},!0)})),n},t.ZOOM_DURATION_MS=200,t}(pi),Hf=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Vf=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.style=ri.light,t.hideIfUnsupported=!1,t.container=void 0,t}return Hf(t,e),t}(Ur),Gf=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Kf=function(e){function t(t){var r=e.call(this)||this;return r.map=null,r.isFullscreenState=!1,r.options=(new Vf).merge(t),r.control=new sr.FullscreenControl({container:r.options.container}),r}return Gf(t,e),t.prototype.onAdd=function(e){var r,n,i=this,o=(this.map=e,null!=(o=null==(o=this.map)?void 0:o._getMap())&&o.addControl(this.control),this.buildContainer(e,this.options.style,"Fullscreen Control")),a=this.control._fullscreenButton;return a&&(r=a.querySelector("span"))&&(n=ii("Enter Fullscreen"),o.appendChild(a),a.classList.add("azure-maps-control-button","fullscreen"),r.classList.add("fullscreen-icon","fullscreen-end"),a.removeAttribute("title"),o.appendChild(n),oi(n,a),this.control.on("fullscreenstart",(function(){a.removeAttribute("title"),r.classList.remove("fullscreen-end"),r.classList.add("fullscreen-start"),n.innerText="Exit Fullscreen",i.isFullscreenState=!0})),this.control.on("fullscreenend",(function(){a.removeAttribute("title"),r.classList.remove("fullscreen-start"),r.classList.add("fullscreen-end"),n.innerText="Enter Fullscreen",i.isFullscreenState=!1}))),this.options.hideIfUnsupported&&!t.isSupported()&&(o.style.display="none"),o},t.prototype.onRemove=function(){var t;e.prototype.onRemove.call(this),null!=(t=null==(t=this.map)?void 0:t._getMap())&&t.removeControl(this.control),this.map=null},t.prototype.isFullscreen=function(){return this.isFullscreenState},t.isSupported=function(){var e=document;return e.fullscreenEnabled||e.msFullscreenEnabled||e.mozFullScreenEnabled||e.webkitFullscreenEnabled},t}(pi),Zf=Object.freeze({__proto__:null,CompassControl:yi,ControlBase:pi,FullscreenControl:Kf,PitchControl:wi,ScaleControl:Ci,StyleControl:id,TrafficControl:ud,TrafficLegendControl:pd,ZoomControl:qf}),Wf=Au;function $f(e,t){return Wf(e,5,t="function"==typeof t?t:void 0)}var Yf=ir($f),Xf=function(){function e(t){var r=this;this.attach=function(e){r.map!==e&&(r.map&&r.detachFromCurrentMap(),r.map=e,r.map.indicators._getCollectionDiv().appendChild(r.element),r.map.indicators.add(r))},this.remove=function(){r.detachFromCurrentMap(),r.element.remove()},this.getElement=function(){return r.element},this.detachFromCurrentMap=function(){r.map&&(r.map.indicators.remove(r),delete r.map)},this.element=document.createElement("div"),this.element.setAttribute("tabindex","0"),this.element.setAttribute("role","option"),null!=t&&t.setSize&&this.element.setAttribute("aria-setsize",t.setSize.toString()),null!=t&&t.positionInSet&&this.element.setAttribute("aria-posinset",t.positionInSet.toString()),this.element.setAttribute("aria-label","data point"),this.element.classList.add(e.Css.hidden)}return e.Css={hidden:"hidden-accessible-element"},e}(),Qf=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Jf=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.buffer=128,t.maxZoom=18,t.cluster=!1,t.clusterRadius=50,t.clusterMaxZoom=void 0,t.clusterProperties=void 0,t.lineMetrics=!1,t.tolerance=.375,t.clusterMinPoints=2,t.generateId=!1,t.promoteId=void 0,t.filter=void 0,t}return Qf(t,e),t}(Ur),em=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),tm=function(e){function t(t){var r=e.call(this)||this;return r.id=t||dr(),r}return em(t,e),t.prototype.getId=function(){return this.id},t.prototype._setMap=function(e,t){var r;void 0===t&&(t=!0),null==e||void 0===e?(r=this.map,delete this.map,t&&(this._invokeEvent("sourceremoved",this),r)&&r.events.invoke("sourceremoved",this)):(this.map=e,t&&(this._invokeEvent("sourceadded",this),this.map.events.invoke("sourceadded",this)))},t}(ui),rm=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),nm=window&&window.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},im=function(e){function t(t,r){return(t=e.call(this,t)||this).requestId=void 0,t.options=(new Jf).merge(Ru(r)),t.shapes=[],t.shapesMap=new ci,t}return rm(t,e),t.prototype.add=function(e,t){this._addNoUpdate(e,t),this._updateSource()},t.prototype.clear=function(){this._clearNoUpdate(),this._updateSource()},t.prototype.dispose=function(){this.options=null,this.shapes=null,this.shapesMap=null,this.map=null},t.prototype.getClusterExpansionZoom=function(e){var t=this;return new Promise((function(r,n){var i;t.map?(i=t.map._getMap().getSource(t.getId()))&&"geojson"===i.type&&i.getClusterExpansionZoom(e).then((function(e){"number"==typeof e&&r(e)})).catch((function(e){e&&n(e)})):n("The DataSource hasn't been added to a map.")}))},t.prototype.getClusterChildren=function(e){var t=this;return new Promise((function(r,n){var i;t.map?(i=t.map._getMap().getSource(t.getId()))&&"geojson"===i.type&&i.getClusterChildren(e).then((function(e){e&&r(t.map.sources._mapFeaturesToShapes(e,!1,t))})).catch((function(e){e&&n(e)})):n("The DataSource hasn't been added to a map.")}))},t.prototype.getClusterLeaves=function(e,t,r){var n=this;return new Promise((function(i,o){var a;n.map?(a=n.map._getMap().getSource(n.getId()))&&"geojson"===a.type&&a.getClusterLeaves(e,t,r).then((function(e){e&&i(n.map.sources._mapFeaturesToShapes(e,!1,n))})).catch((function(e){e&&o(e)})):o("The DataSource hasn't been added to a map.")}))},t.prototype.getOptions=function(){return Ru(this.options)},t.prototype.getShapes=function(){return Array.from(this.shapes)},t.prototype.importDataFromUrl=function(e){var t=this;return fetch(e,{method:"GET",mode:"cors"}).then((function(e){if(e.ok)return e.json();throw new Error("HTTP ".concat(e.status,": ").concat(e.statusText))})).then((function(e){t.add(e)}))},t.prototype.getShapeById=function(e){return this.shapes[this.shapesMap.get(e)]||null},t.prototype.remove=function(e){var t,r;e=Array.isArray(e)?e:[e];try{for(var n=nm(e),i=n.next();!i.done;i=n.next()){var o=i.value;"number"==typeof o?this._removeByIndex(o):this._removeById(o)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}this._updateSource()},t.prototype.removeById=function(e){var t,r;e=Array.isArray(e)?e:[e];try{for(var n=nm(e),i=n.next();!i.done;i=n.next()){var o=i.value;this._removeById(o)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}this._updateSource()},t.prototype.setOptions=function(e){e=(new Jf).merge(this.options,Ru(e)),lp(this.options,e)||(this._invokeEvent("datasourceupdated",this),this.options=e,this.map&&this.map._rebuildStyle())},t.prototype.setShapes=function(e){this._clearNoUpdate(),this.add(e)},t.prototype.toJson=function(){return new wf(this.shapes.map((function(e){return e.toJson()})))},t.prototype._toJson=function(){return new wf(this.shapes.map((function(e){return e._toJson()})))},t.prototype._buildSource=function(){var e={type:"geojson",data:this._toJson(),maxzoom:this.options.maxZoom,cluster:this.options.cluster,clusterRadius:this.options.clusterRadius,tolerance:this.options.tolerance,lineMetrics:this.options.lineMetrics,clusterProperties:this.options.clusterProperties,buffer:this.options.buffer,clusterMinPoints:this.options.clusterMinPoints,generateId:this.options.generateId,promoteId:this.options.promoteId,filter:this.options.filter};return"number"==typeof this.options.clusterMaxZoom&&(e.clusterMaxZoom=this.options.clusterMaxZoom),e},t.prototype._isDeepEqual=function(e){var t;return this.constructor===e.constructor&&(t=this._buildSource(),e=e._buildSource(),t.type===e.type)&&t.maxzoom===e.maxzoom&&t.cluster===e.cluster&&t.clusterRadius===e.clusterRadius&&t.tolerance===e.tolerance&&t.lineMetrics===e.lineMetrics&&JSON.stringify(t.clusterProperties)===JSON.stringify(e.clusterProperties)&&t.buffer===e.buffer&&t.clusterMinPoints===e.clusterMinPoints&&t.generateId===e.generateId&&t.promoteId===e.promoteId&&t.filter===e.filter},t.prototype._addNoUpdate=function(e,t){var r;e instanceof yf?(this._addToSources(e,t),r=[e]):Array.isArray(e)?(r=e.map((function(e){return e instanceof yf?e:new yf(e)})),this._addToSources(r,t)):"FeatureCollection"===e.type?(r=e.features.map((function(e){return new yf(e)})),this._addToSources(r,t)):"GeometryCollection"===e.type?(r=e.geometries.map((function(e){return new yf(e)})),this._addToSources(r,t)):(e=new yf(e),this._addToSources(e,t),r=[e]),this._invokeEvent("dataadded",r)},t.prototype._clearNoUpdate=function(){var e=this.shapes;this.shapes=[],this.shapesMap=new ci,e&&0<e.length&&this._invokeEvent("dataremoved",e)},t.prototype._updateSource=function(){var e=this;void 0===this.requestId&&(this.requestId=requestAnimationFrame((function(){e._updateMboxSource(),e.requestId=void 0})))},t.prototype._addToSources=function(e,t){var r,n,i,o;if(e=Array.isArray(e)?e:[e],"number"!=typeof t)try{for(var a=nm(e),s=a.next();!s.done;s=a.next()){var l=s.value;this.shapes.push(l),this.shapesMap.set(l.getId(),this.shapes.length-1)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}else for(var c=e.length-1;0<=c;c--)this.shapes.splice(t,0,e[c]),this._updateShapesMap(t);try{for(var u=nm(e),h=u.next();!h.done;h=u.next())(l=h.value)._setDataSource(this)}catch(e){i={error:e}}finally{try{h&&!h.done&&(o=u.return)&&o.call(u)}finally{if(i)throw i.error}}},t.prototype._removeById=function(e){e=e instanceof yf?e.getId():"string"==typeof e||"number"==typeof e?e:e.id;var t=this.shapes[this.shapesMap.get(e)];t&&(t._setDataSource(null),this.shapes.splice(this.shapesMap.get(e),1),this._updateShapesMap(this.shapesMap.get(e)),this.shapesMap.delete(e),this._invokeEvent("dataremoved",[t]))},t.prototype._removeByIndex=function(e){var t;if(e>=this.shapes.length)throw new Error("The specified remove index '".concat(e,"' ")+"is greater than the maximum possible index '".concat(this.shapes.length-1,"'"));t=this.shapes[e],this.shapesMap.delete(t.getId()),t._setDataSource(null),this.shapes.splice(e,1),this._updateShapesMap(e),this._invokeEvent("dataremoved",[t])},t.prototype._updateShapesMap=function(e){for(var t=e;t<this.shapes.length;t++)this.shapesMap.set(this.shapes[t].getId(),t)},t.prototype._updateMboxSource=function(){var e;this.map&&this.map._getMap()&&(e=this.map._getMap().getSource(this.getId()))&&"geojson"===e.type&&e.setData(this._toJson())},t}(tm),om=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),am=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bounds=void 0,t.minZoom=0,t.maxZoom=22,t.isTMS=!1,t.tiles=void 0,t.url=void 0,t}return om(t,e),t}(Ur),sm=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),lm=function(e){function t(t,r){return(t=e.call(this,t)||this).options=(new am).merge(Ru(r)),t}return sm(t,e),t.prototype.getOptions=function(){return Ru(this.options)},t.prototype.getShape=function(e,t){return this.map._getMap().querySourceFeatures(this.getId(),{sourceLayer:e,filter:t})},t.prototype._buildSource=function(){var e={type:"vector"};return this.options.bounds&&(e.bounds=this.options.bounds),this.options.tiles?(e.tiles=this.options.tiles,e.minzoom=this.options.minZoom,e.maxzoom=this.options.maxZoom):this.options.url&&(e.url=this.options.url),this.options.isTMS&&(e.scheme="tms"),e},t.prototype._isDeepEqual=function(e){var t,r;return this.constructor===e.constructor&&(t=this._buildSource(),r=e._buildSource(),t.type===r.type)&&t.url===r.url&&(void 0===t.tiles&&void 0===r.tiles||t.tiles&&r.tiles&&t.tiles.length===r.tiles.length&&t.tiles.every((function(e,t){return e===r.tiles[t]})))&&t.minzoom===r.minzoom&&t.maxzoom===r.maxzoom&&t.bounds===r.bounds&&t.attribution===r.attribution&&t.promoteId===r.promoteId&&t.scheme===r.scheme},t}(tm),cm=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),um=function(e){function t(t,r,n){return(t=e.call(this,t)||this).source=r,t}return cm(t,e),t.prototype._isDeepEqual=function(e){var t;return this.constructor===e.constructor&&(t=this.source,e=e.source,t.type===e.type)&&t.canvas===e.canvas&&JSON.stringify(t.coordinates)===JSON.stringify(e.coordinates)&&t.animate===e.animate},t.prototype._buildSource=function(){return this.source},t}(tm),hm=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),dm=function(e){function t(t,r,n){return(t=e.call(this,t)||this).source=r,t}return hm(t,e),t.prototype._isDeepEqual=function(e){var t;return this.constructor===e.constructor&&(t=this.source,e=e.source,t.type===e.type)},t.prototype._buildSource=function(){return this.source},t}(tm),pm=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),fm=function(e){function t(t,r,n){return(t=e.call(this,t)||this).source=r,t}return pm(t,e),t.prototype._isDeepEqual=function(e){var t;return this.constructor===e.constructor&&(t=this.source,e=e.source,t.type===e.type)&&JSON.stringify(t.coordinates)===JSON.stringify(e.coordinates)&&t.url===e.url},t.prototype._buildSource=function(){return this.source},t}(tm),mm=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),gm=function(e){function t(t,r,n){return(t=e.call(this,t)||this).source=r,t}return mm(t,e),t.prototype._isDeepEqual=function(e){var t;return this.constructor===e.constructor&&(t=this.source,e=e.source,t.type===e.type)&&JSON.stringify(t.coordinates)===JSON.stringify(e.coordinates)&&t.urls===e.urls},t.prototype._buildSource=function(){return this.source},t}(tm),ym=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),vm=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tileSize=512,t}return ym(t,e),t}(am),_m=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),bm=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.encoding=void 0,t}return _m(t,e),t}(vm),wm=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),xm=window&&window.__assign||function(){return(xm=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Cm=function(e){function t(t,r){return(t=e.call(this,t)||this).options=(new bm).merge(Ru(r)),t}return wm(t,e),t.prototype.getOptions=function(){return Ru(this.options)},t.prototype._buildSource=function(){return xm({type:"raster-dem",bounds:this.options.bounds,minzoom:this.options.minZoom,maxzoom:this.options.maxZoom,tileSize:this.options.tileSize,encoding:this.options.encoding},this.options.tiles?{tiles:this.options.tiles}:{url:this.options.url})},t.prototype._isDeepEqual=function(e){return this.constructor===e.constructor&&(e=e.getOptions(),this.options.url===e.url)&&this.options.tiles===e.tiles&&this.options.bounds===e.bounds&&this.options.minZoom===e.minZoom&&this.options.maxZoom===e.maxZoom&&this.options.tileSize===e.tileSize&&this.options.encoding===e.encoding},t}(tm),Sm=Object.freeze({__proto__:null,CanvasSource:um,DataSource:im,ElevationTileSource:Cm,ImageSource:fm,Source:tm,UnknownSource:dm,VectorTileSource:lm,VideoSource:gm}),Em=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Tm=function(e){function t(t){var r=e.call(this)||this;return r.id=t||dr(),r}return Em(t,e),t.prototype.getId=function(){return this.id},t.prototype.getMap=function(){return this.map||null},t.prototype.onAdd=function(e){this.map=e,this._invokeEvent("layeradded",this),this.map.events.invoke("layeradded",this)},t.prototype.onRemove=function(){var e=this.map;delete this.map,this._invokeEvent("layerremoved",this),e&&e.events.invoke("layerremoved",this)},t._isMBoxEvent=function(e){return!this.LayerEvents.hasOwnProperty(e)},t.prototype._updateBaseProperties=function(e,t){this._updateFilter(e.filter,t.filter),this._updateZoomRange(e.minZoom,t.minZoom,e.maxZoom,t.maxZoom),this._updateLayoutProperty("visibility",e.visible,t.visible,e.visible?"visible":"none")},t.prototype._updateFilter=function(e,t){lp(e,t)||this.map._getMap().setFilter(this.id,e)},t.prototype._updatePaintProperty=function(e,t,r,n){lp(t,r)||this.map._getMap().setPaintProperty(this.id,e,n||t)},t.prototype._updateLayoutProperty=function(e,t,r,n){lp(t,r)||this.map._getMap().setLayoutProperty(this.id,e,n||t)},t.prototype._updateZoomRange=function(e,t,r,n){e===t&&n===r||this.map._getMap().setLayerZoomRange(this.id,e,r)},t.LayerEvents={layeradded:void 0,layerremoved:void 0,focusin:void 0,focusout:void 0},t}(ui),Im=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),km=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.filter=void 0,t.minZoom=0,t.maxZoom=24,t.visible=!0,t}return Im(t,e),t._cloneCustomizer=function(e){if(e instanceof tm)return e},t}(Ur),Am=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Pm=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.source=void 0,t.sourceLayer=void 0,t.color="#1A73AA",t.blur=0,t.opacity=1,t.strokeColor="#FFFFFF",t.strokeOpacity=1,t.strokeWidth=2,t.pitchAlignment="viewport",t.radius=8,t.createIndicators=!1,t.accessibilityIdKey=void 0,t}return Am(t,e),t}(km),Mm=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Rm=window&&window.__awaiter||function(e,t,r,n){return new(r=r||Promise)((function(i,o){function a(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))},Om=window&&window.__generator||function(e,t){var r,n,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a={next:s(0),throw:s(1),return:s(2)};return"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(r)throw new TypeError("Generator is already executing.");for(;o=a&&c[a=0]?0:o;)try{if(r=1,n&&(i=2&c[0]?n.return:c[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,c[1])).done)return i;switch(n=0,(c=i?[2&c[0],i.value]:c)[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=0<(i=o.trys).length&&i[i.length-1])&&(6===c[0]||2===c[0])){o=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3]))o.label=c[1];else if(6===c[0]&&o.label<i[1])o.label=i[1],i=c;else{if(!(i&&o.label<i[2])){i[2]&&o.ops.pop(),o.trys.pop();continue}o.label=i[2],o.ops.push(c)}}c=t.call(e,o)}catch(l){c=[6,l],n=0}finally{r=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}},Lm=window&&window.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=o.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a},Dm=window&&window.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||((n=n||Array.prototype.slice.call(t,0,i))[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},Nm=function(e){function t(t,r,n){var i=e.call(this,r)||this;return i.accessibleIndicator=[],i._setAccessibleIndicator=function(){return Rm(i,void 0,void 0,(function(){var e,t,r,n,i,o,a=this;return Om(this,(function(s){return this.accessibleIndicator.forEach((function(e){return e.remove()})),this.accessibleIndicator=[],e=this.map.layers.getRenderedShapes(this.map.getCamera().bounds,this),t=this.options.accessibilityIdKey||(this._getDataSource()?yf._shapeIdPropName:void 0),r=function(e,s){var l=e[s],c=l instanceof yf?l.toJson():l,u=new Xf({positionInSet:s+1,setSize:e.length}),h=u.getElement(),d=Lm(a.map.positionsToPixels([a.getFirstCoordinate(c.geometry.coordinates)]),1)[0];return h.addEventListener("focusin",(function(p){a.accessibleIndicator.filter((function(e){return e!==u})).forEach((function(e){return e.remove()})),0<=s-1&&n(u,r(e,s-1)),s+1<e.length&&o(r(e,s+1)),2<=s&&s==e.length-1&&i(r(e,0)),0==s&&2<=e.length&&o(r(e,e.length-1)),void 0!==t&&a.map._getMap().setPaintProperty(a.id,"circle-stroke-color",["case",["==",["get",t],c.properties[t]],"#000000",a.options.strokeColor]),p={target:h,type:"focusin",map:a.map,shape:l,originalEvent:p,pixel:d},a._invokeEvent("focusin",p)})),h.addEventListener("focusout",(function(e){void 0!==t&&a.map._getMap().setPaintProperty(a.id,"circle-stroke-color",["case",["==",["get",t],c.properties[t]],a.options.strokeColor,a.options.strokeColor]),e={target:h,type:"focusout",map:a.map,shape:l,originalEvent:e,pixel:d},a._invokeEvent("focusout",e)})),a.accessibleIndicator.push(u),u},n=function(e,t){t.attach(a.map),t=t.getElement(),(e=e.getElement()).parentElement.insertBefore(t,e)},i=function(e){e.attach(a.map);var t=(e=e.getElement()).parentElement;t.insertBefore(e,t.firstElementChild)},o=function(e){e.attach(a.map)},0<e.length&&o(r(e,0)),1<e.length&&o(r(e,e.length-1)),[2]}))}))},i.options=(new Pm).merge(Yf(n,Pm._cloneCustomizer)),i.options.source=t||i.options.source,i}return Mm(t,e),t.prototype.getOptions=function(){return Yf(this.options,Pm._cloneCustomizer)},t.prototype.getSource=function(){return this.options.source},t.prototype.setOptions=function(e){if(e=(new Pm).merge(this.options,Yf(e,Pm._cloneCustomizer)),this.map){if(e.source!==this.options.source||e.sourceLayer!==this.options.sourceLayer)return this.options=e,void this.map.layers.add(this);this._updateBaseProperties(e,this.options),this._updatePaintProperty("circle-blur",e.blur,this.options.blur),this._updatePaintProperty("circle-color",e.color,this.options.color),this._updatePaintProperty("circle-opacity",e.opacity,this.options.opacity),this._updatePaintProperty("circle-radius",e.radius,this.options.radius),this._updatePaintProperty("circle-stroke-color",e.strokeColor,this.options.strokeColor),this._updatePaintProperty("circle-stroke-opacity",e.strokeOpacity,this.options.strokeOpacity),this._updatePaintProperty("circle-stroke-width",e.strokeWidth,this.options.strokeWidth),this._updatePaintProperty("circle-pitch-alignment",e.pitchAlignment,this.options.pitchAlignment)}this.options=e},t.prototype.onAdd=function(t){var r,n,i=this;e.prototype.onAdd.call(this,t),this.options.createIndicators&&(t.events.addOnce("idle",this._setAccessibleIndicator),t.events.add("moveend",this._setAccessibleIndicator),(r=this._getDataSource())?t.events.add("dataadded",r,(function(){t.events.addOnce("idle",i._setAccessibleIndicator)})):(n="string"==typeof this.options.source?this.options.source:this.options.source.getId(),t.events.add("sourcedata",(function(e){(null==(e=e.source)?void 0:e.getId())===n&&t._getMap().isSourceLoaded(n)&&(e=i._getSourceDataEventCacheKey())!==i.sourceDataEventCacheKey&&(i._setAccessibleIndicator(),i.sourceDataEventCacheKey=e)}))))},t.prototype.onRemove=function(){var t;this.options.createIndicators&&(this.map.events.remove("idle",this._setAccessibleIndicator),this.map.events.remove("moveend",this._setAccessibleIndicator),(t=this._getDataSource())?this.map.events.remove("dataadded",t,this._setAccessibleIndicator):this.map.events.remove("sourcedata",this._setAccessibleIndicator)),e.prototype.onRemove.call(this)},t.prototype._getSourceDataEventCacheKey=function(){var e;if(this.map)return e=this.map.getServiceOptions().mapConfiguration,Dm(Dm([],Lm(this.map.getCamera().bounds),!1),[this.map.getCamera().zoom,this.map.getCamera().pitch,this.map.getStyle().style,e instanceof Object?e.id:e],!1).join(",")},t.prototype._getDataSource=function(){var e="string"==typeof this.options.source?this.map.sources.getById(this.options.source):this.options.source;if(e instanceof im)return e},t.prototype._buildLayers=function(){var e={id:this.id,type:"circle",source:this.options.source instanceof tm?this.options.source.getId():this.options.source,layout:{visibility:this.options.visible?"visible":"none"},paint:{"circle-color":this.options.color,"circle-blur":this.options.blur,"circle-opacity":this.options.opacity,"circle-stroke-color":this.options.strokeColor,"circle-stroke-opacity":this.options.strokeOpacity,"circle-stroke-width":this.options.strokeWidth,"circle-pitch-alignment":this.options.pitchAlignment,"circle-radius":this.options.radius},minzoom:this.options.minZoom,maxzoom:this.options.maxZoom};return this.options.filter&&(e.filter=this.options.filter),this.options.sourceLayer&&(e["source-layer"]=this.options.sourceLayer),[e]},t.prototype._getLayerIds=function(){return[this.id]},t.prototype._getSourceIds=function(){var e=new Set;return this.options.source instanceof tm?e.add(this.options.source.getId()):e.add(this.options.source),e},t.prototype.getFirstCoordinate=function(e){return Array.isArray(e[0])?this.getFirstCoordinate(e[0]):e},t}(Tm),zm=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Fm=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.source=void 0,t.sourceLayer=void 0,t.color=["interpolate",["linear"],["heatmap-density"],0,"rgba(0,0, 255,0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],t.intensity=1,t.opacity=1,t.radius=30,t.weight=1,t}return zm(t,e),t._cloneCustomizer=function(e){if(e instanceof tm)return e},t}(km),Bm=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Um=function(e){function t(t,r,n){return(r=e.call(this,r)||this).options=(new Fm).merge(Yf(n,Fm._cloneCustomizer)),r.options.source=t||r.options.source,r}return Bm(t,e),t.prototype.getOptions=function(){return Yf(this.options,Fm._cloneCustomizer)},t.prototype.getSource=function(){return this.options.source},t.prototype.setOptions=function(e){if(e=(new Fm).merge(this.options,Yf(e,Fm._cloneCustomizer)),this.map){if(e.source!==this.options.source||e.sourceLayer!==this.options.sourceLayer)return this.options=e,void this.map.layers.add(this);this._updateBaseProperties(e,this.options),this._updatePaintProperty("heatmap-color",e.color,this.options.color),this._updatePaintProperty("heatmap-intensity",e.intensity,this.options.intensity),this._updatePaintProperty("heatmap-opacity",e.opacity,this.options.opacity),this._updatePaintProperty("heatmap-radius",e.radius,this.options.radius),this._updatePaintProperty("heatmap-weight",e.weight,this.options.weight)}this.options=e},t.prototype._buildLayers=function(){var e={id:this.id,type:"heatmap",source:this.options.source instanceof tm?this.options.source.getId():this.options.source,layout:{visibility:this.options.visible?"visible":"none"},paint:{"heatmap-color":this.options.color,"heatmap-intensity":this.options.intensity,"heatmap-opacity":this.options.opacity,"heatmap-radius":this.options.radius,"heatmap-weight":this.options.weight},minzoom:this.options.minZoom,maxzoom:this.options.maxZoom};return this.options.filter&&(e.filter=this.options.filter),this.options.sourceLayer&&(e["source-layer"]=this.options.sourceLayer),[e]},t.prototype._getLayerIds=function(){return[this.id]},t.prototype._getSourceIds=function(){var e=new Set;return this.options.source instanceof tm?e.add(this.options.source.getId()):e.add(this.options.source),e},t}(Tm),jm=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),qm=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.contrast=0,t.fadeDuration=300,t.hueRotation=0,t.maxBrightness=1,t.minBrightness=0,t.opacity=1,t.saturation=0,t}return jm(t,e),t}(km),Hm=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Vm=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.url=void 0,t.coordinates=void 0,t}return Hm(t,e),t._cloneCustomizer=function(e){if(e instanceof tm)return e},t}(qm),Gm=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Km=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gm(t,e),t.prototype._getSourceIds=function(){var e=new Set;return e.add(this._getSourceId()),e},t.prototype.onAdd=function(t){e.prototype.onAdd.call(this,t)},t}(Tm),Zm=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Wm=function(e){function t(t,r){return(r=e.call(this,r)||this).isLoading=!1,r.options=(new Vm).merge(Yf(t,Vm._cloneCustomizer)),r.img=new Image,r.reloadImage(),r}return Zm(t,e),t.prototype.getOptions=function(){return Yf(this.options,Vm._cloneCustomizer)},t.prototype.setOptions=function(e){var t,r=(new Vm).merge(this.options,Yf(e,Vm._cloneCustomizer)),n="string"==typeof e.url&&e.url!==this.getOptions().url;e=void 0!==e.coordinates&&e.coordinates!==this.getOptions().coordinates;this.map&&(this._updateBaseProperties(r,this.options),this._updatePaintProperty("raster-contrast",r.contrast,this.options.contrast),this._updatePaintProperty("raster-fade-duration",r.fadeDuration,this.options.fadeDuration),this._updatePaintProperty("raster-hue-rotate",r.hueRotation,this.options.hueRotation),this._updatePaintProperty("raster-brightness-max",r.maxBrightness,this.options.maxBrightness),this._updatePaintProperty("raster-opacity",r.opacity,this.options.opacity),this._updatePaintProperty("raster-saturation",r.saturation,this.options.saturation),t=this.map._getMap().getSource(this._getSourceId()))&&t.updateImage(r),this.options=r,n?this.reloadImage():e&&this.updateTransform()},t.prototype.getPositions=function(e){return this.transform.then((function(t){return t.toTarget(e)}))},t.prototype.getPixels=function(e){return this.transform.then((function(t){return t.toSource(e)}))},t.getCoordinatesFromRefPoints=function(e,t,r,n){return new zf(r,n).toTarget([[0,0],[e,0],[e,t],[0,t]])},t.getCoordinatesFromEdges=function(e,t,r,n,i){return"number"!=typeof i&&(i=0),t=[Math.min(n,r),t,Math.max(n,r),e],n=bf.getCenter(t),Yp([bf.getNorthWest(t),bf.getNorthEast(t),bf.getSouthEast(t),bf.getSouthWest(t)],n,i)},t.prototype._buildLayers=function(){var e={id:this.id,type:"raster",source:this._getSourceId(),layout:{visibility:this.options.visible?"visible":"none"},paint:{"raster-opacity":this.options.opacity,"raster-hue-rotate":this.options.hueRotation,"raster-brightness-min":this.options.minBrightness,"raster-brightness-max":this.options.maxBrightness,"raster-saturation":this.options.saturation,"raster-contrast":this.options.contrast,"raster-fade-duration":this.options.fadeDuration},minzoom:this.options.minZoom,maxzoom:this.options.maxZoom};return this.options.filter&&(e.filter=this.options.filter),[e]},t.prototype._getLayerIds=function(){return[this.id]},t.prototype._buildSource=function(){return{type:"image",url:this.options.url,coordinates:this.options.coordinates}},t.prototype._getSourceId=function(){return"".concat(this.getId(),"-ImageSource")},t.prototype.reloadImage=function(){var e=this;this.options.url&&(this.transform=new Promise((function(t,r){e.img.onload=function(){var r=[[0,0],[e.img.width,0],[e.img.width,e.img.height],[0,e.img.height]];t(new zf(r,e.options.coordinates)),e.isLoading=!1},e.img.onerror=e.img.onabort=function(){r("Failed to load image")},e.isLoading=!0,e.img.src=e.options.url})))},t.prototype.updateTransform=function(){var e;this.isLoading||(e=[[0,0],[this.img.width,0],[this.img.width,this.img.height],[0,this.img.height]],this.transform=Promise.resolve(new zf(e,this.options.coordinates)))},t.prototype._getSourceWrapper=function(){var e=this._getSourceId(),t=this._buildSource();return new fm(e,t)},t}(Km),$m=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ym=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.source=void 0,t.sourceLayer=void 0,t.lineCap="round",t.lineJoin="round",t.blur=0,t.strokeColor="#1E90FF",t.strokeDashArray=void 0,t.strokeGradient=void 0,t.offset=0,t.strokeOpacity=1,t.translate=new hp(0,0),t.translateAnchor="map",t.strokeWidth=2,t}return $m(t,e),t}(km),Xm=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Qm=window&&window.__assign||function(){return(Qm=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Jm=function(e){function t(t,r,n){return(r=e.call(this,r)||this).options=(new Ym).merge(Yf(n,Ym._cloneCustomizer)),r.options.source=t||r.options.source,r}return Xm(t,e),t.prototype.getOptions=function(){return Yf(this.options,Ym._cloneCustomizer)},t.prototype.getSource=function(){return this.options.source},t.prototype.setOptions=function(e){if(e=(new Ym).merge(this.options,Yf(e,Ym._cloneCustomizer)),this.map){if(e.source!==this.options.source||e.sourceLayer!==this.options.sourceLayer)return this.options=e,void this.map.layers.add(this);this._updateBaseProperties(e,this.options),this._updatePaintProperty("line-blur",e.blur,this.options.blur),this._updateLayoutProperty("line-cap",e.lineCap,this.options.lineCap),this._updateLayoutProperty("line-join",e.lineJoin,this.options.lineJoin),this._updatePaintProperty("line-offset",e.offset,this.options.offset),this._updatePaintProperty("line-color",e.strokeColor,this.options.strokeColor),this._updatePaintProperty("line-dasharray",e.strokeDashArray,this.options.strokeDashArray),this._updatePaintProperty("line-gradient",e.strokeGradient,this.options.strokeGradient),this._updatePaintProperty("line-opacity",e.strokeOpacity,this.options.strokeOpacity),this._updatePaintProperty("line-width",e.strokeWidth,this.options.strokeWidth),this._updatePaintProperty("line-translate",e.translate,this.options.translate),this._updatePaintProperty("line-translate-anchor",e.translateAnchor,this.options.translateAnchor)}this.options=e},t.prototype._buildLayers=function(){return[Qm(Qm(Qm(Qm({id:this.id,type:"line"},this.options.sourceLayer&&{"source-layer":this.options.sourceLayer}),{source:this.options.source instanceof tm?this.options.source.getId():this.options.source,layout:{visibility:this.options.visible?"visible":"none","line-cap":this.options.lineCap,"line-join":this.options.lineJoin},paint:Qm(Qm(Qm({"line-blur":this.options.blur,"line-color":this.options.strokeColor},this.options.strokeDashArray?{"line-dasharray":this.options.strokeDashArray}:{}),this.options.strokeGradient?{"line-gradient":this.options.strokeGradient}:{}),{"line-offset":this.options.offset,"line-opacity":this.options.strokeOpacity,"line-translate":this.options.translate,"line-translate-anchor":this.options.translateAnchor,"line-width":this.options.strokeWidth})}),this.options.filter&&{filter:this.options.filter}),{minzoom:this.options.minZoom,maxzoom:this.options.maxZoom})]},t.prototype._getLayerIds=function(){return[this.id]},t.prototype._getSourceIds=function(){var e=new Set;return this.options.source instanceof tm?e.add(this.options.source.getId()):e.add(this.options.source),e},t}(Tm),eg=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),tg=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.source=void 0,t.sourceLayer=void 0,t.base=0,t.fillColor="#1E90FF",t.height=0,t.fillOpacity=1,t.fillPattern=void 0,t.translate=new hp(0,0),t.translateAnchor="map",t.verticalGradient=!0,t}return eg(t,e),t}(km),rg=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ng=window&&window.__assign||function(){return(ng=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},ig=function(e){function t(t,r,n){return(r=e.call(this,r)||this).options=(new tg).merge(Yf(n,tg._cloneCustomizer)),r.options.source=t||r.options.source,r}return rg(t,e),t.prototype.getOptions=function(){return Yf(this.options,tg._cloneCustomizer)},t.prototype.getSource=function(){return this.options.source},t.prototype.setOptions=function(e){if(e=(new tg).merge(this.options,Yf(e,tg._cloneCustomizer)),this.map){if(e.source!==this.options.source||e.sourceLayer!==this.options.sourceLayer)return this.options=e,void this.map.layers.add(this);this._updateBaseProperties(e,this.options),this._updatePaintProperty("fill-extrusion-base",e.base,this.options.base),this._updatePaintProperty("fill-extrusion-color",e.fillColor,this.options.fillColor),this._updatePaintProperty("fill-extrusion-height",e.height,this.options.height),this._updatePaintProperty("fill-extrusion-opacity",e.fillOpacity,this.options.fillOpacity),this._updatePaintProperty("fill-extrusion-pattern",e.fillPattern,this.options.fillPattern),this._updatePaintProperty("fill-extrusion-translate",e.translate,this.options.translate),this._updatePaintProperty("fill-extrusion-translate-anchor",e.translateAnchor,this.options.translateAnchor),this._updatePaintProperty("fill-extrusion-vertical-gradient",e.verticalGradient,this.options.verticalGradient)}this.options=e},t.prototype._buildLayers=function(){return[ng(ng(ng(ng({id:this.id,type:"fill-extrusion"},this.options.sourceLayer&&{"source-layer":this.options.sourceLayer}),{source:this.options.source instanceof tm?this.options.source.getId():this.options.source,layout:{visibility:this.options.visible?"visible":"none"},paint:ng(ng({"fill-extrusion-base":this.options.base,"fill-extrusion-height":this.options.height,"fill-extrusion-opacity":this.options.fillOpacity},this.options.fillPattern?{"fill-extrusion-pattern":this.options.fillPattern}:{"fill-extrusion-color":this.options.fillColor}),{"fill-extrusion-translate":this.options.translate,"fill-extrusion-translate-anchor":this.options.translateAnchor,"fill-extrusion-vertical-gradient":this.options.verticalGradient})}),this.options.filter&&{filter:this.options.filter}),{minzoom:this.options.minZoom,maxzoom:this.options.maxZoom})]},t.prototype._getLayerIds=function(){return[this.id]},t.prototype._getSourceIds=function(){var e=new Set;return this.options.source instanceof tm?e.add(this.options.source.getId()):e.add(this.options.source),e},t}(Tm),og=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ag=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.source=void 0,t.sourceLayer=void 0,t.fillColor="#1E90FF",t.fillOpacity=.5,t.fillPattern=void 0,t.fillAntialias=!0,t}return og(t,e),t}(km),sg=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),lg=function(e){function t(t,r,n){return(r=e.call(this,r)||this).options=(new ag).merge(Yf(n,ag._cloneCustomizer)),r.options.source=t||r.options.source,r}return sg(t,e),t.prototype.getOptions=function(){return Yf(this.options,ag._cloneCustomizer)},t.prototype.getSource=function(){return this.options.source},t.prototype.setOptions=function(e){if(e=(new ag).merge(this.options,Yf(e,ag._cloneCustomizer)),this.map){if(e.source!==this.options.source||e.sourceLayer!==this.options.sourceLayer)return this.options=e,void this.map.layers.add(this);this._updateBaseProperties(e,this.options),this._updatePaintProperty("fill-color",e.fillColor,this.options.fillColor),this._updatePaintProperty("fill-opacity",e.fillOpacity,this.options.fillOpacity),this._updatePaintProperty("fill-pattern",e.fillPattern,this.options.fillPattern),this._updatePaintProperty("fill-antialias",e.fillAntialias,this.options.fillAntialias)}this.options=e},t.prototype._buildLayers=function(){var e={id:this.id,type:"fill",source:this.options.source instanceof tm?this.options.source.getId():this.options.source,layout:{visibility:this.options.visible?"visible":"none"},paint:{"fill-opacity":this.options.fillOpacity,"fill-antialias":this.options.fillAntialias},minzoom:this.options.minZoom,maxzoom:this.options.maxZoom};return this.options.filter&&(e.filter=this.options.filter),this.options.sourceLayer&&(e["source-layer"]=this.options.sourceLayer),this.options.fillPattern?e.paint["fill-pattern"]=this.options.fillPattern:e.paint["fill-color"]=this.options.fillColor,[e]},t.prototype._getLayerIds=function(){return[this.id]},t.prototype._getSourceIds=function(){var e=new Set;return this.options.source instanceof tm?e.add(this.options.source.getId()):e.add(this.options.source),e},t}(Tm),cg=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ug=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.allowOverlap=!1,t.anchor="bottom",t.ignorePlacement=!1,t.image="marker-blue",t.offset=new hp(0,0),t.optional=!1,t.padding=2,t.pitchAlignment="auto",t.rotation=0,t.rotationAlignment="auto",t.size=1,t.opacity=1,t}return cg(t,e),t}(Ur),hg=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),dg=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.allowOverlap=!1,t.anchor="center",t.textField=void 0,t.font=["StandardFont-Regular"],t.ignorePlacement=!1,t.justify="center",t.offset=new hp(0,0),t.optional=!1,t.padding=2,t.pitchAlignment="auto",t.radialOffset=void 0,t.rotation=0,t.rotationAlignment="auto",t.variableAnchor=void 0,t.size=16,t.color="#000000",t.haloBlur=0,t.haloColor="rgba(0,0,0,0)",t.haloWidth=0,t.opacity=1,t}return hg(t,e),t}(Ur),pg=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),fg=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.source=void 0,t.sourceLayer=void 0,t.iconOptions=new ug,t.textOptions=new dg,t.placement="point",t.sortKey=void 0,t.zOrder="auto",t.lineSpacing=250,t}return pg(t,e),t}(km),mg=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),gg=window&&window.__assign||function(){return(gg=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},yg=function(e){function t(t,r,n){return(r=e.call(this,r)||this).options=(new fg).merge(Yf(n,fg._cloneCustomizer)),r.options.source=t||r.options.source,r}return mg(t,e),t.prototype.getOptions=function(){return Yf(this.options,fg._cloneCustomizer)},t.prototype.getSource=function(){return this.options.source},t.prototype.setOptions=function(e){if(e=(new fg).merge(this.options,Yf(e,fg._cloneCustomizer)),this.map){if(e.source!==this.options.source||e.sourceLayer!==this.options.sourceLayer)return this.options=e,void this.map.layers.add(this);var t=this.options,r=e.iconOptions,n=t.iconOptions,i=e.textOptions,o=t.textOptions;this._updateBaseProperties(e,t),this._updateLayoutProperty("symbol-spacing",e.lineSpacing,t.lineSpacing),this._updateLayoutProperty("symbol-placement",e.placement,t.placement),this._updateLayoutProperty("symbol-sort-key",e.sortKey,t.sortKey),this._updateLayoutProperty("symbol-z-order",e.zOrder,t.zOrder),this._updateLayoutProperty("icon-allow-overlap",r.allowOverlap,n.allowOverlap),this._updateLayoutProperty("icon-anchor",r.anchor,n.anchor),this._updateLayoutProperty("icon-ignore-placement",r.ignorePlacement,n.ignorePlacement),this._updateLayoutProperty("icon-image",r.image,n.image),this._updateLayoutProperty("icon-offset",r.offset,n.offset),this._updatePaintProperty("icon-opacity",r.opacity,n.opacity),this._updateLayoutProperty("icon-optional",r.optional,n.optional),this._updateLayoutProperty("icon-padding",r.padding,n.padding),this._updateLayoutProperty("icon-pitch-alignment",r.pitchAlignment,n.pitchAlignment),this._updateLayoutProperty("icon-rotate",r.rotation,n.rotation),this._updateLayoutProperty("icon-rotation-alignment",r.rotationAlignment,n.rotationAlignment),this._updateLayoutProperty("icon-size",r.size,n.size),this._updateLayoutProperty("text-allow-overlap",i.allowOverlap,o.allowOverlap),this._updateLayoutProperty("text-anchor",i.anchor,o.anchor),this._updatePaintProperty("text-color",i.color,o.color),this._updateLayoutProperty("text-font",i.font,o.font),this._updateLayoutProperty("text-ignore-placement",i.ignorePlacement,o.ignorePlacement),this._updateLayoutProperty("text-justify",i.justify,o.justify),this._updatePaintProperty("text-halo-blur",i.haloBlur,o.haloBlur),this._updatePaintProperty("text-halo-color",i.haloColor,o.haloColor),this._updatePaintProperty("text-halo-width",i.haloWidth,o.haloWidth),this._updateLayoutProperty("text-offset",i.offset,o.offset),this._updatePaintProperty("text-opacity",i.opacity,o.opacity),this._updateLayoutProperty("text-optional",i.optional,o.optional),this._updateLayoutProperty("text-padding",i.padding,o.padding),this._updateLayoutProperty("text-pitch-alignment",i.pitchAlignment,o.pitchAlignment),this._updateLayoutProperty("text-radial-offset",i.radialOffset,o.radialOffset),this._updateLayoutProperty("text-rotate",i.rotation,o.rotation),this._updateLayoutProperty("text-rotation-alignment",i.rotationAlignment,o.rotationAlignment),this._updateLayoutProperty("text-size",i.size,o.size),this._updateLayoutProperty("text-variable-anchor",i.variableAnchor,o.variableAnchor),this._updateLayoutProperty("text-field",i.textField,o.textField)}this.options=e},t.prototype._buildLayers=function(){var e=gg(gg(gg(gg({id:this.id,type:"symbol"},this.options.sourceLayer&&{"source-layer":this.options.sourceLayer}),{source:this.options.source instanceof tm?this.options.source.getId():this.options.source,layout:gg(gg({visibility:this.options.visible?"visible":"none","symbol-placement":this.options.placement,"symbol-spacing":this.options.lineSpacing,"symbol-z-order":this.options.zOrder,"text-allow-overlap":this.options.textOptions.allowOverlap,"text-anchor":this.options.textOptions.anchor},this.options.textOptions.textField&&{"text-field":this.options.textOptions.textField}),{"text-font":this.options.textOptions.font,"text-ignore-placement":this.options.textOptions.ignorePlacement,"text-justify":this.options.textOptions.justify,"text-offset":this.options.textOptions.offset,"text-optional":this.options.textOptions.optional,"text-padding":this.options.textOptions.padding,"text-pitch-alignment":this.options.textOptions.pitchAlignment,"text-rotate":this.options.textOptions.rotation,"text-rotation-alignment":this.options.textOptions.rotationAlignment,"text-size":this.options.textOptions.size,"icon-allow-overlap":this.options.iconOptions.allowOverlap,"icon-anchor":this.options.iconOptions.anchor,"icon-ignore-placement":this.options.iconOptions.ignorePlacement,"icon-image":this.options.iconOptions.image,"icon-offset":this.options.iconOptions.offset,"icon-optional":this.options.iconOptions.optional,"icon-padding":this.options.iconOptions.padding,"icon-pitch-alignment":this.options.iconOptions.pitchAlignment,"icon-rotate":this.options.iconOptions.rotation,"icon-rotation-alignment":this.options.iconOptions.rotationAlignment,"icon-size":this.options.iconOptions.size}),paint:{"text-color":this.options.textOptions.color,"text-halo-blur":this.options.textOptions.haloBlur,"text-halo-color":this.options.textOptions.haloColor,"text-halo-width":this.options.textOptions.haloWidth,"text-opacity":this.options.textOptions.opacity,"icon-opacity":this.options.iconOptions.opacity}}),this.options.filter&&{filter:this.options.filter}),{minzoom:this.options.minZoom,maxzoom:this.options.maxZoom});return void 0!==this.options.sortKey&&(e.layout["symbol-sort-key"]=this.options.sortKey),void 0!==this.options.textOptions.radialOffset&&(e.layout["text-radial-offset"]=this.options.textOptions.radialOffset),void 0!==this.options.textOptions.variableAnchor&&(e.layout["text-variable-anchor"]=this.options.textOptions.variableAnchor),[e]},t.prototype._getLayerIds=function(){return[this.id]},t.prototype._getSourceIds=function(){var e=new Set;return this.options.source instanceof tm?e.add(this.options.source.getId()):e.add(this.options.source),e},t}(Tm),vg=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),_g=window&&window.__assign||function(){return(_g=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},bg=function(e){function t(t,r,n){return(t=e.call(this,t)||this).source=t._modifySource(r,n),t}return vg(t,e),t.prototype._buildSource=function(){return this.source},t.prototype._isDeepEqual=function(e){var t,r,n,i;return this.constructor===e.constructor&&(i=this.source,t=e.source,e=i.type===t.type&&i.url===t.url&&(void 0===i.tiles&&void 0===t.tiles||i.tiles&&t.tiles&&i.tiles.length===t.tiles.length&&i.tiles.every((function(e,r){return e===t.tiles[r]})))&&i.minzoom===t.minzoom&&i.maxzoom===t.maxzoom&&i.bounds===t.bounds&&i.attribution===t.attribution,r="raster"!==i.type||"raster"===i.type&&i.type===t.type&&i.tileSize===t.tileSize&&i.scheme===t.scheme,n="raster-dem"!==i.type||"raster-dem"===i.type&&i.type===t.type&&i.tileSize===t.tileSize&&i.encoding===t.encoding,i="vector"!==i.type||"vector"===i.type&&i.type===t.type&&i.promoteId===t.promoteId&&i.scheme===t.scheme,e)&&r&&n&&i},t.prototype._modifySource=function(e,t){if("raster"!==e.type&&"raster-dem"!==e.type&&"vector"!==e.type||!e.tiles){if("raster"!==e.type&&"raster-dem"!==e.type&&"vector"!==e.type||!e.url)throw new Error("Source definition must define a TileJSON 'url' or a 'tiles' array.");e.url="string"==typeof e.url?e.url:new Vr({domain:Cr,path:e.url.path,queryParams:_g(_g({},t),e.url.queryParams)}).toString()}else{var r=e.tiles.map((function(e){return"string"==typeof e?e:new Vr({domain:Cr,path:e.path,queryParams:_g(_g({},t),e.queryParams)}).toString()}));e.tiles=r}return e},t}(tm),wg=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),xg=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bounds=[-180,-85.0511,180,85.0511],t.minSourceZoom=0,t.maxSourceZoom=22,t.tileSize=512,t.isTMS=!1,t.subdomains=void 0,t.tileUrl=void 0,t}return wg(t,e),t}(qm),Cg=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Sg=window&&window.__assign||function(){return(Sg=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Eg=window&&window.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Tg=function(e){function t(t,r){return r=e.call(this,r)||this,t&&r.setOptions(t),r}return Cg(t,e),t.prototype.getOptions=function(){return Yf(this.options,xg._cloneCustomizer)},t.prototype.setOptions=function(e){if(e=(new xg).merge(this.options,Yf(e,xg._cloneCustomizer)),this.map){if(!lp(e.bounds,this.options.bounds)||e.isTMS!==this.options.isTMS||e.maxSourceZoom!==this.options.maxSourceZoom||e.minSourceZoom!==this.options.minSourceZoom||!lp(e.subdomains,this.options.subdomains)||e.tileSize!==this.options.tileSize||e.tileUrl!==this.options.tileUrl)return this.options=e,void this.map.layers.add(this);this._updateBaseProperties(e,this.options),this._updatePaintProperty("raster-contrast",e.contrast,this.options.contrast),this._updatePaintProperty("raster-fade-duration",e.fadeDuration,this.options.fadeDuration),this._updatePaintProperty("raster-hue-rotate",e.hueRotation,this.options.hueRotation),this._updatePaintProperty("raster-brightness-max",e.maxBrightness,this.options.maxBrightness),this._updatePaintProperty("raster-opacity",e.opacity,this.options.opacity),this._updatePaintProperty("raster-saturation",e.saturation,this.options.saturation)}this.options=e},t.prototype._setOptionsNoUpdate=function(e){this.options=(new xg).merge(this.options,Yf(e,xg._cloneCustomizer))},t.prototype._buildLayers=function(){return[Sg(Sg({id:this.id,type:"raster",source:this._getSourceId(),layout:{visibility:this.options.visible?"visible":"none"},paint:{"raster-contrast":this.options.contrast,"raster-fade-duration":this.options.fadeDuration,"raster-hue-rotate":this.options.hueRotation,"raster-brightness-max":this.options.maxBrightness,"raster-brightness-min":this.options.minBrightness,"raster-opacity":this.options.opacity,"raster-saturation":this.options.saturation}},this.options.filter&&{filter:this.options.filter}),{minzoom:this.options.minZoom,maxzoom:this.options.maxZoom})]},t.prototype._getLayerIds=function(){return[this.id]},t.prototype._buildSource=function(){var e,t;if(this.options.tileUrl){if(-1===this.options.tileUrl.indexOf("{"))return{type:"raster",url:this.options.tileUrl};if(-1!==this.options.tileUrl.indexOf("{subdomain}")){if(!(this.options.subdomains&&0<this.options.subdomains.length))throw new Error("The {subdomain} placeholder was included in the tileUrl but no subdomains were specified");var r=[];try{for(var n=Eg(this.options.subdomains),i=n.next();!i.done;i=n.next()){var o=i.value;r.push(this.options.tileUrl.replace(/{subdomain}/g,o))}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}t=r}else t=[this.options.tileUrl]}return Sg({type:"raster",bounds:this.options.bounds,maxzoom:this.options.maxSourceZoom,minzoom:this.options.minSourceZoom,scheme:this.options.isTMS?"tms":"xyz",tileSize:this.options.tileSize},t&&{tiles:t})},t.prototype._getSourceId=function(){return"".concat(this.getId(),"-RasterSource")},t.prototype._getSourceWrapper=function(){var e=this._getSourceId(),t=this._buildSource();return new bg(e,{name:e,tiles:t.tiles,type:t.type,url:t.url})},t}(Km),Ig=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),kg=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderer=void 0,t}return Ig(t,e),t}(km),Ag=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Pg=function(e){function t(t,r){var n=e.call(this,t)||this;return n._onStyleChange=function(){var e,t;n.map._getMap().getLayer(n.id)||(e=n.map,t=null==(t=n.map.layers._getUserLayers().find((function(e){return e.layer.getId()==n.id})))?void 0:t.before,e.layers.remove(n),e.layers.add(n,t))},n.options=(new kg).merge(Yf(r,kg._cloneCustomizer)),n.source=new im,n}return Ag(t,e),t.prototype.getOptions=function(){return Yf(this.options,kg._cloneCustomizer)},t.prototype.setOptions=function(e){e=(new kg).merge(this.options,Yf(e,kg._cloneCustomizer)),this.map&&this.map.triggerRepaint(),this.options=e},t.prototype.onAdd=function(t){var r,n;e.prototype.onAdd.call(this,t),this.map.events.add("stylechanged",this._onStyleChange),this.options.renderer&&this.glContext&&null!=(n=(r=this.options.renderer).onAdd)&&n.call(r,t,this.glContext)},t.prototype.onRemove=function(){var t,r;this.options.renderer&&this.glContext&&null!=(r=(t=this.options.renderer).onRemove)&&r.call(t,this.map,this.glContext),this.map.events.remove("stylechanged",this._onStyleChange),this.glContext=null,e.prototype.onRemove.call(this)},t.prototype._buildLayers=function(){var e=this;if(this.options.renderer)return[{id:this.id,type:"custom",renderingMode:this.options.renderer.renderingMode,onAdd:function(t,r){e.glContext=r},onRemove:function(e,t){},prerender:function(t,r){var n,i;e._shouldRender()&&null!=(i=(n=e.options.renderer).prerender)&&i.call(n,t,r)},render:function(t,r){e._shouldRender()&&e.options.renderer.render(t,r)}}];throw new Error("Cannot build the WebGL layer because renderer was not set.")},t.prototype._getLayerIds=function(){return[this.id]},t.prototype._getSourceIds=function(){return(new Set).add(this.source.getId())},t.prototype._shouldRender=function(){var e;return!!this.map&&(e=this.map.getCamera().zoom,this.options.visible)&&this.options.minZoom<=e&&this.options.maxZoom>e},t}(Tm),Mg=Object.freeze({__proto__:null,BubbleLayer:Nm,HeatMapLayer:Um,ImageLayer:Wm,Layer:Tm,LineLayer:Jm,PolygonExtrusionLayer:ig,PolygonLayer:lg,SymbolLayer:yg,TileLayer:Tg,WebGLLayer:Pg}),Rg=function(){function e(){}return e.convertHtmlString=function(e){var t;return"string"==typeof e?((t=document.createElement("div")).innerHTML=e,t):e},e.parseWithFilter=function(e,t,r,n){var i=this;if(void 0===t&&(t=function(e){return!0}),void 0===r&&(r=function(e){return e}),void 0===n&&(n=function(){return document.createElement("div")}),"string"==typeof e){if(0==(a=(new DOMParser).parseFromString(e,"text/html").body).children.length)return r(a.innerHTML);var o,a=1==a.children.length&&1==a.childNodes.length?a.children[0]:(o=n(),Array.from(a.childNodes).map((function(e){return o.append(e)})),o)}else a=e;return Array.from(a.children).forEach((function(e){return i.parseWithFilter(e,t,r)})),t(a)?r(a):(a.parentNode&&a.parentNode.removeChild(a),null)},e}(),Og=Xa,Lg=$u;function Dg(e){return Og(e)&&1===e.nodeType&&!Lg(e)}var Ng=ir(Dg),zg=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Fg=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.anchor="none",t.draggable=!1,t.closeButton=!0,t.content=document.createElement("span"),t.fillColor="#FFFFFF",t.pixelOffset=new hp(0,0),t.position=new pf(0,0),t.showPointer=!0,t}return zg(t,e),t._cloneCustomizer=function(e){if(Ng(e))return e},t}(Ur),Bg=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ug=window&&window.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=o.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a},jg=function(e){function t(r){var n=e.call(this)||this;return n.attach=function(e){n.map!==e&&(n.map&&n.remove(),n.map=e,n.marker=n._createMarker(n.options),n.marker.addTo(n.map._getMap()),n.map.popups._getCollectionDiv().appendChild(n.containerDiv),n.map.popups.add(n))},n.open=function(e){if(!e&&!n.map)throw new Error("Must specify a map to open on or attach to a map in advance");n.attach(e||n.map),n.containerDiv.classList.remove(t.Css.hidden),n.map.events.add("move",n._onMove),n._onMove(),n._invokeEvent("open",{target:n,type:"open"})},n.close=function(){n.map&&n.map.events.remove("move",n._onMove),n.containerDiv.classList.add(t.Css.hidden),n._invokeEvent("close",{target:n,type:"close"})},n.remove=function(){n.map&&(n.marker.remove(),n.containerDiv.classList.remove(n.autoAnchor||n.options.anchor),n.map.events.remove("move",n._onMove),n.map.popups.remove(n),delete n.map,delete n.marker,delete n.autoAnchor)},n.isOpen=function(){return n.map&&!n.containerDiv.classList.contains(t.Css.hidden)},n._onMove=function(){var e=n._getAutoAnchor(n.map,n.options);e!==n.autoAnchor&&(n._replaceMarker(n.map,n.options,e),n.map.events.add("move",n._onMove))},n._onDown=function(e){n.map.popups._addDraggedPopup(n);var t=Ug(n.map.positionsToPixels([n.options.position]),1)[0];"mousedown"===e.type?n.dragOffset=[t[0]-e.clientX,t[1]-e.clientY]:"touchstart"===e.type&&(n.dragOffset=[t[0]-e.touches[0].clientX,t[1]-e.touches[0].clientY])},n._onDragStart=function(e){e.preventDefault()},n.options=(new Fg).merge(Yf(r,Fg._cloneCustomizer)),n.containerDiv=n._createContainerDiv(n.options),n.contentDiv=n._createContentDiv(n.options),n.containerDiv.appendChild(n.contentDiv),n.options.showPointer&&(n.arrowDiv=n._createArrowDiv(),n.containerDiv.appendChild(n.arrowDiv)),n.options.closeButton&&(n.closeBtn=n._createCloseButton(),n.contentDiv.appendChild(n.closeBtn),r=ii("close"),n.contentDiv.appendChild(r),oi(r,n.closeBtn,!0)),n}return Bg(t,e),t.prototype.setPopupOptions=function(e){this.setOptions(e)},t.prototype.setOptions=function(e){var t;(e=(new Fg).merge(this.options,Yf(e,Fg._cloneCustomizer))).content!==this.options.content?(this.htmlContent.remove(),this.htmlContent=this._createHtmlContent(e),this.contentDiv.prepend(this.htmlContent)):e.draggable!==this.options.draggable&&this._setDraggable(this.htmlContent,e.draggable),e.closeButton&&!this.closeBtn?(this.closeBtn=this._createCloseButton(),this.contentDiv.appendChild(this.closeBtn),t=ii("close"),this.contentDiv.appendChild(t),oi(t,this.closeBtn,!0)):!e.closeButton&&this.closeBtn&&(this.contentDiv.removeChild(this.closeBtn),delete this.closeBtn),e.showPointer&&!this.arrowDiv?(this.arrowDiv=this._createArrowDiv(),this.containerDiv.appendChild(this.arrowDiv)):!e.showPointer&&this.arrowDiv&&(this.containerDiv.removeChild(this.arrowDiv),delete this.arrowDiv),e.fillColor!==this.options.fillColor&&(this.containerDiv.style.borderColor=e.fillColor,this.contentDiv.style.backgroundColor=e.fillColor),this.marker&&(e.anchor!==this.options.anchor?"none"===this.options.anchor?(this.autoAnchor!==e.anchor&&this._replaceMarker(this.map,e),this.map.events.remove("move",this._onMove),delete this.autoAnchor):(this._replaceMarker(this.map,e),"none"===e.anchor&&this.map.events.add("move",this._onMove)):(lp(e.position,this.options.position)||this.marker.setLngLat(e.position),lp(e.pixelOffset,this.options.pixelOffset)||this.marker.setOffset(e.pixelOffset))),this.options=e},t.prototype.getPopupOptions=function(){return this.getOptions()},t.prototype.getOptions=function(){return Yf(this.options,Fg._cloneCustomizer)},t.prototype.getPopupContainer=function(){return this.containerDiv},t.prototype._dragToPixel=function(e){this.dragging||(this.dragging=!0,this.contentDiv.style.pointerEvents="none",this._invokeEvent("dragstart",{type:"dragstart",target:this})),e=[e[0]+this.dragOffset[0],e[1]+this.dragOffset[1]],e=Ug(this.map.pixelsToPositions([e]),1)[0],this.options.position=e,this.marker.setLngLat(this.options.position),this._invokeEvent("drag",{type:"drag",target:this})},t.prototype._onUp=function(){this.dragging&&(this.contentDiv.style.pointerEvents="",this._invokeEvent("dragend",{type:"dragend",target:this}),"none"===this.options.anchor)&&this._onMove(),delete this.dragOffset,delete this.dragging},t.prototype._createContainerDiv=function(e){var r=this,n=document.createElement("div"),i=(n.classList.add(t.Css.container),n.classList.add(t.Css.hidden),n.style.borderColor=e.fillColor,n.setAttribute("role","dialog"),n.setAttribute("aria-label","Map Information Window"),!1);return n.addEventListener("keydown",(function(e){"Tab"!==e.key&&"Escape"!==e.key&&"Esc"!==e.key||(i=!0)})),n.addEventListener("keyup",(function(e){"Tab"!==e.key&&"Escape"!==e.key&&"Esc"!==e.key||(i=!1)})),n.addEventListener("focusin",(function(e){r.map&&!r.isOpen()&&(r.open(r.map),e.target instanceof HTMLElement)&&e.target.focus()})),n.addEventListener("focusout",(function(e){i&&e.relatedTarget instanceof Node&&!n.contains(e.relatedTarget)&&(i=!1,r.isOpen())&&r.close()})),n},t.prototype._createContentDiv=function(e){var r=document.createElement("div");return r.classList.add(t.Css.content),r.style.backgroundColor=e.fillColor,r.setAttribute("tabindex","0"),this.htmlContent=this._createHtmlContent(e),r.appendChild(this.htmlContent),r},t.prototype._createArrowDiv=function(){var e=document.createElement("div");return e.classList.add(t.Css.arrow),e},t.prototype._createCloseButton=function(){var e=document.createElement("button");return e.addEventListener("click",this.close),e.classList.add(t.Css.close),e.setAttribute("aria-label","close"),e.setAttribute("tabindex","0"),e.innerHTML="&times;",e},t.prototype._createHtmlContent=function(e){var t=Rg.convertHtmlString(e.content);return e.draggable&&this._setDraggable(t,e.draggable),t},t.prototype._createMarker=function(e,t){var r=this.marker?this.marker.getLngLat():e.position;return t=("none"===e.anchor?(this.autoAnchor=t||"bottom",this.containerDiv.classList.add(this.autoAnchor),new sr.Marker({anchor:this.autoAnchor,element:this.containerDiv,offset:e.pixelOffset})):(this.containerDiv.classList.add(e.anchor),new sr.Marker({anchor:e.anchor,element:this.containerDiv,offset:e.pixelOffset}))).setLngLat(r)},t.prototype._getAutoAnchor=function(e,t){var r,n,i=this.containerDiv.offsetWidth,o=this.containerDiv.offsetHeight,a=[];return(n=this.marker?(r=(n=e._getMap().project(this.marker.getLngLat())).x,n.y):(n=Ug(e.positionsToPixels([t.position]),1),r=(t=Ug(n[0],2))[0],t[1]))<o?a.push("top"):n>e.getCanvas().offsetHeight-o&&a.push("bottom"),r<i/2?a.push("left"):r>e.getCanvas().offsetWidth-i/2&&a.push("right"),0<a.length?a.join("-"):"bottom"},t.prototype._replaceMarker=function(e,t,r){var n=this.containerDiv.nextElementSibling;this.marker.remove(),this.containerDiv.classList.remove(this.autoAnchor||this.options.anchor),this.marker=this._createMarker(t,r),this.marker.addTo(e._getMap()),e.popups._getCollectionDiv().insertBefore(this.containerDiv,n||null)},t.prototype._setDraggable=function(e,t){t?(e.addEventListener("mousedown",this._onDown),e.addEventListener("touchstart",this._onDown),e.addEventListener("dragstart",this._onDragStart)):(e.removeEventListener("mousedown",this._onDown),e.removeEventListener("touchstart",this._onDown),e.removeEventListener("dragstart",this._onDragStart))},t.Css={arrow:"popup-arrow",close:"popup-close",container:"popup-container",content:"popup-content-container",hidden:"hidden-accessible-element"},t}(ui),qg=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Hg=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.anchor="bottom",t.color="#1A73AA",t.draggable=!1,t.htmlContent='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24.5 36.5" id="marker_'.concat(dr(),'" width="24.5" height="36.5" display="block"><path d="M12.25.25a12.2543,12.2543,0,0,0-12,12.4937c0,6.4436,6.4879,12.1093,11.059,22.5641.5493,1.2563,1.3327,1.2563,1.882,0C17.7621,24.8529,24.25,19.1857,24.25,12.7437A12.2543,12.2543,0,0,0,12.25.25Z"   fill="{color}" stroke="{secondaryColor}" stroke-width="0.5"/><text style="font-family: Arial, Helvetica, sans-serif; font-size: 14px; fill: white;" text-anchor="middle" x="12" y="18">{text}</text></svg>'),t.pixelOffset=new hp(0,0),t.position=new pf(0,0),t.popup=void 0,t.secondaryColor="white",t.text=void 0,t.visible=!0,t}return qg(t,e),t._cloneCustomizer=function(e){if(e instanceof jg||Ng(e))return e},t}(Ur),Vg=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Gg=function(e){function t(t){var r=e.call(this)||this;return r._onDrag=function(){var e=r.marker.getLngLat().wrap();r.options.position=new pf(e.lng,e.lat),r._invokeEvent("drag",{type:"drag",target:r})},r._onDragStart=function(){r._invokeEvent("dragstart",{type:"dragstart",target:r})},r._onDragEnd=function(){r._invokeEvent("dragend",{type:"dragend",target:r})},r._bubbleElementEvent=function(e){r._invokeEvent(e.type,{type:e.type,target:r})},r._onEleDragStart=function(e){e.preventDefault()},r.options=(new Hg).merge(Yf(t,Hg._cloneCustomizer)),r._buildMarker(r.options),r}return Vg(t,e),t.prototype.getOptions=function(){return Yf(this.options,Hg._cloneCustomizer)},t.prototype.getElement=function(){return this.marker.getElement()},t.prototype.setOptions=function(e){e=(new Hg).merge(this.options,Yf(e,Hg._cloneCustomizer)),lp(e.htmlContent,this.options.htmlContent)&&e.anchor===this.options.anchor?("string"!=typeof e.htmlContent||e.color===this.options.color&&e.text===this.options.text&&e.secondaryColor===this.options.secondaryColor||(this.element.innerHTML=this._getSubbedHtmlString(e)||""),e.draggable!==this.options.draggable&&(this._setDraggable(e.draggable),this.marker.setDraggable(e.draggable)),lp(e.pixelOffset,this.options.pixelOffset)||this.marker.setOffset(e.pixelOffset),lp(e.position,this.options.position)||this.marker.setLngLat(e.position),e.visible!==this.options.visible&&(e.visible?this.element.classList.remove(t.hiddenClass):this.element.classList.add(t.hiddenClass))):(this.marker.remove(),this._buildMarker(e),this.map&&(this.marker.addTo(this.map._getMap()),this._getCollectionContainer().appendChild(this.element))),this.options=e},t.prototype.togglePopup=function(){if(this.options.popup)if(this.options.popup.isOpen())this.options.popup.close();else{if(!this.map)throw new Error("The marker must be added to a map before calling togglePopup().");this.options.popup.setOptions({position:this.options.position}),this.options.popup.open(this.map)}},t.prototype._addToMap=function(e,t){this.map&&this.map!==e&&this._removeFromMap(),t&&(this.options.position=Ru(t),this.marker.setLngLat(this.options.position)),this.map!==e&&(this.map=e,this.marker.addTo(e._getMap()),this._getCollectionContainer().appendChild(this.element))},t.prototype._removeFromMap=function(){this.map&&(this.marker.remove(),delete this.map)},t.prototype._getId=function(){if(this.element)return("string"==typeof this.options.htmlContent?this.element.firstChild:this.element).id},t.prototype._buildMarker=function(e){var r;"string"==typeof e.htmlContent?(r=this._getSubbedHtmlString(e)||"",this.element=Rg.convertHtmlString(r)):this.element=e.htmlContent,this.element.classList.add(t.containerClass),e.draggable&&this._setDraggable(!0),e.visible||this.element.classList.add(t.hiddenClass),this.marker=new sr.Marker({element:this.element,offset:e.pixelOffset,draggable:e.draggable,anchor:e.anchor}).setLngLat(e.position),this.marker.on("drag",this._onDrag),this.marker.on("dragstart",this._onDragStart),this.marker.on("dragend",this._onDragEnd),this.element.addEventListener("click",this._bubbleElementEvent),this.element.addEventListener("dblclick",this._bubbleElementEvent),this.element.addEventListener("contextmenu",this._bubbleElementEvent),this.element.addEventListener("keydown",this._bubbleElementEvent),this.element.addEventListener("keypress",this._bubbleElementEvent),this.element.addEventListener("keyup",this._bubbleElementEvent),this.element.addEventListener("mousedown",this._bubbleElementEvent),this.element.addEventListener("mouseenter",this._bubbleElementEvent),this.element.addEventListener("mouseleave",this._bubbleElementEvent),this.element.addEventListener("mousemove",this._bubbleElementEvent),this.element.addEventListener("mouseout",this._bubbleElementEvent),this.element.addEventListener("mouseover",this._bubbleElementEvent),this.element.addEventListener("mouseup",this._bubbleElementEvent)},t.prototype._getSubbedHtmlString=function(e){return"string"==typeof e.htmlContent?e.htmlContent.replace(/{color}/gi,e.color||"").replace(/{secondaryColor}/gi,e.secondaryColor||"").replace(/{text}/gi,e.text||""):null},t.prototype._getCollectionContainer=function(){var e=this.map.getCanvasContainer().querySelector(".".concat(t.collectionContainerClass));return e||((e=document.createElement("div")).classList.add(t.collectionContainerClass),this.map.getCanvasContainer().appendChild(e)),e},t.prototype._setDraggable=function(e){e?this.element.addEventListener("dragstart",this._onEleDragStart):this.element.removeEventListener("dragstart",this._onEleDragStart)},t.collectionContainerClass="marker-collection-container",t.hiddenClass="hidden-accessible-element",t.containerClass="marker-container",t}(ui),Kg=function(){function e(){}return e.getHighContrastMode=function(){return matchMedia("(-ms-high-contrast: white-on-black)").matches?"dark":matchMedia("(-ms-high-contrast: black-on-white)").matches?"light":matchMedia("(-ms-high-contrast: active)").matches?"dark":matchMedia("(inverted-colors: inverted)").matches?"invert":null},e}();function Zg(e,t){return e||t}function Wg(e,t){return e[t]}var $g,Yg=void 0,Xg=null,Qg="function",Jg="object",ey="prototype",ty="__proto__",ry="undefined",ny="constructor",iy="Symbol",oy="length",ay="name",sy="call",ly="toString",cy=Zg(Object),uy=Wg(cy,ey),hy=Zg(String),dy=Wg(hy,ey),py=Zg(Math),fy=Zg(Array),my=Wg(fy,ey),gy=Wg(my,"slice");function yy(e,t){try{return{v:e.apply(this,t)}}catch(e){return{e:e}}}function vy(e){return function(t){return typeof t===e}}function _y(e){var t="[object "+e+"]";return function(e){return!(!e||function(e){return uy[ly].call(e)}(e)!==t)}}function by(e){return typeof e===ry||e===ry}function wy(e){return e===Xg||by(e)}function xy(e){return!!e||e!==Yg}var Cy=vy("string"),Sy=vy(Qg);function Ey(e){return!(!e&&wy(e)||!e||typeof e!==Jg)}var Ty=Wg(fy,"isArray"),Iy=_y("Date"),ky=vy("number"),Ay=vy("boolean"),Py=_y("Error");function My(e){return!!(e&&e.then&&Sy(e.then))}function Ry(e){return!(!e||function(e,t){return(e=yy(e)).e?t:e.v}((function(){return!(e&&0+e)}),!e))}var Oy=Wg(cy,"getOwnPropertyDescriptor");function Ly(e,t){return!!e&&uy.hasOwnProperty[sy](e,t)}var Dy=Zg(Wg(cy,"hasOwn"),(function(e,t){return Ly(e,t)||!!Oy(e,t)}));function Ny(e,t,r){if(e&&Ey(e))for(var n in e)if(Dy(e,n)&&-1===t[sy](r||e,n,e[n]))break}var zy={e:"enumerable",c:"configurable",v:"value",w:"writable",g:"get",s:"set"};var Fy=Wg(cy,"defineProperty");function By(e,t,r){return Fy(e,t,function(e){var t,r={};return r[zy.c]=!0,r[zy.e]=!0,e.l&&(r.get=function(){return e.l.v},t=Oy(e.l,"v"))&&t.set&&(r.set=function(t){e.l.v=t}),Ny(e,(function(e,t){r[zy[e]]=by(t)?r[zy[e]]:t})),r}(r))}function Uy(e,t,r,n,i){var o={};return Ny(e,(function(e,n){jy(o,e,t?n:e,i),jy(o,n,r?n:e,i)})),n?n(o):o}function jy(e,t,r,n){Fy(e,t,{value:r,enumerable:!0,writable:!!n})}var qy=Zg(hy);function Hy(e,t){var r="",n=uy[ly][sy](e);"[object Error]"===n&&(e={stack:qy(e.stack),message:qy(e.message),name:qy(e.name)});try{r=(r=JSON.stringify(e,Xg,t?"number"==typeof t?t:4:Yg))&&r.replace(/"(\w+)"\s*:\s{0,1}/g,"$1: ")||qy(e)}catch(e){r=" - "+Hy(e,t)}return n+": "+r}function Vy(e){throw new Error(e)}function Gy(e){throw new TypeError(e)}var Ky=Wg(cy,"freeze");var Zy=Wg(cy,"assign"),Wy=Wg(cy,"keys");function $y(e){return Ky&&Ny(e,(function(e,t){(Ty(t)||Ey(t))&&$y(t)})),Yy(e)}var Yy=Zg(Ky,(function(e){return e})),Xy=Zg(Wg(cy,"getPrototypeOf"),(function(e){return e[ty]||Xg}));var Qy,Jy=function(e){return Uy(e,0,0,Yy)}({asyncIterator:0,hasInstance:1,isConcatSpreadable:2,iterator:3,match:4,matchAll:5,replace:6,search:7,species:8,split:9,toPrimitive:10,toStringTag:11,unscopables:12}),ev="__tsUtils$gblCfg";function tv(){var e;return(e=(e=(e=typeof globalThis!==ry?globalThis:e)||typeof self===ry?e:self)||typeof window===ry?e:window)||typeof r.g===ry?e:r.g}function rv(){var e;return Qy||(e=yy(tv).v||{},Qy=e[ev]=e[ev]||{}),Qy}function nv(e,t,r){var n=t&&t[e];return function(t){var i,o=t&&t[e]||n;if(o||r)return i=arguments,(o||r).apply(t,o?gy[sy](i,1):i);Gy('"'+qy(e)+'" not defined for '+Hy(t))}}var iv=Wg(py,"max"),ov=nv("slice",dy),av=nv("substring",dy),sv=nv("substr",dy,(function(e,t,r){return wy(e)&&Gy("Invalid "+Hy(e)),r<0?"":((t=t||0)<0&&(t=iv(t+e[oy],0)),by(r)?ov(e,t):ov(e,t,t+r))}));function lv(e,t){return av(e,0,t)}var cv,uv,hv,dv="_urid";function pv(e){var t={description:qy(e),toString:function(){return iy+"("+e+")"},_polyfill:!0};return t}function fv(e){var t,r,n=function(){var e;return cv||(e=rv(),cv=e.gblSym=e.gblSym||{k:{},s:{}}),cv}();return Dy(n.k,e)||(t=pv(e),r=Wy(n.s).length,t[dv]=function(){return r+"_"+t[ly]()},n.k[e]=t,n.s[t[dv]()]=qy(e)),n.k[e]}function mv(){hv=rv()}function gv(e){return Fy({toJSON:function(){return e}},"v",{value:e})}var yv,vv="window";function _v(e,t){var r;return function(){return hv||mv(),(r=r&&!hv.lzy?r:gv(yy(e,t).v)).v}}function bv(e){return hv||mv(),(yv=yv&&!1!==e&&!hv.lzy?yv:gv(yy(tv).v||Xg)).v}function wv(e,t){return(t=yv&&!1!==t?yv.v:bv(t))&&t[e]?t[e]:e===vv?Ev():Xg}function xv(){return!!Cv()}var Cv=_v(wv,["document"]);function Sv(){return!!Ev()}var Ev=_v(wv,[vv]);var Tv=_v(wv,["navigator"]);var Iv,kv,Av,Pv=_v(wv,["history"]),Mv=_v((function(){return!!yy((function(){return process&&(process.versions||{}).node})).v})),Rv=_v((function(){return!!yy((function(){return self&&self instanceof WorkerGlobalScope})).v}));function Ov(){return Iv=gv(yy(wv,[iy]).v)}function Lv(e){var t=(hv.lzy?0:Iv)||Ov();return t.v?t.v[e]:Yg}function Dv(){return hv||mv(),!!((hv.lzy?0:Iv)||Ov()).v}function Nv(e,t){var r=Jy[e],n=(hv||mv(),(hv.lzy?0:Iv)||Ov());return n.v?n.v[r||e]:t?Yg:function(e){var t;return uv=uv||{},(e=Jy[e])?uv[e]=uv[e]||pv(iy+"."+e):t}(e)}function zv(e,t){hv||mv();var r=(hv.lzy?0:Iv)||Ov();return r.v?r.v(e):t?Xg:pv(e)}function Fv(e){return hv||mv(),((kv=(hv.lzy?0:kv)||gv(yy(Lv,["for"]).v)).v||fv)(e)}function Bv(e){return!!e&&Sy(e.next)}function Uv(e){return!function(e){return e===Xg||!xy(e)}(e)&&Sy(e[Nv(3)])}function jv(e,t,r){if(e&&(Bv(e)||(e=e[(Av=Av||gv(Nv(3))).v]?e[Av.v]():null),Bv(e))){var n=Yg,i=Yg;try{for(var o=0;!(i=e.next()).done&&-1!==t[sy](r||e,i.value,o,e);)o++}catch(t){n={e:t},e.throw&&(i=Xg,e.throw(n))}finally{try{i&&!i.done&&e.return&&e.return(i)}finally{if(n)throw n.e}}}}function qv(e,t,r){return e.apply(t,r)}function Hv(e,t){return!by(t)&&e&&(Ty(t)?qv(e.push,e,t):Bv(t)||Uv(t)?jv(t,(function(t){e.push(t)})):e.push(t)),e}function Vv(e,t,r){if(e)for(var n=e[oy]>>>0,i=0;i<n&&(!(i in e)||-1!==t[sy](r||e,e[i],i,e));i++);}var Gv=nv("indexOf",my),Kv=nv("map",my);function Zv(e,t,r){return(e&&e.slice||gy).apply(e,gy[sy](arguments,1))}var Wv,$v,Yv=nv("reduce",my),Xv=Zg(Wg(cy,"create"),(function(e){var t;return e?((t=typeof e)!==Jg&&t!==Qg&&Gy("Prototype must be an Object or function: "+Hy(e)),r[ey]=e,new r):{};function r(){}}));function Qv(e,t){return(cy.setPrototypeOf||function(e,t){var r;(Wv=Wv||gv(((r={})[ty]=[],r instanceof Array))).v?e[ty]=t:Ny(t,(function(t,r){return e[t]=r}))})(e,t)}function Jv(e,t){t&&(e[ay]=t)}function e_(e,t,r){var n=r||Error,i=n[ey][ay],o=Error.captureStackTrace;return function(e,t,r){function n(){this[ny]=t,yy(By,[this,ay,{v:e,c:!0,e:!1}])}return yy(By,[t,ay,{v:e,c:!0,e:!1}]),(t=Qv(t,r))[ey]=r===Xg?Xv(r):(n[ey]=r[ey],new n),t}(e,(function(){var r=arguments;try{yy(Jv,[n,e]);var a,s=qv(n,this,gy[sy](r))||this;return s!==this&&(a=Xy(this))!==Xy(s)&&Qv(s,a),o&&o(s,this[ny]),t&&t(s,r),s}finally{yy(Jv,[n,i])}}),n)}function t_(){return(Date.now||r_)()}function r_(){return(new Date).getTime()}var n_,i_,o_,a_=function(e){return function(t){return wy(t)&&Gy("strTrim called ["+Hy(t)+"]"),t&&t.replace?t.replace(e,""):t}}(/^\s+|(?=\s)\s+$/g),s_=nv("trim",dy,a_);function l_(e){if(!e||typeof e!==Jg)return!1;var t=!1;if(e!==(o_=o_||!Sv()||Ev())){i_||(n_=Function[ey][ly],i_=n_[sy](cy));try{var r=Xy(e);t=(t=!r)||(r=Ly(r,ny)?r[ny]:r)&&typeof r===Qg&&n_[sy](r)===i_}catch(e){}}return t}function c_(e){return e.value&&p_(e),!0}var u_=[function(e){var t,r=e.value;return!!Ty(r)&&((t=e.result=[]).length=r.length,e.copyTo(t,r),!0)},p_,function(e){return e.type===Qg},function(e){var t=e.value;return!!Iy(t)&&(e.result=new Date(t.getTime()),!0)}];function h_(e,t,r,n){var i=r.handler,o=(n=r.path?n?r.path.concat(n):r.path:[],{handler:r.handler,src:r.src,path:n}),a=typeof t,s=!1,l=!1,c=(t&&a===Jg?s=l_(t):l=t===Xg||function(e){return $g=$g||["string","number","boolean",ry,"symbol","bigint"],e!==Jg&&-1!==$g.indexOf(e)}(a),{type:a,isPrim:l,isPlain:s,value:t,result:t,path:n,origin:r.src,copy:function(t,n){return h_(e,t,n?o:r,n)},copyTo:function(t,r){return d_(e,t,r,o)}});return c.isPrim?i&&i[sy](r,c)?c.result:t:function(e,t,r,n){var i;return Vv(e,(function(e){if(e.k===t)return i=e,-1})),i||(i={k:t,v:t},e.push(i),n(i)),i.v}(e,t,0,(function(e){By(c,"result",{g:function(){return e.v},s:function(t){e.v=t}});for(var t=0,n=i;!(n||(t<u_.length?u_[t++]:c_))[sy](r,c);)n=Xg}))}function d_(e,t,r,n){if(!wy(r))for(var i in r)t[i]=h_(e,r[i],n,i);return t}function p_(e){var t,r=e.value;return!(!r||!e.isPlain||(t=e.result={},e.copyTo(t,r),0))}function f_(e,t){return Vv(t,(function(t){!function(e,t,r){d_([],e,t,{handler:r,src:t,path:[]})}(e,t)})),e}function m_(e,t,r,n,i,o,a){return f_(function(e,t){return h_([],e,{handler:t,src:e})}(e)||{},gy[sy](arguments))}var g_,y_=function(e){return function(t){return t[e]}}(oy);function v_(){return hv||mv(),(g_=g_&&!hv.lzy?g_:gv(yy(wv,["performance"]).v)).v}var __=nv("split",dy);function b_(e,t,r){var n;e&&t&&(n=(t=__(t,".")).pop(),Vv(t,(function(t){wy(e[t])&&(e[t]={}),e=e[t]})),e[n]=r)}var w_=nv("endsWith",dy,(function(e,t,r){return Cy(e)||Gy("'"+Hy(e)+"' is not a string"),t=Cy(t)?t:qy(t),r=!by(r)&&r<e[oy]?r:e[oy],av(e,r-t[oy],r)===t}));var x_=nv("indexOf",dy),C_="ref",S_="unref",E_="hasRef";function T_(e,t,r){var n=Ty(t),i=n?t.length:0,o=(0<i?t[0]:n?Yg:t)||setTimeout,a=(1<i?t[1]:Yg)||clearTimeout,s=r[0],l=(r[0]=function(){l.dn(),qv(s,Yg,gy[sy](arguments))},function(e,t,r){var n,i=!0,o=e?t(Xg):Xg;function a(){return i=!1,o&&o[S_]&&o[S_](),n}function s(){o&&r(o),o=Xg}function l(){return o=t(o),i||a(),n}return(n={cancel:s,refresh:l})[E_]=function(){return o&&o[E_]?o[E_]():i},n[C_]=function(){return i=!0,o&&o[C_]&&o[C_](),n},n[S_]=a,{h:n=Fy(n,"enabled",{get:function(){return!!o},set:function(e){!e&&o&&s(),e&&!o&&l()}}),dn:function(){o=Xg}}}(e,(function(e){if(e){if(e.refresh)return e.refresh(),e;qv(a,Yg,[e])}return qv(o,Yg,r)}),(function(e){qv(a,Yg,[e])})));return l.h}function I_(e,t){return T_(!0,Yg,gy[sy](arguments))}var k_,A_=function(e){return Uy(e,1,0,Yy)},P_=function(e){return function(e){var t={};return Ny(e,(function(e,r){jy(t,e,r[1]),jy(t,r[0],r[1])})),Yy(t)}(e)},M_=A_({NONE:0,PENDING:3,INACTIVE:1,ACTIVE:2}),R_="toLowerCase",O_="blkVal",L_="length",D_="rdOnly",N_="notify",z_="warnToConsole",F_="throwInternal",B_="setDf",U_="watch",j_="logger",q_="apply",H_="push",V_="splice",G_="hdlr",K_="cancel",Z_="initialize",W_="identifier",$_="removeNotificationListener",Y_="addNotificationListener",X_="isInitialized",Q_="instrumentationKey",J_="INACTIVE",eb="value",tb="getNotifyMgr",rb="getPlugin",nb="name",ib="iKey",ob="time",ab="processNext",sb="getProcessTelContext",lb="pollInternalLogs",cb="enabled",ub="stopPollingInternalLogs",hb="unload",db="onComplete",pb="version",fb="loggingLevelConsole",mb="createNew",gb="teardown",yb="messageId",vb="message",_b="isAsync",bb="diagLog",wb="_doTeardown",xb="update",Cb="getNext",Sb="setNextPlugin",Eb="protocol",Tb="userAgent",Ib="split",kb="nodeType",Ab="replace",Pb="logInternalMessage",Mb="type",Rb="handler",Ob="status",Lb="getResponseHeader",Db="getAllResponseHeaders",Nb="isChildEvt",zb="data",Fb="getCtx",Bb="setCtx",Ub="complete",jb="itemsReceived",qb="urlString",Hb="sendPOST",Vb="headers",Gb="timeout",Kb="setRequestHeader",Zb="traceId",Wb="spanId",$b="traceFlags";var Yb,Xb="function",Qb="object",Jb="undefined",ew="prototype",tw=Object,rw=tw[ew],nw=((bv()||{}).Symbol,(bv()||{}).Reflect,"hasOwnProperty"),iw=Zy||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])rw[nw].call(t,i)&&(e[i]=t[i]);return e},ow=function(e,t){return(ow=tw.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)t[nw](r)&&(e[r]=t[r])}))(e,t)};function aw(e,t){function r(){this.constructor=e}typeof t!==Xb&&null!==t&&Gy("Class extends value "+String(t)+" is not a constructor or null"),ow(e,t),e[ew]=null===t?Xv(t):(r[ew]=t[ew],new r)}function sw(e,t){for(var r=0,n=t.length,i=e.length;r<n;r++,i++)e[i]=t[r];return e}var lw="constructor",cw="prototype",uw="function",hw="_dynInstFuncs",dw="_isDynProxy",pw="_dynClass",fw="_dynInstChk",mw=fw,gw="_dfOpts",yw="_unknown_",vw="__proto__",_w="_dyn"+vw,bw="__dynProto$Gbl",ww="_dynInstProto",xw="useBaseInst",Cw="setInstFuncs",Sw=Object,Ew=Sw.getPrototypeOf,Tw=Sw.getOwnPropertyNames,Iw=bv(),kw=Iw[bw]||(Iw[bw]={o:((Yb={})[Cw]=!0,Yb[xw]=!0,Yb),n:1e3});function Aw(e){return e&&(e===Sw[cw]||e===Array[cw])}function Pw(e){return Aw(e)||e===Function[cw]}function Mw(e){if(e){if(Ew)return Ew(e);var t=e[vw]||e[cw]||(e[lw]?e[lw][cw]:null),r=e[_w]||t;Ly(e,_w)||(delete e[ww],r=e[_w]=e[ww]||e[_w],e[ww]=t)}return r}function Rw(e,t){var r=[];if(Tw)r=Tw(e);else for(var n in e)"string"==typeof n&&Ly(e,n)&&r.push(n);if(r&&0<r.length)for(var i=0;i<r.length;i++)t(r[i])}function Ow(e,t,r){return t!==lw&&typeof e[t]===uw&&(r||Ly(e,t))&&t!==vw&&t!==cw}function Lw(e){Gy("DynamicProto: "+e)}function Dw(e,t){for(var r=e.length-1;0<=r;r--)if(e[r]===t)return!0;return!1}function Nw(e,t,r,n,i){var o,a;Aw(e)||Aw(o=r[hw]=r[hw]||Xv(null))||(a=o[t]=o[t]||Xv(null),!1!==o[mw]&&(o[mw]=!!i),Aw(a))||Rw(r,(function(t){function i(){return(function(e,t,r,n){var i=null;if(e&&Ly(r,pw)){var o=e[hw]||Xv(null);if((i=(o[r[pw]]||Xv(null))[t])||Lw("Missing ["+t+"] "+uw),!i[fw]&&!1!==o[mw]){for(var a=!Ly(e,t),s=Mw(e),l=[];a&&s&&!Pw(s)&&!Dw(l,s);){var c=s[t];if(c){a=c===n;break}l.push(s),s=Mw(s)}try{a&&(e[t]=i),i[fw]=1}catch(e){o[mw]=!1}}}return i}(this,s,o,i)||function(e,t,r){var n=t[e];return typeof(n=n===r?Mw(t)[e]:n)!==uw&&Lw("["+e+"] is not a "+uw),n}(s,o,i)).apply(this,arguments)}var o,s;Ow(r,t,!1)&&r[t]!==n[t]&&(a[t]=r[t],delete r[t],Ly(e,t)&&(!e[t]||e[t][dw])||(e[t]=(o=e,s=t,i[dw]=1,i)))}))}function zw(e,t){return Ly(e,cw)?e.name||t||yw:((e||{})[lw]||{}).name||t||yw}function Fw(e,t,r,n){Ly(e,cw)||Lw("theClass is an invalid class definition.");var i=e[cw],o=(function(e,t){if(Ew){for(var r=[],n=Mw(t);n&&!Pw(n)&&!Dw(r,n);){if(n===e)return!0;r.push(n),n=Mw(n)}return!1}return!0}(i,t)||Lw("["+zw(e)+"] not in hierarchy of ["+zw(t)+"]"),null),a=!!(e=(Ly(i,pw)?o=i[pw]:(o="_dynCls$"+zw(e,"_")+"$"+kw.n,kw.n++,i[pw]=o),Fw[gw]))[xw],s=(a&&n&&void 0!==n[xw]&&(a=!!n[xw]),function(e){var t=Xv(null);return Rw(e,(function(r){!t[r]&&Ow(e,r,!1)&&(t[r]=e[r])})),t}(t));r(t,function(e,t,r,n){function i(e,t,r){var i,o=t[r];return o[dw]&&n&&!1!==(i=e[hw]||{})[mw]&&(o=(i[t[pw]]||{})[r]||o),function(){return o.apply(e,arguments)}}for(var o=Xv(null),a=(Rw(r,(function(e){o[e]=i(t,r,e)})),Mw(e)),s=[];a&&!Pw(a)&&!Dw(s,a);)Rw(a,(function(e){!o[e]&&Ow(a,e,!Ew)&&(o[e]=i(t,a,e))})),s.push(a),a=Mw(a);return o}(i,t,s,a)),r=!!Ew&&!!e[Cw];Nw(i,o,t,s,!1!==(r=r&&n?!!n[Cw]:r))}Fw[gw]=kw.o;var Bw="Promise",Uw="rejected";function jw(e,t){return qw(e,(function(e){return t?t({status:"fulfilled",rejected:!1,value:e}):e}),(function(e){return t?t({status:Uw,rejected:!0,reason:e}):e}))}function qw(e,t,r,n){var i=e;try{if(My(e))(t||r)&&(i=e.then(t,r));else try{t&&(i=t(e))}catch(e){if(!r)throw e;i=r(e)}}finally{n&&function(e,t){var r=e;t&&(My(e)?r=e.finally?e.finally(t):e.then((function(e){return t(),e}),(function(e){throw t(),e})):t())}(i,n)}return i}var Hw,Vw=["pending","resolving","resolved",Uw],Gw="dispatchEvent";function Kw(e){var t;return!!(t=e&&e.createEvent?e.createEvent("Event"):t)&&t.initEvent}var Zw,Ww,$w,Yw,Xw="unhandledRejection",Qw=Xw.toLowerCase();function Jw(e){return Sy(e)?e.toString():Hy(e)}function ex(e,t,r){var n,i,o=Zv(arguments,3),a=0,s=!1,l=[],c=!1,u=null;function h(t,r){return c=!0,u&&u.cancel(),u=null,e((function(e,i){l.push((function(){try{var o=2===a?t:r,s=by(o)?n:Sy(o)?o(n):o;My(s)?s.then(e,i):(o||3!==a?e:i)(s)}catch(o){i(o)}})),s&&p()}),o)}function d(){return Vw[a]}function p(){var e;0<l.length&&(e=l.slice(),l=[],c=!0,u&&u.cancel(),u=null,t(e))}function f(e,t){return function(r){a===t&&(2===e&&My(r)?(a=1,r.then(f(2,1),f(3,1))):(a=e,s=!0,n=r,p(),c||3!==e||(u=u||I_(m,10))))}}function m(){var e;c||(c=!0,Mv()?process.emit(Xw,n,i):(e=Ev()||bv(),Zw=Zw||gv(yy(wv,[Bw+"RejectionEvent"]).v),function(e,t,r,n){var i=Cv();i=(Hw=Hw||gv(!!yy(Kw,[i]).v)).v?i.createEvent("Event"):n?new Event(t):{},r&&r(i),Hw.v&&i.initEvent(t,!1,!0),i&&e[Gw]?e[Gw](i):(n=e["on"+t])?n(i):(r=wv("console"))&&(r.error||r.log)(t,Hy(i))}(e,Qw,(function(e){return By(e,"promise",{g:function(){return i}}),e.reason=n,e}),!!Zw.v)))}Fy(i={then:h,catch:function(e){return h(void 0,e)},finally:function(e){var t=e,r=e;return Sy(e)&&(t=function(t){return e&&e(),t},r=function(t){throw e&&e(),t}),h(t,r)}},"state",{get:d}),Dv()&&(i[Nv(11)]="IPromise"),i.toString=function(){return"IPromise "+d()+(s?" - "+Jw(n):"")},Sy(r)||Gy(Bw+": executor is not a function - "+Jw(r));var g=f(3,0);try{r.call(i,f(2,0),g)}catch(e){g(e)}return i}function tx(e){var t=ky(e)?e:0;return function(e){I_((function(){!function(e){Vv(e,(function(e){try{e()}catch(e){}}))}(e)}),t)}}function rx(e,t){return ex(rx,tx(t),e,t)}function nx(e,t){var r=(Ww=Ww||gv(yy(wv,[Bw]).v||null)).v;if(!r)return rx(e);Sy(e)||Gy(Bw+": executor is not a function - "+Hy(e));var n=0;return r=new r((function(t,r){e((function(e){n=2,t(e)}),(function(e){n=3,r(e)}))})),Fy(r,"state",{get:function(){return Vw[n]}}),r}function ix(e,t){return($w=$w||gv(nx)).v.call(this,e,t)}var ox=function(e){return function(t){var r=Zv(arguments,1);return e((function(e,r){try{var n=[],i=1;jv(t,(function(t,o){t&&(i++,qw(t,(function(t){n[o]=t,0==--i&&e(n)}),r))})),0===--i&&e(n)}catch(t){r(t)}}),r)}}(ix);function ax(e,t){return(Yw=Yw||function(e){return gv((function(t){var r=Zv(arguments,1);return e((function(e,r){var n=[],i=1;function o(t,r){i++,jw(t,(function(t){t.rejected?n[r]={status:Uw,reason:t.reason}:n[r]={status:"fulfilled",value:t.value},0==--i&&e(n)}))}try{Ty(t)?Vv(t,o):Uv(t)?jv(t,o):Gy("Input is not an iterable"),0===--i&&e(n)}catch(o){r(o)}}),r)}))}(ix)).v(e,t)}var sx=void 0,lx="",cx="channels",ux="core",hx="createPerfMgr",dx="disabled",px="extensionConfig",fx="extensions",mx="processTelemetry",gx="priority",yx="eventsSent",vx="eventsDiscarded",_x="eventsSendRequest",bx="perfEvent",wx="offlineEventsStored",xx="offlineBatchSent",Cx="offlineBatchDrop",Sx="getPerfMgr",Ex="domain",Tx="path",Ix=/-([a-z])/g,kx=/([^\w\d_$])/g,Ax=/^(\d+[\w\d_$])/,Px=Object.getPrototypeOf;function Mx(e){return!wy(e)}function Rx(e){return e&&Cy(e)?(e=(e=e[Ab](Ix,(function(e,t){return t.toUpperCase()})))[Ab](kx,"_"))[Ab](Ax,(function(e,t){return"_"+t})):e}function Ox(e,t){return!(!e||!t)&&-1!==x_(e,t)}function Lx(e){return e&&e.toISOString()||""}function Dx(e){return Py(e)?e[nb]:lx}function Nx(e,t,r,n,i){var o=r;return!e||(o=e[t])===r||i&&!i(o)||n&&!n(r)||(e[t]=o=r),o}function zx(e,t,r){var n;return e?!(n=e[t])&&wy(n)&&(n=by(r)?{}:r,e[t]=n):n=by(r)?{}:r,n}function Fx(e,t){var r=null,n=null;return Sy(e)?r=e:n=e,function(){var e=arguments;if(n=r?r():n)return n[t][q_](n,e)}}function Bx(e,t,r,n,i){e&&t&&r&&(!1===i&&!by(e[t])||(e[t]=Fx(r,n)))}function Ux(e,t,r,n){return e&&t&&Ey(e)&&Ty(r)&&Vv(r,(function(r){Cy(r)&&Bx(e,r,t,r,n)})),e}function jx(e){return e&&Zy?tw(Zy({},e)):e}function qx(e,t,r,n,i,o){var a=arguments,s=a[0]||{},l=a[L_],c=!1,u=1;for(0<l&&Ay(s)&&(c=s,s=a[u]||{},u++),Ey(s)||(s={});u<l;u++){var h,d,p,f,m=a[u],g=Ty(m),y=Ey(m);for(h in m)(g&&h in m||y&&Dy(m,h))&&(d=m[h],p=void 0,c&&d&&((p=Ty(d))||l_(d))&&(f=s[h],p?Ty(f)||(f=[]):l_(f)||(f={}),d=qx(c,f,d)),void 0!==d)&&(s[h]=d)}return s}function Hx(e,t){var r=!1;t=t&&t.featureOptIn&&t.featureOptIn[e];return e&&t?3==(e=t.mode)||1==e:r}function Vx(e){try{return e.responseText}catch(e){}return null}function Gx(e,t){return e?"XDomainRequest,Response:"+Vx(e)||0:t}function Kx(e,t){return e?"XMLHttpRequest,Status:"+e[Ob]+",Response:"+Vx(e)||0:t}function Zx(e,t){return t&&(ky(t)?e=[t].concat(e):Ty(t)&&(e=t.concat(e))),e}var Wx="withCredentials";function $x(e,t,r){return!e[r]&&t&&t[Lb]&&(t=t[Lb](r))&&(e[r]=s_(t)),e}function Yx(e,t){var r={};return e[Db]?r=function(e){var t={};return Cy(e)&&Vv(s_(e)[Ib](/[\r\n]+/),(function(e){var r,n;e&&(-1!==(n=e.indexOf(": "))?(r=s_(e.substring(0,n))[R_](),n=s_(e.substring(n+1)),t[r]=n):t[s_(e)]=1)})),t}(e[Db]()):t&&(r=$x(r,e,"time-delta-millis"),r=$x(r,e,"kill-duration"),r=$x(r,e,"kill-duration-seconds")),r}var Xx="JSON",Qx="msie",Jx="trident/",eC="XMLHttpRequest",tC=null,rC=null,nC=null,iC=null;function oC(e,t){var r,n=!1;if(e){try{(n=t in e)||(r=e[ew])&&(n=t in r)}catch(e){}if(!n)try{n=!by((new e)[t])}catch(e){}}return n}function aC(e){return typeof location===Qb&&location?location:wv("location")}function sC(){return Boolean(typeof JSON===Qb&&JSON||null!==wv(Xx))}function lC(){return sC()?JSON||wv(Xx):null}function cC(){var e=Tv();return!e||e[Tb]===rC&&null!==tC||(e=((rC=e[Tb])||lx)[R_](),tC=Ox(e,Qx)||Ox(e,Jx)),tC}function uC(e){var t=((e=(e=void 0===e?null:e)?e:(t=Tv()||{})?(t.userAgent||lx)[R_]():lx)||lx)[R_]();return Ox(t,Qx)?(e=Cv()||{},Math.max(parseInt(t[Ib](Qx)[1]),e.documentMode||0)):Ox(t,Jx)&&(e=parseInt(t[Ib](Jx)[1]))?e+4:null}function hC(e){return iC=null!==iC&&!1!==e?iC:!!Tv()&&Boolean(Tv().sendBeacon)}function dC(e){var t=!1;try{t=!!wv("fetch");var r=wv("Request");t&&e&&r&&(t=oC(r,"keepalive"))}catch(e){}return t}function pC(){var e=!1;try{e=!!wv(eC)}catch(e){}return e}function fC(e,t,r){var n=bv();if(n&&n.CustomEvent)try{return function(e,t){return!!(e&&e.dispatchEvent&&t)&&(e.dispatchEvent(t),!0)}(n,function(e,t){var r,n=null;return t={detail:t||null},Sy(CustomEvent)?n=new CustomEvent(e,t):(r=Cv())&&r.createEvent&&(n=r.createEvent("CustomEvent")).initCustomEvent(e,!0,!0,t),n}(e,{cfg:t||null,customDetails:r||null}))}catch(e){}return!1}var mC=4294967296,gC=4294967295,yC=123456789,vC=987654321,_C=!1,bC=yC,wC=vC;function xC(){try{var e=2147483647&t_();!function(e){e<0&&(e>>>=0),bC=yC+e&gC,wC=vC-e&gC,_C=!0}((Math.random()*mC^e)+e)}catch(e){}}function CC(e){var t=0,r=wv("crypto")||wv("msCrypto");return 0===(t=r&&r.getRandomValues?r.getRandomValues(new Uint32Array(1))[0]&gC:t)&&cC()&&(_C||xC(),t=function(e){var t=((wC=36969*(65535&wC)+(wC>>16)&gC)<<16)+(65535&(bC=18e3*(65535&bC)+(bC>>16)&gC))>>>0&gC;return e||(t>>>=0),t}()&gC),0===t&&(t=Math.floor(mC*Math.random()|0)),e||(t>>>=0),t}function SC(e){void 0===e&&(e=22);for(var t=CC()>>>0,r=0,n=lx;n[L_]<e;)r++,n+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&t),t>>>=6,5===r&&(t=(CC()<<2&4294967295|3&t)>>>0,r=0);return n}var EC="3.3.0",TC="."+SC(6),IC=0;function kC(e){return 1===e[kb]||9===e[kb]||!+e[kb]}function AC(e,t){return Rx(e+IC+++((t=void 0!==t&&t)?"."+EC:lx)+TC)}function PC(e){var t={id:AC("_aiData-"+(e||lx)+"."+EC),accept:function(e){return kC(e)},get:function(e,r,n,i){var o=e[t.id];return o?o[Rx(r)]:(i&&((o=function(e,t){var r=t[e.id];if(!r){r={};try{kC(t)&&By(t,e.id,{e:!1,v:r})}catch(e){}}return r}(t,e))[Rx(r)]=n),n)},kill:function(e,t){if(e&&e[t])try{delete e[t]}catch(e){}}};return t}function MC(e){return e&&Ey(e)&&(e.isVal||e.fb||Dy(e,"v")||Dy(e,"mrg")||Dy(e,"ref")||e.set)}function RC(e,t,r){var n,i=r.dfVal||xy;if(t&&r.fb){var o=r.fb;Ty(o)||(o=[o]);for(var a=0;a<o[L_];a++){var s=o[a],l=t[s];if(i(l)?n=l:e&&(i(l=e.cfg[s])&&(n=l),e.set(e.cfg,qy(s),l)),i(n))break}}return!i(n)&&i(r.v)?r.v:n}function OC(e,t,r){var n,i=r;return(i=r&&MC(r)?RC(e,t,r):i)&&(MC(i)&&(i=OC(e,t,i)),Ty(i)?(n=[])[L_]=i[L_]:l_(i)&&(n={}),n)&&(Ny(i,(function(r,i){i&&MC(i)&&(i=OC(e,t,i)),n[r]=i})),i=n),i}function LC(e,t,r,n){var i,o,a,s,l,c,u=MC(u=n)?(i=u.isVal,o=u.set,l=u[D_],h=u[O_],a=u.mrg,!(s=u.ref)&&by(s)&&(s=!!a),RC(e,t,u)):n,h=(n=(h&&e[O_](t,r),!0),t[r]);!h&&wy(h)||(c=h,n=!1,i&&c!==u&&!i(c)&&(c=u,n=!0),o&&(n=(c=o(c,u,t))===u)),n?c=u&&OC(e,t,u):(l_(c)||Ty(u))&&a&&u&&(l_(u)||Ty(u))&&Ny(u,(function(t,r){LC(e,c,t,r)})),e.set(t,r,c),s&&e.ref(t,r),l&&e[D_](t,r)}var DC=Fv("[[ai_dynCfg_1]]"),NC=Fv("[[ai_blkDynCfg_1]]"),zC=Fv("[[ai_frcDynCfg_1]]");function FC(e){var t;return e&&(Ty(e)?(t=[])[L_]=e[L_]:l_(e)&&(t={}),t)?(Ny(e,(function(e,r){t[e]=FC(r)})),t):e}function BC(e,t,r){var n=!1;return!r||e[t.blkVal]||(n=r[zC])||r[NC]?n:l_(r)||Ty(r)}function UC(e){Gy("InvalidAccess:"+e)}var jC=["push","pop","shift","unshift","splice"],qC=function(e,t,r,n){e&&e[F_](3,108,"".concat(r," [").concat(t,"] failed - ")+Hy(n))};function HC(e,t){return(e=Oy(e,t))&&e.get}function VC(e,t,r,n){var i;return t&&((i=HC(t,r))&&i[e.prop]?t[r]=n:function(e,t,r,n){var i={n:r,h:[],trk:function(t){t&&t.fn&&(-1===Gv(i.h,t)&&i.h[H_](t),e.trk(t,i))},clr:function(e){-1!==(e=Gv(i.h,e))&&i.h[V_](e,1)}},o=!0,a=!1;function s(){o&&(a=a||BC(s,e,n),n&&!n[DC]&&a&&(n=KC(e,n,r,"Converting")),o=!1);var t=e.act;return t&&i.trk(t),n}s[e.prop]={chng:function(){e.add(i)}},By(t,i.n,{g:s,s:function(l){if(n!==l){s[e.ro]&&!e.upd&&UC("["+r+"] is read-only:"+Hy(t)),o&&(a=a||BC(s,e,n),o=!1);var c,u=a&&s[e.rf];if(a)if(u){Ny(n,(function(e){n[e]=l?l[e]:sx}));try{Ny(l,(function(t,r){VC(e,n,t,r)})),l=n}catch(c){qC((e.hdlr||{})[j_],r,"Assigning",c),a=!1}}else n&&n[DC]&&Ny(n,(function(t){(t=HC(n,t))&&(t=t[e.prop])&&t.chng()}));l!==n&&(c=l&&BC(s,e,l),!u&&c&&(l=KC(e,l,r,"Converting")),n=l,a=c),e.add(i)}}})}(e,t,r,n)),t}function GC(e,t,r,n){if(t){var i=HC(t,r),o=i&&!!i[e.prop],a=n&&n[0],s=n&&n[1];n=n&&n[2];if(!o){if(n)try{!function(e){if(e&&(l_(e)||Ty(e)))try{e[NC]=!0}catch(e){}}(t)}catch(t){qC((e.hdlr||{})[j_],r,"Blocking",t)}try{VC(e,t,r,t[r]),i=HC(t,r)}catch(t){qC((e.hdlr||{})[j_],r,"State",t)}}a&&(i[e.rf]=a),s&&(i[e.ro]=s),n&&(i[e.blkVal]=!0)}return t}function KC(e,t,r,n){try{Ny(t,(function(r,n){VC(e,t,r,n)})),t[DC]||(Fy(t,DC,{get:function(){return e[G_]}}),function(e,t,r){Ty(t)&&Vv(jC,(function(n){var i=t[n];t[n]=function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var a=i[q_](this,n);return KC(e,t,r,"Patching"),a}}))}(e,t,r))}catch(Hj){qC((e.hdlr||{})[j_],r,n,Hj)}return t}var ZC="[[ai_",WC="]]";function $C(e){var t,r=zv(ZC+"get"+e.uid+WC),n=zv(ZC+"ro"+e.uid+WC),i=zv(ZC+"rf"+e.uid+WC),o=zv(ZC+"blkVal"+e.uid+WC),a=zv(ZC+"dtl"+e.uid+WC),s=null,l=null;function c(r,n){var i=t.act;try{(t.act=r)&&r[a]&&(Vv(r[a],(function(e){e.clr(r)})),r[a]=[]),n({cfg:e.cfg,set:e.set.bind(e),setDf:e[B_].bind(e),ref:e.ref.bind(e),rdOnly:e[D_].bind(e)})}catch(n){var o=e[j_];throw o&&o[F_](1,107,Hy(n)),n}finally{t.act=i||null}}function u(){if(s){var e=s,t=(s=null,l&&l[K_](),l=null,[]);if(Vv(e,(function(r){if(r&&(r[a]&&(Vv(r[a],(function(e){e.clr(r)})),r[a]=null),r.fn))try{c(r,r.fn)}catch(e){t[H_](e)}})),s)try{u()}catch(e){t[H_](e)}0<t[L_]&&function(e,t){k_=k_||e_("AggregationError",(function(e,t){1<t[L_]&&(e.errors=t[1])}));var r=e||"One or more errors occurred.";throw Vv(t,(function(e,t){r+="\n".concat(t," > ").concat(Hy(e))})),new k_(r,t||[])}("Watcher error(s): ",t)}}return(r={prop:r,ro:n,rf:i})[O_]=o,r[G_]=e,r.add=function(e){if(e&&0<e.h[L_]){s=s||[],l=l||I_((function(){l=null,u()}),0);for(var t=0;t<e.h[L_];t++){var r=e.h[t];r&&-1===Gv(s,r)&&s[H_](r)}}},r[N_]=u,r.use=c,r.trk=function(e,t){e&&(e=e[a]=e[a]||[],-1===Gv(e,t))&&e[H_](t)},t=r}function YC(e,t,r){var n,i,o=function(e){if(e){var t=e[DC]||e;if(t.cfg&&(t.cfg===e||t.cfg[DC]===t))return t}return null}(t);return o||(o=AC("dyncfg",!0),(t={uid:null,cfg:r=t&&!1!==r?t:FC(t)})[j_]=e,t[N_]=function(){n[N_]()},t.set=function(t,r,i){try{t=VC(n,t,r,i)}catch(t){qC(e,r,"Setting value",t)}return t[r]},t[B_]=function(e,t){return t&&Ny(t,(function(t,r){LC(i,e,t,r)})),e},t[U_]=function(e){return function(e,t){var r={fn:t,rm:function(){r.fn=null,t=e=null}};return By(r,"toJSON",{v:function(){return"WatcherHandler"+(r.fn?"":"[X]")}}),e.use(r,t),r}(n,e)},t.ref=function(e,t){return GC(n,e,t,((e={})[0]=!0,e))[t]},t[D_]=function(e,t){return GC(n,e,t,((e={})[1]=!0,e))[t]},t[O_]=function(e,t){return GC(n,e,t,((e={})[2]=!0,e))[t]},t._block=function(e,t){n.use(null,(function(r){var i=n.upd;try{by(t)||(n.upd=t),e(r)}finally{n.upd=i}}))},By(i=t,"uid",{c:!1,e:!1,w:!1,v:o}),KC(n=$C(i),r,"config","Creating"),i)}function XC(e,t,r,n){return r=YC(r,e||{},n),t&&r[B_](r.cfg,t),r}function QC(e,t,r){var n=e[DC]||e;return(!n.cfg||n.cfg!==e&&n.cfg[DC]!==n?(function(e,t){e?(e[z_](t),e[F_](2,108,t)):UC(t)}(r,"Not dynamic - "+Hy(e)),XC(e,null,r)):n)[U_](t)}function JC(e,t){if(e&&e[hb])return e[hb](t)}function eS(e,t,r){var n;return r||(n=ix((function(e){r=e}))),e&&0<y_(e)?jw(JC(e[0],t),(function(){eS(Zv(e,1),t,r)})):r(),n}var tS="Microsoft_ApplicationInsights_BypassAjaxInstrumentation";function rS(e,t,r){return!e&&wy(e)?t:Ay(e)?e:"true"===qy(e)[R_]()}function nS(e){return{mrg:!0,v:e}}function iS(e,t){return{set:e,v:t}}function oS(e,t,r){return{fb:r,isVal:e,v:t}}function aS(e,t){return{fb:t,set:rS,v:!!e}}var sS,lS,cS=[yx,vx,_x,bx],uS=null;function hS(e,t){return function(){var r=arguments,n=dS(t);n&&(n=n.listener)&&n[e]&&n[e][q_](n,r)}}function dS(e){var t=uS;return(t=t||!0===e.disableDbgExt?t:uS||function(){var e=wv("Microsoft");return uS=e?e.ApplicationInsights:uS}())?t.ChromeDbgExt:null}var pS="warnToConsole",fS={loggingLevelConsole:0,loggingLevelTelemetry:1,maxMessageLimit:25,enableDebug:!1},mS=((lS={})[0]=null,lS[1]="errorToConsole",lS[2]=pS,lS[3]="debugToConsole",lS);function gS(e){return e?'"'+e[Ab](/\"/g,lx)+'"':lx}function yS(e,t){var r,n=typeof console!==Jb?console:wv("console");n&&(r="log",n[e]&&(r=e),Sy(n[r]))&&n[r](t)}var vS=function(){function e(e,t,r,n){void 0===r&&(r=!1),this[yb]=e,this[vb]=(r?"AI: ":"AI (Internal): ")+e,r=lx,sC()&&(r=lC().stringify(n)),e=(t?" message:"+gS(t):lx)+(n?" props:"+gS(r):lx),this[vb]+=e}return e.dataType="MessageData",e}();function _S(e,t){return(e||{})[j_]||new xS(t)}var bS,wS,xS=function(){function e(t){this.identifier="DiagnosticLogger",this.queue=[];var r,n,i,o,a,s=0,l={};Fw(e,this,(function(e){function c(t,r){var o,a;i<=s||(a=!0,o="AITR_"+r[yb],l[o]?a=!1:l[o]=!0,a&&(t<=n&&(e.queue[H_](r),s++,u(1===t?"error":"warn",r)),s===i)&&(a=new vS(23,o="Internal events throttle limit per PageView reached for this app.",!1),e.queue[H_](a),1===t?e.errorToConsole(o):e[z_](o)))}function u(e,r){var n=dS(t||{});n&&n[bb]&&n[bb](e,r)}a=QC(XC(t||{},fS,e).cfg,(function(e){e=e.cfg,r=e[fb],n=e.loggingLevelTelemetry,i=e.maxMessageLimit,o=e.enableDebug})),e.consoleLoggingLevel=function(){return r},e[F_]=function(t,n,i,a,s){if(n=new vS(n,i,s=void 0!==s&&s,a),o)throw Hy(n);i=mS[t]||pS,by(n[vb])?u("throw"+(1===t?"Critical":"Warning"),n):(s?(a=+n[yb],!l[a]&&t<=r&&(e[i](n[vb]),l[a]=!0)):t<=r&&e[i](n[vb]),c(t,n))},e.debugToConsole=function(e){yS("debug",e),u("warning",e)},e[z_]=function(e){yS("warn",e),u("warning",e)},e.errorToConsole=function(e){yS("error",e),u("error",e)},e.resetInternalMessageCount=function(){s=0,l={}},e[Pb]=c,e[hb]=function(e){a&&a.rm(),a=null}}))}return e.__ieDyn=1,e}();function CS(e){return e||new xS}function SS(e,t,r,n,i,o){void 0===o&&(o=!1),CS(e)[F_](t,r,n,i,o)}function ES(e,t){CS(e)[z_](t)}var TS,IS="toGMTString",kS="toUTCString",AS="cookie",PS="expires",MS="isCookieUseDisabled",RS="disableCookiesUsage",OS="_ckMgr",LS=null,DS=null,NS=null,zS={},FS={},BS=((bS={cookieCfg:nS(((wS={})[Ex]={fb:"cookieDomain",dfVal:Mx},wS.path={fb:"cookiePath",dfVal:Mx},wS.enabled=sx,wS.ignoreCookies=sx,wS.blockedCookies=sx,wS)),cookieDomain:sx,cookiePath:sx})[RS]=sx,bS);function US(){TS=TS||function(e){var t={};return hv||mv(),t.b=hv.lzy,Fy(t,"v",{configurable:!0,get:function(){var r=e();return hv.lzy||Fy(t,"v",{value:r}),t.b=hv.lzy,r}}),t}((function(){return Cv()}))}function jS(e){return!e||e.isEnabled()}function qS(e,t){return!!(t&&e&&Ty(e.ignoreCookies))&&-1!==Gv(e.ignoreCookies,t)}function HS(e,t){var r;return wy(t=t[cb])&&(r=void 0,by(e[MS])||(r=!e[MS]),t=r=by(e[RS])?r:!e[RS]),t}function VS(e,t){var r,n;return e?n=e.getCookieMgr():t&&(n=(r=t.cookieCfg)&&r[OS]?r[OS]:GS(t)),n||function(e,t){var r=GS[OS]||FS[OS];return r||(r=GS[OS]=GS(e,t),FS[OS]=r),r}(t,(e||{})[j_])}function GS(e,t){e=XC(e||FS,null,t).cfg,a=QC(e,(function(t){t[B_](t.cfg,BS),n=t.ref(t.cfg,"cookieCfg"),i=n[Tx]||"/",o=n[Ex],s=!1!==HS(e,n),l=n.getCookie||YS,c=n.setCookie||XS,u=n.delCookie||XS}),t),(r={isEnabled:function(){var r=!1!==HS(e,n)&&s&&KS(t),i=FS[OS];return r&&i&&h!==i?jS(i):r},setEnabled:function(e){s=!1!==e,n[cb]=e},set:function(e,t,r,a,s){var l,u,d,p=!1;return jS(h)&&!function(e,t){return!!(t&&e&&Ty(e.blockedCookies)&&-1!==Gv(e.blockedCookies,t))||qS(e,t)}(n,e)&&(l={},u=s_(t||lx),-1!==(d=x_(u,";"))&&(u=s_(lv(t,d)),l=ZS(av(t,d+1))),Nx(l,Ex,a||o,Ry,by),wy(r)||(t=cC(),by(l[PS])&&0<(d=t_()+1e3*r)&&((a=new Date).setTime(d),Nx(l,PS,WS(a,t?IS:kS)||WS(a,t?IS:kS)||lx,Ry)),t)||Nx(l,"max-age",lx+r,null,by),(d=aC())&&"https:"===d[Eb]&&(Nx(l,"secure",null,null,by),DS=null===DS?!function(e){return!(!Cy(e)||!Ox(e,"CPU iPhone OS 12")&&!Ox(e,"iPad; CPU OS 12")&&!(Ox(e,"Macintosh; Intel Mac OS X 10_14")&&Ox(e,"Version/")&&Ox(e,"Safari"))&&(!Ox(e,"Macintosh; Intel Mac OS X 10_14")||!w_(e,"AppleWebKit/605.1.15 (KHTML, like Gecko)"))&&!Ox(e,"Chrome/5")&&!Ox(e,"Chrome/6")&&(!Ox(e,"UnrealEngine")||Ox(e,"Chrome"))&&!Ox(e,"UCBrowser/12")&&!Ox(e,"UCBrowser/11"))}((Tv()||{})[Tb]):DS)&&Nx(l,"SameSite","None",null,by),Nx(l,Tx,s||i,null,by),c(e,$S(u,l)),p=!0),p},get:function(e){var t=lx;return jS(h)&&!qS(n,e)?l(e):t},del:function(e,t){var r=!1;return jS(h)?h.purge(e,t):r},purge:function(e,r){var n,i=!1;return KS(t)&&((n={})[Tx]=r||"/",n[PS]="Thu, 01 Jan 1970 00:00:01 GMT",r=n,cC()||(r["max-age"]="0"),u(e,$S(lx,r)),i=!0),i}})[hb]=function(e){a&&a.rm(),a=null};var r,n,i,o,a,s,l,c,u,h=r;return h[OS]=h}function KS(e){if(null===LS){LS=!1,TS||US();try{var t=TS.v||{};LS=void 0!==t[AS]}catch(t){SS(e,2,68,"Cannot access document.cookie - "+Dx(t),{exception:Hy(t)})}}return LS}function ZS(e){var t={};return e&&e[L_]&&Vv(s_(e)[Ib](";"),(function(e){var r;(e=s_(e||lx))&&(-1===(r=x_(e,"="))?t[e]=null:t[s_(lv(e,r))]=s_(av(e,r+1)))})),t}function WS(e,t){return Sy(e[t])?e[t]():null}function $S(e,t){var r=e||lx;return Ny(t,(function(e,t){r+="; "+e+(wy(t)?lx:"="+t)})),r}function YS(e){var t,r=lx;return TS||US(),TS.v&&(t=TS.v[AS]||lx,NS!==t&&(zS=ZS(t),NS=t),r=s_(zS[e]||lx)),r}function XS(e,t){TS||US(),TS.v&&(TS.v[AS]=e+"="+t)}var QS={perfEvtsSendAll:!1};function JS(e){e.h=null;var t=e.cb;e.cb=[],Vv(t,(function(e){yy(e.fn,[e.arg])}))}function eE(e,t,r,n){Vv(e,(function(e){e&&e[t]&&(r?(r.cb[H_]({fn:n,arg:e}),r.h=r.h||I_(JS,0,r)):yy(n,[e]))}))}var tE=function(){function e(t){this.listeners=[];var r,n=[],i={h:null,cb:[]},o=XC(t,QS)[U_]((function(e){r=!!e.cfg.perfEvtsSendAll}));Fw(e,this,(function(e){By(e,"listeners",{g:function(){return n}}),e[Y_]=function(e){n[H_](e)},e[$_]=function(e){for(var t=Gv(n,e);-1<t;)n[V_](t,1),t=Gv(n,e)},e[yx]=function(e){eE(n,yx,i,(function(t){t[yx](e)}))},e[vx]=function(e,t){eE(n,vx,i,(function(r){r[vx](e,t)}))},e[_x]=function(e,t){eE(n,_x,t?i:null,(function(r){r[_x](e,t)}))},e[bx]=function(e){!e||!r&&e[Nb]()||eE(n,bx,null,(function(t){e[_b]?I_((function(){return t[bx](e)}),0):t[bx](e)}))},e[wx]=function(e){e&&e[L_]&&eE(n,wx,i,(function(t){t[wx](e)}))},e[xx]=function(e){e&&e[zb]&&eE(n,xx,i,(function(t){t[xx](e)}))},e[Cx]=function(e,t){var r;0<e&&(r=t||0,eE(n,Cx,i,(function(t){t[Cx](e,r)})))},e[hb]=function(e){function t(){o&&o.rm(),o=null,n=[],i.h&&i.h[K_](),i.h=null,i.cb=[]}var r;if(eE(n,"unload",null,(function(t){(t=t[hb](e))&&(r=r||[])[H_](t)})),r)return ix((function(e){return jw(ox(r),(function(){t(),e()}))}));t()}}))}return e.__ieDyn=1,e}(),rE="ctx",nE="ParentContextKey",iE="ChildrenContextKey",oE=function(){function e(t,r,n){var i,o=this;o.start=t_(),o[nb]=t,o[_b]=n,o[Nb]=function(){return!1},Sy(r)&&By(o,"payload",{g:function(){return!i&&Sy(r)&&(i=r(),r=null),i}}),o[Fb]=function(t){return t?(t===e[nE]||t===e[iE]?o:o[rE]||{})[t]:null},o[Bb]=function(t,r){t&&(t===e[nE]?(o[t]||(o[Nb]=function(){return!0}),o[t]=r):t===e[iE]?o[t]=r:(o[rE]=o[rE]||{})[t]=r)},o[Ub]=function(){var t=0,r=o[Fb](e[iE]);if(Ty(r))for(var n=0;n<r[L_];n++){var i=r[n];i&&(t+=i[ob])}o[ob]=t_()-o.start,o.exTime=o[ob]-t,o[Ub]=function(){}}}return e.ParentContextKey="parent",e.ChildrenContextKey="childEvts",e}(),aE=function(){function e(t){this.ctx={},Fw(e,this,(function(e){e.create=function(e,t,r){return new oE(e,t,r)},e.fire=function(e){e&&(e[Ub](),t)&&Sy(t[bx])&&t[bx](e)},e[Bb]=function(t,r){t&&((e[rE]=e[rE]||{})[t]=r)},e[Fb]=function(t){return(e[rE]||{})[t]}}))}return e.__ieDyn=1,e}(),sE="CoreUtils.doPerf";function lE(e,t,r,n,i){if(e&&(e=e[Sx]?e[Sx]():e)){var o,a=void 0,s=e[Fb](sE);try{if(a=e.create(t(),n,i))return s&&a[Bb]&&(a[Bb](oE[nE],s),s[Fb])&&s[Bb]&&((o=s[Fb](oE[iE]))||(o=[],s[Bb](oE[iE],o)),o[H_](a)),e[Bb](sE,a),r(a)}catch(e){a&&a[Bb]&&a[Bb]("exception",e)}finally{a&&e.fire(a),e[Bb](sE,s)}}return r()}function cE(){for(var e,t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],r=lx,n=0;n<4;n++)r+=t[15&(e=CC())]+t[e>>4&15]+t[e>>8&15]+t[e>>12&15]+t[e>>16&15]+t[e>>20&15]+t[e>>24&15]+t[e>>28&15];var i=t[8+(3&CC())|0];return sv(r,0,8)+sv(r,9,4)+"4"+sv(r,13,3)+i+sv(r,16,3)+sv(r,19,12)}var uE="00",hE="00000000000000000000000000000000",dE="0000000000000000";function pE(e,t,r){return!(!e||e[L_]!==t||e===r||!e.match(/^[\da-f]*$/i))}function fE(e,t,r){return pE(e,t)?e:r}function mE(e,t,r,n){var i={};return i[pb]=pE(n,2,"ff")?n:uE,i[Zb]=gE(e)?e:cE(),i[Wb]=yE(t)?t:lv(cE(),16),i.traceFlags=0<=r&&r<=255?r:1,i}function gE(e){return pE(e,32,hE)}function yE(e){return pE(e,16,dE)}function vE(e){var t,r;return e?(pE(t=function(e){for(var t=(e=isNaN(e)||e<0||255<e?1:e).toString(16);t[L_]<2;)t="0"+t;return t}(e[$b]),2)||(t="01"),r=e[pb]||uE,"".concat((r="00"!==r&&"ff"!==r?uE:r).toLowerCase(),"-").concat(fE(e.traceId,32,hE).toLowerCase(),"-").concat(fE(e.spanId,16,dE).toLowerCase(),"-").concat(t.toLowerCase())):""}var _E=PC("plugin");function bE(e){return _E.get(e,"state",{},!0)}function wE(e,t){for(var r=[],n=null,i=e[Cb]();i;){var o,a,s=i[rb]();s&&(n&&n[Sb]&&s[mx]&&n[Sb](s),a=!!(o=bE(s))[X_],(a=s[X_]?s[X_]():a)||r[H_](s),n=s,i=i[Cb]())}Vv(r,(function(r){var n=e[ux]();r[Z_](e.getCfg(),n,t,e[Cb]()),o=bE(r),r[ux]||o[ux]||(o[ux]=n),o[X_]=!0,delete o[gb]}))}function xE(e){return e.sort((function(e,t){var r,n=0;return t?(r=t[mx],e[mx]?n=r?e[gx]-t[gx]:1:r&&(n=-1)):n=e?1:-1,n}))}var CE,SE="TelemetryPluginChain",EE="_hasRun",TE="_getTelCtx",IE=0;function kE(e,t,r,n){var i=null,o=[],a=(t=t||XC({},null,r[j_]),null!==n&&(i=n?function(e,t,r){for(;e;){if(e[rb]()===r)return e;e=e[Cb]()}return RE([r],t.config||{},t)}(e,r,n):e),{_next:function(){var e,t=i;return i=t?t[Cb]():null,t||(e=o)&&0<e[L_]&&(Vv(e,(function(e){try{e.func.call(e.self,e.args)}catch(e){SS(r[j_],2,73,"Unexpected Exception during onComplete - "+Hy(e))}})),o=[]),t},ctx:{core:function(){return r},diagLog:function(){return _S(r,t.cfg)},getCfg:function(){return t.cfg},getExtCfg:function(e,r){var n=s(e,!0);return r&&Ny(r,(function(e,r){var i;!wy(n[e])||!(i=t.cfg[e])&&wy(i)||(n[e]=i),LC(t,n,e,r)})),t[B_](n,r)},getConfig:function(e,r,n){void 0===n&&(n=!1);e=s(e,!1);var i,o=t.cfg;return!e||!e[r]&&wy(e[r])?!o[r]&&wy(o[r])||(i=o[r]):i=e[r],i||!wy(i)?i:n},hasNext:function(){return!!i},getNext:function(){return i},setNext:function(e){i=e},iterate:function(e){for(;t=a._next();){var t=t[rb]();t&&e(t)}},onComplete:function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];e&&o[H_]({func:e,self:by(t)?a.ctx:t,args:r})}}});function s(e,r){var n,i=null,o=t.cfg;return o&&e&&(n=o[px],o[px]=n=!n&&r?{}:n,n=t.ref(o,px))&&(i=n[e],n[e]=i=!i&&r?{}:i,i=t.ref(n,e)),i}return a}function AE(e,t,r,n){var i=XC(t),o=kE(e,i,r,n),a=o.ctx;return a[ab]=function(e){var t=o._next();return t&&t[mx](e,a),!t},a[mb]=function(e,t){return AE((e=Ty(e=void 0===e?null:e)?RE(e,i.cfg,r,t):e)||a[Cb](),i.cfg,r,t)},a}function PE(e,t,r){var n=XC(t.config),i=kE(e,n,t,r),o=i.ctx;return o[ab]=function(e){var t=i._next();return t&&t[hb](o,e),!t},o[mb]=function(e,r){return PE((e=Ty(e=void 0===e?null:e)?RE(e,n.cfg,t,r):e)||o[Cb](),t,r)},o}function ME(e,t,r){var n=XC(t.config),i=kE(e,n,t,r).ctx;return i[ab]=function(e){return i.iterate((function(t){Sy(t[xb])&&t[xb](i,e)}))},i[mb]=function(e,r){return ME((e=Ty(e=void 0===e?null:e)?RE(e,n.cfg,t,r):e)||i[Cb](),t,r)},i}function RE(e,t,r,n){var i,o=null,a=!n;return Ty(e)&&0<e[L_]&&(i=null,Vv(e,(function(e){(a=!a&&n===e||a)&&e&&Sy(e[mx])&&(e=function(e,t,r){var n=null,i=Sy(e[mx]),o=Sy(e[Sb]),a=e?e[W_]+"-"+e[gx]+"-"+IE++:"Unknown-0-"+IE++,s={getPlugin:function(){return e},getNext:function(){return n},processTelemetry:function(a,c){l(c=c||function(){var n;return e&&Sy(e[TE])&&(n=e[TE]()),n=n||AE(s,t,r)}(),(function(t){var r;return!(!e||!i||(r=bE(e))[gb]||r[dx]||(o&&e[Sb](n),e[mx](a,t),0))}),"processTelemetry",(function(){return{item:a}}),!a.sync)||c[ab](a)},unload:function(t,r){l(t,(function(){var n,i,o=!1;return e&&(n=bE(e),i=e[ux]||n[ux],!e||i&&i!==t.core()||n[gb]||(n[ux]=null,n[gb]=!0,n[X_]=!1,e[gb]&&!0===e[gb](t,r)&&(o=!0))),o}),"unload",(function(){}),r[_b])||t[ab](r)},update:function(t,r){l(t,(function(){var n,i,o=!1;return e&&(n=bE(e),i=e[ux]||n[ux],!e||i&&i!==t.core()||n[gb]||e[xb]&&!0===e[xb](t,r)&&(o=!0)),o}),"update",(function(){}),!1)||t[ab](r)},_id:a,_setNext:function(e){n=e}};function l(t,r,i,o,s){var l=!1,c=e?e[W_]:SE,u=(u=t[EE])||(t[EE]={});return t.setNext(n),e&&lE(t[ux](),(function(){return c+":"+i}),(function(){u[a]=!0;try{var e=n?n._id:lx;e&&(u[e]=!1),l=r(t)}catch(r){(e=!n||u[n._id])&&(l=!0),n&&e||SS(t[bb](),1,73,"Plugin ["+c+"] failed during "+i+" - "+Hy(r)+", run flags: "+Hy(u))}}),o,s),l}return Yy(s)}(e,t,r),o=o||e,i&&i._setNext(e),i=e)}))),n&&!o?RE([n],t,r):o}function OE(){var e=[];return{add:function(t){t&&e[H_](t)},run:function(t,r){Vv(e,(function(e){try{e(t,r)}catch(e){SS(t[bb](),2,73,"Unexpected error calling unload handler - "+Hy(e))}})),e=[]}}}function LE(){var e=[];return{run:function(t){var r=e;e=[],Vv(r,(function(e){try{(e.rm||e.remove).call(e)}catch(e){SS(t,2,73,"Unloading:"+Hy(e))}}))},add:function(t){t&&Hv(e,t)}}}var DE="getPlugin",NE=((CE={})[px]={isVal:Mx,v:{}},CE),zE=function(){function e(){var t,r,n,i,o,a=this;function s(e){var t;return(e=e=void 0===e?null:e)||(t=r||AE(null,{},a[ux]),e=n&&n[DE]?t[mb](null,n[DE]):t[mb](null,n)),e}function l(e,t,i){XC(e,NE,_S(t)),!i&&t&&(i=t[sb]()[Cb]());var o=n;n&&n[DE]&&(o=n[DE]()),a[ux]=t,r=AE(i,e,t,o)}function c(){t=!1,a[ux]=null,n=r=null,o=LE(),i=OE()}c(),Fw(e,a,(function(e){e[Z_]=function(e,r,n,i){l(e,r,i),t=!0},e[gb]=function(t,r){var a,s,l,u,h=e[ux];if(h&&(!t||h===t[ux]()))return s=!1,l=t||PE(null,h,n&&n[DE]?n[DE]():n),u=r||((t={reason:0})[_b]=!1,t),e[wb]&&!0===e[wb](l,u,d)?a=!0:d(),a;function d(){s||(s=!0,i.run(l,r),o.run(l[bb]()),!0===a&&l[ab](u),c())}},e[xb]=function(t,r){var i,o,a,s=e[ux];if(s&&(!t||s===t[ux]()))return o=!1,a=t||ME(null,s,n&&n[DE]?n[DE]():n),e._doUpdate&&!0===e._doUpdate(a,r||{reason:0},c)?i=!0:c(),i;function c(){o||(o=!0,l(a.getCfg(),a.core(),a[Cb]()))}},Bx(e,"_addUnloadCb",(function(){return i}),"add"),Bx(e,"_addHook",(function(){return o}),"add"),By(e,"_unloadHooks",{g:function(){return o}})})),a[bb]=function(e){return s(e)[bb]()},a[X_]=function(){return t},a.setInitialized=function(e){t=e},a[Sb]=function(e){n=e},a[ab]=function(e,t){t?t[ab](e):n&&Sy(n[mx])&&n[mx](e,null)},a._getTelCtx=s}return e.__ieDyn=1,e}();var FE,BE=function(e){function t(){var r,n,i=e.call(this)||this;function o(){r=0,n=[]}return i.identifier="TelemetryInitializerPlugin",i.priority=199,o(),Fw(t,i,(function(e,t){e.addTelemetryInitializer=function(e){return function(e,t,r){var n={id:t,fn:r};return Hv(e,n),{remove:function(){Vv(e,(function(t,r){if(t.id===n.id)return e[V_](r,1),-1}))}}}(n,r++,e)},e[mx]=function(t,r){(function(e,t,r){for(var n=!1,i=e[L_],o=0;o<i;++o){var a=e[o];if(a)try{if(!1===a.fn[q_](null,[t])){n=!0;break}}catch(e){SS(r,2,64,"Telemetry initializer failed: "+Dx(e),{exception:Hy(e)},!0)}}return!n})(n,t,(r||e)[bb]())&&e[ab](t,r)},e[wb]=function(){o()}})),i}return aw(t,e),t.__ieDyn=1,t}(zE),UE="Plugins must provide initialize method",jE="SDK is still unloading...",qE=$y(((FE={cookieCfg:{}})[fx]={rdOnly:!0,ref:!0,v:[]},FE[cx]={rdOnly:!0,ref:!0,v:[]},FE[px]={ref:!0,v:{}},FE[hx]=sx,FE.loggingLevelConsole=0,FE.diagnosticLogInterval=sx,FE));function HE(e,t){return new aE(t)}function VE(e,t){var r=!1;return Vv(t,(function(t){if(t===e)return r=!0,-1})),r}function GE(e,t,r,n){r&&Ny(r,(function(r,i){n&&l_(i)&&l_(t[r])&&GE(e,t[r],i,n),n&&l_(i)&&l_(t[r])?GE(e,t[r],i,n):e.set(t,r,i)}))}function KE(e,t){var r=null,n=-1;return Vv(e,(function(e,i){if(e.w===t)return r=e,n=i,-1})),{i:n,l:r}}function ZE(e,t,r,n){return t.add(e[U_]((function(e){var t=e.cfg.disableDbgExt;!0===t&&n&&(r[$_](n),n=null),r&&!n&&!0!==t&&(n=function(e){if(!sS){sS={};for(var t=0;t<cS[L_];t++)sS[cS[t]]=hS(cS[t],e)}return sS}(e.cfg),r[Y_](n))}))),n}var WE=function(){function e(){var t,r,n,i,o,a,s,l,c,u,h,d,p,f,m,g,y,v,_,b,w,x,C,S,E,T,I,k,A,P,M,R;Fw(e,this,(function(e){function O(){A=!0,wy(w)?(T=M_[J_],SS(n,1,112,"ikey can't be resolved from promises")):T=M_.ACTIVE,L()}function L(){r&&(e.releaseQueue(),e[lb]())}function D(e){return P&&P[cb]||R||(e||n&&0<n.queue[L_])&&(M||(M=!0,W(t[U_]((function(e){var t=((e=e.cfg.diagnosticLogInterval)&&0<e||(e=1e4),!1);P&&(t=P[cb],P[K_]()),(P=function(e,t){return T_(!1,Yg,gy[sy](arguments))}(H,e)).unref(),P[cb]=t})))),P[cb]=!0),P}function N(){function e(e){e&&Vv(e,(function(e){var r;e[W_]&&e[pb]&&!t[e.identifier]&&(r=e[W_]+"="+e[pb],S[H_](r),t[e.identifier]=e)}))}var t={};S=[],e(d),h&&Vv(h,(function(t){e(t)})),e(u)}function z(){r=!1,(t=XC({},qE,e[j_])).cfg[fb]=1,By(e,"config",{g:function(){return t.cfg},s:function(t){e.updateCfg(t,!1)}}),By(e,"pluginVersionStringArr",{g:function(){return S||N(),S}}),By(e,"pluginVersionString",{g:function(){return E||(S||N(),E=S.join(";")),E||lx}}),By(e,"logger",{g:function(){return n||(n=new xS(t.cfg),t[j_]=n),n},s:function(e){t[j_]=e,n!==e&&(JC(n,!1),n=e)}}),e[j_]=new xS(t.cfg),C=[];var _=e.config[fx]||[];_.splice(0,_[L_]),Hv(_,C),f=new BE,JC(o,!(i=[])),s=a=o=null,JC(l,!1),p=!(u=[]),g=AC("AIBaseCore",!(m=d=h=c=l=null)),y=OE(),w=b=null,v=LE(),T=0,k=I=P=S=E=null,A=M=R=!(x=[])}function F(){var r=AE(j(),t.cfg,e);return r[db](D),r}function B(t){var r=function(e,t,r){var n=[],i=[],o={};return Vv(r,(function(r){(wy(r)||wy(r[Z_]))&&Vy(UE);var a=r[gx],s=r[W_];r&&a&&(wy(o[a])?o[a]=s:ES(e,"Two extensions have same priority #"+a+" - "+o[a]+", "+s)),(!a||a<t?n:i)[H_](r)})),(r={})[ux]=n,r[cx]=i,r}(e[j_],500,u),n=(r=(S=E=c=null,d=xE(Hv(d=(h||[])[0]||[],r[cx])),Hv(xE(r[ux]),d)),(n=(C=Yy(r),e.config[fx]||[])).splice(0,n[L_]),Hv(n,C),F());d&&0<d[L_]&&wE(n[mb](d),r),wE(n,r),t&&G(t)}function U(e){var t=null,r=null,n=[];return Vv(C,(function(t){if(t[W_]===e&&t!==f)return r=t,-1;t.getChannel&&n[H_](t)})),!r&&0<n[L_]&&Vv(n,(function(t){if(!(r=t.getChannel(e)))return-1})),r?{plugin:r,setEnabled:function(e){bE(r)[dx]=!e},isEnabled:function(){var e=bE(r);return!e[gb]&&!e[dx]},remove:function(e,t){var n,i=[r];(n={reason:1})[_b]=e=void 0===e||e,q(i,n,(function(e){e&&B({reason:32,removed:i}),t&&t(e)}))}}:t}function j(){var r;return c||(r=(C||[]).slice(),-1===Gv(r,f)&&r[H_](f),c=RE(xE(r),t.cfg,e)),c}function q(r,n,i){var o;r&&0<r[L_]?((o=PE(RE(r,t.cfg,e),e))[db]((function(){var e=!1,t=[],n=(Vv(u,(function(n,i){VE(n,r)?e=!0:t[H_](n)})),u=t,S=E=null,[]);h&&(Vv(h,(function(t,i){var o=[];Vv(t,(function(t){VE(t,r)?e=!0:o[H_](t)})),n[H_](o)})),h=n),i&&i(e),D()})),o[ab](n)):i(!1)}function H(){var t;n&&n.queue&&(t=n.queue.slice(0),n.queue[L_]=0,Vv(t,(function(t){(r={})[nb]=m||"InternalMessageId: "+t[yb],r[ib]=w,r[ob]=Lx(new Date),r.baseType=vS.dataType,r.baseData={message:t[vb]};var r;t=r;e.track(t)})))}function V(e,t,r,n){var i=1,o=!1,a=null;function s(){i--,o&&0===i&&(a&&a[K_](),a=null,t&&t(o),t=null)}return n=n||5e3,d&&0<d[L_]&&F()[mb](d).iterate((function(t){var o;t.flush&&(i++,o=!1,t.flush(e,(function(){o=!0,s()}),r)||o||(e&&null==a?a=I_((function(){a=null,s()}),n):s()))})),o=!0,s(),!0}function G(t){var r=ME(j(),e);r[db](D),e._updateHook&&!0===e._updateHook(r,t)||r[ab](t)}function K(t){var r=e[j_];r?(SS(r,2,73,t),D()):Vy(t)}function Z(t){var r=e[tb]();r&&r[vx]([t],2)}function W(e){v.add(e)}z(),e._getDbgPlgTargets=function(){return[C,i]},e[X_]=function(){return r},e.activeStatus=function(){return T},e._setPendingStatus=function(){T=3},e[Z_]=function(i,l,c,f){p&&Vy(jE),e[X_]()&&Vy("Core cannot be initialized more than once"),t=XC(i,qE,c||e[j_],!1),i=t.cfg,W(t[U_]((function(e){var t,o,a,s,l=e.cfg;3!==T&&(k=l.initInMemoMaxSize||100,o=l[Q_],a=l.endpointUrl,wy(o)?(w=null,T=M_[J_],t="Please provide instrumentation key",r?(SS(n,1,100,t),L()):Vy(t)):(t=[],w=My(o)?(t[H_](o),null):o,I=My(a)?(t[H_](a),null):a,t[L_]?(A=!1,T=3,o=Mx(l.initTimeOut)?l.initTimeOut:5e4,a=ax(t),I_((function(){A||O()}),o),jw(a,(function(e){try{var t,r,n;A||(e.rejected||((t=e[eb])&&t[L_]&&(r=t[0],w=r&&r[eb],1<t[L_])&&(n=t[1],I=n&&n[eb]),w&&(i[Q_]=w,i.endpointUrl=I)),O())}catch(e){A||O()}}))):O(),Ny(s=e.ref(e.cfg,px),(function(t){e.ref(s,t)}))))}))),_=ZE(t,v,(o=f)&&e[tb](),_),W(t[U_]((function(t){var r;t.cfg.enablePerfMgr?(r=t.cfg[hx],m!==r&&(zx(t.cfg,hx,r=r||HE),m=r,s=null),a||s||!Sy(r)||(s=r(e,e[tb]()))):m=s=null}))),e[j_]=c;var m;f=i[fx];(u=[])[H_].apply(u,sw(sw([],l),f)),h=i[cx],B(null),d&&0!==d[L_]||Vy("No "+cx+" available"),h&&1<h[L_]&&((c=e[rb]("TeeChannelController"))&&c.plugin||SS(n,1,28,"TeeChannel required")),function(e,t,r){Vv(t,(function(t){var n=QC(e,t.w,r);delete t.w,t.rm=function(){n.rm()}}))}(i,x,n),r=!(x=null),T===M_.ACTIVE&&L()},e.getChannels=function(){var e=[];return d&&Vv(d,(function(t){e[H_](t)})),Yy(e)},e.track=function(t){lE(e[Sx](),(function(){return"AppInsightsCore:track"}),(function(){null===t&&(Z(t),Vy("Invalid telemetry item")),!t[nb]&&wy(t[nb])&&(Z(t),Vy("telemetry name required")),t[ib]=t[ib]||w,t[ob]=t[ob]||Lx(new Date),t.ver=t.ver||"4.0",!p&&e[X_]()&&T===M_.ACTIVE?F()[ab](t):T!==M_[J_]&&i[L_]<=k&&i[H_](t)}),(function(){return{item:t}}),!t.sync)},e[sb]=F,e[tb]=function(){return o||(o=new tE(t.cfg),e._notificationManager=o),o},e[Y_]=function(t){e.getNotifyMgr()[Y_](t)},e[$_]=function(e){o&&o[$_](e)},e.getCookieMgr=function(){return l=l||GS(t.cfg,e[j_])},e.setCookieMgr=function(e){l!==e&&(JC(l,!1),l=e)},e[Sx]=function(){return a||s||null},e.setPerfMgr=function(e){a=e},e.eventCnt=function(){return i[L_]},e.releaseQueue=function(){var e;r&&0<i[L_]&&(e=i,i=[],2===T?Vv(e,(function(e){e[ib]=e[ib]||w,F()[ab](e)})):SS(n,2,20,"core init status is not active"))},e[lb]=function(e){return m=e||null,R=!1,P&&P[K_](),D(!0)},e[ub]=function(){R=!0,P&&P[K_](),H()},Ux(e,(function(){return f}),["addTelemetryInitializer"]),e[hb]=function(t,i,a){void 0===t&&(t=!0),r||Vy("SDK is not initialized"),p&&Vy(jE),(s={reason:50})[_b]=t,s.flushComplete=!1;var s,c,u=s,h=(t&&!i&&(c=ix((function(e){i=e}))),PE(j(),e));return h[db]((function(){v.run(e[j_]),eS([l,o,n],t,(function(){z(),i&&i(u)}))}),e),H(),V(t,(function(t){u.flushComplete=t,p=!0,y.run(h,u),e[ub](),h[ab](u)}),6,a),c},e[rb]=U,e.addPlugin=function(e,t,r,n){var i,o,a;function s(){u[H_](e),o.added=[e],B(o),n&&n(!0)}e?(i=U(e[W_]))&&!t?(n&&n(!1),K("Plugin ["+e[W_]+"] is already loaded!")):(o={reason:16},i?q(a=[i.plugin],{reason:2,isAsync:!!r},(function(e){e?(o.removed=a,o.reason|=32,s()):n&&n(!1)})):s()):(n&&n(!1),K(UE))},e.updateCfg=function(r,n){var i,o;void 0===n&&(n=!0),e[X_]()&&(i={reason:1,cfg:t.cfg,oldCfg:m_({},t.cfg),newConfig:m_({},r),merge:n},r=i.newConfig,o=t.cfg,r[fx]=o[fx],r[cx]=o[cx]),t._block((function(e){var t=e.cfg;GE(e,t,r,n),n||Ny(t,(function(n){Dy(r,n)||e.set(t,n,sx)})),e[B_](t,qE)}),!0),t[N_](),i&&G(i)},e.evtNamespace=function(){return g},e.flush=V,e.getTraceCtx=function(e){return b=b||function(e){var t={};return{getName:function(){return t[nb]},setName:function(r){e&&e.setName(r),t[nb]=r},getTraceId:function(){return t[Zb]},setTraceId:function(r){e&&e.setTraceId(r),gE(r)&&(t[Zb]=r)},getSpanId:function(){return t[Wb]},setSpanId:function(r){e&&e.setSpanId(r),yE(r)&&(t[Wb]=r)},getTraceFlags:function(){return t[$b]},setTraceFlags:function(r){e&&e.setTraceFlags(r),t[$b]=r}}}()},e.setTraceCtx=function(e){b=e||null},e.addUnloadHook=W,Bx(e,"addUnloadCb",(function(){return y}),"add"),e.onCfgChange=function(n){return n=r?QC(t.cfg,n,e[j_]):function(e,t){var r=KE(e,t).l;return r||e[H_](r={w:t,rm:function(){var r=KE(e,t);-1!==r.i&&e[V_](r.i,1)}}),r}(x,n),function(e){return By({rm:function(){e.rm()}},"toJSON",{v:function(){return"aicore::onCfgChange<"+JSON.stringify(e)+">"}})}(n)},e.getWParam=function(){return xv()||t.cfg.enableWParam?0:-1}}))}return e.__ieDyn=1,e}();function $E(e,t){try{if(e&&""!==e){var r=lC().parse(e);if(r&&r[jb]&&r[jb]>=r.itemsAccepted&&r.itemsReceived-r.itemsAccepted===r.errors[L_])return r}}catch(r){SS(t,1,43,"Cannot parse the response. "+(r[nb]||Hy(r)),{response:e})}return null}var YE="",XE="&NoResponseBody=true",QE="POST",JE=function(){function e(){var t,r,n,i,o,a,s,l,c,u,h,d,p,f=0;Fw(e,this,(function(e,m){var g=!0;function y(e,t){SS(n,2,26,"Failed to send telemetry.",{message:e}),_(t,400,{})}function v(e){y("No endpoint url is provided for the batch",e)}function _(e,t,r,n){try{e&&e(t,r,n)}catch(e){}}function b(e,t){var r,n=Tv();return(r=e[qb])?(r=e[qb]+(d?XE:YE),e=e[zb],e=i?e:new Blob([e],{type:"text/plain;charset=UTF-8"}),n.sendBeacon(r,e)):(v(t),!0)}function w(e,t,r){var a,l=e[zb];try{l&&(b(e,t)?_(t,200,{},YE):(a=o&&o.beaconOnRetry)&&Sy(a)?a(e,t,b):(s&&s[Hb](e,t,!0),SS(n,2,40,". Failed to send telemetry with Beacon API, retried with normal sender.")))}catch(e){i&&ES(n,"Failed to send telemetry using sendBeacon API. Ex:"+Hy(e)),_(t,i?0:400,{},YE)}}function x(e,r,n){var a,s,l,c,u=e[Vb]||{},h=(!n&&t&&(a=ix((function(e,t){s=e,l=t}))),i&&n&&e.disableXhrSync&&(n=!1),e[qb]);if(h)return c=function(e,t,r,n,i,o){function a(e,t,r){try{e[t]=r}catch(e){}}void 0===n&&(n=!1),void 0===i&&(i=!1);var s=new XMLHttpRequest;return n&&a(s,"Microsoft_ApplicationInsights_BypassAjaxInstrumentation",n),r&&a(s,Wx,r),s.open(e,t,!i),r&&a(s,Wx,r),!i&&o&&a(s,"timeout",o),s}(QE,h,g,!0,n,e[Gb]),i||c[Kb]("Content-type","application/json"),Vv(Wy(u),(function(e){c[Kb](e,u[e])})),c.onreadystatechange=function(){i||(d(c),4===c.readyState&&s&&s(!0))},c.onload=function(){i&&d(c)},c.onerror=function(e){_(r,i?c[Ob]:400,Yx(c,i),i?YE:Kx(c)),l&&l(e)},c.ontimeout=function(){_(r,i?c[Ob]:500,Yx(c,i),i?YE:Kx(c)),s&&s(!1)},c.send(e[zb]),a;function d(t){var n=o&&o.xhrOnComplete;n&&Sy(n)?n(t,r,e):(n=Vx(t),_(r,t[Ob],Yx(t,i),n))}v(r),s&&s(!1)}function C(e,r,n){var a,s,l,c=e[qb],u=e[zb],h=i?u:new Blob([u],{type:"application/json"}),m=new Headers,y=u[L_],b=(u=!1,!1),w=e[Vb]||{},x=((h={method:QE,body:h})[tS]=!0,e.headers&&0<Wy(e.headers)[L_]&&(Vv(Wy(w),(function(e){m.append(e,w[e])})),h[Vb]=m),g&&i&&(h.credentials="include"),n&&(h.keepalive=!0,f+=y,i?2===e._sendReason&&(u=!0,d)&&(c+=XE):u=!0),new Request(c,h));try{x[tS]=!0}catch(a){}if(!n&&t&&(a=ix((function(e,t){s=e,l=t}))),c){try{jw(fetch(i?c:x,i?h:null),(function(t){if(n&&(f-=y,y=0),!b)if(b=!0,t.rejected)C(t.reason&&t.reason[vb]),l&&l(t.reason);else{var r=t[eb];try{i||r.ok?i&&!r.body?(S(r,null,YE),s&&s(!0)):jw(r.text(),(function(t){S(r,e,t[eb]),s&&s(!0)})):(C(r.statusText),s&&s(!1))}catch(t){C(Hy(t)),l&&l(t)}}}))}catch(a){b||(C(Hy(a)),l&&l(a))}return u&&!b&&(b=!0,_(r,200,{}),s)&&s(!0),i&&!b&&0<e[Gb]&&p&&p.set((function(){b||(b=!0,_(r,500,{}),s&&s(!0))}),e[Gb]),a}function C(e){_(r,i?0:400,{},i?YE:e)}function S(e,t,n){var i=e[Ob],a=o.fetchOnComplete;a&&Sy(a)?a(e,r,n||YE,t):_(r,i,{},n||YE)}v(r),s&&s(!1)}function S(e,t,r){var a=Ev(),s=new XDomainRequest,l=e[zb],c=(a=(s.onload=function(){var r=Vx(s),n=o&&o.xdrOnComplete;n&&Sy(n)?n(s,t,e):_(t,200,{},r)},s.onerror=function(){_(t,400,{},i?YE:Gx(s))},s.ontimeout=function(){_(t,500,{})},s.onprogress=function(){},a&&a.location&&a.location[Eb]||""),e[qb]);c?i||0===c.lastIndexOf(a,0)?(a=i?c:c[Ab](/^(https?:)/,""),s.open(QE,a),e[Gb]&&(s[Gb]=e[Gb]),s.send(l),i&&r?p&&p.set((function(){s.send(l)}),0):s.send(l)):(SS(n,2,40,". "+(c="Cannot send XDomain request. The endpoint URL protocol doesn't match the hosting page protocol.")),y(c,t)):v(t)}function E(){f=0,d=h=u=c=l=t=r=!1,p=s=a=o=i=n=null}E(),e[Z_]=function(t,i){n=i,r&&SS(n,1,28,"Sender is already initialized"),e.SetConfig(t),r=!0},e._getDbgPlgTargets=function(){return[r,i,a,t]},e.SetConfig=function(e){try{var r;return o=e.senderOnCompleteCallBack||{},a=!!e.disableCredentials,i=!!e.isOneDs,t=!!e.enableSendPromise,l=!!e.disableXhr,c=!!e.disableBeacon,u=!!e.disableBeaconSync,p=e.timeWrapper,d=!!e.addNoResponse,h=!!e.disableFetchKeepAlive,s={sendPOST:x},i||(g=!1),a&&(r=aC())&&r.protocol&&"file:"===r.protocol[R_]()&&(g=!1),!0}catch(e){}return!1},e.getSyncFetchPayload=function(){return f},e.getSenderInst=function(e,t){if(e&&e[L_]){for(var r=e,n=t,i=0,o=null,a=0;null==o&&a<r[L_];)i=r[a],l||1!==i?2!==i||!dC(n)||n&&h?3!==i||!hC()||(n?u:c)||(o=w):o=C:(nC=null===nC&&(nC=typeof XDomainRequest!==Jb)&&pC()?nC&&!oC(wv(eC),"withCredentials"):nC)?o=S:pC()&&(o=x),a++;return o?((e={_transport:i,_isSync:n})[Hb]=o,e):null}return null},e.getFallbackInst=function(){return s},e[wb]=function(e,t){E()}}))}return e.__ieDyn=1,e}(),eT="attachEvent",tT="addEventListener",rT="detachEvent",nT="removeEventListener",iT="events",oT="visibilitychange",aT="pagehide",sT="unload",lT="beforeunload",cT=AC("aiEvtPageHide"),uT=(AC("aiEvtPageShow"),/\.[\.]+/g),hT=/[\.]+$/,dT=1,pT=PC("events"),fT=/^([^.]*)(?:\.(.+)|)/;function mT(e){return e&&e[Ab]?e[Ab](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,lx):e}function gT(e,t){t&&(r=lx,Ty(t)?(r=lx,Vv(t,(function(e){(e=mT(e))&&("."!==e[0]&&(e="."+e),r+=e)}))):r=mT(t),r)&&("."!==r[0]&&(r="."+r),e=(e||lx)+r);var r;t=fT.exec(e||lx)||[];return(e={})[Mb]=t[1],e.ns=(t[2]||lx).replace(uT,".").replace(hT,lx)[Ib](".").sort().join("."),e}function yT(e,t,r){return(e=pT.get(e,iT,{},r=void 0===r||r))[t]||(e[t]=[])}function vT(e,t,r,n){e&&t&&t[Mb]&&(e[nT]?e[nT](t[Mb],r,n):e[rT]&&e[rT]("on"+t[Mb],r))}function _T(e,t,r,n){for(var i=t[L_];i--;){var o=t[i];!o||r.ns&&r.ns!==o.evtName.ns||n&&!n(o)||(vT(e,o.evtName,o[Rb],o.capture),t[V_](i,1))}}function bT(e,t){var r=t?gT("xx",r=Ty(t)?[e].concat(t):[e,t]).ns[Ib]("."):e;return r}function wT(e,t,r,n,i){void 0===i&&(i=!1);var o,a=!1;if(e)try{var s,l=gT(t,n);(a=function(e,t,r,n){var i=!1;return e&&t&&t[Mb]&&r&&(e[tT]?(e[tT](t[Mb],r,n),i=!0):e[eT]&&(e[eT]("on"+t[Mb],r),i=!0)),i}(e,l,r,i))&&pT.accept(e)&&((o={guid:dT++,evtName:l})[Rb]=r,o.capture=i,s=o,yT(e,l.type)[H_](s))}catch(e){}return a}function xT(e,t,r,n,i){if(void 0===i&&(i=!1),e)try{var o=gT(t,n),a=!1;(function(e,t,r){var n;t[Mb]?_T(e,yT(e,t[Mb]),t,r):(Ny(n=pT.get(e,iT,{}),(function(n,i){_T(e,i,t,r)})),0===Wy(n)[L_]&&pT.kill(e,iT))})(e,o,(function(e){return!((!o.ns||r)&&e[Rb]!==r)&&(a=!0)})),a||vT(e,o,r,i)}catch(e){}}function CT(e,t,r,n){var i=!1;return t&&e&&0<e[L_]&&Vv(e,(function(e){!e||r&&-1!==Gv(r,e)||(i=function(e,t,r){var n,i=!1;return(n=Ev())&&(i=wT(n,e,t,r),i=wT(n.body,e,t,r)||i),(n=Cv())&&wT(n,e,t,r)||i}(e,t,n)||i)})),i}function ST(e,t,r){e&&Ty(e)&&Vv(e,(function(e){e&&function(e,t,r){var n;(n=Ev())&&(xT(n,e,t,r),xT(n.body,e,t,r)),(n=Cv())&&xT(n,e,t,r)}(e,t,r)}))}function ET(e,t,r){return function(e,t,r,n){var i=!1;return t&&e&&Ty(e)&&!(i=CT(e,t,r,n))&&r&&0<r[L_]?CT(e,t,null,n):i}([lT,sT,aT],e,t,r)}function TT(e,t,r){var n=bT(cT,r),i=CT([aT],e,t,n);return!(i=t&&-1!==Gv(t,oT)?i:CT([oT],(function(t){var r=Cv();e&&r&&"hidden"===r.visibilityState&&e(t)}),t,n)||i)&&t?TT(e,null,r):i}var IT="_aiHooks",kT=["req","rsp","hkErr","fnErr"];function AT(e,t){if(e)for(var r=0;r<e[L_]&&!t(e[r],r);r++);}function PT(e,t,r,n,i){0<=i&&i<=2&&AT(e,(function(e,o){var a=(e=e.cbks)[kT[i]];if(a){t.ctx=function(){return n[o]=n[o]||{}};try{a[q_](t.inst,r)}catch(o){a=t.err;try{var s=e[kT[2]];s&&(t.err=o,s[q_](t.inst,r))}catch(o){}finally{t.err=a}}}}))}function MT(e,t,r,n){var i=null;return e&&(Ly(e,t)?i=e:r&&(i=MT(Px(e),t,n,!1))),i}function RT(e,t,r,n){var i,o=r&&r[IT];o||((i=o={i:0,n:t,f:r,h:[]},r=function(){var e=arguments,t=i.h,r=((n={})[nb]=i.n,n.inst=this,n.ctx=null,n.set=function(t,n){(e=a([],e))[t]=n,o=a([r],e)},n),n=[],o=a([r],e);function a(e,t){return AT(t,(function(t){e[H_](t)})),e}r.evt=wv("event"),PT(t,r,o,n,0);var s=i.f;if(s)try{r.rslt=s[q_](this,e)}catch(s){throw r.err=s,PT(t,r,o,n,3),s}return PT(t,r,o,n,1),r.rslt})[IT]=o,e[t]=r),e={id:o.i,cbks:n,rm:function(){var e=this.id;AT(o.h,(function(t,r){if(t.id===e)return o.h[V_](r,1),1}))}};return o.i++,o.h[H_](e),e}function OT(e,t,r,n,i){return void 0===n&&(n=!0),e&&t&&r&&(e=MT(e,t,n,i))&&typeof(n=e[t])===Xb?RT(e,t,n,r):null}function LT(e,t,r,n,i){return e&&t&&r&&(n=MT(e,t,n,i)||e)?RT(n,t,n[t],r):null}var DT="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",NT="sampleRate",zT="ProcessLegacy",FT="http.method",BT="https://dc.services.visualstudio.com",UT="/v2/track",jT="not_specified",qT="iKey",HT=P_({requestContextHeader:[0,"Request-Context"],requestContextTargetKey:[1,"appId"],requestContextAppIdFormat:[2,"appId=cid-v1:"],requestIdHeader:[3,"Request-Id"],traceParentHeader:[4,"traceparent"],traceStateHeader:[5,"tracestate"],sdkContextHeader:[6,"Sdk-Context"],sdkContextHeaderAppIdRequest:[7,"appId"],requestContextHeaderLowerCase:[8,"request-context"]}),VT="split",GT="length",KT="toLowerCase",ZT="ingestionendpoint",WT="toString",$T="push",YT="removeItem",XT="name",QT="message",JT="count",eI="preTriggerDate",tI="disabled",rI="interval",nI="daysOfMonth",iI="date",oI="getUTCDate",aI="stringify",sI="pathname",lI="correlationHeaderExcludePatterns",cI="exceptions",uI="parsedStack",hI="properties",dI="measurements",pI="sizeInBytes",fI="typeName",mI="severityLevel",gI="problemGroup",yI="isManual",vI="CreateFromInterface",_I="assembly",bI="fileName",wI="hasFullStack",xI="level",CI="method",SI="line",EI="duration",TI="receivedResponse";function II(e,t,r){var n=t[GT],i=function(e,t){var r;return t&&150<(t=s_(qy(t)))[GT]&&(r=av(t,0,150),SS(e,2,57,"name is too long.  It has been truncated to 150 characters.",{name:t},!0)),r||t}(e,t);if(i[GT]!==n){for(var o=0,a=i;void 0!==r[a];)o++,a=av(i,0,147)+LI(o);i=a}return i}function kI(e,t,r){var n;return void 0===r&&(r=1024),t&&(r=r||1024,(t=s_(qy(t)))[GT]>r)&&(n=av(t,0,r),SS(e,2,61,"string value is too long. It has been truncated to "+r+" characters.",{value:t},!0)),n||t}function AI(e,t){return OI(e,t,2048,66)}function PI(e,t){var r;return t&&32768<t[GT]&&(r=av(t,0,32768),SS(e,2,56,"message is too long, it has been truncated to 32768 characters.",{message:t},!0)),r||t}function MI(e,t){var r;return t&&(r={},Ny(t,(function(t,n){if(Ey(n)&&sC())try{n=lC()[aI](n)}catch(t){SS(e,2,49,"custom property is not valid",{exception:t},!0)}n=kI(e,n,8192),t=II(e,t,r),r[t]=n})),t=r),t}function RI(e,t){var r;return t&&(r={},Ny(t,(function(t,n){t=II(e,t,r),r[t]=n})),t=r),t}function OI(e,t,r,n){var i;return t&&(t=s_(qy(t)))[GT]>r&&(i=av(t,0,r),SS(e,2,n,"input is too long, it has been truncated to "+r+" characters.",{data:t},!0)),i||t}function LI(e){return sv(e="00"+e,e[GT]-3)}var DI=Cv()||{},NI=0,zI=[null,null,null,null,null];function FI(e){var t=NI,r=zI,n=r[t];return DI.createElement?r[t]||(n=r[t]=DI.createElement("a")):n={host:BI(e,!0)},n.href=e,++t>=r[GT]&&(t=0),NI=t,n}function BI(e,t){return(e=UI(e,t)||"")&&null!=(t=e.match(/(www\d{0,5}\.)?([^\/:]{1,256})(:\d{1,20})?/i))&&3<t[GT]&&Cy(t[2])&&0<t[2][GT]?t[2]+(t[3]||""):e}function UI(e,t){var r=null;return e&&null!=(e=e.match(/(\w{1,150}):\/\/([^\/:]{1,256})(:\d{1,20})?/i))&&2<e[GT]&&Cy(e[2])&&0<e[2][GT]&&(r=e[2]||"",t)&&2<e[GT]&&(t=(e[1]||"")[KT](),e=e[3]||"",r+=e="http"===t&&":80"===e||"https"===t&&":443"===e?"":e),r}var jI=[BT+UT,"https://breeze.aimon.applicationinsights.io"+UT,"https://dc-int.services.visualstudio.com"+UT];function qI(e){return-1!==Gv(jI,e[KT]())}function HI(e,t,r){if(!t||e&&e.disableCorrelationHeaders)return!1;if(e&&e[lI])for(var n=0;n<e.correlationHeaderExcludePatterns[GT];n++)if(e[lI][n].test(t))return!1;var i,o=FI(t).host[KT]();if(!o||-1===x_(o,":443")&&-1===x_(o,":80")||(o=(UI(t,!0)||"")[KT]()),(!e||!e.enableCorsCorrelation)&&o&&o!==r)return!1;if((r=e&&e.correlationHeaderDomains)&&(Vv(r,(function(e){e=new RegExp(e.toLowerCase().replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*")),i=i||e.test(o)})),!i))return!1;var a=e&&e.correlationHeaderExcludedDomains;if(!a||0===a[GT])return!0;for(n=0;n<a[GT];n++)if(new RegExp(a[n].toLowerCase().replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*")).test(o))return!1;return o&&0<o[GT]}function VI(e){if(e&&(e=function(e,t){if(e)for(var r=e[VT](","),n=0;n<r[GT];++n){var i=r[n][VT]("=");if(2===i[GT]&&i[0]===t)return i[1]}}(e,HT[1]),e&&"cid-v1:"!==e))return e}function GI(){var e=v_();return e&&e.now&&e.timing&&0<(e=e.now()+e.timing.navigationStart)?e:t_()}function KI(e,t){var r=null;return 0===e||0===t||wy(e)||wy(t)?r:t-e}function ZI(e,t){var r=e||{};return{getName:function(){return r[XT]},setName:function(e){t&&t.setName(e),r[XT]=e},getTraceId:function(){return r.traceID},setTraceId:function(e){t&&t.setTraceId(e),gE(e)&&(r.traceID=e)},getSpanId:function(){return r.parentID},setSpanId:function(e){t&&t.setSpanId(e),yE(e)&&(r.parentID=e)},getTraceFlags:function(){return r.traceFlags},setTraceFlags:function(e){t&&t.setTraceFlags(e),r.traceFlags=e}}}var WI=A_({LocalStorage:0,SessionStorage:1}),$I=void 0,YI=void 0,XI="";function QI(){return ik()?JI(WI.LocalStorage):null}function JI(e){try{if(wy(bv()))return null;var t=(new Date)[WT](),r=wv(e===WI.LocalStorage?"localStorage":"sessionStorage"),n=XI+t,i=(r.setItem(n,t),r.getItem(n)!==t);if(r[YT](n),!i)return r}catch(e){}return null}function ek(){return sk()?JI(WI.SessionStorage):null}function tk(){YI=$I=!1}function rk(e){XI=e||""}function nk(){$I=ik(!0),YI=sk(!0)}function ik(e){return $I=e||void 0===$I?!!JI(WI.LocalStorage):$I}function ok(e,t){var r=QI();if(null!==r)try{return r.getItem(t)}catch(t){$I=!1,SS(e,2,1,"Browser failed read of local storage. "+Dx(t),{exception:Hy(t)})}return null}function ak(e,t,r){var n=QI();if(null!==n)try{return n.setItem(t,r),!0}catch(t){$I=!1,SS(e,2,3,"Browser failed write to local storage. "+Dx(t),{exception:Hy(t)})}return!1}function sk(e){return YI=e||void 0===YI?!!JI(WI.SessionStorage):YI}function lk(e,t){var r=ek();if(null!==r)try{return r.getItem(t)}catch(t){YI=!1,SS(e,2,2,"Browser failed read of session storage. "+Dx(t),{exception:Hy(t)})}return null}function ck(e,t,r){var n=ek();if(null!==n)try{return n.setItem(t,r),!0}catch(t){YI=!1,SS(e,2,4,"Browser failed write to session storage. "+Dx(t),{exception:Hy(t)})}return!1}function uk(e,t){var r=ek();if(null!==r)try{return r[YT](t),!0}catch(t){YI=!1,SS(e,2,6,"Browser failed removal of session storage item. "+Dx(t),{exception:Hy(t)})}return!1}var hk=function(e,t){var r,n,i,o,a,s,l,c=this,u=!1,h=!1;function d(e,t,i,o){if(u){if(!function(e){try{var t=p(e);return function(e){return 0<e?Math.floor(CC()/gC*(e+1))>>>0:0}(1e6)<=t.limit.samplingRate}catch(e){}return!1}(e))return;var s=p(e),l=b(e),c=m(s,r,l),h=!1,d=0,f=w(e);try{c&&!f?(d=Math.min(s.limit.maxSendNumber,l[JT]+1),h=!(l[JT]=0),a[e]=!0,l[eI]=new Date):(a[e]=c,l[JT]+=1);var y=g(e);v(n,y,l);for(var _=0;_<d;_++)SS(n,i||1,e,t)}catch(e){}return{isThrottled:h,throttleNum:d}}return o&&x(e)[$T]({msgID:e,message:t,severity:i}),null}function p(e){return i[e]||i[109]}function f(e,t){var r,n;try{var o=t||{},a={},s=(a[tI]=!!o[tI],o[rI]||{}),l=(h=(null===s?void 0:s.daysOfMonth)&&0<(null===s?void 0:s.daysOfMonth[GT]),a[rI]=function(e){var t=null==(e=e||{})?void 0:e.monthInterval,r=null==e?void 0:e.dayInterval;return wy(t)&&wy(r)&&(e.monthInterval=3,h||(e[nI]=[28],h=!0)),{monthInterval:null==e?void 0:e.monthInterval,dayInterval:null==e?void 0:e.dayInterval,daysOfMonth:null==e?void 0:e.daysOfMonth}}(s),{samplingRate:(null==(r=o.limit)?void 0:r.samplingRate)||100,maxSendNumber:(null==(n=o.limit)?void 0:n.maxSendNumber)||1});a.limit=l,i[e]=a}catch(e){}}function m(e,t,r){var n,i;return!(!e||e[tI]||!t||!Mx(r))&&(t=y(),r=r[iI],n=1,null!=(e=e[rI])&&e.monthInterval&&(i=12*(t.getUTCFullYear()-r.getUTCFullYear())+t.getUTCMonth()-r.getUTCMonth(),n=_(e.monthInterval,0,i)),i=1,h?i=Gv(e[nI],t[oI]()):null!=e&&e.dayInterval&&(t=Math.floor((t.getTime()-r.getTime())/864e5),i=_(e.dayInterval,0,t)),0<=n)&&0<=i}function g(e,t){return t=Mx(t)?t:"",e?"appInsightsThrottle"+t+"-"+e:null}function y(e){try{if(!e)return new Date;var t=new Date(e);if(!isNaN(t.getDate()))return t}catch(e){}return null}function v(e,t,r){try{return ak(e,t,s_(JSON[aI](r)))}catch(e){}}function _(e,t,r){return e<=0?1:t<=r&&(r-t)%e==0?Math.floor((r-t)/e)+1:-1}function b(e){try{var t,r=o[e];return r||(t=g(e,s),r=function(e,t,r){try{var n,i={date:y(),count:0};return e?{date:y((n=JSON.parse(e))[iI])||i[iI],count:n[JT]||i[JT],preTriggerDate:n.preTriggerDate?y(n[eI]):void 0}:(v(t,r,i),i)}catch(e){}return null}(ok(n,t),n,t),o[e]=r),o[e]}catch(e){}return null}function w(e){var t,r=a[e];return wy(r)&&(r=!1,(t=b(e))&&(r=function(e){try{var t;if(e)return t=new Date,e.getUTCFullYear()===t.getUTCFullYear()&&e.getUTCMonth()===t.getUTCMonth()&&e[oI]()===t[oI]()}catch(e){}return!1}(t[eI])),a[e]=r),a[e]}function x(e){return wy((l=l||{})[e])&&(l[e]=[]),l[e]}n=_S(e),a={},o={},l={},i={},f(109),s=Mx(t)?t:"",e.addUnloadHook(QC(e.config,(function(e){e=e.cfg,r=ik(),Ny(e.throttleMgrCfg||{},(function(e,t){f(parseInt(e),t)}))}))),c._getDbgPlgTargets=function(){return[l]},c.getConfig=function(){return i},c.canThrottle=function(e){var t=b(e);return m(p(e),r,t)},c.isTriggered=w,c.isReady=function(){return u},c.flush=function(e){try{var t,r=x(e);if(r&&0<r[GT])return t=r.slice(0),l[e]=[],Vv(t,(function(e){d(e.msgID,e[QT],e.severity,!1)})),!0}catch(e){}return!1},c.flushAll=function(){try{var t;if(l)return t=!0,Ny(l,(function(e){e=c.flush(parseInt(e)),t=t&&e})),t}catch(e){}return!1},c.onReadyState=function(e,t){return void 0===t&&(t=!0),(u=!!wy(e)||e)&&t?c.flushAll():null},c.sendMessage=function(e,t,r){return d(e,t,r,!0)}};function dk(e){var t;return e?(e=e[VT](";"),e=Yv(e,(function(e,t){var r;return 2===(t=t[VT]("="))[GT]&&(r=t[0][KT](),t=t[1],e[r]=t),e}),{}),0<Wy(e)[GT]&&(e.endpointsuffix&&(t=e.location?e.location+".":"",e[ZT]=e[ZT]||"https://"+t+"dc."+e.endpointsuffix),e[ZT]=e[ZT]||BT,w_(e[ZT],"/"))&&(e[ZT]=e[ZT].slice(0,-1)),e):{}}var pk=function(e,t,r){var n=this;this.ver=1,this.sampleRate=100,this.tags={},this[XT]=kI(e,r)||jT,this.data=t,this.time=Lx(new Date),this.aiDataContract={time:1,iKey:1,name:1,sampleRate:function(){return 100===n.sampleRate?4:1},tags:1,data:1}},fk=function(){function e(e,t,r,n){this.aiDataContract={ver:1,name:1,properties:0,measurements:0},this.ver=2,this[XT]=kI(e,t)||jT,this[hI]=MI(e,r),this[dI]=RI(e,n)}return e.envelopeType="Microsoft.ApplicationInsights.{0}.Event",e.dataType="EventData",e}(),mk="error",gk="stack",yk="stackDetails",vk="errorSrc",_k="message",bk="description";function wk(e,t){var r=e;return r&&!Cy(r)&&(JSON&&JSON[aI]?(r=JSON[aI](e),!t||r&&"{}"!==r||(r=Sy(e[WT])?e[WT]():""+e)):r=e+" - (Missing JSON.stringify)"),r||""}function xk(e,t){var r=e;return e&&((r=r&&!Cy(r)&&(e[_k]||e[bk])||r)&&!Cy(r)&&(r=wk(r,!0)),e.filename)&&(r=r+" @"+(e.filename||"")+":"+(e.lineno||"?")+":"+(e.colno||"?")),(r=t&&"String"!==t&&"Object"!==t&&"Error"!==t&&-1===x_(r||"",t)?t+": "+r:r)||""}function Ck(e){return e&&e.src&&Cy(e.src)&&e.obj&&Ty(e.obj)}function Sk(e){var t=(e=Cy(e=e||"")?e:Cy(e[gk])?e[gk]:""+e)[VT]("\n");return{src:e,obj:t}}function Ek(e){var t,r=null;if(e)try{e[gk]?r=Sk(e[gk]):e[mk]&&e[mk][gk]?r=Sk(e[mk][gk]):e.exception&&e.exception[gk]?r=Sk(e.exception[gk]):Ck(e)?r=e:Ck(e[yk])?r=e[yk]:Ev()&&Ev().opera&&e[_k]?r=function(e){for(var t=[],r=e[VT]("\n"),n=0;n<r[GT];n++){var i=r[n];r[n+1]&&(i+="@"+r[n+1],n++),t[$T](i)}return{src:e,obj:t}}(e[QT]):e.reason&&e.reason[gk]?r=Sk(e.reason[gk]):Cy(e)?r=Sk(e):(t=e[_k]||e[bk]||"",Cy(e[vk])&&(t&&(t+="\n"),t+=" from "+e[vk]),t&&(r=Sk(t)))}catch(e){r=Sk(e)}return r||{src:"",obj:null}}function Tk(e){var t="";if(e&&!(t=e.typeName||e[XT]||""))try{var r=/function (.{1,200})\(/.exec(e.constructor[WT]());t=r&&1<r[GT]?r[1]:""}catch(e){}return t}function Ik(e){if(e)try{var t,r;if(!Cy(e))return t=Tk(e),(r=wk(e,!1))&&"{}"!==r||(e[mk]&&(t=Tk(e=e[mk])),r=wk(e,!0)),0!==x_(r,t)&&"String"!==t?t+":"+r:r}catch(e){}return""+(e||"")}var kk=function(){function e(e,t,r,n,i,o){this.aiDataContract={ver:1,exceptions:1,severityLevel:0,properties:0,measurements:0};var a=this;a.ver=2,function(e){try{if(Ey(e))return"ver"in e&&"exceptions"in e&&"properties"in e}catch(e){}return!1}(t)?(a[cI]=t[cI]||[],a[hI]=t[hI],a[dI]=t[dI],t[mI]&&(a[mI]=t[mI]),t.id&&(a.id=t.id,t[hI].id=t.id),t[gI]&&(a[gI]=t[gI]),wy(t[yI])||(a[yI]=t[yI])):(r=r||{},o&&(r.id=o),a[cI]=[new Ak(e,t,r)],a[hI]=MI(e,r),a[dI]=RI(e,n),i&&(a[mI]=i),o&&(a.id=o))}return e.CreateAutoException=function(e,t,r,n,i,o,a,s){var l=Tk(i||o||e),c={};return c[QT]=xk(e,l),c.url=t,c.lineNumber=r,c.columnNumber=n,c.error=Ik(i||o||e),c.evt=Ik(o||e),c[fI]=l,c.stackDetails=Ek(a||i||o),c.errorSrc=s,c},e.CreateFromInterface=function(t,r,n,i){var o=r[cI]&&Kv(r[cI],(function(e){return Ak[vI](t,e)}));return new e(t,iw(iw({},r),{exceptions:o}),n,i)},e.prototype.toInterface=function(){var e=this.exceptions,t=this.properties,r=this.measurements,n=this.severityLevel,i=this.problemGroup,o=this.id,a=this.isManual,s=(e=e instanceof Array&&Kv(e,(function(e){return e.toInterface()}))||void 0,{ver:"4.0"});return s[cI]=e,s.severityLevel=n,s.properties=t,s.measurements=r,s.problemGroup=i,s.id=o,s.isManual=a,s},e.CreateSimpleException=function(e,t,r,n,i,o){var a;return{exceptions:[((a={})[wI]=!0,a.message=e,a.stack=i,a.typeName=t,a)]}},e.envelopeType="Microsoft.ApplicationInsights.{0}.Exception",e.dataType="ExceptionData",e.formatError=Ik,e}(),Ak=function(){function e(e,t,r){this.aiDataContract={id:0,outerId:0,typeName:1,message:1,hasFullStack:0,stack:0,parsedStack:2};var n,i,o=this;!function(e){try{if(Ey(e))return"hasFullStack"in e&&"typeName"in e}catch(e){}return!1}(t)?(i=(n=t)&&n.evt,Py(n)||(n=n[mk]||i||n),o[fI]=kI(e,Tk(n))||jT,o[QT]=PI(e,xk(t||n,o[fI]))||jT,i=t[yk]||Ek(t),o[uI]=function(e){if((e=e.obj)&&0<e[GT]){var t=[],r=0,n=0;if(Vv(e,(function(e){e=e[WT](),Pk.regex.test(e)&&(e=new Pk(e,r++),n+=e[pI],t[$T](e))})),32768<n)for(var i=0,o=t[GT]-1,a=0,s=i,l=o;i<o;){if(32768<(a+=t[i][pI]+t[o][pI])){t.splice(s,l-s+1);break}s=i,l=o,i++,o--}}return t}(i),Ty(o[uI])&&Kv(o[uI],(function(t){t[_I]=kI(e,t[_I]),t[bI]=kI(e,t[bI])})),o[gk]=function(e,t){var r,n;return t&&32768<(n=""+t)[GT]&&(r=av(n,0,32768),SS(e,2,52,"exception is too long, it has been truncated to 32768 characters.",{exception:t},!0)),r||t}(e,function(e){var t="";return e&&(e.obj?Vv(e.obj,(function(e){t+=e+"\n"})):t=e.src||""),t}(i)),o.hasFullStack=Ty(o.parsedStack)&&0<o.parsedStack[GT],r&&(r[fI]=r[fI]||o[fI])):(o[fI]=t[fI],o[QT]=t[QT],o[gk]=t[gk],o[uI]=t[uI]||[],o[wI]=t[wI])}return e.prototype.toInterface=function(){var e,t=this[uI]instanceof Array&&Kv(this[uI],(function(e){return e.toInterface()}));return(e={id:this.id,outerId:this.outerId,typeName:this[fI],message:this[QT],hasFullStack:this[wI],stack:this[gk]})[uI]=t||void 0,e},e.CreateFromInterface=function(t,r){var n=r[uI]instanceof Array&&Kv(r[uI],(function(e){return Pk[vI](e)}))||r[uI];return new e(t,iw(iw({},r),{parsedStack:n}))},e}(),Pk=function(){function e(t,r){this.aiDataContract={level:1,method:1,assembly:0,fileName:0,line:0};var n,i=this;i[pI]=0,"string"==typeof t?(n=t,i[xI]=r,i[CI]="<no_method>",i[_I]=s_(n),i[bI]="",i[SI]=0,(r=n.match(e.regex))&&5<=r[GT]&&(i[CI]=s_(r[2])||i[CI],i[bI]=s_(r[4]),i[SI]=parseInt(r[5])||0)):(i[xI]=t[xI],i[CI]=t[CI],i[_I]=t[_I],i[bI]=t[bI],i[SI]=t[SI],i[pI]=0),i.sizeInBytes+=i.method[GT],i.sizeInBytes+=i.fileName[GT],i.sizeInBytes+=i.assembly[GT],i[pI]+=e.baseSize,i.sizeInBytes+=i.level.toString()[GT],i.sizeInBytes+=i.line.toString()[GT]}return e.CreateFromInterface=function(t){return new e(t,null)},e.prototype.toInterface=function(){return{level:this[xI],method:this[CI],assembly:this[_I],fileName:this[bI],line:this[SI]}},e.regex=/^([\s]+at)?[\s]{0,50}([^\@\()]+?)[\s]{0,50}(\@|\()([^\(\n]+):([0-9]+):([0-9]+)(\)?)$/,e.baseSize=58,e}(),Mk=function(){this.aiDataContract={name:1,kind:0,value:1,count:0,min:0,max:0,stdDev:0},this.kind=0},Rk=function(){function e(e,t,r,n,i,o,a,s,l){this.aiDataContract={ver:1,metrics:1,properties:0},this.ver=2;var c=new Mk;c[JT]=0<n?n:void 0,c.max=isNaN(o)||null===o?void 0:o,c.min=isNaN(i)||null===i?void 0:i,c[XT]=kI(e,t)||jT,c.value=r,c.stdDev=isNaN(a)||null===a?void 0:a,this.metrics=[c],this[hI]=MI(e,s),this[dI]=RI(e,l)}return e.envelopeType="Microsoft.ApplicationInsights.{0}.Metric",e.dataType="MetricData",e}();function Ok(e){(isNaN(e)||e<0)&&(e=0);var t=""+(e=Math.round(e))%1e3,r=""+Math.floor(e/1e3)%60,n=""+Math.floor(e/6e4)%60,i=""+Math.floor(e/36e5)%24;return(0<(e=Math.floor(e/864e5))?e+".":"")+(i[GT]<2?"0"+i:i)+":"+(n[GT]<2?"0"+n:n)+":"+(r[GT]<2?"0"+r:r)+"."+(1===t[GT]?"00"+t:2===t[GT]?"0"+t:t)}var Lk=function(){function e(e,t,r,n,i,o,a){this.aiDataContract={ver:1,name:0,url:0,duration:0,properties:0,measurements:0,id:0},this.ver=2,this.id=function(e,t){return t&&OI(e,t,128,69)[WT]()}(e,a),this.url=AI(e,r),this[XT]=kI(e,t)||jT,isNaN(n)||(this[EI]=Ok(n)),this[hI]=MI(e,i),this[dI]=RI(e,o)}return e.envelopeType="Microsoft.ApplicationInsights.{0}.Pageview",e.dataType="PageviewData",e}(),Dk=function(){function e(e,t,r,n,i,o,a,s,l,c,u,h){void 0===l&&(l="Ajax"),this.aiDataContract={id:1,ver:1,name:0,resultCode:0,duration:0,success:0,data:0,target:0,type:0,properties:0,measurements:0,kind:0,value:0,count:0,min:0,max:0,stdDev:0,dependencyKind:0,dependencySource:0,commandName:0,dependencyTypeName:0};var d=this;d.ver=2,d.id=t,d[EI]=Ok(i),d.success=o,d.resultCode=a+"",d.type=kI(e,l),t=function(e,t,r,n){var i,o,a,s=n,l=n;return s=t&&0<t[GT]?(a=(i=FI(t)).host,s||(null!=i[sI]?("/"!==(o=0===i.pathname[GT]?"/":i[sI]).charAt(0)&&(o="/"+o),l=i[sI],kI(e,r?r+" "+o:o)):kI(e,t))):a=n,{target:a,name:s,data:l}}(e,r,s,n);d.data=AI(e,n)||t.data,d.target=kI(e,t.target),c&&(d.target="".concat(d.target," | ").concat(c)),d[XT]=kI(e,t[XT]),d[hI]=MI(e,u),d[dI]=RI(e,h)}return e.envelopeType="Microsoft.ApplicationInsights.{0}.RemoteDependency",e.dataType="RemoteDependencyData",e}(),Nk=function(){function e(e,t,r,n,i){this.aiDataContract={ver:1,message:1,severityLevel:0,properties:0},this.ver=2,this[QT]=PI(e,t=t||jT),this[hI]=MI(e,n),this[dI]=RI(e,i),r&&(this[mI]=r)}return e.envelopeType="Microsoft.ApplicationInsights.{0}.Message",e.dataType="MessageData",e}(),zk=function(){function e(e,t,r,n,i,o,a){this.aiDataContract={ver:1,name:0,url:0,duration:0,perfTotal:0,networkConnect:0,sentRequest:0,receivedResponse:0,domProcessing:0,properties:0,measurements:0};var s=this;s.ver=2,s.url=AI(e,r),s[XT]=kI(e,t)||jT,s[hI]=MI(e,i),s[dI]=RI(e,o),a&&(s.domProcessing=a.domProcessing,s[EI]=a[EI],s.networkConnect=a.networkConnect,s.perfTotal=a.perfTotal,s[TI]=a[TI],s.sentRequest=a.sentRequest)}return e.envelopeType="Microsoft.ApplicationInsights.{0}.PageviewPerformance",e.dataType="PageviewPerformanceData",e}(),Fk=function(e,t){this.aiDataContract={baseType:1,baseData:1},this.baseType=e,this.baseData=t};function Bk(e){var t="ai."+e+".";return function(e){return t+e}}var Uk=Bk("application"),jk=Bk("device"),qk=Bk("location"),Hk=Bk("operation"),Vk=Bk("session"),Gk=Bk("user"),Kk=Bk("cloud"),Zk=Bk("internal"),Wk=function(e){function t(){return e.call(this)||this}return aw(t,e),t}(function(e){return function(){var t=this;e&&Ny(e,(function(e,r){t[e]=r}))}}({applicationVersion:Uk("ver"),applicationBuild:Uk("build"),applicationTypeId:Uk("typeId"),applicationId:Uk("applicationId"),applicationLayer:Uk("layer"),deviceId:jk("id"),deviceIp:jk("ip"),deviceLanguage:jk("language"),deviceLocale:jk("locale"),deviceModel:jk("model"),deviceFriendlyName:jk("friendlyName"),deviceNetwork:jk("network"),deviceNetworkName:jk("networkName"),deviceOEMName:jk("oemName"),deviceOS:jk("os"),deviceOSVersion:jk("osVersion"),deviceRoleInstance:jk("roleInstance"),deviceRoleName:jk("roleName"),deviceScreenResolution:jk("screenResolution"),deviceType:jk("type"),deviceMachineName:jk("machineName"),deviceVMName:jk("vmName"),deviceBrowser:jk("browser"),deviceBrowserVersion:jk("browserVersion"),locationIp:qk("ip"),locationCountry:qk("country"),locationProvince:qk("province"),locationCity:qk("city"),operationId:Hk("id"),operationName:Hk("name"),operationParentId:Hk("parentId"),operationRootId:Hk("rootId"),operationSyntheticSource:Hk("syntheticSource"),operationCorrelationVector:Hk("correlationVector"),sessionId:Vk("id"),sessionIsFirst:Vk("isFirst"),sessionIsNew:Vk("isNew"),userAccountAcquisitionDate:Gk("accountAcquisitionDate"),userAccountId:Gk("accountId"),userAgent:Gk("userAgent"),userId:Gk("id"),userStoreRegion:Gk("storeRegion"),userAuthUserId:Gk("authUserId"),userAnonymousUserAcquisitionDate:Gk("anonUserAcquisitionDate"),userAuthenticatedUserAcquisitionDate:Gk("authUserAcquisitionDate"),cloudName:Kk("name"),cloudRole:Kk("role"),cloudRoleVer:Kk("roleVer"),cloudRoleInstance:Kk("roleInstance"),cloudEnvironment:Kk("environment"),cloudLocation:Kk("location"),cloudDeploymentUnit:Kk("deploymentUnit"),internalNodeName:Zk("nodeName"),internalSdkVersion:Zk("sdkVersion"),internalAgentVersion:Zk("agentVersion"),internalSnippet:Zk("snippet"),internalSdkSrc:Zk("sdkSrc")}));function $k(e,t,r,n,i,o){r=kI(n,r)||jT,(wy(e)||wy(t)||wy(r))&&Vy("Input doesn't contain all required fields");n="";var a,s=(e[qT]&&(n=e[qT],delete e[qT]),(a={})[XT]=r,a.time=Lx(new Date),a.iKey=n,a.ext=o||{},a.tags=[],a.data={},a.baseType=t,a.baseData=e,a);return wy(i)||Ny(i,(function(e,t){s.data[e]=t})),s}var Yk="user",Xk="device",Qk="trace",Jk="web",eA="app",tA="os",rA=new Wk;function nA(e){var t,r=null;return Sy(Event)?r=new Event(e):(t=Cv())&&t.createEvent&&(r=t.createEvent("Event")).initEvent(e,!0,!0),r}function iA(e,t){xT(e,null,null,t)}var oA="AppInsightsPropertiesPlugin",aA="AppInsightsChannelPlugin",sA="ApplicationInsightsAnalytics",lA="toString",cA="isStorageUseDisabled",uA="_addHook",hA="core",dA="dataType",pA="envelopeType",fA="diagLog",mA="track",gA="trackPageView",yA="trackPreviousPageVisit",vA="sendPageViewInternal",_A="startTime",bA="properties",wA="duration",xA="sendPageViewPerformanceInternal",CA="populatePageViewPerformanceEvent",SA="href",EA="sendExceptionInternal",TA="exception",IA="error",kA="_onerror",AA="errorSrc",PA="lineNumber",MA="columnNumber",RA="message",OA="CreateAutoException",LA="addTelemetryInitializer",DA="autoTrackPageVisitTime",NA="isBrowserLinkTrackingEnabled",zA="length",FA="enableAutoRouteTracking",BA="enableUnhandledPromiseRejectionTracking",UA="autoUnhandledPromiseInstrumented",jA="getEntriesByType",qA="isPerformanceTimingSupported",HA="getPerformanceTiming",VA="navigationStart",GA="shouldCollectDuration",KA="isPerformanceTimingDataReady",ZA="responseStart",WA="loadEventEnd",$A="responseEnd",YA="connectEnd",XA="pageVisitStartTime",QA=function(){function e(t,r,n,i){Fw(e,this,(function(e){var o,a=null,s=[],l=!1,c=!1;function u(e){n&&n.flush(e,(function(){}))}function h(e){s.push(e),function e(){a=a||I_((function(){a=null;var t=s.slice(0),r=!1;s=[],Vv(t,(function(e){e()?r=!0:s.push(e)})),0<s[zA]&&e(),r&&u(!0)}),100)}()}n&&(o=n.logger),e[gA]=function(e,n){var a,s,d,p,f,m,g=e.name,y=(!wy(g)&&"string"==typeof g||(s=Cv(),g=e.name=s&&s.title||""),e.uri);!wy(y)&&"string"==typeof y||(s=aC(),y=e.uri=s&&s[SA]||""),c||((a=(s=v_())&&s[jA]&&s[jA]("navigation"))&&a[0]&&!by(s.timeOrigin)?(a=a[0].loadEventStart,e[_A]=new Date(s.timeOrigin+a)):(s=(n||e[bA]||{})[wA]||0,e[_A]=new Date((new Date).getTime()-s)),c=!0),i[qA]()?(d=!1,0<(f=i[HA]()[VA])&&(p=KI(f,+new Date),i[GA](p)||(p=void 0)),wy(n)||wy(n[wA])||(m=n[wA]),!r&&isNaN(m)||(isNaN(m)&&((n=n||{})[wA]=p),t[vA](e,n),u(!0),d=!0),n=n||{},h((function(){var r,a=!1;try{i[KA]()?(a=!0,r={name:g,uri:y},i[CA](r),r.isValid||d?(d||(n[wA]=r.durationMs,t[vA](e,n)),l||(t[xA](r,n),l=!0)):(n[wA]=p,t[vA](e,n))):0<f&&6e4<KI(f,+new Date)&&(a=!0,d||(n[wA]=6e4,t[vA](e,n)))}catch(r){SS(o,1,38,"trackPageView failed on page load calculation: "+Dx(r),{exception:Hy(r)})}return a}))):(t[vA](e,n),u(!0),Rv()||SS(o,2,25,"trackPageView: navigation timing API used for calculation of page duration is not supported in this browser. This page view will be collected without duration and timing info."))},e.teardown=function(e,t){var r;a&&(a.cancel(),a=null,r=s.slice(0),s=[],Vv(r,(function(e){e()})))}}))}return e.__ieDyn=1,e}(),JA=["googlebot","adsbot-google","apis-google","mediapartners-google"];function eP(){var e=v_();return e&&!!e.timing}function tP(){var e;return(e=(e=v_())?e.timing:0)&&0<e.domainLookupStart&&0<e[VA]&&0<e[ZA]&&0<e.requestStart&&0<e[WA]&&0<e[$A]&&0<e[YA]&&0<e.domLoading}function rP(){return eP()?v_().timing:null}function nP(){return function(){var e=v_();return e&&e.getEntriesByType&&0<e.getEntriesByType("navigation")[zA]}()?v_()[jA]("navigation")[0]:null}function iP(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=(Tv()||{}).userAgent,n=!1;if(r)for(var i=0;i<JA[zA];i++)n=n||-1!==x_(r.toLowerCase(),JA[i]);if(n)return!1;for(i=0;i<e[zA];i++)if(e[i]<0||36e5<=e[i])return!1;return!0}var oP,aP=function(){function e(t){var r=_S(t);Fw(e,this,(function(e){e[CA]=function(t){t.isValid=!1;var n=nP(),i=rP(),o=0,a=0,s=0,l=0,c=0;(n||i)&&(c=n?(o=n[wA],a=0===n[_A]?n[YA]:KI(n[_A],n[YA]),s=KI(n.requestStart,n[ZA]),l=KI(n[ZA],n[$A]),KI(n.responseEnd,n[WA])):(o=KI(i[VA],i[WA]),a=KI(i[VA],i[YA]),s=KI(i.requestStart,i[ZA]),l=KI(i[ZA],i[$A]),KI(i.responseEnd,i[WA])),0===o?SS(r,2,10,"error calculating page view performance.",{total:o,network:a,request:s,response:l,dom:c}):e[GA](o,a,s,l,c)?o<Math.floor(a)+Math.floor(s)+Math.floor(l)+Math.floor(c)?SS(r,2,8,"client performance math error.",{total:o,network:a,request:s,response:l,dom:c}):(t.durationMs=o,t.perfTotal=t[wA]=Ok(o),t.networkConnect=Ok(a),t.sentRequest=Ok(s),t.receivedResponse=Ok(l),t.domProcessing=Ok(c),t.isValid=!0):SS(r,2,45,"Invalid page load duration value. Browser perf data won't be sent.",{total:o,network:a,request:s,response:l,dom:c}))},e[HA]=rP,e[qA]=eP,e[KA]=tP,e[GA]=iP}))}return e.__ieDyn=1,e}(),sP=function(){function e(t,r){var n="prevPageVisitData";Fw(e,this,(function(e){e[yA]=function(e,i){try{var o=function(e,r){var i=null;try{var o;i=function(){var e=null;try{var r,i;sk()&&(r=t_(),i=lk(t,n))&&sC()&&((e=lC().parse(i)).pageVisitTime=r-e[XA],uk(t,n))}catch(r){ES(t,"Stop page visit timer failed: "+Hy(r)),e=null}return e}(),sk()&&(null!=lk(t,n)&&Vy("Cannot call startPageVisit consecutively without first calling stopPageVisit"),o=lC().stringify(new lP(e,r)),ck(t,n,o))}catch(e){ES(t,"Call to restart failed: "+Hy(e)),i=null}return i}(e,i);o&&r(o.pageName,o.pageUrl,o.pageVisitTime)}catch(e){ES(t,"Auto track page visit time failed, metric will not be collected: "+Hy(e))}},By(e,"_logger",{g:function(){return t}}),By(e,"pageVisitTimeTrackingHandler",{g:function(){return r}})}))}return e.__ieDyn=1,e}(),lP=function(e,t){this[XA]=t_(),this.pageName=e,this.pageUrl=t},cP=function(e,t){var r=this,n={};r.start=function(t){void 0!==n[t]&&SS(e,2,62,"start was called more than once for this event without calling stop.",{name:t,key:t},!0),n[t]=+new Date},r.stop=function(t,i,o,a){var s=n[t];isNaN(s)?SS(e,2,63,"stop was called without a corresponding start.",{name:t,key:t},!0):(s=KI(s,+new Date),r.action(t,i,s,o,a)),delete n[t],n[t]=void 0}};function uP(e,t){e&&e.dispatchEvent&&t&&e.dispatchEvent(t)}var hP=$y(((oP={sessionRenewalMs:iS(dP,18e5),sessionExpirationMs:iS(dP,864e5),disableExceptionTracking:aS()})[DA]=aS(),oP.overridePageViewDuration=aS(),oP[BA]=aS(),oP[UA]=!1,oP.samplingPercentage=oS((function(e){return!isNaN(e)&&0<e&&e<=100}),100),oP[cA]=aS(),oP[NA]=aS(),oP[FA]=aS(),oP.namePrefix=function(e){return{isVal:Cy,v:qy(e||lx)}}(),oP.enableDebug=aS(),oP.disableFlushOnBeforeUnload=aS(),oP.disableFlushOnUnload=aS(!1,"disableFlushOnBeforeUnload"),oP));function dP(e,t){return+(e=(e=e||t)<6e4?6e4:e)}function pP(e){by(e[cA])||(e[cA]?tk:nk)()}var fP=function(e){function t(){var r,n,i,o,a,s,l,c,u,h,d,p,f,m,g,y,v,_,b,w=e.call(this)||this;return w.identifier=sA,w.priority=180,w.autoRoutePVDelay=500,Fw(t,w,(function(e,t){var w=t[uA];function x(t,r,n,i,o){e[fA]().throwInternal(t,r,n,i,o)}function C(){s=a=o=i=n=r=null;var t=aC(y=m=f=p=d=h=u=c=l=!1);v=t&&t[SA]||"",g=b=_=null,By(e,"config",{g:function(){return g}})}C(),e.getCookieMgr=function(){return VS(e[hA])},e.processTelemetry=function(t,r){e.processNext(t,r)},e.trackEvent=function(t,r){try{var n=$k(t,fk[dA],fk[pA],e[fA](),r);e[hA][mA](n)}catch(t){x(2,39,"trackTrace failed, trace will not be collected: "+Dx(t),{exception:Hy(t)})}},e.startTrackEvent=function(e){try{r.start(e)}catch(e){x(1,29,"startTrackEvent failed, event will not be collected: "+Dx(e),{exception:Hy(e)})}},e.stopTrackEvent=function(e,t,n){try{r.stop(e,void 0,t,n)}catch(e){x(1,30,"stopTrackEvent failed, event will not be collected: "+Dx(e),{exception:Hy(e)})}},e.trackTrace=function(t,r){try{var n=$k(t,Nk[dA],Nk[pA],e[fA](),r);e[hA][mA](n)}catch(t){x(2,39,"trackTrace failed, trace will not be collected: "+Dx(t),{exception:Hy(t)})}},e.trackMetric=function(t,r){try{var n=$k(t,Rk[dA],Rk[pA],e[fA](),r);e[hA][mA](n)}catch(t){x(1,36,"trackMetric failed, metric will not be collected: "+Dx(t),{exception:Hy(t)})}},e[gA]=function(e,t){try{var r=e||{};i[gA](r,iw(iw(iw({},r.properties),r.measurements),t)),y&&a[yA](r.name,r.uri)}catch(e){x(1,37,"trackPageView failed, page view will not be collected: "+Dx(e),{exception:Hy(e)})}},e[vA]=function(t,r,n){var i=((i=Cv())&&(t.refUri=void 0===t.refUri?i.referrer:t.refUri),wy(t[_A])&&(i=(r||t[bA]||{})[wA]||0,t[_A]=new Date((new Date).getTime()-i)),$k(t,Lk[dA],Lk[pA],e[fA](),r,n));e[hA][mA](i)},e[xA]=function(t,r,n){t=$k(t,zk[dA],zk[pA],e[fA](),r,n),e[hA][mA](t)},e.trackPageViewPerformance=function(t,r){t=t||{};try{o[CA](t),e[xA](t,r)}catch(t){x(1,37,"trackPageViewPerformance failed, page view will not be collected: "+Dx(t),{exception:Hy(t)})}},e.startTrackPage=function(e){try{var t;"string"!=typeof e&&(e=(t=Cv())&&t.title||""),n.start(e)}catch(e){x(1,31,"startTrackPage failed, page view may not be collected: "+Dx(e),{exception:Hy(e)})}},e.stopTrackPage=function(e,t,r,i){try{var o,s;"string"!=typeof e&&(e=(o=Cv())&&o.title||""),"string"!=typeof t&&(t=(s=aC())&&s[SA]||""),n.stop(e,t,r,i),y&&a[yA](e,t)}catch(e){x(1,32,"stopTrackPage failed, page view will not be collected: "+Dx(e),{exception:Hy(e)})}},e[EA]=function(t,r,n){var i=t&&(t[TA]||t[IA])||Py(t)&&t||{name:t&&typeof t,message:t||jT};t=t||{},i=$k(new kk(e[fA](),i,t[bA]||r,t.measurements,t.severityLevel,t.id).toInterface(),kk[dA],kk[pA],e[fA](),r,n),e[hA][mA](i)},e.trackException=function(t,r){t&&!t[TA]&&t[IA]&&(t[TA]=t[IA]);try{e[EA](t,r)}catch(t){x(1,35,"trackException failed, exception will not be collected: "+Dx(t),{exception:Hy(t)})}},e[kA]=function(t){var r=t&&t[IA],n=t&&t.evt;try{n||(c=Ev())&&(n=c.event);var i,o,a=t&&t.url||(Cv()||{}).URL,s=t[AA]||"window.onerror@"+a+":"+(t[PA]||0)+":"+(t[MA]||0),l={errorSrc:s,url:a,lineNumber:t[PA]||0,columnNumber:t[MA]||0,message:t[RA]};!function(e,t,r,n,i){return!i&&Cy(e)&&("Script error."===e||"Script error"===e)}(t.message,t.url,t.lineNumber,t.columnNumber,t[IA])?(t[AA]||(t[AA]=s),e.trackException({exception:t,severityLevel:3},l)):(i=kk[OA]("Script error: The browser's same-origin policy prevents us from getting the details of this exception. Consider using the 'crossorigin' attribute.",a,t[PA]||0,t[MA]||0,r,n,null,s),o=l,i=$k(i,kk[dA],kk[pA],e[fA](),o),e[hA][mA](i))}catch(t){var c=r?r.name+", "+r[RA]:"null";x(1,11,"_onError threw exception while logging error, error will not be collected: "+Dx(t),{exception:Hy(t),errorString:c})}},e[LA]=function(t){if(e[hA])return e[hA][LA](t);(s=s||[]).push(t)},e.initialize=function(x,C,S,E){if(!e.isInitialized()){wy(C)&&Vy("Error initializing"),t.initialize(x,C,S,E);try{var T,I;b=bT(AC(e.identifier),C.evtNamespace&&C.evtNamespace()),s&&(Vv(s,(function(e){C[LA](e)})),s=null),R=x,O=e.identifier,L=e[hA],e[uA](QC(R,(function(){var t,r=AE(null,R,L);g=r.getExtCfg(O,hP),y=g[DA],R.storagePrefix&&rk(R.storagePrefix),pP(g),l=g[NA],!c&&l&&(t=["/browserLinkSignalR/","/__browserLink/"],e[uA](e[LA]((function(e){if(l&&e.baseType===Dk[dA]){var r=e.baseData;if(r)for(var n=0;n<t[zA];n++)if(r.target&&0<=x_(r.target,t[n]))return!1}return!0}))),c=!0)}))),o=new aP(e[hA]),i=new QA(e,g.overridePageViewDuration,e[hA],o),a=new sP(e[fA](),(function(t,r,n){var i;i={PageName:t,PageUrl:r},e.trackMetric({name:"PageVisitTime",average:n,max:n,min:n,sampleCount:1},i)})),(r=new cP(e[fA](),"trackEvent")).action=function(t,r,n,i,o){o=o||{},(i=i||{}).duration=n[lA](),e.trackEvent({name:t,properties:i,measurements:o})},(n=new cP(e[fA](),"trackPageView")).action=function(t,r,n,i,o){(i=wy(i)?{}:i).duration=n[lA](),e[vA]({name:t,uri:r,properties:i,measurements:o},i)},Sv()&&(P=Ev(),M=aC(),e[uA](QC(g,(function(){(d=g.disableExceptionTracking)||p||g.autoExceptionInstrumented||(w(LT(P,"onerror",{ns:b,rsp:function(t,r,n,i,o,a){d||!0===t.rslt||e[kA](kk[OA](r,n,i,o,a,t.evt))}},!1)),p=!0)}))),T=P,I=M,e[uA](QC(g,(function(){f=!0===g[BA],p=p||g[UA],f&&!m&&(w(LT(T,"onunhandledrejection",{ns:b,rsp:function(t,r){f&&!0!==t.rslt&&e[kA](kk[OA](function(e){var t;return e&&e.reason?(t=e.reason,!Cy(t)&&Sy(t[lA])?t[lA]():Hy(t)):e||""}(r),I?I[SA]:"",0,0,r,t.evt))}},!1)),g[UA]=m=!0)}))),k=Ev(),A=aC(),e[uA](QC(g,(function(){var t,r,n,i;u=!0===g[FA],k&&u&&!h&&Pv()&&(r=Pv(),Sy(r.pushState))&&Sy(r.replaceState)&&typeof Event!==Jb&&(t=k,n=A,h||(i=g.namePrefix||"",w(LT(r,"pushState",{ns:b,rsp:function(){u&&(uP(t,nA(i+"pushState")),uP(t,nA(i+"locationchange")))}},!0)),w(LT(r,"replaceState",{ns:b,rsp:function(){u&&(uP(t,nA(i+"replaceState")),uP(t,nA(i+"locationchange")))}},!0)),wT(t,i+"popstate",(function(){u&&uP(t,nA(i+"locationchange"))}),b),wT(t,i+"locationchange",(function(){var t,r;_&&(v=_),_=n&&n[SA]||"",u&&((t=function(){var t,r=null;return e[hA]&&e[hA].getTraceCtx&&(r=e[hA].getTraceCtx(!1)),r||(t=e[hA].getPlugin(oA))&&(t=t.plugin.context)&&(r=ZI(t.telemetryTrace)),r}())&&(t.setTraceId(cE()),r="_unknown_",n&&n.pathname&&(r=n.pathname+(n.hash||"")),t.setName(kI(e[fA](),r))),I_(function(t){e[gA]({refUri:t,properties:{duration:0}})}.bind(e,v),e.autoRoutePVDelay))}),b),h=!0))}))))}catch(x){throw e.setInitialized(!1),x}var k,A,P,M,R,O,L}},e._doTeardown=function(e,t){i&&i.teardown(e,t),xT(window,null,null,b),C()},By(e,"_pageViewManager",{g:function(){return i}}),By(e,"_pageViewPerformanceManager",{g:function(){return o}}),By(e,"_pageVisitTimeManager",{g:function(){return a}}),By(e,"_evtNamespace",{g:function(){return"."+b}})})),w}return aw(t,e),t.Version="3.3.0",t}(zE),mP="featureOptIn",gP="onCfgChangeReceive",yP="nonOverrideConfigs",vP="scheduleFetchTimeout";function _P(e,t,r,n){try{var i=n<r,o=(i&&(e=null),0==r?function(e,t,r,n,i,o,a){return f_(e||{},gy[sy](arguments))}({},e):e);return o&&t&&!i&&Ny(o,(function(e){var i=t[e];i&&(Ey(o[e])&&Ey(i)?o[e]=_P(o[e],i,++r,n):delete o[e])})),o}catch(e){}return e}var bP,wP="featureOptIn.",xP=".mode",CP=".onCfg",SP=".offCfg";function EP(e,t){try{var r,n;return e&&e.enabled?e[mP]?(r=e[mP],n=e.config||{},Ny(r,(function(r){var i=function(e,t,r){var n,i,o,a,s,l,c,u,h,d;return t&&t.enabled?(n=(t=(t[mP]||{})[e]||{mode:1}).mode,i=t.onCfg,t=t.offCfg,o=(r=(r||{})[e]||{mode:2}).mode,a=r.onCfg,s=r.offCfg,r=!!r.blockCdnCfg,l=wP+e+CP,c=wP+e+SP,u=o,h=a,d=s,r||(4===n||5===n?(u=4==n?3:2,h=i||a,d=t||s):2===n||2===o?(u=2,h=a||i,d=s||t):3===n?(u=3,h=a||i,d=s||t):1===n&&1===o&&(u=1)),(r={})[wP+e+xP]=u,r[l]=h,r[c]=d,r):null}(r,e,t.config[mP]);wy(i)||(Ny(i,(function(e,t){b_(n,e,t)})),function(e,t,r){var n=t[wP+e+xP],i=t[wP+e+CP];t=t[wP+e+SP],e=2===n?t:3===n?i:null;e&&Ny(e,(function(e,t){b_(r,e,t)}))}(r,i,n))})),n):e.config:null}catch(r){}return null}var TP=void 0,IP=$y(((bP={syncMode:1,blkCdnCfg:TP,customEvtName:TP,cfgUrl:TP,overrideSyncFn:TP,overrideFetchFn:TP})[gP]=TP,bP[vP]=18e5,bP[yP]={instrumentationKey:!0,connectionString:!0,endpointUrl:!0},bP)),kP=function(e){function t(){var r,n,i,o,a,s,l,c,u,h,d,p,f,m,g,y,v=e.call(this)||this,_=(v.priority=198,!(v.identifier="AppInsightsCfgSyncPlugin"));return Fw(t,v,(function(e,t){function v(){p=y=g=u=d=h=s=f=c=l=a=o=i=n=null}function b(t,r){if(t){if(n=t,r&&!_)return x();if(l&&!_)return e.core.updateCfg(t),!0}return!1}function w(){try{var e=bv();e&&xT(e,null,null,o)}catch(e){}}function x(e){try{return y&&Sy(y)?y(n,e):fC(i,n,e)}catch(e){}return!1}function C(e){try{if(w(),e&&(i=e,l)){var t=bv();if(t)try{wT(t,i,(function(e){e=e&&e.detail;p&&e?p(e):(e=(e=e&&e.cfg)&&l_(e)&&k(e))&&b(e)}),o,!0)}catch(e){}}return!0}catch(e){}return!1}function S(e,t,r){var n=(n=bv())&&n.fetch||null;if(e&&n&&Sy(n))try{var i=new Request(e,{method:"GET"});jw(fetch(i),(function(e){var n=e.value;e.rejected?I(t,400):n.ok?jw(n.text(),(function(e){I(t,n.status,e.value,r)})):I(t,n.status,null,r)}))}catch(e){}}function E(e,t,r){try{var n=new XMLHttpRequest;n.open("GET",e),n.onreadystatechange=function(){n.readyState===XMLHttpRequest.DONE&&I(t,n.status,n.responseText,r)},n.onerror=function(){I(t,400)},n.ontimeout=function(){I(t,400)},n.send()}catch(e){}}function T(t,r,n){try{var i,o,a;200<=t&&t<400&&r?(d=0,(i=lC())&&(a=(o=EP(i.parse(r),e.core))&&l_(o)&&k(o))&&b(a,n)):d++,d<3&&A()}catch(t){}}function I(e,t,r,n){try{e(t,r,n)}catch(e){}}function k(e){var t=null;try{e&&(t=_P(e,f,0,5))}catch(e){}return t}function A(){!s&&h&&(s=I_((function(){s=null,m(a,T,c)}),h)).unref()}function P(){s&&s.cancel(),s=null,d=0}v(),e.initialize=function(s,v,_,b){var I,k,A;t.initialize(s,v,_,b),o=bT(AC(e.identifier),v.evtNamespace&&v.evtNamespace()),I=s,k=e.identifier,A=e.core,e._addHook(QC(I,(function(){var e=AE(null,I,A);r=e.getExtCfg(k,IP),e=u,u=!!r.blkCdnCfg,wy(e)||e===u||(!u&&a?m&&m(a,T,c):P()),wy(l)&&(l=2===r.syncMode),wy(c)&&(c=1===r.syncMode),e=r.customEvtName||"ai_cfgsync";i!==e&&(l?C(e):(w(),i=e)),(a=wy(a)?r.cfgUrl:a)||(n=I,c&&x())}))),y=r.overrideSyncFn,g=r.overrideFetchFn,p=r[gP],f=r[yP],h=r[vP],m=function(){var e=g;return wy(e)&&(dC()?e=S:pC()&&(e=E)),e}(),d=0,a&&!u&&m&&m(a,T,c)},e.getCfg=function(){return n},e.pause=function(){_=!0,P()},e.resume=function(){_=!1,A()},e.setCfg=function(e){return b(e)},e.sync=x,e.updateEventListenerName=C,e._doTeardown=function(e,t){w(),P(),v()},e._getDbgPlgTargets=function(){return[c,l,i,u,f]},e.processTelemetry=function(t,r){e.processNext(t,r)}})),v}return aw(t,e),t.__ieDyn=1,t}(zE),AP="duration",PP="tags",MP="deviceType",RP="data",OP="name",LP="traceID",DP="length",NP="stringify",zP="measurements",FP="dataType",BP="envelopeType",UP="toString",jP="_get",qP="enqueue",HP="count",VP="eventsLimitInMem",GP="push",KP="item",ZP="emitLineDelimitedJson",WP="clear",$P="createNew",YP="markAsSent",XP="clearSent",QP="bufferOverride",JP="BUFFER_KEY",eM="SENT_BUFFER_KEY",tM="concat",rM="MAX_BUFFER_SIZE",nM="triggerSend",iM="diagLog",oM="initialize",aM="_sender",sM="customHeaders",lM="maxBatchSizeInBytes",cM="onunloadDisableBeacon",uM="isBeaconApiDisabled",hM="alwaysUseXhrOverride",dM="disableXhr",pM="enableSessionStorageBuffer",fM="_buffer",mM="onunloadDisableFetch",gM="disableSendBeaconSplit",yM="instrumentationKey",vM="enableSendPromise",_M="getSenderInst",bM="unloadTransports",wM="convertUndefined",xM="maxBatchInterval",CM="serialize",SM="_onError",EM="_onPartialSuccess",TM="_onSuccess",IM="itemsReceived",kM="itemsAccepted",AM="oriPayload",PM="baseType",MM="sampleRate",RM="eventsSendRequest",OM="getSamplingScore",LM="baseType",DM="baseData",NM="properties",zM="true";function FM(e,t,r){return Nx(e,t,r,Ry)}function BM(e,t,r){wy(e)||Ny(e,(function(e,n){ky(n)?r[e]=n:Cy(n)?t[e]=n:sC()&&(t[e]=lC()[NP](n))}))}function UM(e,t){wy(e)||Ny(e,(function(r,n){e[r]=n||t}))}function jM(e,t,r,n){return FM(n=new pk(e,n,t),"sampleRate",r[NT]),(r[DM]||{}).startTime&&(n.time=Lx(r[DM].startTime)),n.iKey=r.iKey,t=r.iKey.replace(/-/g,""),n[OP]=n[OP].replace("{0}",t),function(e,t,r){for(var n,i=r[PP]=r[PP]||{},o=t.ext=t.ext||{},a=t[PP]=t[PP]||[],s=((n=o.user)&&(FM(i,rA.userAuthUserId,n.authId),FM(i,rA.userId,n.id||n.localId)),(n=o.app)&&FM(i,rA.sessionId,n.sesId),(n=o.device)&&(FM(i,rA.deviceId,n.id||n.localId),FM(i,rA[MP],n.deviceClass),FM(i,rA.deviceIp,n.ip),FM(i,rA.deviceModel,n.model),FM(i,rA[MP],n[MP])),(n=t.ext.web)&&(FM(i,rA.deviceLanguage,n.browserLang),FM(i,rA.deviceBrowserVersion,n.browserVer),FM(i,rA.deviceBrowser,n.browser),FM(t=(t=(t=r[RP]=r[RP]||{})[DM]=t[DM]||{})[NM]=t[NM]||{},"domain",n.domain),FM(t,"isManual",n.isManual?zM:null),FM(t,"screenRes",n.screenRes),FM(t,"userConsent",n.userConsent?zM:null)),(t=o.os)&&(FM(i,rA.deviceOS,t[OP]),FM(i,rA.deviceOSVersion,t.osVer)),(n=o.trace)&&(FM(i,rA.operationParentId,n.parentID),FM(i,rA.operationName,kI(e,n[OP])),FM(i,rA.operationId,n[LP])),{}),l=a[DP]-1;0<=l;l--)Ny(a[l],(function(e,t){s[e]=t})),a.splice(l,1);Ny(a,(function(e,t){s[e]=t})),(t=iw(iw({},i),s))[rA.internalSdkVersion]||(t[rA.internalSdkVersion]=kI(e,"javascript:".concat(HM.Version),64)),r[PP]=jx(t)}(e,r,n),r[PP]=r[PP]||[],jx(n)}function qM(e,t){wy(t[DM])&&SS(e,1,46,"telemetryItem.baseData cannot be null.")}var HM={Version:"3.3.0"};function VM(e,t,r){qM(e,t);var n={},i={};t[LM]!==fk[FP]&&(n.baseTypeSource=t[LM]),t[LM]===fk[FP]?(n=t[DM][NM]||{},i=t[DM][zP]||{}):t[DM]&&BM(t[DM],n,i),BM(t[RP],n,i),wy(r)||UM(n,r),r=t[DM][OP],r=new fk(e,r,n,i),n=new Fk(fk[FP],r);return jM(e,fk[BP],t,n)}var GM,KM,ZM=function(){function e(t,r){var n=[],i=!1,o=r.maxRetryCnt;this[jP]=function(){return n},this._set=function(e){return n=e},Fw(e,this,(function(e){e[qP]=function(a){e[HP]()>=r[VP]?i||(SS(t,2,105,"Maximum in-memory buffer size reached: "+e[HP](),!0),i=!0):(a.cnt=a.cnt||0,!wy(o)&&a.cnt>o||n[GP](a))},e[HP]=function(){return n[DP]},e.size=function(){for(var e=n[DP],t=0;t<n[DP];t++)e+=n[t].item[DP];return r[ZP]||(e+=2),e},e[WP]=function(){i=!(n=[])},e.getItems=function(){return n.slice(0)},e.batchPayloads=function(e){var t;return e&&0<e[DP]?(t=[],Vv(e,(function(e){t[GP](e[KP])})),r[ZP]?t.join("\n"):"["+t.join(",")+"]"):null},e[$P]=function(e,r,i){var o=n.slice(0),a=new(i?YM:WM)(e=e||t,r=r||{});return Vv(o,(function(e){a[qP](e)})),a}}))}return e.__ieDyn=1,e}(),WM=function(e){function t(r,n){return Fw(t,r=e.call(this,r,n)||this,(function(e,t){e[YP]=function(e){t[WP]()},e[XP]=function(e){}})),r}return aw(t,e),t.__ieDyn=1,t}(ZM),$M=["AI_buffer","AI_sentBuffer"],YM=function(e){function t(r,n){var i=e.call(this,r,n)||this,o=!1,a=null==n?void 0:n.namePrefix,s=n[QP]||{getItem:lk,setItem:ck},l=s.getItem,c=s.setItem,u=n.maxRetryCnt;return Fw(t,i,(function(e,n){var i=p(t[JP]),s=p(t[eM]),h=function(){var e=[];try{return Vv($M,(function(t){var r=g(t);e=e[tM](r),a&&(r=g(a+"_"+t),e=e[tM](r))})),e}catch(i){SS(r,2,41,"Transfer events from previous buffers: "+Dx(i)+". previous Buffer items can not be removed",{exception:Hy(i)})}return[]}();s=s[tM](h);function d(e,t){var r=[],n=[];return Vv(e,(function(e){n[GP](e[KP])})),Vv(t,(function(e){Sy(e)||-1!==Gv(n,e[KP])||r[GP](e)})),r}function p(e){return f(a?a+"_"+e:e)}function f(e){try{var t=l(r,e);if(t){var n=lC().parse(t);if((n=Cy(n)?lC().parse(n):n)&&Ty(n))return n}}catch(t){SS(r,1,42," storage key: "+e+", "+Dx(t),{exception:Hy(t)})}return[]}function m(e,t){try{e=a?a+"_"+e:e;var n=JSON[NP](t);c(r,e,n)}catch(t){c(r,e,JSON[NP]([])),SS(r,2,41," storage key: "+e+", "+Dx(t)+". Buffer cleared",{exception:Hy(t)})}}function g(e){try{var t=f(e),n=[];return Vv(t,(function(e){n[GP]({item:e,cnt:0})})),uk(r,e),n}catch(e){}return[]}(h=e._set(i[tM](s)))[DP]>t[rM]&&(h[DP]=t[rM]),m(t[eM],[]),m(t[JP],h),e[qP]=function(i){e[HP]()>=t[rM]?o||(SS(r,2,67,"Maximum buffer size reached: "+e[HP](),!0),o=!0):(i.cnt=i.cnt||0,!wy(u)&&i.cnt>u||(n[qP](i),m(t.BUFFER_KEY,e[jP]())))},e[WP]=function(){n[WP](),m(t.BUFFER_KEY,e[jP]()),m(t[eM],[]),o=!1},e[YP]=function(n){m(t[JP],e._set(d(n,e[jP]())));var i=p(t[eM]);i instanceof Array&&n instanceof Array&&((i=i[tM](n))[DP]>t[rM]&&(SS(r,1,67,"Sent buffer reached its maximum size: "+i[DP],!0),i[DP]=t[rM]),m(t[eM],i))},e[XP]=function(e){e=d(e,p(t[eM])),m(t[eM],e)},e[$P]=function(n,i,o){o=!!o;var a=e[jP]().slice(0),s=p(t[eM]).slice(0),l=(n=n||r,i=i||{},e[WP](),new(o?t:WM)(n,i));return Vv(a,(function(e){l[qP](e)})),o&&l[YP](s),l}})),i}var r;return aw(t,e),(r=t).VERSION="_1",t.BUFFER_KEY="AI_buffer"+r.VERSION,t.SENT_BUFFER_KEY="AI_sentBuffer"+r.VERSION,t.MAX_BUFFER_SIZE=2e3,t}(ZM),XM=function(){function e(t){Fw(e,this,(function(e){function r(e,o){var a="__aiCircularRefCheck",s={};if(e)if(e[a])SS(t,2,50,"Circular reference detected while serializing object",{name:o},!0);else if(e.aiDataContract)e[a]=!0,Ny(e.aiDataContract,(function(i,a){var l=Sy(a)?1&a():1&a,c=Sy(a)?4&a():4&a,u=(a=2&a,void 0!==e[i]),h=Ey(e[i])&&null!==e[i];!l||u||a?c||(l=void 0)!==(l=h?(a?n:r)(e[i],i):e[i])&&(s[i]=l):SS(t,1,24,"Missing required field specification. The field is required but not present on source",{field:i,name:o})})),delete e[a];else if("measurements"===o)s=i(e,"number",o);else if("properties"===o)s=i(e,"string",o);else if("tags"===o)s=i(e,"string",o);else if(Ty(e))s=n(e,o);else{SS(t,2,49,"Attempting to serialize an object which does not implement ISerializable",{name:o},!0);try{lC()[NP](e),s=e}catch(a){SS(t,1,48,a&&Sy(a[UP])?a[UP]():"Error serializing object",null,!0)}}else SS(t,1,48,"cannot serialize object because it is null or undefined",{name:o},!0);return s}function n(e,n){if(e)if(Ty(e))for(var i=[],o=0;o<e[DP];o++){var a=r(e[o],n+"["+o+"]");i[GP](a)}else SS(t,1,54,"This field was specified as an array in the contract but the item is not an array.\r\n",{name:n},!0);return i}function i(e,r,n){var i;return e&&(i={},Ny(e,(function(e,o){"string"===r?void 0===o?i[e]="undefined":null===o?i[e]="null":o[UP]?i[e]=o[UP]():i[e]="invalid field: toString() is not defined.":"number"===r?void 0===o?i[e]="undefined":null===o?i[e]="null":(o=parseFloat(o),i[e]=o):(i[e]="invalid field: "+n+" is of unknown type.",SS(t,1,i[e],null,!0))}))),i}e[CM]=function(e){e=r(e,"root");try{return lC()[NP](e)}catch(e){SS(t,1,48,e&&Sy(e[UP])?e[UP]():"Error serializing object",null,!0)}}}))}return e.__ieDyn=1,e}(),QM=function(){function e(){}return e.prototype.getHashCodeScore=function(t){return this.getHashCode(t)/e.INT_MAX_VALUE*100},e.prototype.getHashCode=function(e){if(""===e)return 0;for(;e[DP]<8;)e=e[tM](e);for(var t=5381,r=0;r<e[DP];++r)t=(t<<5)+t+e.charCodeAt(r),t&=t;return Math.abs(t)},e.INT_MAX_VALUE=2147483647,e}(),JM=function(){var e=new QM,t=new Wk;this[OM]=function(r){return r[PP]&&r[PP][t.userId]?e.getHashCodeScore(r[PP][t.userId]):r.ext&&r.ext.user&&r.ext.user.id?e.getHashCodeScore(r.ext.user.id):r[PP]&&r[PP][t.operationId]?e.getHashCodeScore(r[PP][t.operationId]):r.ext&&r.ext.telemetryTrace&&r.ext.telemetryTrace[LP]?e.getHashCodeScore(r.ext.telemetryTrace[LP]):100*Math.random()}},eR=function(){function e(e,t){this.INT_MAX_VALUE=2147483647,t=t||_S(null),(100<e||e<0)&&(t.throwInternal(2,58,"Sampling rate is out of range (0..100). Sampling will be disabled, you may be sending too much data which may affect your AI service level.",{samplingRate:e},!0),e=100),this[MM]=e,this.samplingScoreGenerator=new JM}return e.prototype.isSampledIn=function(e){var t=this[MM];return null==t||100<=t||e.baseType===Rk[FP]||this.samplingScoreGenerator[OM](e)<t},e}(),tR=void 0;function rR(e){try{return e.responseText}catch(e){}return null}var nR=$y(((GM={endpointUrl:oS(Ry,BT+UT)})[ZP]=aS(),GM[xM]=15e3,GM[lM]=102400,GM.disableTelemetry=aS(),GM[pM]=aS(!0),GM.isRetryDisabled=aS(),GM[uM]=aS(!0),GM[gM]=aS(!0),GM[dM]=aS(),GM[mM]=aS(),GM[cM]=aS(),GM[yM]=tR,GM.namePrefix=tR,GM.samplingPercentage=oS((function(e){return!isNaN(e)&&0<e&&e<=100}),100),GM[sM]=tR,GM[wM]=tR,GM[VP]=1e4,GM[QP]=!1,GM.httpXHROverride={isVal:function(e){return e&&e.sendPOST},v:tR},GM[hM]=aS(),GM.transports=tR,GM.retryCodes=tR,GM.maxRetryCnt={isVal:ky,v:10},GM));(KM={})[fk.dataType]=VM,KM[Nk.dataType]=function(e,t,r){qM(e,t);var n=t[DM].message,i=t[DM].severityLevel,o=t[DM][NM]||{},a=t[DM][zP]||{};return BM(t[RP],o,a),wy(r)||UM(o,r),r=new Nk(e,n,i,o,a),n=new Fk(Nk[FP],r),jM(e,Nk[BP],t,n)},KM[Lk.dataType]=function(e,t,r){qM(e,t);var n,i=(wy(i=t[DM])||wy(i[NM])||wy(i[NM][AP])?wy(t[RP])||wy(t[RP][AP])||(n=t[RP][AP],delete t[RP][AP]):(n=i[NM][AP],delete i[NM][AP]),t[DM]),o=(((t.ext||{}).trace||{})[LP]&&(o=t.ext.trace[LP]),i.id||o),a=i[OP],s=i.uri,l=i[NM]||{},c=i[zP]||{};return wy(i.refUri)||(l.refUri=i.refUri),wy(i.pageType)||(l.pageType=i.pageType),wy(i.isLoggedIn)||(l.isLoggedIn=i.isLoggedIn[UP]()),wy(i[NM])||Ny(i[NM],(function(e,t){l[e]=t})),BM(t[RP],l,c),wy(r)||UM(l,r),i=new Lk(e,a,s,n,l,c,o),r=new Fk(Lk[FP],i),jM(e,Lk[BP],t,r)},KM[zk.dataType]=function(e,t,r){qM(e,t);var n=t[DM],i=n[OP],o=n.uri||n.url,a=n[NM]||{},s=n[zP]||{};return BM(t[RP],a,s),wy(r)||UM(a,r),r=new zk(e,i,o,void 0,a,s,n),i=new Fk(zk[FP],r),jM(e,zk[BP],t,i)},KM[kk.dataType]=function(e,t,r){qM(e,t);var n=t[DM][zP]||{},i=t[DM][NM]||{};return BM(t[RP],i,n),wy(r)||UM(i,r),r=t[DM],r=kk.CreateFromInterface(e,r,i,n),i=new Fk(kk[FP],r),jM(e,kk[BP],t,i)},KM[Rk.dataType]=function(e,t,r){qM(e,t);var n=(o=t[DM])[NM]||{},i=o[zP]||{},o=(r=(BM(t[RP],n,i),wy(r)||UM(n,r),new Rk(e,o[OP],o.average,o.sampleCount,o.min,o.max,o.stdDev,n,i)),new Fk(Rk[FP],r));return jM(e,Rk[BP],t,o)},KM[Dk.dataType]=function(e,t,r){qM(e,t);var n,i=t[DM][zP]||{},o=t[DM][NM]||{};return BM(t[RP],o,i),wy(r)||UM(o,r),r=t[DM],wy(r)?(ES(e,"Invalid input for dependency data"),null):(n=r[NM]&&r[NM][FT]?r[NM][FT]:"GET",n=new Dk(e,r.id,r.target,r[OP],r[AP],r.success,r.responseCode,n,r.type,r.correlationContext,o,i),r=new Fk(Dk[FP],n),jM(e,Dk[BP],t,r))};var iR=KM,oR=function(e){function t(){var r,n,i,o,a,s,l,c,u,h,d,p,f,m,g,y,v,_,b,w,x,C,S,E,T,I,k,A,P,M,R,O,L,D,N=e.call(this)||this,z=(N.priority=1001,N.identifier=aA,0);return Fw(t,N,(function(e,F){function B(t,n){var i=rR(t);!t||i+""!="200"&&""!==i?(i=$E(i))&&i[IM]&&i[IM]>i[kM]&&!x?e[EM](n,i):e[SM](n,Gx(t)):(r=0,e[TM](n,0))}function U(e,t,r){4===e.readyState&&X(e.status,t,e.responseURL,r,Kx(e),rR(e)||e.response)}function j(e){try{var t;if(e)return(t=e[AM])&&t[DP]?t:null}catch(e){}return null}function q(t,r){return!(_||(t?t.baseData&&!t[PM]?(r&&SS(r,1,70,"Cannot send telemetry without baseData and baseType"),1):(t[PM]||(t[PM]="EventData"),e[aM]?e._sample.isSampledIn(t)?(t[NT]=e._sample[MM],0):(r&&SS(r,2,33,"Telemetry item was sampled out and not sent",{SampleRate:e._sample[MM]}),1):(r&&SS(r,1,28,"Sender was not initialized"),1)):(r&&SS(r,1,7,"Cannot send empty telemetry"),1)))}function H(e,r){var n=e.iKey||b,i=t.constructEnvelope(e,n,r,w);if(i){var o=!1;if(e[PP]&&e[PP][zT]&&(Vv(e[PP][zT],(function(e){try{e&&!1===e(i)&&(o=!0,ES(r,"Telemetry processor check returns false"))}catch(e){SS(r,1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+Dx(e),{exception:Hy(e)},!0)}})),delete e[PP][zT]),!o)return i}else SS(r,1,47,"Unable to create an AppInsights envelope")}function V(t){var r="",n=e[iM]();try{var i=q(t,n),o=null;(o=i?H(t,n):o)&&(r=a[CM](o))}catch(t){}return r}function G(e){var t="";return e&&e[DP]?"["+e.join(",")+"]":t}function K(e){var t=$(),r={urlString:d};return r[RP]=e,r.headers=t,r}function Z(t,r,n,i){void 0===i&&(i=!0);var o=W(r);return(t=t&&t.sendPOST)&&o?(i&&e._buffer[YP](r),t(o,(function(t,n,i){var o;o=r,200===t&&o?e._onSuccess(o,o[DP]):i&&e[SM](o,i)}),!n)):null}function W(t){var r,n,i;return Ty(t)&&0<t[DP]?(n=e[fM].batchPayloads(t),i=$(),(r={})[RP]=n,r.urlString=d,r.headers=i,r.disableXhrSync=A,r.disableFetchKeepAlive=!P,r[AM]=t,r):null}function $(){try{var e=l||{};return qI(d)&&(e[HT[6]]=HT[7]),e}catch(e){}return null}function Y(t){t=t?t[DP]:0,e[fM].size()+t>f&&(u&&!u.isOnline()||e[nM](!0,null,10))}function X(t,n,i,o,a,s){var l=null;e._appId||(l=$E(s))&&l.appId&&(e._appId=l.appId),(t<200||300<=t)&&0!==t?(301!==t&&307!==t&&308!==t||Q(i))&&!x&&oe(t)?(re(n),SS(e[iM](),2,40,". Response code "+t+". Will retry to send "+n[DP]+" items.")):e[SM](n,a):u&&!u.isOnline()?x||(re(n,10),SS(e[iM](),2,40,". Offline - Response Code: ".concat(t,". Offline status: ").concat(!u.isOnline(),". Will retry to send ").concat(n.length," items."))):(Q(i),206===t?(l=l||$E(s))&&!x?e[EM](n,l):e[SM](n,a):(r=0,e[TM](n,o)))}function Q(e){return!(10<=s||wy(e)||""===e||e===d)&&(d=e,++s,1)}function J(e,t){if(!c)return Z(L&&L[_M]([3],!0),e,t);c(e,!1)}function ee(e){try{if(e&&e[DP])return Cy(e[0])}catch(e){}}function te(t,r){var n=null;if(Ty(t)){for(var i=t[DP],o=0;o<t[DP];o++)i+=t[o].item[DP];return L.getSyncFetchPayload()+i<=65e3?n=2:hC()?n=3:(n=1,SS(e[iM](),2,40,". Failed to send telemetry with Beacon API, retried with xhrSender.")),Z(L&&L[_M]([n],!0),t,r)}return null}function re(t,i){if(void 0===i&&(i=1),t&&0!==t[DP]){var o=e[fM];o[XP](t),r++;for(var a,s=0,l=t;s<l.length;s++){var c=l[s];c.cnt=c.cnt||0,c.cnt++,o[qP](c)}t=i,t=r<=1?10:(a=(Math.pow(2,r)-1)/2,a=Math.floor(Math.random()*a*10)+1,a*=t,Math.max(Math.min(a,3600),10)),a=t_()+1e3*t,n=a,ne()}}function ne(){var t;o||i||(t=n?Math.max(0,n-t_()):0,t=Math.max(C,t),o=I_((function(){o=null,e[nM](!0,null,1)}),t))}function ie(){o&&o.cancel(),n=o=null}function oe(e){return wy(D)?401===e||408===e||429===e||500===e||502===e||503===e||504===e:D[DP]&&-1<D.indexOf(e)}function ae(){e[aM]=null,e[fM]=null,e._appId=null,e._sample=null,f=z=s=r=0,T=w=tR,O=P=A=x=_=m=i=!(l={}),L=R=M=S=b=v=p=d=h=c=a=o=n=u=null,By(e,"_senderConfig",{g:function(){return qx({},nR)}})}ae(),e.pause=function(){ie(),i=!0},e.resume=function(){i&&(i=!1,n=null,Y(),ne())},e.flush=function(t,r,n){if(void 0===t&&(t=!0),!i){ie();try{return e[nM](t,null,n||1)}catch(t){SS(e[iM](),1,22,"flush failed, telemetry will not be collected: "+Dx(t),{exception:Hy(t)})}}},e.onunloadFlush=function(){if(!i)if(m||k)try{return e[nM](!0,J,2)}catch(J){SS(e[iM](),1,20,"failed to flush with beacon sender on page unload, telemetry will not be collected: "+Dx(J),{exception:Hy(J)})}else e.flush(!1)},e.addHeader=function(e,t){l[e]=t},e[oM]=function(t,i,o,z){e.isInitialized()&&SS(e[iM](),1,28,"Sender is already initialized"),F[oM](t,i,o,z);var q=e.identifier,H=(a=new XM(i.logger),r=0,n=null,e[aM]=null,s=0,e[iM]());h=bT(AC("Sender"),i.evtNamespace&&i.evtNamespace()),u=function(e){var t,r=Cv(),n=Tv(),i=!1,o=[],a=1,s=(!n||wy(n.onLine)||n.onLine||(a=2),0),l=h(),c=bT(AC("OfflineListener"),e);try{u(Ev())&&(i=!0),r&&(t=r.body||r).ononline&&u(t)&&(i=!0)}catch(e){i=!1}function u(e){var t=!1;return e&&(t=wT(e,"online",p,c))&&wT(e,"offline",f,c),t}function h(){return 2!==s&&2!==a}function d(){var e=h();l!==e&&(l=e,Vv(o,(function(e){var t={isOnline:l,rState:a,uState:s};try{e(t)}catch(e){}})))}function p(){a=1,d()}function f(){a=2,d()}return{isOnline:function(){return l},isListening:function(){return i},unload:function(){var e=Ev();e&&i&&(iA(e,c),r&&!by((e=r.body||r).ononline)&&iA(e,c),i=!1)},addListener:function(e){return o[$T](e),{rm:function(){var t=o.indexOf(e);if(-1<t)return o.splice(t,1)}}},setOnlineState:function(e){s=e,d()}}}(h),e._addHook(QC(t,(function(t){(t=t.cfg).storagePrefix&&rk(t.storagePrefix);var r=AE(null,t,i).getExtCfg(q,nR),n=(By(e,"_senderConfig",{g:function(){return r}}),i.activeStatus()===M_.PENDING?e.pause():i.activeStatus()===M_.ACTIVE&&e.resume(),p!==r.endpointUrl&&(d=p=r.endpointUrl),v&&v!==r[sM]&&Vv(v,(function(e){delete l[e.header]})),f=r[lM],m=(!1===r[cM]||!1===r[uM])&&hC(),g=!1===r[cM]&&hC(),y=!1===r[uM]&&hC(),k=r[hM],A=!!r[dM],D=r.retryCodes,r[QP]),o=!!r[pM]&&(!!n||sk()),a=r.namePrefix,s=o!==S||o&&T!==a||o&&E!==n;if(e[fM]){if(s)try{e._buffer=e._buffer[$P](H,r,o)}catch(t){SS(e[iM](),1,12,"failed to transfer telemetry to different buffer storage, telemetry will be lost: "+Dx(t),{exception:Hy(t)})}Y()}else e[fM]=new(o?YM:WM)(H,r);T=a,S=o,E=n,P=!r[mM]&&dC(!0),O=!!r[gM],e._sample=new eR(r.samplingPercentage,H),function(e,t){return!wy(t=t.disableInstrumentationKeyValidation)&&t?1:new RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(e)}(b=r[yM],t)||SS(H,1,100,"Invalid Instrumentation key "+b),v=r[sM],Cy(d)&&!qI(d)&&v&&0<v[DP]?Vv(v,(function(e){N.addHeader(e.header,e.value)})):v=null,I=r[vM];s=function(){var t;try{var r={xdrOnComplete:function(e,t,r){if(r=j(r))return B(e,r)},fetchOnComplete:function(e,t,r,n){if(n=j(n))return X(e.status,n,e.url,n[DP],e.statusText,r||"")},xhrOnComplete:function(e,t,r){if(r=j(r))return U(e,r,r[DP])},beaconOnRetry:function(t,r,n){var i=r,o=n,a=t&&t[AM];if(O)R&&R(a,!0),SS(e[iM](),2,40,". Failed to send telemetry with Beacon API, retried with normal sender.");else{for(var s=[],l=0;l<a[DP];l++){var c=a[l],u=[c];o(W(u),i)?e._onSuccess(u,u[DP]):s[GP](c)}0<s[DP]&&(R&&R(s,!0),SS(e[iM](),2,40,". Failed to send telemetry with Beacon API, retried with normal sender."))}}};return(t={})[vM]=I,t.isOneDs=!1,t.disableCredentials=!1,t[dM]=A,t.disableBeacon=!y,t.disableBeaconSync=!g,t.senderOnCompleteCallBack=r,t}catch(t){}return null}(),L?L.SetConfig(s):(L=new JE)[oM](s,H),a=r.httpXHROverride,o=Zx([3,1,2],r.transports);var u,h=L&&L[_M](o,!1),z=L&&L.getFallbackInst();M=function(e,t){return Z(z,e,t)},R=function(e,t){return Z(z,e,t,!1)},h=k?a:h||a||z,e[aM]=function(e,t){return Z(h,e,t)},P&&(c=te),n=Zx([3,1],r[bM]);P||(n=n.filter((function(e){return 2!==e}))),u=L&&L[_M](n,!0),u=!k&&u||a,c=(c=(k||r[bM]||!c)&&u?function(e,t){return Z(u,e,t)}:c)||M,_=r.disableTelemetry,w=r[wM]||tR,x=r.isRetryDisabled,C=r[xM]})))},e.processTelemetry=function(t,r){var n,i=(r=e._getTelCtx(r))[iM]();try{if(!q(t,i))return;var o=H(t,i);if(!o)return;var s=a[CM](o),l=e[fM],c=(Y(s),(n={})[KP]=s,n.cnt=0,n);l[qP](c),ne()}catch(t){SS(i,2,12,"Failed adding telemetry to the sender's buffer, some telemetry will be lost: "+Dx(t),{exception:Hy(t)})}e.processNext(t,r)},e.isCompletelyIdle=function(){return!i&&0===z&&0===e._buffer[HP]()},e._xhrReadyStateChange=function(e,t,r){if(!ee(t))return U(e,t,r)},e[nM]=function(t,r,n){var o;if(void 0===t&&(t=!0),!i)try{var a=e[fM];if(_)a[WP]();else if(0<a[HP]()){var s=a.getItems(),l=n||0,c=t,u=function(){var t="getNotifyMgr";return e.core[t]?e.core[t]():e.core._notificationManager}();if(u&&u[RM])try{u[RM](l,c)}catch(t){SS(e[iM](),1,74,"send request notification failed: "+Dx(t),{exception:Hy(t)})}o=r?r.call(e,s,t):e[aM](s,t)}ie()}catch(t){(!(a=uC())||9<a)&&SS(e[iM](),1,40,"Telemetry transmission failed, some telemetry will be lost: "+Dx(t),{exception:Hy(t)})}return o},e.getOfflineSupport=function(){var e={getUrl:function(){return d},createPayload:K};return e[CM]=V,e.batch=G,e.shouldProcess=function(e){return!!q(e)},e},e._doTeardown=function(t,r){e.onunloadFlush(),JC(u,!1),ae()},e[SM]=function(t,r,n){if(!ee(t))return SS(e[iM](),2,26,"Failed to send telemetry.",{message:r}),void(e._buffer&&e._buffer[XP](t))},e[EM]=function(t,r){if(!ee(t)){for(var n=t,i=[],o=[],a=0,s=r=(t=r).errors.reverse();a<s.length;a++){var l=s[a],c=n.splice(l.index,1)[0];(oe(l.statusCode)?o:i)[GP](c)}0<n[DP]&&e[TM](n,t[kM]),0<i[DP]&&e[SM](i,Kx(null,["partial success",t[kM],"of",t.itemsReceived].join(" "))),0<o[DP]&&(re(o),SS(e[iM](),2,40,"Partial success. Delivered: "+n[DP]+", Failed: "+i[DP]+". Will retry to send "+o[DP]+" our of "+t[IM]+" items"))}},e[TM]=function(t,r){ee(t)||e._buffer&&e._buffer[XP](t)},e._xdrOnLoad=function(e,t){if(!ee(t))return B(e,t)}})),N}return aw(t,e),t.constructEnvelope=function(e,t,r,n){return e=t===e.iKey||wy(t)?e:iw(iw({},e),{iKey:t}),(iR[e.baseType]||VM)(r,e,n)},t}(zE),aR="duration",sR="properties",lR="requestUrl",cR="inst",uR="length",hR="traceID",dR="spanID",pR="traceFlags",fR="context",mR="aborted",gR="traceId",yR="spanId",vR="_addHook",_R="core",bR="includeCorrelationHeaders",wR="getAbsoluteUrl",xR="headers",CR="requestHeaders",SR="setRequestHeader",ER="trackDependencyDataInternal",TR="startTime",IR="toLowerCase",kR="enableRequestHeaderTracking",AR="enableAjaxErrorStatusText",PR="enableAjaxPerfTracking",MR="maxAjaxCallsPerView",RR="excludeRequestFromAutoTrackingPatterns",OR="addRequestContext",LR="disableAjaxTracking",DR="ajaxPerfLookupDelay",NR="disableFetchTracking",zR="enableResponseHeaderTracking",FR="status",BR="statusText",UR="headerMap",jR="openDone",qR="sendDone",HR="requestSentTime",VR="abortDone",GR="getTraceId",KR="getTraceFlags",ZR="method",WR="errorStatusText",$R="stateChangeAttached",YR="responseText",XR="responseFinishedTime",QR="CreateTrackItem",JR="response",eO="getAllResponseHeaders",tO="getPartAProps",rO="perfMark",nO="name",iO="perfTiming",oO="exception",aO="ajaxDiagnosticsMessage",sO="correlationContext",lO="ajaxTotalDuration",cO="eventTraceCtx";function uO(e,t,r){var n=0;t=e[t],e=e[r];return t&&e?KI(t,e):n}function hO(e,t,r,n,i){var o=0;return(r=uO(r,n,i))?dO(e,t,Ok(r)):o}function dO(e,t,r){var n=0;return e&&t&&r&&((e.ajaxPerf=e.ajaxPerf||{})[t]=r,n=1),n}var pO,fO=function(){this[jR]=!1,this.setRequestHeaderDone=!1,this[qR]=!1,this[VR]=!1,this[$R]=!1},mO=function(){function e(t,r,n,i){var o=this,a=n;o[rO]=null,o.completed=!1,o.requestHeadersSize=null,o[CR]=null,o.responseReceivingDuration=null,o.callbackDuration=null,o[lO]=null,o[mR]=0,o.pageUrl=null,o[lR]=null,o.requestSize=0,o[ZR]=null,o[FR]=null,o[HR]=null,o.responseStartedTime=null,o[XR]=null,o.callbackFinishedTime=null,o.endTime=null,o.xhrMonitoringState=new fO,o.clientFailure=0,o[hR]=t,o[dR]=r,o[pR]=null==i?void 0:i.getTraceFlags(),o[cO]=i?((n={})[gR]=i[GR](),n[yR]=i.getSpanId(),n[pR]=i[KR](),n):null,Fw(e,o,(function(e){e.getAbsoluteUrl=function(){return e[lR]?function(e){var t;return(e=FI(e))?e.href:t}(e[lR]):null},e.getPathName=function(){return e[lR]?AI(a,function(e,t){return e?e.toUpperCase()+" "+t:t}(e[ZR],e[lR])):null},e[QR]=function(t,r,n){var i;return e.ajaxTotalDuration=Math.round(1e3*KI(e.requestSentTime,e.responseFinishedTime))/1e3,e[lO]<0?null:((i={id:"|"+e[hR]+"."+e[dR],target:e[wR]()})[nO]=e.getPathName(),i.type=t,i[TR]=null,i.duration=e[lO],i.success=200<=+e[FR]&&+e[FR]<400,i.responseCode=+e[FR],i[sR]={HttpMethod:e[ZR]},i=(t=i)[sR],e[mR]&&(i[mR]=!0),e[HR]&&(t[TR]=new Date,t[TR].setTime(e[HR])),function(e,t){var r,n=e[iO],i=t[sR]||{},o=0,a="domainLookup",s="connect",l="request",c="response",u=s+"End",h=l+(h="Start"),d=c+"End",p="transferSize",f="encodedBodySize",m="decodedBodySize",g="serverTiming";n?(o=(o=(o=(o=(o=(o=(o|=hO(i,"End",n,"redirectStart","End"))|hO(i,a,n,"domainLookupStart","domainLookupEnd"))|hO(i,s,n,"connectStart",u))|hO(i,l,n,h,"requestEnd"))|hO(i,c,n,"responseStart",d))|hO(i,"networkConnect",n,"startTime",u))|hO(i,"sentRequest",n,h,d),a=(a=n[aR])||uO(n,"startTime",d)||0,o=(o|=dO(i,aR,a))|dO(i,"perfTotal",a),(s=n[g])&&(r={},Vv(s,(function(e,t){t=Rx(e.name||""+t);var n=r[t]||{};Ny(e,(function(e,t){!("name"!==e&&Cy(t)||ky(t))||!(t=n[e]?n[e]+";"+t:t)&&Cy(t)||(n[e]=t)})),r[t]=n})),o|=dO(i,g,r)),o=(o=(o|=dO(i,p,n[p]))|dO(i,f,n[f]))|dO(i,m,n[m])):e[rO]&&(o|=dO(i,"missing",e.perfAttempts)),o&&(t[sR]=i)}(e,t),r&&0<Wy(e.requestHeaders)[uR]&&(i[CR]=e[CR]),n&&(r=n())&&((n=r[sO])&&(t.correlationContext=n),r[UR]&&0<Wy(r.headerMap)[uR]&&(i.responseHeaders=r[UR]),e[WR])&&(400<=e[FR]?(""!==(n=r.type)&&"text"!==n||(i.responseText=r.responseText?r[BR]+" - "+r.responseText:r[BR]),"json"===n&&(i.responseText=r.response?r[BR]+" - "+JSON.stringify(r[JR]):r[BR])):0===e[FR]&&(i.responseText=r[BR]||"")),t)},e[tO]=function(){var t,r=null,n=e[cO];return n&&(n[gR]||n[yR])&&(t=(r={})[Qk]=((t={})[hR]=n[gR],t.parentID=n[yR],t),wy(n[pR])||(t[pR]=n[pR])),r}}))}return e.__ieDyn=1,e}(),gO="diagLog",yO="_ajaxData",vO="fetch",_O="Failed to monitor XMLHttpRequest",bO=", monitoring data for this ajax call ",wO=bO+"may be incorrect.",xO=bO+"won't be sent.",CO="Failed to get Request-Context correlation header as it may be not included in the response or not accessible.",SO="Failed to add custom defined request context as configured call back may missing a null check.",EO="Failed to calculate the duration of the ",TO=0;var IO=function(e,t){return e&&t&&e[yO]?(e[yO].i||{})[t]:null},kO=function(e,t){var r=!1;return e&&(e=(e[yO]||{}).xh)&&Vv(e,(function(e){if(e.n===t)return r=!0,-1})),r};function AO(e,t){var r="";try{var n=IO(e,t);n&&n[lR]&&(r+="(url: '"+n[lR]+"')")}catch(e){}return r}function PO(e,t,r,n,i){SS(e[gO](),1,t,r,n,i)}function MO(e,t,r,n,i){SS(e[gO](),2,t,r,n,i)}function RO(e,t,r){return function(n){var i;PO(e,t,r,((i={ajaxDiagnosticsMessage:AO(n[cR],e._ajaxDataId)})[oO]=Hy(n.err),i))}}function OO(e,t){return e&&t?x_(e,t):-1}function LO(e,t,r){var n={id:t,fn:r};return e.push(n),{remove:function(){Vv(e,(function(t,r){if(t.id===n.id)return e.splice(r,1),-1}))}}}function DO(e,t,r,n){var i=!0;return Vv(t,(function(t,o){try{!1===t.fn.call(null,r)&&(i=!1)}catch(t){SS(e&&e.logger,1,64,"Dependency "+n+" [#"+o+"] failed: "+Dx(t),{exception:Hy(t)},!0)}})),i}var NO="*.blob.core.",zO=Yy([NO+"windows.net",NO+"chinacloudapi.cn",NO+"cloudapi.de",NO+"usgovcloudapi.net"]),FO=[/https:\/\/[^\/]*(\.pipe\.aria|aria\.pipe|events\.data|collector\.azure)\.[^\/]+\/(OneCollector\/1|Collector\/3)\.0/i],BO=Yy(((pO={})[MR]=500,pO[LR]=!1,pO[NR]=!1,pO[RR]=void 0,pO.disableCorrelationHeaders=!1,pO.distributedTracingMode=1,pO.correlationHeaderExcludedDomains=zO,pO.correlationHeaderDomains=void 0,pO.correlationHeaderExcludePatterns=void 0,pO.appId=void 0,pO.enableCorsCorrelation=!1,pO[kR]=!1,pO[zR]=!1,pO[AR]=!1,pO[PR]=!1,pO.maxAjaxPerfLookupAttempts=3,pO[DR]=25,pO.ignoreHeaders=["Authorization","X-API-Key","WWW-Authenticate"],pO[OR]=void 0,pO.addIntEndpoints=!0,pO)),UO=function(e){function t(){var r,n,i,o,a,s,l,c,u,h,d,p,f,m,g,y,v,_,b,w,x,C,S,E,T,I,k,A,P,M,R=e.call(this)||this;return R.identifier=t.identifier,R.priority=120,Fw(t,R,(function(e,R){var O=R[vR];function L(){var t=aC();M=n=r=!1,i=t&&t.host&&t.host[IR](),m=p=h=u=s=a=!1,v=y=!(g={}),w=b=_=d=c=o=null,C=f=l=0,S=[],E=[],x=AC("ajaxData"),e._ajaxDataId=x,A=k=I=1,P=T=null}function D(e){var t=!0;return(e||T)&&Vv(T,(function(r){if(r[IR]()===e[IR]())return t=!1,-1})),t}function N(e,t,r){O(function(e,t,r){return e?OT(e[ew],t,r,!1):null}(e,t,r))}function z(e,t,r){var n,i,o=!1,a=((Cy(t)?t:(t||{}).url||"")||"")[IR]();return Vv(_,(function(e){var t=e;Cy(e)&&(t=new RegExp(e)),o=o||t.test(a)})),o||(n=OO(a,"?"),i=OO(a,"#"),-1!==(n=-1===n||-1!==i&&i<n?i:n)&&(a=a.substring(0,n)),wy(e)?wy(t)||(o="object"==typeof t&&!0===t[DT]||!!r&&!0===r[DT]):o=!0===e[DT]||!0===a[DT],(o=!(o||!a||!qI(a))||o)?g[a]||(g[a]=1):g[a]&&(o=!0)),o}function F(e,t,r){var i=!0,o=n;return wy(e)||(i=!0===r||!wy(t)),o&&i}function B(){var t=null;return!(t=e[_R]&&e[_R].getTraceCtx?e[_R].getTraceCtx(!1):t)&&c&&c.telemetryTrace?ZI(c.telemetryTrace):t}function U(e,t){var r;t[lR]&&d&&p&&(r=v_())&&Sy(r.mark)&&(e=d+e+"#"+ ++TO,r.mark(e),r=r.getEntriesByName(e))&&1===r[uR]&&(t[rO]=r[0])}function j(e,t,r,n){var i=t[rO],o=v_(),a=I,s=k,l=t[lR],c=0;!function u(){try{if(o&&i){c++;for(var h=null,d=o.getEntries(),p=d[uR]-1;0<=p;p--){var f=d[p];if(f){if("resource"===f.entryType)f.initiatorType!==e||-1===OO(f[nO],l)&&-1===OO(l,f[nO])||(h=f);else if("mark"===f.entryType&&f[nO]===i[nO]){t[iO]=h;break}if(f[TR]<i[TR]-1e3)break}}}!i||t[iO]||a<=c||!1===t.async?(i&&Sy(o.clearMarks)&&o.clearMarks(i[nO]),t.perfAttempts=c,r()):I_(u,s)}catch(u){n(u)}}()}function q(t){var r="";try{wy(t)||(r+="(url: '".concat("string"==typeof t?t:t.url,"')"))}catch(t){PO(e,15,"Failed to grab failed fetch diagnostics message",{exception:Hy(t)})}return r}function H(t,r,n,i,o,s){function l(t,r,i){(i=i||{}).fetchDiagnosticsMessage=q(n),r&&(i.exception=Hy(r)),MO(e,t,EO+"fetch call"+xO,i)}o&&(o[XR]=GI(),o[FR]=r,j(vO,o,(function(){var t,c=o[QR]("Fetch",a,s);try{b&&(t=b({status:r,request:n,response:i}))}catch(t){MO(e,104,SO)}c?(void 0!==t&&(c[sR]=iw(iw({},c.properties),t)),t=o[tO](),V(E,e[_R],o,c,null,t)):l(14,null,{requestSentTime:o[HR],responseFinishedTime:o[XR]})}),(function(e){l(18,e,null)})))}function V(t,r,n,i,o,a){var s,l=!0;0<t[uR]&&((s={item:i})[sR]=o,s.sysProperties=a,s.context=n?n[fR]:null,s.aborted=!!n&&!!n[mR],l=DO(r,t,s,"initializer")),l&&e[ER](i,o,a)}L(),e.initialize=function(i,l,g,C){var S,L;!e.isInitialized()&&(R.initialize(i,l,g,C),w=bT(AC("ajax"),l&&l.evtNamespace&&l.evtNamespace()),e[vR](QC(i,(function(r){r=AE(null,r.cfg,e[_R]),o=r.getExtCfg(t.identifier,BO),A=o.distributedTracingMode,a=o[kR],s=o[AR],p=o[PR],f=o[MR],_=[].concat(o[RR]||[],!1!==o.addIntEndpoints?FO:[]),b=o[OR],h=0===A||1===A,u=1===A||2===A,p&&(d=x),y=!!o[LR],I=o.maxAjaxPerfLookupAttempts,k=o[DR],T=o.ignoreHeaders,P=o.appId}))),function(e,t){var r,n=!1,i=(pC()&&(n=!(wy(i=XMLHttpRequest[ew])||wy(i.open)||wy(i.send)||wy(i.abort))),uC());if(n=!(i&&i<9)&&n)try{var o=new XMLHttpRequest,a={xh:[],i:((r={})[t]={},r)},s=(o[yO]=a,XMLHttpRequest[ew].open);XMLHttpRequest[ew].open=s}catch(t){n=!1,PO(e,15,"Failed to enable XMLHttpRequest monitoring, extension is not supported",((i={})[oO]=Hy(t),i))}return n}(e,x)&&e[vR](QC(o,(function(){y=!!o[LR],a=o[kR],y||n||(N(XMLHttpRequest,"open",{ns:w,req:function(t,r,n,i){var o,l,c,u,h,d,p;y||(t=t[cR],o=IO(t,x),!z(t,n)&&F(t,o,!0)&&(o&&o.xhrMonitoringState[jR]||(u=t,d=(h=B())&&h[GR]()||cE(),p=sv(cE(),0,16),(d=(u=(u=u[yO]=u[yO]||{xh:[],i:{}}).i=u.i||{})[x]=u[x]||new mO(d,p,e[gO](),null==(u=e.core)?void 0:u.getTraceCtx()))[pR]=h&&h[KR](),d[ZR]=r,d[lR]=n,d.xhrMonitoringState[jR]=!0,d[CR]={},d.async=i,d[WR]=s,o=d),l=t,(c=o).xhrMonitoringState[$R]=wT(l,"readystatechange",(function(){var r,n,i;try{l&&4===l.readyState&&F(l,c)&&((i=IO(n=l,x))[XR]=GI(),i[FR]=n[FR],j("xmlhttprequest",i,(function(){try{var t,r=i[QR]("Ajax",a,(function(){var t,r,i;return(i={statusText:n[BR]})[UR]=null,i[sO]=function(r){try{var n=r[eO]();if(null!==n&&-1!==OO(n[IR](),HT[8]))return VI(r.getResponseHeader(HT[0]))}catch(t){MO(e,18,CO,((n={})[aO]=AO(r,x),n[oO]=Hy(t),n))}}(n),i.type=n.responseType,i[YR]=function(e){try{var t=e.responseType;if(""===t||"text"===t)return e[YR]}catch(e){}return null}(n),i.response=n[JR],m&&(t=n[eO]())&&(t=s_(t).split(/[\r\n]+/),r={},Vv(t,(function(e){var t=(e=e.split(": ")).shift();e=e.join(": ");D(t)&&(r[t]=e)})),i[UR]=r),i})),o=void 0;try{b&&(o=b({status:n[FR],xhr:n}))}catch(t){MO(e,104,SO)}r?(void 0!==o&&(r[sR]=iw(iw({},r.properties),o)),t=i[tO](),V(E,e[_R],i,r,null,t)):s(null,{requestSentTime:i[HR],responseFinishedTime:i[XR]})}finally{try{var l=(n[yO]||{i:{}}).i||{};l[x]&&(l[x]=null)}catch(t){}}}),(function(e){s(e,null)})))}catch(t){var o=Hy(t);o&&-1!==OO(o[IR](),"c00c023f")||PO(e,16,_O+" 'readystatechange' event handler"+wO,((r={})[aO]=AO(l,x),r[oO]=o,r))}function s(t,r){(r=r||{}).ajaxDiagnosticsMessage=AO(n,x),t&&(r.exception=Hy(t)),MO(e,14,EO+"ajax call"+xO,r)}}),w)))},hkErr:RO(e,15,_O+".open"+wO)}),N(XMLHttpRequest,"send",{ns:w,req:function(t,r){var n;y||F(t=t[cR],n=IO(t,x))&&!n.xhrMonitoringState[qR]&&(U("xhr",n),n[HR]=GI(),e[bR](n,void 0,void 0,t),n.xhrMonitoringState[qR]=!0)},hkErr:RO(e,17,_O+wO)}),N(XMLHttpRequest,"abort",{ns:w,req:function(e){y||F(e=e[cR],e=IO(e,x))&&!e.xhrMonitoringState[VR]&&(e[mR]=1,e.xhrMonitoringState[VR]=!0)},hkErr:RO(e,13,_O+".abort"+wO)}),N(XMLHttpRequest,"setRequestHeader",{ns:w,req:function(e,t,r){var n;y||(e=e[cR],(n=IO(e,x))&&F(e,n)&&(function(e,t,r){e&&(e=(e[yO]||{}).xh)&&e.push({n:t,v:r})}(e,t,r),a)&&D(t)&&n&&(n[CR][t]=r))},hkErr:RO(e,71,_O+".setRequestHeader"+wO)}),n=!0)}))),(g=function(){var e=bv();return!e||wy(e.Request)||wy(e.Request[ew])||wy(e[vO])?null:e[vO]}())&&(S=bv(),L=g.polyfill,e[vR](QC(o,(function(){v=!!o[NR],m=o[zR],v||r?L&&!M&&(O(OT(S,vO,{ns:w,req:function(e,t,r){z(null,t,r)}})),M=!0):(O(OT(S,vO,{ns:w,req:function(t,i,o){var l,c;v||!r||z(null,i,o)||L&&n||(l=t.ctx(),c=function(t,r){var n=B(),i=n&&n[GR]()||cE(),o=sv(cE(),0,16);(o=new mO(i,o,e[gO](),null==(i=e.core)?void 0:i.getTraceCtx()))[pR]=n&&n[KR](),o[HR]=GI(),o[WR]=s,""===(i=t instanceof Request?(t||{}).url||"":t)&&(n=aC())&&n.href&&(i=__(n.href,"#")[0]),o[lR]=i,n="GET",r&&r[ZR]?n=r[ZR]:t&&t instanceof Request&&(n=t[ZR]),o[ZR]=n;var l={};return a&&new Headers((r?r[xR]:0)||t instanceof Request&&t[xR]||{}).forEach((function(e,t){D(t)&&(l[t]=e)})),o[CR]=l,U(vO,o),o}(i,o),(i=e[bR](c,i,o))!==o&&t.set(1,i),l.data=c)},rsp:function(t,r){var n;v||(n=t.ctx().data)&&(t.rslt=t.rslt.then((function(t){return H(0,(t||{})[FR],r,t,n,(function(){var r,n;return(n={statusText:(t||{})[BR]})[UR]=null,n[sO]=function(t){if(t&&t[xR])try{return VI(t[xR].get(HT[0]))}catch(n){MO(e,18,CO,((t={fetchDiagnosticsMessage:q(t)})[oO]=Hy(n),t))}}(t),m&&t&&(r={},t.headers.forEach((function(e,t){D(t)&&(r[t]=e)})),n[UR]=r),n})),t})).catch((function(e){throw H(0,0,r,null,n,null,e.message||Hy(e)),e})))},hkErr:RO(e,15,"Failed to monitor Window.fetch"+wO)},!0,Rv())),r=!0)}))),L)&&(S[vO].polyfill=L),C=e[_R].getPlugin(oA))&&(c=C.plugin[fR])},e._doTeardown=function(){L()},e.trackDependencyData=function(t,r){V(E,e[_R],null,t,r)},e[bR]=function(t,r,n,s){var l,d,p,f,m=e._currentWindowHost||i;return function(e,t,r,n,i,o){var a;0<e[uR]&&((a={})[_R]=t,a.xhr=n,a.input=i,a.init=o,a.traceId=r[hR],a.spanId=r[dR],a.traceFlags=r[pR],a.context=r[fR]||{},a.aborted=!!r[mR],DO(t,e,n=a,"listener"),r[hR]=n[gR],r[dR]=n[yR],r[pR]=n[pR],r[fR]=n[fR])}(S,e[_R],t,s,r,n),r||""===r?(HI(o,t[wR](),m)&&(n=n||{},r=new Headers(n[xR]||r instanceof Request&&r[xR]||{}),h&&(l="|"+t[hR]+"."+t[dR],r.set(HT[3],l),a)&&(t[CR][HT[3]]=l),(d=P||c&&c.appId())&&(r.set(HT[0],HT[2]+d),a)&&(t[CR][HT[0]]=HT[2]+d),u&&(wy(p=t[pR])&&(p=1),f=vE(mE(t[hR],t[dR],p)),r.set(HT[4],f),a)&&(t[CR][HT[4]]=f),n[xR]=r),n):s?(HI(o,t[wR](),m)&&(h&&(kO(s,HT[3])?MO(e,71,"Unable to set ["+HT[3]+"] as it has already been set by another instance"):(l="|"+t[hR]+"."+t[dR],s[SR](HT[3],l),a&&(t[CR][HT[3]]=l))),(d=P||c&&c.appId())&&(kO(s,HT[0])?MO(e,71,"Unable to set ["+HT[0]+"] as it has already been set by another instance"):(s[SR](HT[0],HT[2]+d),a&&(t[CR][HT[0]]=HT[2]+d))),u)&&(wy(p=t[pR])&&(p=1),kO(s,HT[4])?MO(e,71,"Unable to set ["+HT[4]+"] as it has already been set by another instance"):(f=vE(mE(t[hR],t[dR],p)),s[SR](HT[4],f),a&&(t[CR][HT[4]]=f))),s):void 0},e[ER]=function(t,r,n){-1===f||l<f?(2!==A&&1!==A||"string"!=typeof t.id||"."===t.id[t.id[uR]-1]||(t.id+="."),wy(t[TR])&&(t[TR]=new Date),t=$k(t,Dk.dataType,Dk.envelopeType,e[gO](),r,n),e[_R].track(t)):l===f&&PO(e,55,"Maximum ajax per page view limit reached, ajax monitoring is paused until the next trackPageView(). In order to increase the limit set the maxAjaxCallsPerView configuration parameter.",!0),++l},e.addDependencyListener=function(e){return LO(S,C++,e)},e.addDependencyInitializer=function(e){return LO(E,C++,e)}})),R}return aw(t,e),t.prototype.processTelemetry=function(e,t){this.processNext(e,t)},t.prototype.addDependencyInitializer=function(e){return null},t.identifier="AjaxDependencyPlugin",t}(zE),jO=function(){},qO=function(){this.id="browser",this.deviceClass="Browser"},HO=function(e,t){var r=this,n=QC(e,(function(){var t=e.sdkExtension;r.sdkVersion=(t?t+"_":"")+"javascript:3.3.0"}));t&&t.add(n)},VO=function(){},GO="sessionManager",KO="update",ZO="isUserCookieSet",WO="isNewUser",$O="getTraceCtx",YO="telemetryTrace",XO="applySessionContext",QO="applyApplicationContext",JO="applyDeviceContext",eL="applyOperationContext",tL="applyUserContext",rL="applyOperatingSystemContxt",nL="applyLocationContext",iL="applyInternalContext",oL="accountId",aL="getSessionId",sL="namePrefix",lL="userCookiePostfix",cL="idLength",uL="getNewId",hL="length",dL="automaticSession",pL="authenticatedId",fL="acquisitionDate",mL="renewalDate",gL="join",yL="cookieSeparator",vL="authUserCookieName",_L=function(){},bL=function(){function e(t,r,n){var i,o,a,s,l=_S(r),c=VS(r);Fw(e,this,(function(e){var r=QC(t=t||{},(function(e){a=t.sessionExpirationMs||864e5,s=t.sessionRenewalMs||18e5;var r=t.sessionCookiePostfix||t[sL]||"";i="ai_session"+r}));function u(e,t){var r=!1,n=", session will be reset",i=t.split("|");if(2<=i[hL])try{var o=+i[1]||0,a=+i[2]||0;isNaN(o)||o<=0?SS(l,2,27,"AI session acquisition date is 0"+n):isNaN(a)||a<=0?SS(l,2,27,"AI session renewal date is 0"+n):i[0]&&(e.id=i[0],e[fL]=o,e[mL]=a,r=!0)}catch(e){SS(l,1,9,"Error parsing ai_session value ["+(t||"")+"]"+n+" - "+Dx(e),{exception:Hy(e)})}return r}function h(e,r){var n=e[fL],l=(e[mL]=r,s),u=n+a-r;e=[e.id,n,r],n=0,n=u<l?u/1e3:l/1e3,u=t.cookieDomain||null;c.set(i,e[gL]("|"),0<a?n:null,u),o=r}n&&n.add(r),e[dL]=new _L,e[KO]=function(){var r,n,d=t_(),p=!1,f=e[dL];!(p=f.id?p:!function(e){var t=!1,r=c.get(i);return(r&&Sy(r.split)||(r=ok(l,i)))&&(t=u(e,r)),t||e.id}(f))&&0<a&&(r=d-f[fL],n=d-f[mL],p=(p=(p=r<0||n<0)||a<r)||s<n),p?(r=d,n=t[uL]||SC,e.automaticSession.id=n(t[cL]||22),e[dL][fL]=r,h(e[dL],r),ik()||SS(l,2,0,"Browser does not support local storage. Session durations will be inaccurate.")):(!o||6e4<d-o)&&h(f,d)},e.backup=function(){var t,r,n=e[dL];t=n.id,r=n[fL],n=n[mL],ak(l,i,[t,r,n][gL]("|"))}}))}return e.__ieDyn=1,e}(),wL=function(e,t,r,n){this.traceID=e||cE(),this.parentID=t,e=aC(),!r&&e&&e.pathname&&(r=e.pathname),this.name=kI(n,r)};function xL(e){return!("string"!=typeof e||!e||e.match(/,|;|=| |\|/))}var CL=function(){function e(t,r,n){this.isNewUser=!1,this.isUserCookieSet=!1;var i,o=_S(r),a=VS(r);Fw(e,this,(function(r){By(r,"config",{g:function(){return t}});var s=QC(t,(function(){var n=t[lL]||"";(n=((n=(i=e.userCookieName+n,a.get(i)))&&(r[WO]=!1,0<(n=n.split(e[yL]))[hL])&&(r.id=n[0],r[ZO]=!!r.id),r.id||(r.id=l(),u(c(r.id)[gL](e[yL])),n=(t[sL]||"")+"ai_session",function(e,t){var r=QI();if(null!==r)try{return r[YT](t),!0}catch(t){$I=!1,SS(e,2,5,"Browser failed removal of local storage item. "+Dx(t),{exception:Hy(t)})}}(o,n)),r[oL]=t[oL]||void 0,a.get(e[vL])))&&((n=(n=decodeURI(n)).split(e[yL]))[0]&&(r[pL]=n[0]),1<n[hL])&&n[1]&&(r[oL]=n[1])}));function l(){var e=t||{};return(e[uL]||SC)(e[cL]?t[cL]:22)}function c(e){var t=Lx(new Date);return r.accountAcquisitionDate=t,r[WO]=!0,[e,t]}function u(e){r[ZO]=a.set(i,e,31536e3)}n&&n.add(s),r.setAuthenticatedUserContext=function(t,n,i){void 0===i&&(i=!1),!xL(t)||n&&!xL(n)?SS(o,2,60,"Setting auth user context failed. User auth/account id should be of type string, and not contain commas, semi-colons, equal signs, spaces, or vertical-bars.",!0):(r[pL]=t,t=r[pL],n&&(r[oL]=n,t=[r[pL],r.accountId][gL](e[yL])),i&&a.set(e[vL],encodeURI(t)))},r.clearAuthenticatedUserContext=function(){r[pL]=null,r[oL]=null,a.del(e[vL])},r[KO]=function(t){r.id===t&&r[ZO]||u(c(t||l())[gL](e[yL]))}}))}return e.cookieSeparator="|",e.userCookieName="ai_user",e.authUserCookieName="ai_authUser",e}(),SL="ext",EL="tags";function TL(e,t){e&&e[t]&&0===Wy(e[t])[hL]&&delete e[t]}function IL(){return null}var kL,AL,PL,ML,RL,OL,LL,DL=function(){function e(t,r,n,i){var o=this,a=t.logger;Fw(e,this,(function(e){var s,l,c;e.appId=IL,e[aL]=IL,e.application=new jO,e.internal=new HO(r,i),Sv()&&(e[GO]=new bL(r,t,i),e.device=new qO,e.location=new VO,e.user=new CL(r,t,i),l=s=void 0,n&&(s=n.getTraceId(),l=n.getSpanId(),c=n.getName()),e[YO]=new wL(s,l,c,a),e.session=new _L),e[aL]=function(){var t=e.session;return t&&Cy(t.id)||(t=(e[GO]||{})[dL])&&Cy(t.id)?t.id:null},e[XO]=function(t,r){Nx(zx(t.ext,eA),"sesId",e[aL](),Cy)},e[rL]=function(t,r){Nx(t.ext,tA,e.os)},e[QO]=function(t,r){var n=e.application;n&&(Nx(t=zx(t,EL),rA.applicationVersion,n.ver,Cy),Nx(t,rA.applicationBuild,n.build,Cy))},e[JO]=function(t,r){var n=e.device;n&&(Nx(t=zx(zx(t,SL),Xk),"localId",n.id,Cy),Nx(t,"ip",n.ip,Cy),Nx(t,"model",n.model,Cy),Nx(t,"deviceClass",n.deviceClass,Cy))},e[iL]=function(t,r){var n,i=e.internal;i&&(Nx(n=zx(t,EL),rA.internalAgentVersion,i.agentVersion,Cy),Nx(n,rA.internalSdkVersion,kI(a,i.sdkVersion,64),Cy),t.baseType!==vS.dataType&&t.baseType!==Lk.dataType||(Nx(n,rA.internalSnippet,i.snippetVer,Cy),Nx(n,rA.internalSdkSrc,i.sdkSrc,Cy)))},e[nL]=function(e,t){var r=o.location;r&&Nx(zx(e,EL,[]),rA.locationIp,r.ip,Cy)},e[eL]=function(t,r){var n=e[YO];n&&(Nx(t=zx(zx(t,SL),Qk,{traceID:void 0,parentID:void 0}),"traceID",n.traceID,Cy,wy),Nx(t,"name",n.name,Cy,wy),Nx(t,"parentID",n.parentID,Cy,wy))},e.applyWebContext=function(e,t){var r=o.web;r&&Nx(zx(e,SL),Jk,r)},e[tL]=function(t,r){var n=e.user;n&&(Nx(zx(t,EL,[]),rA.userAccountId,n[oL],Cy),Nx(t=zx(zx(t,SL),Yk),"id",n.id,Cy),Nx(t,"authId",n[pL],Cy))},e.cleanUp=function(e,t){(e=e.ext)&&(TL(e,Xk),TL(e,Yk),TL(e,Jk),TL(e,tA),TL(e,eA),TL(e,Qk))}}))}return e.__ieDyn=1,e}(),NL=null,zL=$y(((kL={})[oL]=NL,kL.sessionRenewalMs=18e5,kL.samplingPercentage=100,kL.sessionExpirationMs=864e5,kL.cookieDomain=NL,kL.sdkExtension=NL,kL.isBrowserLinkTrackingEnabled=!1,kL.appId=NL,kL[aL]=NL,kL[sL]=AL,kL.sessionCookiePostfix=AL,kL[lL]=AL,kL[cL]=22,kL[uL]=NL,kL)),FL=function(e){function t(){var r,n,i,o,a,s=e.call(this)||this;return s.priority=110,s.identifier=oA,Fw(t,s,(function(e,t){function s(){a=!(o=i=n=r=null)}s(),By(e,"context",{g:function(){return o}}),e.initialize=function(s,l,c,u){var h,d,p;t.initialize(s,l,c,u),h=s,d=e.identifier,p=e.core,e._addHook(QC(h,(function(){var t=AE(null,h,p);h.storagePrefix&&rk(h.storagePrefix),a=!1!==h.disableUserInitMessage,r=t.getExtCfg(d,zL),e._extConfig=r}))),i=p[$O](!1),o=new DL(p,r,i,e._unloadHooks),n=ZI(e.context[YO],i),p.setTraceCtx(n),e.context.appId=function(){var e=p.getPlugin(aA);return e?e.plugin._appId:null}},e.processTelemetry=function(t,r){var n,i,s,l;wy(t)||(r=e._getTelCtx(r),t.name===Lk.envelopeType&&r.diagLog().resetInternalMessageCount(),(s=o||{}).session&&"string"!=typeof o.session.id&&s[GO]&&s[GO][KO](),(n=s.user)&&!n[ZO]&&n[KO](s.user.id),s=r,zx(i=t,"tags",[]),zx(i,"ext",{}),(l=e.context)[XO](i,s),l[QO](i,s),l[JO](i,s),l[eL](i,s),l[tL](i,s),l[rL](i,s),l.applyWebContext(i,s),l[nL](i,s),l[iL](i,s),l.cleanUp(i,s),n&&n[WO]&&(n[WO]=!1,a||(l=new vS(72,(Tv()||{}).userAgent||""),function(e,t,r){CS(e)[Pb](t,r)}(r.diagLog(),1,l))),e.processNext(t,r))},e._doTeardown=function(e,t){(e=(e||{}).core())&&e[$O]&&e[$O](!1)===n&&e.setTraceCtx(i),s()}})),s}return aw(t,e),t.__ieDyn=1,t}(zE),BL=FL,UL="AuthenticatedUserContext",jL="track",qL="snippet",HL="flush",VL="pollInternalLogs",GL="getPlugin",KL="evtNamespace",ZL=jL+"Event",WL=jL+"Trace",$L=jL+"Metric",YL=jL+"PageView",XL=jL+"Exception",QL=jL+"DependencyData",JL="set"+UL,eD="clear"+UL,tD="version",rD="queue",nD="connectionString",iD="instrumentationKey",oD="instrumentationkey",aD="userOverrideEndpointUrl",sD="endpointUrl",lD="ingestionendpoint",cD="onunloadFlush",uD="context",hD="addHousekeepingBeforeUnload",dD="sendMessage",pD=[qL,"dependencies","properties","_snippetVersion","appInsightsNew","getSKUDefaults"],fD="iKeyUsage",mD="CdnUsage",gD="SdkLoaderVer",yD=void 0,vD={disabled:!0,limit:nS({samplingRate:100,maxSendNumber:1}),interval:nS({monthInterval:3,daysOfMonth:[28]})},_D=((PL={})[nD]=yD,PL[sD]=yD,PL[iD]=yD,PL[aD]=yD,PL.diagnosticLogInterval=oS((function(e){return e&&0<e}),1e4),PL.featureOptIn=((ML={})[fD]={mode:3},ML[mD]={mode:2},ML[gD]={mode:2},ML),PL.throttleMgrCfg=nS(((RL={})[109]=nS(vD),RL[106]=nS(vD),RL[111]=nS(vD),RL[110]=nS(vD),RL)),PL.extensionConfig=nS(((OL={}).AppInsightsCfgSyncPlugin=nS({cfgUrl:"https://js.monitor.azure.com/scripts/b/ai.config.1.cfg.json",syncMode:2}),OL)),PL);var bD=function(){function e(t){var r,n,i,o,a,s,l,c,u,h,d,p,f,m,g=this;Fw(e,this,(function(e){v(),By(e,"config",{g:function(){return c}}),Vv(["pluginVersionStringArr","pluginVersionString"],(function(t){By(e,t,{g:function(){return l?l[t]:null}})})),o=""+(t.sv||t[tD]||""),t[rD]=t[rD]||[],t[tD]=t[tD]||2;var y=XC(t.config||{},_D);function v(){a=AC("AISKU"),d=o=i=n=r=s=null,m=f=p=!1,h=new kP}function _(){s&&(function(e,t){ST([lT,sT,aT],e,t)}(null,s),function(e,t){t=bT(cT,t),ST([aT],e,t),ST([oT],null,t)}(null,s))}function b(e){l.addUnloadHook(e)}c=y.cfg,u=new fP,By(e,"appInsights",{g:function(){return u}}),n=new BL,r=new UO,i=new oR,l=new WE,By(e,"core",{g:function(){return l}}),b(QC(y,(function(){var e,t,r=c[nD];function n(){return rx((function(e,t){jw(r,(function(t){var r=t&&t.value,n=null;!t.rejected&&r&&(n=dk(c[nD]=r)),e(n)}))}))}My(r)&&(e=rx((function(e,t){n().then((function(t){var r=c[iD];r=t&&t[oD]||r;e(r)})).catch((function(t){e(null)}))})),wy(t=c[aD])&&(t=rx((function(e,t){n().then((function(t){var r=c[sD];t=t&&t[lD];e(t?t+UT:r)})).catch((function(t){e(null)}))}))),c[iD]=e,c[sD]=t),Cy(r)&&(t=(e=dk(r))[lD],c.endpointUrl=c[aD]||t+UT,c[iD]=e[oD]||c[iD]),c.endpointUrl=c[aD]||c[sD]}))),e[qL]=t,e[HL]=function(e,t){var r;return lE(l,(function(){return"AISKU.flush"}),(function(){function n(){0===--i&&t()}e&&!t&&(r=ix((function(e){t=e})));var i=1;Vv(l.getChannels(),(function(t){t&&(i++,t[HL](e,n))})),n()}),null,e=void 0===e||e),r},e[cD]=function(e){void 0===e&&(e=!0),Vv(l.getChannels(),(function(t){t[cD]?t[cD]():t[HL](e)}))},e.loadAppInsights=function(t,a,s){return(t=void 0!==t&&t)&&function(e){throw new($v=$v||e_("UnsupportedError"))(e)}("Legacy Mode is no longer supported"),lE(e.core,(function(){return"AISKU.loadAppInsights"}),(function(){l.initialize(c,[i,n,r,u,h],a,s),By(e,"context",{g:function(){return n[uD]}}),d=d||new hk(l);var t,g=function(){if(!LL){var e=null;try{var t=(document||{}).currentScript;t&&(e=t.src)}catch(e){}if(e){try{var r,n=e.toLowerCase();n&&(r="",Vv(["://js.monitor.azure.com/","://az416426.vo.msecnd.net/"],(function(e,t){if(-1!==x_(n,e))return r="cdn"+(t+1),-1===x_(n,"/scripts/")&&(-1!==x_(n,"/next/")?r+="-next":-1!==x_(n,"/beta/")&&(r+="-beta")),LL=r+"",-1})))}catch(e){}LL=e}}return LL}();g&&e[uD]&&(e[uD].internal.sdkSrc=g),(t=e[qL])&&(g="",wy(o)||(g+=o),e[uD]&&e[uD].internal&&(e[uD].internal.snippetVer=g||"-"),Ny(e,(function(e,r){Cy(e)&&!Sy(r)&&e&&"_"!==e[0]&&-1===Gv(pD,e)&&t[e]!==r&&(t[e]=r)}))),e.emptyQueue(),e[VL](),e[hD](e),b(QC(y,(function(){var t=!1;c.throttleMgrCfg[109]&&(t=!c.throttleMgrCfg[109].disabled),!d.isReady()&&c.extensionConfig&&c.extensionConfig[h.identifier]&&t&&d.onReadyState(!0),p||c[nD]||!Hx(fD,c)||(d[dD](106,"See Instrumentation key support at aka.ms/IkeyMigrate"),p=!0),!f&&e[uD].internal.sdkSrc&&-1!=e[uD].internal.sdkSrc.indexOf("az416426")&&Hx(mD,c)&&(d[dD](110,"See Cdn support notice at aka.ms/JsActiveCdn"),f=!0),!m&&parseInt(o)<6&&Hx(gD,c)&&(d[dD](111,"An updated Sdk Loader is available, see aka.ms/SnippetVer"),m=!0)})))})),e},e.updateSnippetDefinitions=function(t){!function(e,t,r){if(e&&t&&Ey(e)&&Ey(t))for(var n in t)!function(n){var i;Cy(n)&&(i=t[n],Sy(i)?r&&!r(n,!0,t,e)||(e[n]=Fx(t,n)):r&&!r(n,!1,t,e)||(Dy(e,n)&&delete e[n],By(e,n,{g:function(){return t[n]},s:function(e){t[n]=e}})))}(n)}(t,e,(function(e){return e&&-1===Gv(pD,e)}))},e.emptyQueue=function(){try{if(Ty(e.snippet[rD])){for(var t=e.snippet[rD].length,r=0;r<t;r++)(0,e.snippet[rD][r])();e.snippet[rD]=void 0,delete e.snippet[rD]}}catch(t){t&&Sy(t.toString)&&t.toString()}},e[hD]=function(t){var r,n;(Sv()||xv())&&(n=!(r=function(){var r;t[cD](!1),Sy(e.core[GL])&&(r=g.core[GL](oA))&&(r=r.plugin)&&r[uD]&&r[uD]._sessionManager&&r[uD]._sessionManager.backup()}),s=s||bT(a,l[KL]&&l[KL]()),b(QC(c,(function(e){var i=AE(null,e=e.cfg,(i=t.appInsights).core).getExtCfg(i.identifier||sA);_(),e=e.disablePageUnloadEvents;i.disableFlushOnBeforeUnload||(ET(r,e,s)&&(n=!0),n=!!TT(r,e,s)||n)||function(){var e=Tv();return!(!e||!e.product)&&"ReactNative"===e.product}()||SS(l.logger,1,19,"Could not add handler for beforeunload and pagehide"),n||i.disableFlushOnUnload||TT(r,e,s)}))))},e.getSender=function(){return i},e.unload=function(t,r,n){var i,o=!1;return t&&!r&&(i=ix((function(e){r=e}))),e[cD](t),_(),l.unload&&l.unload(t,(function(e){o||(o=!0,v(),r&&r(e))}),n),i},Ux(e,u,["getCookieMgr",ZL,YL,"trackPageViewPerformance",XL,"_onerror",WL,$L,"startTrackPage","stopTrackPage","startTrackEvent","stopTrackEvent"]),Ux(e,(function(){return r}),[QL,"addDependencyListener","addDependencyInitializer"]),Ux(e,l,["addTelemetryInitializer",VL,"stopPollingInternalLogs",GL,"addPlugin",KL,"addUnloadCb","getTraceCtx","updateCfg","onCfgChange"]),Ux(e,(function(){var e=n[uD];return e?e.user:null}),[JL,eD])}))}return e.prototype.addDependencyInitializer=function(e){return null},e}();var wD,xD=function(){function e(e){this.options=e,!this.options.disableTelemetry&&yr&&(this.appInsights=new bD({config:{instrumentationKey:yr,disableExceptionTracking:!0,disableAjaxTracking:!0,isCookieUseDisabled:!0,maxBatchInterval:5e3}}),this.appInsights.loadAppInsights(),this.appInsights.addTelemetryInitializer((function(e){e.tags[rA.applicationVersion]=Xr.getFullVersion()})))}return e.prototype.trackEvent=function(e,t){!this.options.disableTelemetry&&this.appInsights&&this.appInsights.trackEvent(e,t)},e.prototype.setAuthenticatedUserContext=function(e,t){!this.options.disableTelemetry&&this.appInsights&&this.appInsights.setAuthenticatedUserContext(e,t)},e.prototype.trackException=function(e){!this.options.disableTelemetry&&this.appInsights&&this.appInsights.trackException(e)},e.prototype.flush=function(e){!this.options.disableTelemetry&&this.appInsights&&this.appInsights.flush(e)},e}(),CD=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),SD=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.copyrightMessage=void 0,t.copyrightContent=void 0,t.customAttribution=void 0,t.showFeedbackLink=!0,t.showLogo=!0,t}return CD(t,e),t}(Ur),ED=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),TD=function(e){function t(r){var n=e.call(this)||this;return n.textAttribution=function(e){return[n.options.copyrightMessage,n.options.customAttribution].filter((function(e){return e})).join("")},n.updateFeedbackLink=function(){var e,r;n.feedbackAnchor&&n.map&&(e=(r=n.map.getCamera()).center,r=r.zoom,n.feedbackAnchor.href="".concat(t.feedbackLink,"&cp=").concat(e[1],"~").concat(e[0],"&lvl=").concat(r+1))},n.options=(new SD).merge(r),n}return ED(t,e),t.prototype.onAdd=function(e){return this.map=e,this.container=this.buildContainer(e,ri.auto),this.container.className="map-copyright without-bg",this.copyrightDiv=this.buildCopyrightDiv(),this.copyrightDiv.className="azure-map-copyright",this.container.appendChild(this.copyrightDiv),this.options.showFeedbackLink&&this.addRemoveFeedbackDiv(!0),this.container},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),delete this.container},t.prototype.setOptions=function(e){var t,r=this;(e=(new SD).merge(this.options,e)).copyrightMessage===this.options.copyrightMessage&&e.customAttribution===this.options.customAttribution||(this.copyrightDiv.innerText=this.textAttribution(e)),e.copyrightContent!==this.options.copyrightContent&&(this.options.copyrightContent&&(t=Array.from(this.copyrightDiv.children).find((function(e){return e===r.options.copyrightContent})),this.copyrightDiv.removeChild(t)),0<this.copyrightDiv.childNodes.length?this.copyrightDiv.insertBefore(e.copyrightContent,this.copyrightDiv.childNodes[0]):this.copyrightDiv.appendChild(e.copyrightContent),this.options.copyrightContent=e.copyrightContent),!e.showFeedbackLink&&this.feedbackAnchor?this.addRemoveFeedbackDiv(!1):e.showFeedbackLink&&!this.feedbackAnchor&&this.addRemoveFeedbackDiv(!0),this.options=e},t.prototype.getDefaultAttributions=function(){var e=(new Date).getFullYear(),t=["\xa9".concat(e," TomTom")];return this.options.showLogo||t.push("\xa9".concat(e," Microsoft")),t},t.prototype.buildCopyrightDiv=function(){var e=document.createElement("div");return e.innerText=this.textAttribution(this.options)||"",e},t.prototype.buildFeedbackLink=function(){var e=document.createElement("a");return e.setAttribute("alt","Provide Map Data Feedback"),e.setAttribute("aria-label","Provide Map Data Feedback"),e.innerText="Feedback",e.href=t.feedbackLink,e.target="_blank",e.rel="noopener",e.className="azure-map-feedback-text",e},t.prototype.addRemoveFeedbackDiv=function(e){e?(this.feedbackAnchor=this.buildFeedbackLink(),this.feedbackTooltip=ii("Provide Map Data Feedback"),this.container.appendChild(this.feedbackAnchor),this.container.appendChild(this.feedbackTooltip),oi(this.feedbackTooltip,this.feedbackAnchor),null!=(e=null==(e=this.map)?void 0:e.events)&&e.add("moveend",this.updateFeedbackLink)):(this.feedbackAnchor.remove(),this.feedbackTooltip.remove(),delete this.feedbackTooltip,delete this.feedbackAnchor,null!=(e=null==(e=this.map)?void 0:e.events)&&e.remove("moveend",this.updateFeedbackLink))},t.feedbackLink="https://aka.ms/azuremaps-feedback?feedbackep=UrlAzureMapsWebSdk",t}(pi),ID=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),kD=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.showLogo=!0,t}return ID(t,e),t}(Ur),AD=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),PD=function(e){function t(r){var n=e.call(this)||this;return n.map=null,n._onResize=function(){var e=(null==(e=null==(e=n.map)?void 0:e.getMapContainer())?void 0:e.clientWidth)||0;n._setVisiblity(n.options.showLogo&&t.CONTAINER_MIN_WIDTH<=e)},n.options=(new kD).merge(r),n}return AD(t,e),t.prototype.onAdd=function(e){return this.map=e,this.container=this.buildContainer(e,ri.auto),this.container.className="map-logo-control",null!=(e=this.map)&&e.events.add("resize",this._onResize),this._addRemoveLogo(this.options.showLogo),this.container},t.prototype.onRemove=function(){var t;e.prototype.onRemove.call(this),null!=(t=this.map)&&t.events.remove("resize",this._onResize),this.map=null,delete this.container},t.prototype.setOptions=function(e){!(e=(new kD).merge(this.options,e)).showLogo&&this.logoAnchor?this._addRemoveLogo(!1):e.showLogo&&!this.logoAnchor&&this._addRemoveLogo(!0),this.options=e},t.prototype._addRemoveLogo=function(e){e?(this.logoAnchor=document.createElement("a"),this.logoAnchor.className="azure-map-logo",this.logoAnchor.href="https://aka.ms/azuremaps",this.logoAnchor.setAttribute("aria-label","Visit azure.microsoft.com"),this.logoAnchor.setAttribute("target","_blank"),this.container.appendChild(this.logoAnchor),this.logoTooltip=ii("Visit azure.microsoft.com"),this.container.appendChild(this.logoTooltip),oi(this.logoTooltip,this.logoAnchor),this._setVisiblity(!0)):(null!=(e=this.logoAnchor)&&e.remove(),null!=(e=this.logoTooltip)&&e.remove(),delete this.logoAnchor,this._setVisiblity(!1))},t.prototype._setVisiblity=function(e){this.container&&(this.container.style.display=e?"flex":"none")},t.CONTAINER_MIN_WIDTH=480,t}(pi),MD=function(){function e(){}return e.throwOnError=function(e,t){function r(e){throw n.off("error",r),e.error}var n=e instanceof _H?e._getMap():e;n.on("error",r),e=t();return n.off("error",r),e},e.tryCatch=function(e,t,r,n){try{return this.throwOnError(e,t)}catch(e){return r(e)}finally{"function"==typeof n&&n()}},e.tryFinally=function(e,t,r){try{return this.throwOnError(e,t)}finally{r()}},e}(),RD=window&&window.__assign||function(){return(RD=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},OD=function(){function e(e){this.map=e}return e.prototype.request=function(e){var t;e={domain:this.map.getServiceOptions().domain,path:"reverseGeocode",queryParams:RD({"api-version":"2023-06-01",coordinates:"".concat($p(e.position[0]),",").concat(Wp(e.position[1]))},e.style.view&&{view:e.style.view}),headers:{"Accept-Language":e.style.language}};return new Vr((null==(t=this.map.authentication)?void 0:t.signRequest(e))||e).get()},e}(),LD=function(){function e(){this._labelCache={},this._labelIdx={},this._preloadedCache=new Set}return e.prototype.cache=function(e,t,r,n){n="".concat(e,"_").concat(r[0],"_").concat(r[1],"_").concat(n),this._labelIdx[t.labelType]||(this._labelIdx[t.labelType]=[],this._labelCache[t.labelType]=[]),-1===this._labelIdx[t.labelType].indexOf(n)&&(this._labelCache[t.labelType].push({name:e,radius:t.radius,minZoom:t.minZoom,maxZoom:t.maxZoom||24,position:r}),this._labelIdx[t.labelType].push(n))},e.prototype.getNearestLabel=function(e,t,r){var n=null,i=this._labelCache[e];if(i)for(var o,a=1/0,s=0,l=i.length;s<l;s++)r>=i[s].minZoom&&r<=i[s].maxZoom&&(o=zp(i[s].position,t))<=i[s].radius&&o<=a&&(a=o,n=i[s]);return n},e.prototype._preloadCache=function(e){if(!this._preloadedCache.has(e)){this._preloadedCache.add(e);var t={source:[],labelType:"water",minZoom:0,radius:395e4,polygonSources:[]},r=e,n=r.indexOf("-");switch(r=-1!==n?r.substr(0,n):r){case"fr":this.cache("Oc\xe9an Pacifique",t,[-170,32],e),this.cache("Oc\xe9an Pacifique",t,[-138,-27],e),this.cache("Oc\xe9an Atlantique",t,[-40,32],e),this.cache("Oc\xe9an Atlantique",t,[-17,-29],e);break;case"es":this.cache("Oc\xe9an Pacifique",t,[-170,32],e),this.cache("Oc\xe9an Pacifique",t,[-138,-27],e),this.cache("Oc\xe9ano Atl\xe1ntico",t,[-40,32],e),this.cache("Oc\xe9ano Atl\xe1ntico",t,[-17,-29],e);break;case"pt":this.cache("Oceano Pac\xedfico",t,[-170,32],e),this.cache("Oceano Pac\xedfico",t,[-138,-27],e),this.cache("Oceano Atl\xe2ntico",t,[-40,32],e),this.cache("Oceano Atl\xe2ntico",t,[-17,-29],e);break;case"ja":this.cache("\u592a\u5e73\u6d0b",t,[-170,32],e),this.cache("\u592a\u5e73\u6d0b",t,[-138,-27],e);break;case"en":this.cache("Pacific Ocean",t,[-170,32],e),this.cache("Pacific Ocean",t,[-138,-27],e),this.cache("Atlantic Ocean",t,[-40,32],e),this.cache("Atlantic Ocean",t,[-17,-29],e),this.cache("Indian Ocean",t,[77,-26],e)}}},e}(),DD=window&&window.__awaiter||function(e,t,r,n){return new(r=r||Promise)((function(i,o){function a(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))},ND=window&&window.__generator||function(e,t){var r,n,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a={next:s(0),throw:s(1),return:s(2)};return"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(r)throw new TypeError("Generator is already executing.");for(;o=a&&c[a=0]?0:o;)try{if(r=1,n&&(i=2&c[0]?n.return:c[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,c[1])).done)return i;switch(n=0,(c=i?[2&c[0],i.value]:c)[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=0<(i=o.trys).length&&i[i.length-1])&&(6===c[0]||2===c[0])){o=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3]))o.label=c[1];else if(6===c[0]&&o.label<i[1])o.label=i[1],i=c;else{if(!(i&&o.label<i[2])){i[2]&&o.ops.pop(),o.trys.pop();continue}o.label=i[2],o.ops.push(c)}}c=t.call(e,o)}catch(l){c=[6,l],n=0}finally{r=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}},zD=window&&window.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=o.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a},FD=window&&window.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||((n=n||Array.prototype.slice.call(t,0,i))[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},BD=function(){function e(t,r){var n=this;this._disposed=!1,this._lastHeadingTime=0,this._actionQueue=[],this._pointerUpdateDelay=3e3,this._camUpdateDelay=1e3,this._headUpdateLimit=1e3,this._controlEventDelay=500,this._moveThreshold=25,this._headingThreshold=5,this._pitchThreshold=5,this._roadPixelRadius=120,this._minRoadDistance=25,this._minIntersectionPixelDistance=50,this._labelConfig=[{source:["Ocean label","Ocean name"],labelType:"water",minZoom:0,radius:395e4,polygonSources:["Ocean","Ocean or sea"]},{source:["Sea label"],labelType:"water",minZoom:3,radius:1e6,polygonSources:["Sea","Ocean or sea"]},{source:["Country name"],labelType:"country",minZoom:0,maxZoom:5,radius:3e5},{source:["State name","State name short"],labelType:"state",minZoom:4,maxZoom:7,radius:3e5},{source:["Capital city","Large city"],labelType:"city",minZoom:8,radius:4e4},{source:["Medium city"],labelType:"city",minZoom:8,radius:3e4},{source:["Small city"],labelType:"city",minZoom:8,radius:2e4},{source:["Island label"],labelType:"city",minZoom:8,radius:1e4},{source:["Town"],labelType:"city",minZoom:10,radius:1e4},{source:["Village"],labelType:"neighbourhood",minZoom:12,radius:6e3},{source:["Amusement area label"],labelType:"poi",minZoom:14,radius:2e3,polygonSources:["Amusement park"]},{source:["Hospital label"],labelType:"poi",minZoom:14,radius:1e3,polygonSources:["Hospital"]},{source:["Shopping centre label"],labelType:"poi",minZoom:14,radius:1e3,polygonSources:["Shopping"]},{source:["Stadium label"],labelType:"poi",minZoom:14,radius:1e3,polygonSources:["Stadium"]},{source:["University/School label"],labelType:"poi",minZoom:14,radius:1e3,polygonSources:["University"]},{source:["Zoo label"],labelType:"poi",minZoom:14,radius:1e3,polygonSources:["Zoo"]},{source:["Airport Label","Airport name","Airport POI"],labelType:"majorPoi",minZoom:11,radius:3e3,polygonSources:["Airport","Runway"]},{source:["National park label"],labelType:"majorPoi",minZoom:7,radius:15e3,polygonSources:["National or state park","National park","Forest"]},{source:["Reservation label"],labelType:"majorPoi",minZoom:7,radius:15e3,polygonSources:["Reservation"]}],this._labelCache=new Set(["city","state","country","water","majorPoi"]),this._roadLayers=new Set(["Connecting road","Connecting road tunnel","International road","International road tunnel","Local road","Local road tunnel","Major local road","Major local road tunnel","Major road","Major road tunnel","Minor local road","Minor local road tunnel","Motorway","Motorway tunnel","Secondary road","Secondary road tunnel","Toll connecting road","Toll connecting road tunnel","Toll international road","Toll international road tunnel","Toll local road","Toll local road tunnel","Toll major local road","Toll major local road tunnel","Toll major road","Toll major road tunnel","Toll minor local road","Toll minor local road tunnel","Toll motorway","Toll motorway tunnel","Toll secondary road","Toll secondary road tunnel"]),this._returnDetailedDescriptions=!1,this._shortcutListener=function(e){return DD(n,void 0,void 0,(function(){var t,r,n;return ND(this,(function(i){switch(i.label){case 0:return e.altKey&&e.ctrlKey&&68===e.keyCode?(this._returnDetailedDescriptions=!this._returnDetailedDescriptions,n=this._map.getCamera(),r=this._map.getStyle(),t=r.language.toLowerCase(),r=r.style.toLowerCase(),[4,this._getLocDesc(n,t,r)]):[3,2];case 1:n=i.sent(),this._descCallback(n),i.label=2;case 2:return[2]}}))}))},this._onRotate=function(){n._rotateTimeout||(Date.now()-n._lastHeadingTime>=n._headUpdateLimit?n._rotateTimeout=setTimeout(n._updateHeading,yi.RotationDuration+25):n._rotateTimeout=setTimeout(n._updateHeading,n._headUpdateLimit-(Date.now()-n._lastHeadingTime)))},this._onMove=function(){n._moveTimeout&&(clearTimeout(n._moveTimeout),delete n._moveTimeout),n._controlTimeout&&(clearTimeout(n._controlTimeout),delete n._controlTimeout)},this._onMoveEnd=function(e){e.fromControl?n._controlTimeout=setTimeout(n._updateCam,n._controlEventDelay):n._updateCam()},this._onStyleData=function(){setTimeout(n._updateStyle)},this._onPointerDown=function(e){n._lastPointerPos=n._getEventPos(e),n._pointerTimeout=setTimeout((function(){return DD(n,void 0,void 0,(function(){var e,t,r;return ND(this,(function(n){switch(n.label){case 0:return t=this._map.getStyle(),e=t.language.toLowerCase(),t=t.style.toLowerCase(),(r=this._map.getCamera()).center=this._map.pixelsToPositions([this._lastPointerPos])[0],[4,this._getLocDesc(r,e,t)];case 1:return r=n.sent(),this._descCallback(r),this._onPointerUp(),[2]}}))}))}),n._pointerUpdateDelay),n._map.getCanvas().addEventListener("mousemove",n._onPointerMove),n._map.getCanvas().addEventListener("touchmove",n._onPointerMove),n._map.getCanvas().addEventListener("mouseup",n._onPointerUp),n._map.getCanvas().addEventListener("touchend",n._onPointerUp)},this._onPointerMove=function(e){e=n._getEventPos(e);var t=n._lastPointerPos[0]-e[0];e=n._lastPointerPos[1]-e[1];Math.sqrt(t*t+e*e)>n._moveThreshold&&n._onPointerUp()},this._onPointerUp=function(){clearTimeout(n._pointerTimeout),delete n._pointerTimeout,n._map.getCanvas().removeEventListener("mousemove",n._onPointerMove),n._map.getCanvas().removeEventListener("touchmove",n._onPointerMove),n._map.getCanvas().removeEventListener("mouseup",n._onPointerUp),n._map.getCanvas().removeEventListener("touchend",n._onPointerUp)},this._updateHeading=function(){var e,t=n._map.getCamera();n._lastHead&&!n._checkHeadingThreshold(t.bearing,n._lastHead)||(e=n._getHeadingDesc(t),n._lastHead=t.bearing,n._descCallback("<p>Map heading ".concat(e,".</p>")),n._lastHeadingTime=Date.now()),delete n._rotateTimeout},this._updateStyle=function(){return DD(n,void 0,void 0,(function(){var t,r,n,i;return ND(this,(function(o){switch(o.label){case 0:return t=this._map.getCamera(),n=this._map.getStyle(),r=n.language.toLowerCase(),n=n.style.toLowerCase(),this._lastLang===r?[3,2]:(e._labelCache._preloadCache(r),[4,this._getLocDesc(t,r,n)]);case 1:return i=o.sent(),[3,4];case 2:return this._lastStyle===n||"blank"!==this._lastStyle?[3,4]:[4,this._getLocDesc(t,r,n)];case 3:i=o.sent(),o.label=4;case 4:return this._lastLang=r,this._lastStyle=n,i&&this._descCallback(i),[2]}}))}))},this._updateCam=function(e){void 0===e&&(e=!1);var t,r,i,o=n._map.getCamera();(!n._lastCam||0<n._actionQueue.length||n._checkThresholds(o,n._lastCam))&&(i=n._map.getStyle(),t=i.language.toLowerCase(),r=i.style.toLowerCase(),(i=n._getActionDesc(o))&&n._actionQueue.push(i),n._lastCam=o,n._moveTimeout&&(clearTimeout(n._moveTimeout),delete n._moveTimeout),n._moveTimeout=setTimeout((function(){return DD(n,void 0,void 0,(function(){var e;return ND(this,(function(n){switch(n.label){case 0:return clearTimeout(this._rotateTimeout),delete this._rotateTimeout,[4,this._getLocDesc(o,t,r)];case 1:return e=n.sent(),0<this._actionQueue.length?(this._descCallback("<p>Map ".concat(this._actionQueue.join(", then "),".</p>").concat(e)),this._actionQueue=[]):this._descCallback(e),[2]}}))}))}),e?0:n._camUpdateDelay))},this._map=t,this._restFallback=t.getServiceOptions().enableAccessibilityLocationFallback,this._descCallback=r,this._reverseSearch=new OD(t),e._labelCache||(e._labelCache=new LD),this._lastLang=this._map.getStyle().language.toLowerCase(),e._labelCache._preloadCache(this._lastLang),this._map.events.addOnce("idle",(function(){var t;n._disposed||(n._updateCam(!0),n._baseVectorTileSourceId=e._baseVectorTileSourceIds.find((function(e){return n._map.sources.getById(e)})),"bing-mvt"===n._baseVectorTileSourceId&&(n._labelConfig=e._labelConfigBing,n._roadLayers=e._roadLayersBing),n._polygonStyleLayer=n._labelConfig.reduce((function(e,t){return t.polygonSources&&e.push.apply(e,FD([],zD(t.polygonSources),!1)),e}),[]),(t=n._map._getMap()).on("move",n._onMove),t.on("moveend",n._onMoveEnd),t.on("styledata",n._onStyleData),t.on("rotate",n._onRotate),(t=n._map.getCanvas()).addEventListener("mousedown",n._onPointerDown),t.addEventListener("touchstart",n._onPointerDown))})),this._map.getMapContainer().addEventListener("keydown",this._shortcutListener)}return e.prototype.dispose=function(){var e;this._disposed=!0,(e=((e=this._map._getMap()).off("move",this._onMove),e.off("moveend",this._onMoveEnd),e.off("styledata",this._onStyleData),e.off("rotate",this._onRotate),this._map.getCanvas())).removeEventListener("mousedown",this._onPointerDown),e.removeEventListener("touchstart",this._onPointerDown),this._map.getMapContainer().removeEventListener("keydown",this._shortcutListener)},e.prototype._getEventPos=function(e){var t,r;return"touches"in e?(t=e.touches[0],r=e.target.getBoundingClientRect(),[t.pageX-r.left,t.pageY-r.top]):[e.offsetX,e.offsetY]},e.prototype._checkThresholds=function(e,t){return this._checkZoomThreshold(e.zoom,t.zoom)||this._checkPitchThreshold(e.pitch,t.pitch)||this._checkLocThreshold(e.center,t.center)||this._checkHeadingThreshold(e.bearing,t.bearing)},e.prototype._checkZoomThreshold=function(e,t){return this._round(e)!==this._round(t)},e.prototype._checkPitchThreshold=function(e,t){return Math.abs(e-t)>=this._pitchThreshold},e.prototype._checkLocThreshold=function(e,t){return e=(t=zD(this._map.positionsToPixels([t,e]),2))[0],t=t[1],hp.getDistance(e,t)>=this._moveThreshold},e.prototype._checkHeadingThreshold=function(e,t){return e<0&&(e+=360),t<0&&(t+=360),(e=180<(e=Math.abs(e-t))?360-e:e)>=this._headingThreshold},e.prototype._getLocDesc=function(t,r,n){return DD(this,void 0,void 0,(function(){var i,o,a,s,l,c,u,h,d,p=this;return ND(this,(function(f){switch(f.label){case 0:return"blank"===n?[3,3]:this._map._getMap().loaded()?[3,2]:[4,new Promise((function(e){return p._map._getMap().once("idle",e)}))];case 1:f.sent(),f.label=2;case 2:for(i={},o=this._map.positionsToPixels([t.center])[0],MD.tryCatch(this._map,(function(){var e=p._map._getMap();a=e.queryRenderedFeatures(o,{layers:p._polygonStyleLayer.filter((function(t){return e.getLayer(t)})),filter:["==",["geometry-type"],"Polygon"]})}),(function(){})),s=null,a&&0<a.length&&(s=a[0]),l=null,c=0,u=this._labelConfig.length;c<u;c++)h=this._labelConfig[c],t.zoom>=h.minZoom?h.polygonSources?s&&-1!==h.polygonSources.indexOf(s.layer["source-layer"])?(l=h.labelType,this._getClosestLabel(h,t,r,i,!1)):this._getClosestLabel(h,t,r,i,!0):this._getClosestLabel(h,t,r,i,!1):this._getClosestLabel(h,t,r,i,!0);return 8<=t.zoom&&this._processRoads(i,t,r),this._labelCache.forEach((function(r){!i[r]&&(d=null,d="water"!==r&&"majorPoi"!==r||r===l?e._labelCache.getNearestLabel(r,t.center,t.zoom):d)&&(i[r]=d.name)})),[2,this._processLocInfo(t,l,i,!0,this._restFallback)];case 3:return[2,this._processLocInfo(t,null,null,!1,!1)]}}))}))},e.prototype._getHeadingDesc=function(e){var t=e.bearing;switch(t<0&&(t+=360),t=this._round(t,this._headingThreshold)){case 0:case 360:return"north";case 45:return"north east";case 90:return"east";case 135:return"south east";case 180:return"south";case 225:return"south west";case 270:return"west";case 315:return"north west";default:return"".concat(t," degrees")}},e.prototype._getClosestLabel=function(t,r,n,i,o){for(var a=t.radius,s=0,l=t.source.length;s<l;s++){var c={sourceLayer:t.source[s],filter:["has","name"]},u=this._map._getMap().querySourceFeatures(this._baseVectorTileSourceId,c),h=null,d=1/0,p=this._labelCache.has(t.labelType);if(!o||p)for(var f=0,m=u.length;f<m;f++){var g,y="Point"===u[f].geometry.type?u[f]:hf(r.center,u[f].geometry);o||(g="Point"===u[f].geometry.type?zp(r.center,y.geometry.coordinates):y.properties.distance)<d&&(d=g,h=u[f]),p&&e._labelCache.cache(u[f].properties.name,t,y.geometry.coordinates,n)}o||(c=t.labelType+"Dis",h&&d<=a&&("number"!=typeof i[c]||d<=i[c])&&(i[t.labelType]=h.properties.name,i[c]=d))}},e.prototype._processRoads=function(t,r,n,i){var o=this._map._getMap().queryRenderedFeatures(i,{filter:["==",["geometry-type"],"LineString"]});if(o){for(var a,s=void 0,l=void 0,c=void 0,u=void 0,h=0,d=o.length;h<d;h++)this._roadLayers.has(o[h].layer["source-layer"])&&o[h].properties.name&&""!==o[h].properties.name&&(a=hf(r.center,o[h]),!c||a.properties.distance<c.properties.distance)&&(s&&o[h].properties.name===s.properties.name?c=a:s&&o[h].properties.name===s.properties.name?(!u||a.properties.distance<u.properties.distance)&&(u=a,l=o[h]):(u=c,l=s,c=a,s=o[h]));s&&(!t.country&&s.properties.country_code&&(t.country=s.properties.country_code,t.countryDis=0,e._labelCache.cache(t.country,{source:[],labelType:"country",radius:5e3,minZoom:0},c.geometry.coordinates,n)),!t.state&&s.properties.country_subdivision&&(t.state=s.properties.country_subdivision,t.stateDis=0,e._labelCache.cache(t.state,{source:[],labelType:"state",radius:5e3,minZoom:4},c.geometry.coordinates,n)),15<=r.zoom)&&(i=this._map.positionsToPixels([r.center,c.geometry.coordinates]),(hp.getDistance(i[0],i[1])<this._roadPixelRadius||c.properties.distance<this._minRoadDistance)&&(t.road=s.properties.name),l)&&(n=this._map.positionsToPixels([u.geometry.coordinates]),hp.getDistance(i[0],n[0])<this._minIntersectionPixelDistance||u.properties.distance<this._minRoadDistance)&&(t.secondRoad=l.properties.name,t.secondRoadDis=u.properties.distance)}},e.prototype._getActionDesc=function(e){var t,r,n;return this._lastCam&&(t=[],this._checkLocThreshold(e.center,this._lastCam.center)&&(n=["panned"],0===(r=Math.round(qp(this._lastCam.center,e.center)))||360===r?n.push("north"):r<90?n.push("north east"):90===r?n.push("east"):r<180?n.push("south east"):180===r?n.push("south"):r<270?n.push("south west"):270===r?n.push("west"):r<360&&n.push("north west"),r=zp(this._lastCam.center,e.center,ip.meters),n.push(1e3<r?"".concat(Lp(r/1e3,2)," kilometers"):"".concat(Lp(r,2)," meters")),t.push(n.join(" "))),this._checkZoomThreshold(e.zoom,this._lastCam.zoom)&&((n=["zoomed"]).push(this._lastCam.zoom<e.zoom?"in":"out"),1<=(r=Math.abs(this._lastCam.zoom-e.zoom))&&(r=Math.ceil(r),n.push("".concat(r,1<r?" levels":" level"))),this._getCanonicalZoom(this._lastCam.zoom)!==this._getCanonicalZoom(e.zoom)&&n.push("to ".concat(this._getCanonicalZoom(e.zoom)," level")),e.zoom>=e.maxZoom&&n.push("Zoom In button disabled, maximum zoom level reached"),r=bf.getSouth(e.bounds)<=-85.0511&&bf.getNorth(e.bounds)>=_p,(e.zoom<=e.minZoom||r)&&n.push("Zoom Out button disabled, minimum zoom level reached"),t.push(n.join(" "))),this._checkPitchThreshold(e.pitch,this._lastCam.pitch)&&(r=this._round(e.pitch,this._pitchThreshold),t.push("pitched to ".concat(r," degrees")),60!==e.pitch&&0!==e.pitch||(n=60===e.pitch?"maximum":"minimum",t.push("reached ".concat(n," of ").concat(e.pitch," degrees")))),this._checkHeadingThreshold(this._lastCam.bearing,e.bearing)&&t.push("rotated to ".concat(this._getHeadingDesc(e))),t.join(" and "))||null},e.prototype._getCanonicalZoom=function(e){return(e=this._round(e))<2?"world":e<5?"country":e<11?"state province":e<15?"city":"street"},e.prototype._processLocInfo=function(e,t,r,n,i){var o=this;return new Promise((function(a,s){var l=[];if(n){var c=[];if(r&&(t&&("water"===t&&r.water?c.push(r.water):"majorPoi"===t&&r.majorPoi&&c.push(r.majorPoi)),0===c.length)&&(r.majorPoi&&8<=e.zoom?c.push(r.majorPoi):(r.poi&&14<=e.zoom?c.push(r.poi):r.road&&15<=e.zoom&&(r.secondRoad?c.push(r.road+" & "+r.secondRoad):c.push(r.road)),r.neighbourhood&&12<=e.zoom&&c.push(r.neighbourhood),r.city&&6<=e.zoom&&c.push(r.city)),r.state&&4<=e.zoom&&c.push(r.state),0===c.length?r.water?c.push(r.water):r.country&&c.push(r.country):1===c.length&&r.state&&4<=e.zoom&&r.country&&c.push(r.country)),0<c.length)l.push("<p>Location: ",c.join(", "),".</p>");else if(i&&"water"!==t)return void o._reverseGeocodeDescription(e).then((function(e){a(e)}),(function(){s("<p>Location: unknown</p>")}))}o._returnDetailedDescriptions&&(l.push("<p>Zoom: ",Lp(e.zoom,2),".</p>"),l.push("<p>Latitude: ",Lp(e.center[1],5),".</p>"),l.push("<p>Longitude: ",Lp(e.center[0],5),".</p>")),a(l.join(""))}))},e.prototype._reverseGeocodeDescription=function(t){var r=this;return new Promise((function(n){var i=r._map.getStyle();r._reverseSearch.request({position:t.center,style:i}).then((function(o){var a,s={};o&&o.features&&0<o.features.length&&null!=(a=null==(a=o.features[0])?void 0:a.properties)&&a.address&&((a=o.features[0].properties.address).countryRegion&&(s.country=a.countryRegion.name,e._labelCache.cache(s.country,{source:[],labelType:"country",radius:5e3,minZoom:0},t.center,i.language)),a.adminDistricts&&(s.state=null==(o=a.adminDistricts[0])?void 0:o.shortName,e._labelCache.cache(s.state,{source:[],labelType:"state",radius:5e3,minZoom:4},t.center,i.language)),a.locality&&(s.city=a.locality,e._labelCache.cache(s.city,{source:[],labelType:"city",radius:1e3,minZoom:10},t.center,i.language)),a.addressLine)&&(s.road=a.addressLine),r._processLocInfo(t,null,s,!0,!1).then((function(e){n(e)}))}),(function(e){r._processLocInfo(t,null,null,!0,!1).then((function(e){n(e)}))})).catch((function(e){r._processLocInfo(t,null,null,!0,!1).then((function(e){n(e)}))}))}))},e.prototype._round=function(e,t){return void 0===t&&(t=1),Math.round(e/t)*t},e._baseVectorTileSourceIds=["microsoft.base","vectorTiles","bing-mvt"],e._labelConfigBing=[{source:["water_feature"],labelType:"water",minZoom:0,radius:395e4,polygonSources:["generic_water_fill"]},{source:["water_feature"],labelType:"water",minZoom:3,radius:1e6,polygonSources:["generic_water_fill"]},{source:["country_region"],labelType:"country",minZoom:0,maxZoom:5,radius:3e5},{source:["admin_division1"],labelType:"state",minZoom:4,maxZoom:7,radius:3e5},{source:["populated_place"],labelType:"city",minZoom:8,radius:4e4},{source:["neighborhood"],labelType:"neighbourhood",minZoom:12,radius:6e3},{source:["amusement_park"],labelType:"poi",minZoom:14,radius:2e3,polygonSources:["amusement_park_fill"]},{source:["hospital"],labelType:"poi",minZoom:14,radius:1e3,polygonSources:["hospital_fill"]},{source:["shopping_center"],labelType:"poi",minZoom:14,radius:1e3,polygonSources:["shopping_center_fill"]},{source:["stadium"],labelType:"poi",minZoom:14,radius:1e3,polygonSources:["stadium_fill"]},{source:["higher_education_facility","school"],labelType:"poi",minZoom:14,radius:1e3,polygonSources:["higher_education_facility_fill","school_fill"]},{source:["zoo"],labelType:"poi",minZoom:14,radius:1e3,polygonSources:["zoo_fill"]},{source:["airport","airport_terminal"],labelType:"majorPoi",minZoom:11,radius:3e3,polygonSources:["airport_terminal_fill","airport_fill-merged7","airport_runway_fill"]},{source:["reserve"],labelType:"majorPoi",minZoom:7,radius:15e3,polygonSources:["generic_reserve_fill","land_cover_forest_fill"]}],e._roadLayersBing=new Set(["road"]),e}(),UD=function(e){var t=this;this.addToMap=function(){null==t.mapViewDesc&&(t.initializeMapLiveStateInfo(),t.initializeMapStyleInfo(),t.createMapKeyBindingInfo(),t.map.getMapContainer().setAttribute("role","application"),t.map.getMapContainer().setAttribute("aria-label","Map Application"),t.map.getCanvasContainer().setAttribute("aria-live","polite"),t.map.getCanvasContainer().setAttribute("aria-describedby","atlas-map-state atlas-map-style"),t.map.getCanvas().setAttribute("aria-label","Interactive Map"),t.map.getCanvas().setAttribute("aria-describedby","atlas-map-shortcuts"),t.map.getCanvas().setAttribute("alt","Interactive Map"))},this.removeFromMap=function(){null!=t.mapViewDesc&&t.mapViewDesc.dispose(),delete t.mapViewDesc,null!=t.atlasMapKeyBindings&&t.map.getCanvasContainer().removeChild(t.atlasMapKeyBindings),delete t.atlasMapKeyBindings,null!=t.atlasMapLiveStateInfo&&t.map.getCanvasContainer().removeChild(t.atlasMapLiveStateInfo),delete t.atlasMapLiveStateInfo,null!=t.atlasMapStyleInfo&&t.map.getCanvasContainer().removeChild(t.atlasMapStyleInfo),delete t.atlasMapStyleInfo,t.map.getMapContainer().removeAttribute("role"),t.map.getMapContainer().removeAttribute("aria-label"),t.map.getCanvasContainer().removeAttribute("aria-live"),t.map.getCanvasContainer().removeAttribute("aria-describedby"),t.map.getCanvas().removeAttribute("aria-label"),t.map.getCanvas().removeAttribute("aria-describedby"),t.map.getCanvas().removeAttribute("alt"),t.map.events.remove("stylechanged",t.updateMapStyle)},this.createMapKeyBindingInfo=function(){t.atlasMapKeyBindings=document.createElement("div"),t.atlasMapKeyBindings.setAttribute("tabindex","-1"),t.atlasMapKeyBindings.setAttribute("aria-hidden","true"),t.atlasMapKeyBindings.id="atlas-map-shortcuts",t.atlasMapKeyBindings.classList.add("hidden-accessible-element"),t.atlasMapKeyBindings.innerHTML=["Map shortcuts:","Zoom out: hyphen.","Zoom in: plus.","Pan right 100 pixels: right arrow.","Pan left 100 pixels: left arrow.","Pan up 100 pixels: up arrow.","Pan down 100 pixels: down arrow.","Rotate 15 degrees clockwise: shift + right arrow.","Rotate 15 degrees counter clockwise: shift + left arrow.","Increase pitch 10 degrees: shift + up arrow.","Decrease pitch 10 degrees: shift + down arrow.","Jump focus to the map: Escape."].join("\n"),t.map.getCanvasContainer().appendChild(t.atlasMapKeyBindings);var e=[189,187,38,37,39,40],r=t.map._getMap()._canvas;null!=r&&r.addEventListener("keyup",(function(r){e.find((function(e){return r.keyCode===e}))&&(t.atlasMapKeyBindings.innerHTML="")}))},this.initializeMapLiveStateInfo=function(){t.mapViewDesc=new BD(t.map,t.updateMapState),t.atlasMapLiveStateInfo=document.createElement("div"),t.atlasMapLiveStateInfo.setAttribute("tabindex","-1"),t.atlasMapLiveStateInfo.setAttribute("aria-hidden","true"),t.atlasMapLiveStateInfo.id="atlas-map-state",t.atlasMapLiveStateInfo.classList.add("hidden-accessible-element"),t.map.getCanvasContainer().appendChild(t.atlasMapLiveStateInfo)},this.initializeMapStyleInfo=function(){t.atlasMapStyleInfo=document.createElement("div"),t.atlasMapStyleInfo.setAttribute("tabindex","-1"),t.atlasMapStyleInfo.setAttribute("aria-hidden","true"),t.atlasMapStyleInfo.id="atlas-map-style",t.atlasMapStyleInfo.classList.add("hidden-accessible-element"),t.map.events.add("stylechanged",t.updateMapStyle),t.map.getCanvasContainer().appendChild(t.atlasMapStyleInfo)},this.updateMapStyle=function(){t.atlasMapStyleInfo.innerHTML="<p>Map style: ".concat(t.map.getStyle().style,".</p>")},this.updateMapState=function(e){t.atlasMapLiveStateInfo.innerHTML=e},this.map=e},jD=function(e){var t=this;this.listenerEnabled=!1,this.lastFlowMode="none",this.addToMap=function(){if(!t.map._isReady())throw new Error("Traffic flow could not be added to the map because the map is not ready. Please use a ready event listener to guarantee the map is ready before enabling traffic flow.");t.listenerEnabled||(t.map.events.add("styledata",t.addToMap),t.listenerEnabled=!0);var e,r=t.map.getTraffic();"none"!==r.flow&&(e=t.map.layers.getLayerById("traffic_".concat(r.flow)))&&(t.lastFlowMode=r.flow,e._updateLayoutProperty("visibility","visible","none"))},this.removeFromMap=function(){var e;t.map.getTraffic(),"none"!=t.lastFlowMode&&((e=t.map.layers.getLayerById("traffic_".concat(t.lastFlowMode)))&&e._updateLayoutProperty("visibility","none","visible"),t.lastFlowMode="none"),t.listenerEnabled&&(t.map.events.remove("styledata",t.addToMap),t.listenerEnabled=!1)},this.map=e},qD=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),HD=function(e){function t(r,n,i){var o=null!=(o=null!=(o=null!=(o=null!=(o=null!=(o=null!=(o=null!=(o=null!=(o=null!=(o=null!=(o=null!=(o=null!=(o=null!=(o=r.icon_category_12)?o:r.icon_category_11)?o:r.icon_category_10)?o:r.icon_category_9)?o:r.icon_category_8)?o:r.icon_category_7)?o:r.icon_category_6)?o:r.icon_category_5)?o:r.icon_category_4)?o:r.icon_category_3)?o:r.icon_category_2)?o:r.icon_category_1)?o:r.icon_category_0)?o:r.icon_category,a=null!=(a=null!=(a=null!=(a=null!=(a=null!=(a=null!=(a=null!=(a=null!=(a=null!=(a=null!=(a=null!=(a=null!=(a=null!=(a=r.description_12)?a:r.description_11)?a:r.description_10)?a:r.description_9)?a:r.description_8)?a:r.description_7)?a:r.description_6)?a:r.description_5)?a:r.description_4)?a:r.description_3)?a:r.description_2)?a:r.description_1)?a:r.description_0)?a:r.description;o={icon:"".concat(t.getSeverityColorName(r.magnitude),"-").concat(t.getIncidentTypeIconName(o)),incidentType:t.getIncidentTypeName(o,i),description:a,delay:r.delay,color:t.getSeverityColorHexCode(r.magnitude),id:r.id};return e.call(this,n,o)||this}return qD(t,e),t.getIncidentTypeName=function(e,t){switch(e){case 0:default:return t.Unknown;case 1:return t.Accident;case 2:return t.Fog;case 3:return t.Danger;case 4:return t.Rain;case 5:return t.Ice;case 6:return t.Jam;case 7:return t.LaneClosed;case 8:return t.RoadClosed;case 9:return t.RoadWorks;case 10:return t.Wind;case 11:return t.Flood;case 12:return t.Detour}},t.getIncidentTypeIconName=function(e){switch(e){case 0:default:return"unknown";case 1:return"accident";case 2:return"fog";case 3:return"danger";case 4:return"rain";case 5:return"ice";case 6:return"jam";case 7:return"lane-closed";case 8:return"road-closed";case 9:return"road-work";case 10:return"wind";case 11:return"flood";case 12:return"detour"}},t.getSeverityColorName=function(e){switch(e){case 0:default:return"grey";case 1:return"yellow";case 2:return"orange";case 3:return"red"}},t.getSeverityColorHexCode=function(e){switch(e){case 0:default:return"#B5B6B7";case 1:return"#F4C951";case 2:return"#F4873F";case 3:return"#F04F4E"}},t}(cp),VD=(function(e){e.DELAY="delay",e.LENGTH="length",e.FROM="from",e.TO="to"}(wD=wD||{}),function(){function e(){}return e.build=function(e,t){void 0===t&&(t="en-US");var r,n,i,o=((i=((n=document.createElement("div")).classList.add("incident-popup-title"),n.classList.add("font-segoeui-b"),n.innerText=e.properties.incidentType,n.setAttribute("aria-label","Incident Type ".concat(e.properties.incidentType)),document.createElement("div"))).classList.add("incident-popup-subtitle"),i.classList.add("font-segoeui-b"),i.setAttribute("aria-label","Incident Description ".concat(e.properties.description)),i.innerText=e.properties.description,document.createElement("div"));return(i=((n=(o.classList.add("incident-popup-header"),o.style.backgroundColor=e.properties.color,o.appendChild(n),o.appendChild(i),document.createElement("div"))).classList.add("incident-popup-body"),e.properties.delay&&(i="".concat(Math.floor(e.properties.delay/60)," min"),i=this.createInfoSection(i,wD.DELAY),n.appendChild(i)),e.properties.length&&(i=new Intl.NumberFormat([t,"en-US"],{maximumFractionDigits:2}),r=void 0,r="en-US"===t?(t=Dp(e.properties.length,"meters","miles"),"".concat(i.format(t)," miles")):(t=Dp(e.properties.length,"meters","kilometers"),"".concat(i.format(t)," km")),i=this.createInfoSection(r,wD.LENGTH),n.appendChild(i)),e.properties.from&&(t=this.createInfoSection(e.properties.from,wD.FROM),n.appendChild(t)),e.properties.to&&(r=this.createInfoSection(e.properties.to,wD.TO),n.appendChild(r)),document.createElement("div"))).classList.add("incident-popup-content"),i.appendChild(o),i.appendChild(n),new jg({content:i,position:e.geometry.coordinates})},e.createInfoSection=function(e,t){var r=document.createElement("div"),n=(r.classList.add("incident-popup-info"),document.createElement("div")),i=(n.classList.add("icon"),n.classList.add(t),document.createElement("span"));return i.classList.add("message"),i.classList.add("font-segoeui"),i.setAttribute("aria-label","Incident ".concat(t," ").concat(e)),i.innerText=e,r.appendChild(n),r.appendChild(i),r},e}()),GD=window&&window.__awaiter||function(e,t,r,n){return new(r=r||Promise)((function(i,o){function a(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))},KD=window&&window.__generator||function(e,t){var r,n,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a={next:s(0),throw:s(1),return:s(2)};return"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(r)throw new TypeError("Generator is already executing.");for(;o=a&&c[a=0]?0:o;)try{if(r=1,n&&(i=2&c[0]?n.return:c[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,c[1])).done)return i;switch(n=0,(c=i?[2&c[0],i.value]:c)[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=0<(i=o.trys).length&&i[i.length-1])&&(6===c[0]||2===c[0])){o=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3]))o.label=c[1];else if(6===c[0]&&o.label<i[1])o.label=i[1],i=c;else{if(!(i&&o.label<i[2])){i[2]&&o.ops.pop(),o.trys.pop();continue}o.label=i[2],o.ops.push(c)}}c=t.call(e,o)}catch(l){c=[6,l],n=0}finally{r=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}},ZD=function(){function e(e){var t=this;this.incidentLayerName="incidents",this.incidentSourceName="mapcontrol_traffic_incident",this.addToMap=function(){t.map.sources.getById(t.incidentSourceName)||t.map.sources.add(t.vectorTileSource),t.map.layers.getLayerById(t.incidentLayerName)||t.map.layers.add(t.incidentLayer,"labels"),t.clickPopup=new jg({position:[0,0],pixelOffset:[0,-18]}),t.map.addEventListener("mouseover",t.incidentLayerName,t.cursorToPointer),t.map.addEventListener("mouseleave",t.incidentLayerName,t.cursorToDefault),t.map.addEventListener("click",t.incidentLayerName,t.openIncidentPopup),t.map.events.addOnce("idle",t.setAccessiblePopups),t.map.events.add("moveend",t.setAccessiblePopups)},this.accessiblePopups=[],this.setAccessiblePopups=function(){return GD(t,void 0,void 0,(function(){var e,t,r,n,i,o,a=this;return KD(this,(function(s){switch(s.label){case 0:return this.accessiblePopups.forEach((function(e){return e.remove()})),this.accessiblePopups=[],e=this.map.layers.getRenderedShapes(this.map.getCamera().bounds,this.incidentLayer),[4,this.map._getLocalizedStrings()];case 1:return t=s.sent(),r=function(e,s){var l=(c=e[s]).geometry.coordinates,c=(l=new dp(new pf(l[0],l[1])),new HD(c.properties,l,t)),u=VD.build(c,a.incidentLanguage);return(l=u.getPopupContainer()).addEventListener("focusin",(function(t){a.clickPopup.remove(),a.accessiblePopups.filter((function(e){return e!==u})).forEach((function(e){return e.remove()})),0<=s-1&&n(u,r(e,s-1)),s+1<e.length&&o(r(e,s+1)),2<=s&&s==e.length-1&&i(r(e,0)),0==s&&2<=e.length&&o(r(e,e.length-1))})),s==e.length-1&&l.addEventListener("focusout",(function(e){null===e.relatedTarget&&u.close()})),a.accessiblePopups.push(u),u},n=function(e,t){t.open(a.map),t.close(),t=t.getPopupContainer(),(e=e.getPopupContainer()).parentElement.insertBefore(t,e)},i=function(e){e.open(a.map),e.close();var t=(e=e.getPopupContainer()).parentElement;t.insertBefore(e,t.firstElementChild)},o=function(e){e.open(a.map),e.close()},0<e.length&&o(r(e,0)),1<e.length&&o(r(e,e.length-1)),[2]}}))}))},this.removeFromMap=function(){var e;t.map.removeEventListener("mouseover",t.incidentLayerName,t.cursorToPointer),t.map.removeEventListener("mouseleave",t.incidentLayerName,t.cursorToDefault),t.map.removeEventListener("click",t.incidentLayerName,t.openIncidentPopup),t.map.events.remove("idle",t.setAccessiblePopups),t.map.events.remove("moveend",t.setAccessiblePopups),t.accessiblePopups.forEach((function(e){return e.remove()})),t.accessiblePopups=[],null!=(e=t.clickPopup)&&e.remove(),null!=t.map.layers.getLayerById(t.incidentLayerName)&&t.map.layers.remove(t.incidentLayerName),null!=t.map.sources.getById(t.incidentSourceName)&&t.map.sources.remove(t.incidentSourceName)},this.cursorToPointer=function(e){t.map.getCanvas().style.cursor="pointer"},this.cursorToDefault=function(e){t.map.getCanvas().style.cursor=""},this.openIncidentPopup=function(e){t.clickPopup.remove(),t.accessiblePopups.forEach((function(e){return e.close()}));var r=e.position,n=e.features[0];t.map._getLocalizedStrings().then((function(e){var i=new dp(new pf(r[0],r[1]));i=new HD(n.properties,i,e);t.clickPopup=VD.build(i,t.incidentLanguage),t.clickPopup.open(t.map),t.clickPopup.getPopupContainer().addEventListener("focusout",(function(e){null===e.relatedTarget&&t.clickPopup.close()}))}))},this.map=e,this.vectorTileSource=new lm(this.incidentSourceName,{maxZoom:22,tiles:["https://".concat(Cr,"/traffic/incident/tile/pbf?api-version=1.0&zoom={z}&x={x}&y={y}")]}),e=this.getIncidentIconImageExpression();this.incidentLayer=new yg(this.incidentSourceName,this.incidentLayerName,{sourceLayer:"Traffic incident POI",iconOptions:{ignorePlacement:!0,allowOverlap:!0,image:e,size:.75}})}return e.prototype.getIncidentIconImageExpression=function(){return["concat",["let","magnitude",["get","magnitude"],["case",["==",["var","magnitude"],0],"grey",["==",["var","magnitude"],1],"yellow",["==",["var","magnitude"],2],"orange",["==",["var","magnitude"],3],"red",["==",["var","magnitude"],4],"grey","grey"]],"-",["let","category",["coalesce",["get","icon_category_12"],["get","icon_category_11"],["get","icon_category_10"],["get","icon_category_9"],["get","icon_category_8"],["get","icon_category_7"],["get","icon_category_6"],["get","icon_category_5"],["get","icon_category_4"],["get","icon_category_3"],["get","icon_category_2"],["get","icon_category_0"],["get","icon_category"],0],["case",["==",["var","category"],0],"unknown",["==",["var","category"],1],"accident",["==",["var","category"],2],"fog",["==",["var","category"],3],"danger",["==",["var","category"],4],"rain",["==",["var","category"],5],"ice",["==",["var","category"],6],"jam",["==",["var","category"],7],"lane-closed",["==",["var","category"],8],"road-closed",["==",["var","category"],9],"road-work",["==",["var","category"],10],"wind",["==",["var","category"],11],"flood",["==",["var","category"],12],"detour","unknown"]]]},e}(),WD=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),$D=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.interactive=!0,t.scrollZoomInteraction=!0,t.boxZoomInteraction=!0,t.dragRotateInteraction=!0,t.dragPanInteraction=!0,t.keyboardInteraction=!0,t.dblClickZoomInteraction=!0,t.touchInteraction=!0,t.touchRotate=!0,t.wheelZoomRate=1/450,t}return WD(t,e),t}(Ur),YD=function(){function e(e){var t=this;this._onKeyDown=function(e){27===e.keyCode&&t.map.getCanvas().focus()},this.map=e}return e.prototype.enable=function(){this.map.getMapContainer().addEventListener("keydown",this._onKeyDown)},e.prototype.disable=function(){this.map.getMapContainer().removeEventListener("keydown",this._onKeyDown)},e}(),XD=function(){function e(e){var t=this;this._onGestureStart=function(e){t.hasTouch||(e.preventDefault(),t.initZoom=t.map.getCamera().zoom)},this._onGestureChange=function(e){t.hasTouch||(e.preventDefault(),t.map.setCamera({zoom:t.initZoom+e.scale-1}))},this._onTouchStart=function(e){t.hasTouch=!0},this._onTouchEnd=function(e){0===e.touches.length&&(t.hasTouch=!1)},this.map=e}return e.prototype.enable=function(){this.map.getCanvasContainer().addEventListener("gesturestart",this._onGestureStart),this.map.getCanvasContainer().addEventListener("gesturechange",this._onGestureChange),this.map.getCanvasContainer().addEventListener("touchstart",this._onTouchStart),this.map.getCanvasContainer().addEventListener("touchend",this._onTouchEnd)},e.prototype.disable=function(){this.map.getCanvasContainer().removeEventListener("gesturestart",this._onGestureStart),this.map.getCanvasContainer().removeEventListener("gesturechange",this._onGestureChange),this.map.getCanvasContainer().removeEventListener("touchstart",this._onTouchStart),this.map.getCanvasContainer().removeEventListener("touchend",this._onTouchEnd)},e}(),QD=function(){function e(e,t){this.added=!1,this.map=e,this.focusShortcut=new YD(e),this.pinchZoom=new XD(e),this.options=(new $D).merge(t)}return e.prototype.addToMap=function(){this.added||(this.added=!0,this._setInteractions(this.options))},e.prototype.removeFromMap=function(){this.added&&(this.added=!1,this._setInteractions({interactive:!1}))},e.prototype.setOptions=function(e){this.options=(new $D).merge(this.options,e),this.added&&this._setInteractions(this.options)},e.prototype.getOptions=function(){return Object.assign({},this.options)},e.prototype._setInteractions=function(e){var t;e.interactive?(e.boxZoomInteraction?this.map._getMap().boxZoom.enable():this.map._getMap().boxZoom.disable(),e.dblClickZoomInteraction?this.map._getMap().doubleClickZoom.enable():this.map._getMap().doubleClickZoom.disable(),e.dragPanInteraction?this.map._getMap().dragPan.enable():this.map._getMap().dragPan.disable(),e.dragRotateInteraction?this.map._getMap().dragRotate.enable():this.map._getMap().dragRotate.disable(),e.keyboardInteraction?(this.map._getMap().keyboard.enable(),this.focusShortcut.enable()):(this.map._getMap().keyboard.disable(),this.focusShortcut.disable()),e.scrollZoomInteraction?(this.map._getMap().scrollZoom.enable(),this.map._getMap().scrollZoom.setWheelZoomRate(e.wheelZoomRate)):this.map._getMap().scrollZoom.disable(),t=this.map._getMap().touchZoomRotate,e.touchInteraction?(t.enable(),e.touchRotate?t.enableRotation():t.disableRotation()):t.disable(),this.pinchZoom.enable()):(this.map._getMap().boxZoom.disable(),this.map._getMap().doubleClickZoom.disable(),this.map._getMap().dragPan.disable(),this.map._getMap().dragRotate.disable(),this.map._getMap().keyboard.disable(),this.focusShortcut.disable(),this.map._getMap().scrollZoom.disable(),this.map._getMap().touchZoomRotate.disable(),this.pinchZoom.disable())},e}();function JD(e,t,r){var n={type:"Feature"};return 0!==(r=void 0===r?{}:r).id&&!r.id||(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=t||{},n.geometry=e,n}function eN(e){return"Feature"===e.type?e.geometry:e}var tN={exports:{}},rN=(tN.exports=function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function r(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}var n=function(e,t){this.next=null,this.key=e,this.data=t,this.left=null,this.right=null};function i(e,t){return e>t?1:e<t?-1:0}function o(e,t,r){for(var i=new n(null,null),o=i,a=i;;){var s=r(e,t.key);if(s<0){if(null===t.left)break;if(r(e,t.left.key)<0){var l=t.left;if(t.left=l.right,l.right=t,null===(t=l).left)break}a.left=t,a=t,t=t.left}else{if(!(s>0))break;if(null===t.right)break;if(r(e,t.right.key)>0){l=t.right;if(t.right=l.left,l.left=t,null===(t=l).right)break}o.right=t,o=t,t=t.right}}return o.right=t.left,a.left=t.right,t.left=i.right,t.right=i.left,t}function a(e,t,r,i){var a=new n(e,t);if(null===r)return a.left=a.right=null,a;var s=i(e,(r=o(e,r,i)).key);return s<0?(a.left=r.left,a.right=r,r.left=null):s>=0&&(a.right=r.right,a.left=r,r.right=null),a}function s(e,t,r){var n=null,i=null;if(t){var a=r((t=o(e,t,r)).key,e);0===a?(n=t.left,i=t.right):a<0?(i=t.right,t.right=null,n=t):(n=t.left,t.left=null,i=t)}return{left:n,right:i}}function l(e,t,r,n,i){if(e){n(t+(r?"\u2514\u2500\u2500 ":"\u251c\u2500\u2500 ")+i(e)+"\n");var o=t+(r?"    ":"\u2502   ");e.left&&l(e.left,o,!1,n,i),e.right&&l(e.right,o,!0,n,i)}}var c=function(){function e(e){void 0===e&&(e=i),this._root=null,this._size=0,this._comparator=e}return e.prototype.insert=function(e,t){return this._size++,this._root=a(e,t,this._root,this._comparator)},e.prototype.add=function(e,t){var r=new n(e,t);null===this._root&&(r.left=r.right=null,this._size++,this._root=r);var i=this._comparator,a=o(e,this._root,i),s=i(e,a.key);return 0===s?this._root=a:(s<0?(r.left=a.left,r.right=a,a.left=null):s>0&&(r.right=a.right,r.left=a,a.right=null),this._size++,this._root=r),this._root},e.prototype.remove=function(e){this._root=this._remove(e,this._root,this._comparator)},e.prototype._remove=function(e,t,r){var n;return null===t?null:0===r(e,(t=o(e,t,r)).key)?(null===t.left?n=t.right:(n=o(e,t.left,r)).right=t.right,this._size--,n):t},e.prototype.pop=function(){var e=this._root;if(e){for(;e.left;)e=e.left;return this._root=o(e.key,this._root,this._comparator),this._root=this._remove(e.key,this._root,this._comparator),{key:e.key,data:e.data}}return null},e.prototype.findStatic=function(e){for(var t=this._root,r=this._comparator;t;){var n=r(e,t.key);if(0===n)return t;t=n<0?t.left:t.right}return null},e.prototype.find=function(e){return this._root&&(this._root=o(e,this._root,this._comparator),0!==this._comparator(e,this._root.key))?null:this._root},e.prototype.contains=function(e){for(var t=this._root,r=this._comparator;t;){var n=r(e,t.key);if(0===n)return!0;t=n<0?t.left:t.right}return!1},e.prototype.forEach=function(e,t){for(var r=this._root,n=[],i=!1;!i;)null!==r?(n.push(r),r=r.left):0!==n.length?(r=n.pop(),e.call(t,r),r=r.right):i=!0;return this},e.prototype.range=function(e,t,r,n){for(var i=[],o=this._comparator,a=this._root;0!==i.length||a;)if(a)i.push(a),a=a.left;else{if(o((a=i.pop()).key,t)>0)break;if(o(a.key,e)>=0&&r.call(n,a))return this;a=a.right}return this},e.prototype.keys=function(){var e=[];return this.forEach((function(t){var r=t.key;return e.push(r)})),e},e.prototype.values=function(){var e=[];return this.forEach((function(t){var r=t.data;return e.push(r)})),e},e.prototype.min=function(){return this._root?this.minNode(this._root).key:null},e.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},e.prototype.minNode=function(e){if(void 0===e&&(e=this._root),e)for(;e.left;)e=e.left;return e},e.prototype.maxNode=function(e){if(void 0===e&&(e=this._root),e)for(;e.right;)e=e.right;return e},e.prototype.at=function(e){for(var t=this._root,r=!1,n=0,i=[];!r;)if(t)i.push(t),t=t.left;else if(i.length>0){if(t=i.pop(),n===e)return t;n++,t=t.right}else r=!0;return null},e.prototype.next=function(e){var t=this._root,r=null;if(e.right){for(r=e.right;r.left;)r=r.left;return r}for(var n=this._comparator;t;){var i=n(e.key,t.key);if(0===i)break;i<0?(r=t,t=t.left):t=t.right}return r},e.prototype.prev=function(e){var t=this._root,r=null;if(null!==e.left){for(r=e.left;r.right;)r=r.right;return r}for(var n=this._comparator;t;){var i=n(e.key,t.key);if(0===i)break;i<0?t=t.left:(r=t,t=t.right)}return r},e.prototype.clear=function(){return this._root=null,this._size=0,this},e.prototype.toList=function(){return function(e){var t=e,r=[],i=!1,o=new n(null,null),a=o;for(;!i;)t?(r.push(t),t=t.left):r.length>0?t=(t=a=a.next=r.pop()).right:i=!0;return a.next=null,o.next}(this._root)},e.prototype.load=function(e,t,r){void 0===t&&(t=[]),void 0===r&&(r=!1);var i=e.length,o=this._comparator;if(r&&d(e,t,0,i-1,o),null===this._root)this._root=u(e,t,0,i),this._size=i;else{var a=function(e,t,r){var i=new n(null,null),o=i,a=e,s=t;for(;null!==a&&null!==s;)r(a.key,s.key)<0?(o.next=a,a=a.next):(o.next=s,s=s.next),o=o.next;null!==a?o.next=a:null!==s&&(o.next=s);return i.next}(this.toList(),function(e,t){for(var r=new n(null,null),i=r,o=0;o<e.length;o++)i=i.next=new n(e[o],t[o]);return i.next=null,r.next}(e,t),o);i=this._size+i,this._root=h({head:a},0,i)}return this},e.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),e.prototype.toString=function(e){void 0===e&&(e=function(e){return String(e.key)});var t=[];return l(this._root,"",!0,(function(e){return t.push(e)}),e),t.join("")},e.prototype.update=function(e,t,r){var n=this._comparator,i=s(e,this._root,n),l=i.left,c=i.right;n(e,t)<0?c=a(t,r,c,n):l=a(t,r,l,n),this._root=function(e,t,r){return null===t?e:(null===e||((t=o(e.key,t,r)).left=e),t)}(l,c,n)},e.prototype.split=function(e){return s(e,this._root,this._comparator)},e}();function u(e,t,r,i){var o=i-r;if(o>0){var a=r+Math.floor(o/2),s=e[a],l=t[a],c=new n(s,l);return c.left=u(e,t,r,a),c.right=u(e,t,a+1,i),c}return null}function h(e,t,r){var n=r-t;if(n>0){var i=t+Math.floor(n/2),o=h(e,t,i),a=e.head;return a.left=o,e.head=e.head.next,a.right=h(e,i+1,r),a}return null}function d(e,t,r,n,i){if(!(r>=n)){for(var o=e[r+n>>1],a=r-1,s=n+1;;){do{a++}while(i(e[a],o)<0);do{s--}while(i(e[s],o)>0);if(a>=s)break;var l=e[a];e[a]=e[s],e[s]=l,l=t[a],t[a]=t[s],t[s]=l}d(e,t,r,s,i),d(e,t,s+1,n,i)}}var p=function(e,t){return e.ll.x<=t.x&&t.x<=e.ur.x&&e.ll.y<=t.y&&t.y<=e.ur.y},f=function(e,t){if(t.ur.x<e.ll.x||e.ur.x<t.ll.x||t.ur.y<e.ll.y||e.ur.y<t.ll.y)return null;var r=e.ll.x<t.ll.x?t.ll.x:e.ll.x,n=e.ur.x<t.ur.x?e.ur.x:t.ur.x;return{ll:{x:r,y:e.ll.y<t.ll.y?t.ll.y:e.ll.y},ur:{x:n,y:e.ur.y<t.ur.y?e.ur.y:t.ur.y}}},m=Number.EPSILON;void 0===m&&(m=Math.pow(2,-52));var g=m*m,y=function(e,t){if(-m<e&&e<m&&-m<t&&t<m)return 0;var r=e-t;return r*r<g*e*t?0:e<t?-1:1},v=function(){function t(){e(this,t),this.reset()}return r(t,[{key:"reset",value:function(){this.xRounder=new _,this.yRounder=new _}},{key:"round",value:function(e,t){return{x:this.xRounder.round(e),y:this.yRounder.round(t)}}}]),t}(),_=function(){function t(){e(this,t),this.tree=new c,this.round(0)}return r(t,[{key:"round",value:function(e){var t=this.tree.add(e),r=this.tree.prev(t);if(null!==r&&0===y(t.key,r.key))return this.tree.remove(e),r.key;var n=this.tree.next(t);return null!==n&&0===y(t.key,n.key)?(this.tree.remove(e),n.key):e}}]),t}(),b=new v,w=function(e,t){return e.x*t.y-e.y*t.x},x=function(e,t){return e.x*t.x+e.y*t.y},C=function(e,t,r){var n={x:t.x-e.x,y:t.y-e.y},i={x:r.x-e.x,y:r.y-e.y},o=w(n,i);return y(o,0)},S=function(e){return Math.sqrt(x(e,e))},E=function(e,t,r){var n={x:t.x-e.x,y:t.y-e.y},i={x:r.x-e.x,y:r.y-e.y};return w(i,n)/S(i)/S(n)},T=function(e,t,r){var n={x:t.x-e.x,y:t.y-e.y},i={x:r.x-e.x,y:r.y-e.y};return x(i,n)/S(i)/S(n)},I=function(e,t,r){return 0===t.y?null:{x:e.x+t.x/t.y*(r-e.y),y:r}},k=function(e,t,r){return 0===t.x?null:{x:r,y:e.y+t.y/t.x*(r-e.x)}},A=function(){function t(r,n){e(this,t),void 0===r.events?r.events=[this]:r.events.push(this),this.point=r,this.isLeft=n}return r(t,null,[{key:"compare",value:function(e,r){var n=t.comparePoints(e.point,r.point);return 0!==n?n:(e.point!==r.point&&e.link(r),e.isLeft!==r.isLeft?e.isLeft?1:-1:M.compare(e.segment,r.segment))}},{key:"comparePoints",value:function(e,t){return e.x<t.x?-1:e.x>t.x?1:e.y<t.y?-1:e.y>t.y?1:0}}]),r(t,[{key:"link",value:function(e){if(e.point===this.point)throw new Error("Tried to link already linked events");for(var t=e.point.events,r=0,n=t.length;r<n;r++){var i=t[r];this.point.events.push(i),i.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var e=this.point.events.length,t=0;t<e;t++){var r=this.point.events[t];if(void 0===r.segment.consumedBy)for(var n=t+1;n<e;n++){var i=this.point.events[n];void 0===i.consumedBy&&(r.otherSE.point.events===i.otherSE.point.events&&r.segment.consume(i.segment))}}}},{key:"getAvailableLinkedEvents",value:function(){for(var e=[],t=0,r=this.point.events.length;t<r;t++){var n=this.point.events[t];n!==this&&!n.segment.ringOut&&n.segment.isInResult()&&e.push(n)}return e}},{key:"getLeftmostComparator",value:function(e){var t=this,r=new Map,n=function(n){var i=n.otherSE;r.set(n,{sine:E(t.point,e.point,i.point),cosine:T(t.point,e.point,i.point)})};return function(e,t){r.has(e)||n(e),r.has(t)||n(t);var i=r.get(e),o=i.sine,a=i.cosine,s=r.get(t),l=s.sine,c=s.cosine;return o>=0&&l>=0?a<c?1:a>c?-1:0:o<0&&l<0?a<c?-1:a>c?1:0:l<o?-1:l>o?1:0}}}]),t}(),P=0,M=function(){function t(r,n,i,o){e(this,t),this.id=++P,this.leftSE=r,r.segment=this,r.otherSE=n,this.rightSE=n,n.segment=this,n.otherSE=r,this.rings=i,this.windings=o}return r(t,null,[{key:"compare",value:function(e,t){var r=e.leftSE.point.x,n=t.leftSE.point.x,i=e.rightSE.point.x,o=t.rightSE.point.x;if(o<r)return 1;if(i<n)return-1;var a=e.leftSE.point.y,s=t.leftSE.point.y,l=e.rightSE.point.y,c=t.rightSE.point.y;if(r<n){if(s<a&&s<l)return 1;if(s>a&&s>l)return-1;var u=e.comparePoint(t.leftSE.point);if(u<0)return 1;if(u>0)return-1;var h=t.comparePoint(e.rightSE.point);return 0!==h?h:-1}if(r>n){if(a<s&&a<c)return-1;if(a>s&&a>c)return 1;var d=t.comparePoint(e.leftSE.point);if(0!==d)return d;var p=e.comparePoint(t.rightSE.point);return p<0?1:p>0?-1:1}if(a<s)return-1;if(a>s)return 1;if(i<o){var f=t.comparePoint(e.rightSE.point);if(0!==f)return f}if(i>o){var m=e.comparePoint(t.rightSE.point);if(m<0)return 1;if(m>0)return-1}if(i!==o){var g=l-a,y=i-r,v=c-s,_=o-n;if(g>y&&v<_)return 1;if(g<y&&v>_)return-1}return i>o?1:i<o||l<c?-1:l>c?1:e.id<t.id?-1:e.id>t.id?1:0}}]),r(t,[{key:"replaceRightSE",value:function(e){this.rightSE=e,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var e=this.leftSE.point.y,t=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:e<t?e:t},ur:{x:this.rightSE.point.x,y:e>t?e:t}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(e){return e.x===this.leftSE.point.x&&e.y===this.leftSE.point.y||e.x===this.rightSE.point.x&&e.y===this.rightSE.point.y}},{key:"comparePoint",value:function(e){if(this.isAnEndpoint(e))return 0;var t=this.leftSE.point,r=this.rightSE.point,n=this.vector();if(t.x===r.x)return e.x===t.x?0:e.x<t.x?1:-1;var i=(e.y-t.y)/n.y,o=t.x+i*n.x;if(e.x===o)return 0;var a=(e.x-t.x)/n.x,s=t.y+a*n.y;return e.y===s?0:e.y<s?-1:1}},{key:"getIntersection",value:function(e){var t=this.bbox(),r=e.bbox(),n=f(t,r);if(null===n)return null;var i=this.leftSE.point,o=this.rightSE.point,a=e.leftSE.point,s=e.rightSE.point,l=p(t,a)&&0===this.comparePoint(a),c=p(r,i)&&0===e.comparePoint(i),u=p(t,s)&&0===this.comparePoint(s),h=p(r,o)&&0===e.comparePoint(o);if(c&&l)return h&&!u?o:!h&&u?s:null;if(c)return u&&i.x===s.x&&i.y===s.y?null:i;if(l)return h&&o.x===a.x&&o.y===a.y?null:a;if(h&&u)return null;if(h)return o;if(u)return s;var d=function(e,t,r,n){if(0===t.x)return k(r,n,e.x);if(0===n.x)return k(e,t,r.x);if(0===t.y)return I(r,n,e.y);if(0===n.y)return I(e,t,r.y);var i=w(t,n);if(0==i)return null;var o={x:r.x-e.x,y:r.y-e.y},a=w(o,t)/i,s=w(o,n)/i;return{x:(e.x+s*t.x+(r.x+a*n.x))/2,y:(e.y+s*t.y+(r.y+a*n.y))/2}}(i,this.vector(),a,e.vector());return null===d?null:p(n,d)?b.round(d.x,d.y):null}},{key:"split",value:function(e){var r=[],n=void 0!==e.events,i=new A(e,!0),o=new A(e,!1),a=this.rightSE;this.replaceRightSE(o),r.push(o),r.push(i);var s=new t(i,a,this.rings.slice(),this.windings.slice());return A.comparePoints(s.leftSE.point,s.rightSE.point)>0&&s.swapEvents(),A.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),n&&(i.checkForConsuming(),o.checkForConsuming()),r}},{key:"swapEvents",value:function(){var e=this.rightSE;this.rightSE=this.leftSE,this.leftSE=e,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var t=0,r=this.windings.length;t<r;t++)this.windings[t]*=-1}},{key:"consume",value:function(e){for(var r=this,n=e;r.consumedBy;)r=r.consumedBy;for(;n.consumedBy;)n=n.consumedBy;var i=t.compare(r,n);if(0!==i){if(i>0){var o=r;r=n,n=o}if(r.prev===n){var a=r;r=n,n=a}for(var s=0,l=n.rings.length;s<l;s++){var c=n.rings[s],u=n.windings[s],h=r.rings.indexOf(c);-1===h?(r.rings.push(c),r.windings.push(u)):r.windings[h]+=u}n.rings=null,n.windings=null,n.consumedBy=r,n.leftSE.consumedBy=r.leftSE,n.rightSE.consumedBy=r.rightSE}}},{key:"prevInResult",value:function(){return void 0!==this._prevInResult||(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null),this._prevInResult}},{key:"beforeState",value:function(){if(void 0!==this._beforeState)return this._beforeState;if(this.prev){var e=this.prev.consumedBy||this.prev;this._beforeState=e.afterState()}else this._beforeState={rings:[],windings:[],multiPolys:[]};return this._beforeState}},{key:"afterState",value:function(){if(void 0!==this._afterState)return this._afterState;var e=this.beforeState();this._afterState={rings:e.rings.slice(0),windings:e.windings.slice(0),multiPolys:[]};for(var t=this._afterState.rings,r=this._afterState.windings,n=this._afterState.multiPolys,i=0,o=this.rings.length;i<o;i++){var a=this.rings[i],s=this.windings[i],l=t.indexOf(a);-1===l?(t.push(a),r.push(s)):r[l]+=s}for(var c=[],u=[],h=0,d=t.length;h<d;h++)if(0!==r[h]){var p=t[h],f=p.poly;if(-1===u.indexOf(f))if(p.isExterior)c.push(f);else{-1===u.indexOf(f)&&u.push(f);var m=c.indexOf(p.poly);-1!==m&&c.splice(m,1)}}for(var g=0,y=c.length;g<y;g++){var v=c[g].multiPoly;-1===n.indexOf(v)&&n.push(v)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;var e=this.beforeState().multiPolys,t=this.afterState().multiPolys;switch(j.type){case"union":var r=0===e.length,n=0===t.length;this._isInResult=r!==n;break;case"intersection":var i,o;e.length<t.length?(i=e.length,o=t.length):(i=t.length,o=e.length),this._isInResult=o===j.numMultiPolys&&i<o;break;case"xor":var a=Math.abs(e.length-t.length);this._isInResult=a%2===1;break;case"difference":var s=function(e){return 1===e.length&&e[0].isSubject};this._isInResult=s(e)!==s(t);break;default:throw new Error("Unrecognized operation type found ".concat(j.type))}return this._isInResult}}],[{key:"fromRing",value:function(e,r,n){var i,o,a,s=A.comparePoints(e,r);if(s<0)i=e,o=r,a=1;else{if(!(s>0))throw new Error("Tried to create degenerate segment at [".concat(e.x,", ").concat(e.y,"]"));i=r,o=e,a=-1}return new t(new A(i,!0),new A(o,!1),[n],[a])}}]),t}(),R=function(){function t(r,n,i){if(e(this,t),!Array.isArray(r)||0===r.length)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=n,this.isExterior=i,this.segments=[],"number"!==typeof r[0][0]||"number"!==typeof r[0][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var o=b.round(r[0][0],r[0][1]);this.bbox={ll:{x:o.x,y:o.y},ur:{x:o.x,y:o.y}};for(var a=o,s=1,l=r.length;s<l;s++){if("number"!==typeof r[s][0]||"number"!==typeof r[s][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var c=b.round(r[s][0],r[s][1]);c.x===a.x&&c.y===a.y||(this.segments.push(M.fromRing(a,c,this)),c.x<this.bbox.ll.x&&(this.bbox.ll.x=c.x),c.y<this.bbox.ll.y&&(this.bbox.ll.y=c.y),c.x>this.bbox.ur.x&&(this.bbox.ur.x=c.x),c.y>this.bbox.ur.y&&(this.bbox.ur.y=c.y),a=c)}o.x===a.x&&o.y===a.y||this.segments.push(M.fromRing(a,o,this))}return r(t,[{key:"getSweepEvents",value:function(){for(var e=[],t=0,r=this.segments.length;t<r;t++){var n=this.segments[t];e.push(n.leftSE),e.push(n.rightSE)}return e}}]),t}(),O=function(){function t(r,n){if(e(this,t),!Array.isArray(r))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new R(r[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var i=1,o=r.length;i<o;i++){var a=new R(r[i],this,!1);a.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=a.bbox.ll.x),a.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=a.bbox.ll.y),a.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=a.bbox.ur.x),a.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=a.bbox.ur.y),this.interiorRings.push(a)}this.multiPoly=n}return r(t,[{key:"getSweepEvents",value:function(){for(var e=this.exteriorRing.getSweepEvents(),t=0,r=this.interiorRings.length;t<r;t++)for(var n=this.interiorRings[t].getSweepEvents(),i=0,o=n.length;i<o;i++)e.push(n[i]);return e}}]),t}(),L=function(){function t(r,n){if(e(this,t),!Array.isArray(r))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"===typeof r[0][0][0]&&(r=[r])}catch(r){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var i=0,o=r.length;i<o;i++){var a=new O(r[i],this);a.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=a.bbox.ll.x),a.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=a.bbox.ll.y),a.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=a.bbox.ur.x),a.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=a.bbox.ur.y),this.polys.push(a)}this.isSubject=n}return r(t,[{key:"getSweepEvents",value:function(){for(var e=[],t=0,r=this.polys.length;t<r;t++)for(var n=this.polys[t].getSweepEvents(),i=0,o=n.length;i<o;i++)e.push(n[i]);return e}}]),t}(),D=function(){function t(r){e(this,t),this.events=r;for(var n=0,i=r.length;n<i;n++)r[n].segment.ringOut=this;this.poly=null}return r(t,null,[{key:"factory",value:function(e){for(var r=[],n=0,i=e.length;n<i;n++){var o=e[n];if(o.isInResult()&&!o.ringOut){for(var a=null,s=o.leftSE,l=o.rightSE,c=[s],u=s.point,h=[];a=s,s=l,c.push(s),s.point!==u;)for(;;){var d=s.getAvailableLinkedEvents();if(0===d.length){var p=c[0].point,f=c[c.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(p.x,",")+" ".concat(p.y,"]. Last matching segment found ends at")+" [".concat(f.x,", ").concat(f.y,"]."))}if(1===d.length){l=d[0].otherSE;break}for(var m=null,g=0,y=h.length;g<y;g++)if(h[g].point===s.point){m=g;break}if(null===m){h.push({index:c.length,point:s.point});var v=s.getLeftmostComparator(a);l=d.sort(v)[0].otherSE;break}var _=h.splice(m)[0],b=c.splice(_.index);b.unshift(b[0].otherSE),r.push(new t(b.reverse()))}r.push(new t(c))}}return r}}]),r(t,[{key:"getGeom",value:function(){for(var e=this.events[0].point,t=[e],r=1,n=this.events.length-1;r<n;r++){var i=this.events[r].point,o=this.events[r+1].point;0!==C(i,e,o)&&(t.push(i),e=i)}if(1===t.length)return null;var a=t[0],s=t[1];0===C(a,e,s)&&t.shift(),t.push(t[0]);for(var l=this.isExteriorRing()?1:-1,c=this.isExteriorRing()?0:t.length-1,u=this.isExteriorRing()?t.length:-1,h=[],d=c;d!=u;d+=l)h.push([t[d].x,t[d].y]);return h}},{key:"isExteriorRing",value:function(){if(void 0===this._isExteriorRing){var e=this.enclosingRing();this._isExteriorRing=!e||!e.isExteriorRing()}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var e=this.events[0],t=1,r=this.events.length;t<r;t++){var n=this.events[t];A.compare(e,n)>0&&(e=n)}for(var i=e.segment.prevInResult(),o=i?i.prevInResult():null;;){if(!i)return null;if(!o)return i.ringOut;if(o.ringOut!==i.ringOut)return o.ringOut.enclosingRing()!==i.ringOut?i.ringOut:i.ringOut.enclosingRing();i=o.prevInResult(),o=i?i.prevInResult():null}}}]),t}(),N=function(){function t(r){e(this,t),this.exteriorRing=r,r.poly=this,this.interiorRings=[]}return r(t,[{key:"addInterior",value:function(e){this.interiorRings.push(e),e.poly=this}},{key:"getGeom",value:function(){var e=[this.exteriorRing.getGeom()];if(null===e[0])return null;for(var t=0,r=this.interiorRings.length;t<r;t++){var n=this.interiorRings[t].getGeom();null!==n&&e.push(n)}return e}}]),t}(),z=function(){function t(r){e(this,t),this.rings=r,this.polys=this._composePolys(r)}return r(t,[{key:"getGeom",value:function(){for(var e=[],t=0,r=this.polys.length;t<r;t++){var n=this.polys[t].getGeom();null!==n&&e.push(n)}return e}},{key:"_composePolys",value:function(e){for(var t=[],r=0,n=e.length;r<n;r++){var i=e[r];if(!i.poly)if(i.isExteriorRing())t.push(new N(i));else{var o=i.enclosingRing();o.poly||t.push(new N(o)),o.poly.addInterior(i)}}return t}}]),t}(),F=function(){function t(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M.compare;e(this,t),this.queue=r,this.tree=new c(n),this.segments=[]}return r(t,[{key:"process",value:function(e){var t=e.segment,r=[];if(e.consumedBy)return e.isLeft?this.queue.remove(e.otherSE):this.tree.remove(t),r;var n=e.isLeft?this.tree.insert(t):this.tree.find(t);if(!n)throw new Error("Unable to find segment #".concat(t.id," ")+"[".concat(t.leftSE.point.x,", ").concat(t.leftSE.point.y,"] -> ")+"[".concat(t.rightSE.point.x,", ").concat(t.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var i=n,o=n,a=void 0,s=void 0;void 0===a;)null===(i=this.tree.prev(i))?a=null:void 0===i.key.consumedBy&&(a=i.key);for(;void 0===s;)null===(o=this.tree.next(o))?s=null:void 0===o.key.consumedBy&&(s=o.key);if(e.isLeft){var l=null;if(a){var c=a.getIntersection(t);if(null!==c&&(t.isAnEndpoint(c)||(l=c),!a.isAnEndpoint(c)))for(var u=this._splitSafely(a,c),h=0,d=u.length;h<d;h++)r.push(u[h])}var p=null;if(s){var f=s.getIntersection(t);if(null!==f&&(t.isAnEndpoint(f)||(p=f),!s.isAnEndpoint(f)))for(var m=this._splitSafely(s,f),g=0,y=m.length;g<y;g++)r.push(m[g])}if(null!==l||null!==p){var v=null;if(null===l)v=p;else if(null===p)v=l;else{v=A.comparePoints(l,p)<=0?l:p}this.queue.remove(t.rightSE),r.push(t.rightSE);for(var _=t.split(v),b=0,w=_.length;b<w;b++)r.push(_[b])}r.length>0?(this.tree.remove(t),r.push(e)):(this.segments.push(t),t.prev=a)}else{if(a&&s){var x=a.getIntersection(s);if(null!==x){if(!a.isAnEndpoint(x))for(var C=this._splitSafely(a,x),S=0,E=C.length;S<E;S++)r.push(C[S]);if(!s.isAnEndpoint(x))for(var T=this._splitSafely(s,x),I=0,k=T.length;I<k;I++)r.push(T[I])}}this.tree.remove(t)}return r}},{key:"_splitSafely",value:function(e,t){this.tree.remove(e);var r=e.rightSE;this.queue.remove(r);var n=e.split(t);return n.push(r),void 0===e.consumedBy&&this.tree.insert(e),n}}]),t}(),B="undefined"!==typeof process&&{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_KEY:"4txBvRsNUWNCM8EFEEhub4vJBGrBXARQnlMnRy7DYhXWnKZDtONXJQQJ99ALACYeBjFB99tCAAAgAZMP1MtN"}.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,U="undefined"!==typeof process&&{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_KEY:"4txBvRsNUWNCM8EFEEhub4vJBGrBXARQnlMnRy7DYhXWnKZDtONXJQQJ99ALACYeBjFB99tCAAAgAZMP1MtN"}.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,j=new(function(){function t(){e(this,t)}return r(t,[{key:"run",value:function(e,t,r){j.type=e,b.reset();for(var n=[new L(t,!0)],i=0,o=r.length;i<o;i++)n.push(new L(r[i],!1));if(j.numMultiPolys=n.length,"difference"===j.type)for(var a=n[0],s=1;s<n.length;)null!==f(n[s].bbox,a.bbox)?s++:n.splice(s,1);if("intersection"===j.type)for(var l=0,u=n.length;l<u;l++)for(var h=n[l],d=l+1,p=n.length;d<p;d++)if(null===f(h.bbox,n[d].bbox))return[];for(var m=new c(A.compare),g=0,y=n.length;g<y;g++)for(var v=n[g].getSweepEvents(),_=0,w=v.length;_<w;_++)if(m.insert(v[_]),m.size>B)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var x=new F(m),C=m.size,S=m.pop();S;){var E=S.key;if(m.size===C){var T=E.segment;throw new Error("Unable to pop() ".concat(E.isLeft?"left":"right"," SweepEvent ")+"[".concat(E.point.x,", ").concat(E.point.y,"] from segment #").concat(T.id," ")+"[".concat(T.leftSE.point.x,", ").concat(T.leftSE.point.y,"] -> ")+"[".concat(T.rightSE.point.x,", ").concat(T.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(m.size>B)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(x.segments.length>U)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var I=x.process(E),k=0,P=I.length;k<P;k++){var M=I[k];void 0===M.consumedBy&&m.insert(M)}C=m.size,S=m.pop()}b.reset();var R=D.factory(x.segments);return new z(R).getGeom()}}]),t}());return{union:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return j.run("union",e,r)},intersection:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return j.run("intersection",e,r)},xor:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return j.run("xor",e,r)},difference:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return j.run("difference",e,r)}}}(),tN.exports),nN=ir(rN);function iN(e,t,r){return void 0===r&&(r={}),e=eN(e),t=eN(t),0===(e=nN.intersection(e.coordinates,t.coordinates)).length?null:1===e.length?function(e,t,r){void 0===r&&(r={});for(var n=0,i=e;n<i.length;n++){var o=i[n];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<o[o.length-1].length;a++)if(o[o.length-1][a]!==o[0][a])throw new Error("First and last Position are not equivalent.")}return JD({type:"Polygon",coordinates:e},t,r)}(e[0],r.properties):function(e,t,r){return JD({type:"MultiPolygon",coordinates:e},t,r=void 0===r?{}:r)}(e,r.properties)}var oN=function(e){return function(t,r,n){var i=n.value,o=new Map;return n.value=function(){var t=this,r=arguments;!o.get(t)&&(i.apply(t,r),o.set(t,!0),setTimeout((function(){return o.delete(t)}),e))},n}},aN=window&&window.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;0<=s;s--)(i=e[s])&&(a=(o<3?i(a):3<o?i(t,r,a):i(t,r))||a);return 3<o&&a&&Object.defineProperty(t,r,a),a},sN=window&&window.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=o.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a},lN=window&&window.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||((n=n||Array.prototype.slice.call(t,0,i))[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},cN=["DIV","SPAN","A"],uN=["data-azure-maps-attribution-minzoom","data-azure-maps-attribution-maxzoom","data-azure-maps-attribution-geometry","data-azure-maps-attribution-tileset","data-azure-maps-attribution-order","data-azure-maps-attribution-dynamic"],hN=lN(["href"],sN(uN),!1),dN=function(){function e(e,t){var r=this;this.lastFetchState={bounds:null,zoom:null},this.getElement=function(){return r.element},this.element=e,this.attributionChangeCallback=t}return e.prototype.equals=function(e){return this.stringRepresentation===e.stringRepresentation},Object.defineProperty(e.prototype,"stringRepresentation",{get:function(){return[void 0!==this.minZoom?"minzoom=".concat(this.minZoom):"",void 0!==this.maxZoom?"maxzoom=".concat(this.maxZoom):"",void 0!==this.geometry?this.element.attributes.getNamedItem("data-azure-maps-attribution-geometry").value:"",void 0!==this.tilesetId?"tilesetId=".concat(this.tilesetId):"",this.dynamic?"dynamic":""].filter((function(e){return 0<e.length})).join(";")},enumerable:!1,configurable:!0}),e.applicable=function(e){return Array.from(e.attributes).map((function(e){return uN.includes(e.name)})).reduce((function(e,t){return e||t}),!1)},Object.defineProperty(e.prototype,"minZoom",{get:function(){var e=this.element.attributes.getNamedItem("data-azure-maps-attribution-minzoom");return e&&!isNaN(e.value)?parseInt(e.value):void 0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxZoom",{get:function(){var e=this.element.attributes.getNamedItem("data-azure-maps-attribution-maxzoom");return e&&!isNaN(e.value)?parseInt(e.value):void 0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"geometry",{get:function(){var e=this.element.attributes.getNamedItem("data-azure-maps-attribution-geometry");if(e&&e.value)try{return JSON.parse(e.value)}catch(e){}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tilesetId",{get:function(){var e=this.element.attributes.getNamedItem("data-azure-maps-attribution-tileset");return e&&e.value?e.value:void 0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"order",{get:function(){var e=this.element.attributes.getNamedItem("data-azure-maps-attribution-order");return e&&!isNaN(e.value)?parseInt(e.value):void 0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dynamic",{get:function(){return null!==this.element.attributes.getNamedItem("data-azure-maps-attribution-dynamic")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hidesElement",{get:function(){return"none"==this.element.style.display},enumerable:!1,configurable:!0}),e.prototype.forceHide=function(){this.element.style.display="none"},e.prototype.satisfied=function(e){var t=!this.minZoom||!e.zoom||e.zoom>=this.minZoom,r=!this.maxZoom||!e.zoom||e.zoom<=this.maxZoom,n=!0;return this.geometry&&e.bounds&&(n=null!==iN({type:"Feature",geometry:this.geometry,properties:{}},{type:"Feature",geometry:{type:"Polygon",coordinates:[[bf.getNorthWest(e.bounds),bf.getNorthEast(e.bounds),bf.getSouthEast(e.bounds),bf.getSouthWest(e.bounds),bf.getNorthWest(e.bounds)]]},properties:{}})),t&&r&&n},e.prototype.apply=function(e,t){var r=this,n=(void 0===t&&(t=null),this.satisfied(e.getCamera())),i=this.dynamic&&this.tilesetId,o=this.hidesElement;t=t&&["dragend","zoomend","pitchend"].includes(t.type);return n||o?n&&(o||i)&&(n&&o&&this.element.style.removeProperty("display"),i)&&(t?e.events.addOnce("idle",(function(t){return r.fetchAndApplyDynamicAttribution(e)})):this.fetchAndApplyDynamicAttribution(e)):this.element.style.display="none",n===o},e.prototype.fetchAndApplyDynamicAttribution=function(t){var r,n,i,o=this,a=t.getCamera();this.lastFetchState&&bf.containsBoundingBox(this.lastFetchState.bounds,a.bounds)&&Math.floor(this.lastFetchState.zoom)==Math.floor(a.zoom)||(r=Zp(a.center,bf.getSouthWest(a.bounds),e.viewportBufferExpansionRatio),i=((n=Zp(a.center,bf.getNorthEast(a.bounds),e.viewportBufferExpansionRatio))[0]<r[0]?[[r[0],r[1],180,n[1]],[-180,r[1],n[0],n[1]]]:[[r[0],r[1],n[0],n[1]]]).map((function(e){e=new URLSearchParams({"api-version":"2.1",tilesetId:o.tilesetId,zoom:void 0!==a.zoom?"".concat(Math.floor(a.zoom)):void 0,bounds:e.join(",")});var r={url:n="".concat("https://{{azMapsDomain}}","/map/attribution"),headers:{}},n=(t._substituteDomainLanguageViewAndSignInRequest(n,r),"".concat(r.url).concat(r.url.includes("?")?"&":"?").concat(e.toString()));return t._sendRequest(n,"Attribution",r.headers).then((function(e){return e.json()}))})),Promise.all(i).then((function(e){o.applyAttributionResponse(e),o.lastFetchState={bounds:new bf([r[0],r[1],n[0],n[1]]),zoom:a.zoom}})).catch((function(e){return console.error(e)})))},e.prototype.applyAttributionResponse=function(e){var t,r,n,i=this;e=e.map((function(e){return e.copyrights||[]})).reduce((function(e,t){return lN(lN([],sN(e),!1),sN(t),!1)}),[]);0!=e.length&&(null===(e=Rg.parseWithFilter(e.join(""),(function(e){return!0}),(function(e){return e}),(function(){return i.element.innerHTML="",i.element})))?console.warn("Dynamic attribution is empty after filtering"):(t="string"==typeof e?((t=document.createElement("span")).innerHTML=e,t):e,n=t===this.element?(r=document.createElement("span"),Array.from(this.element.childNodes).forEach((function(e){return r.appendChild(e)})),r):t,Array.from(this.element.attributes).filter((function(e){return uN.includes(e.name)})).forEach((function(e){return n.attributes.setNamedItem(e.cloneNode())})),n.style.display=this.element.style.display,e=this.element.parentElement,this.element.remove(),e.append(n),this.element=n,this.attributionChangeCallback(this)))},e.viewportBufferExpansionRatio=2,aN([oN(1e3)],e.prototype,"fetchAndApplyDynamicAttribution",null),e}(),pN=window&&window.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=o.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a},fN=window&&window.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||((n=n||Array.prototype.slice.call(t,0,i))[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},mN=[/all rights reserved/gi],gN=function(){function e(e,t,r){var n,i=this;this.rules=[],this.virtualContext=((n=document.createElement("span")).className="azure-map-copyright-context",n),this.renderContext=this.virtualContext.cloneNode(!1),this.addAttributionFromSource=function(e){},this.removeAttributionFromSource=function(e){},this.getMapStyleVisibleSources=function(){var e=i.map._getMap(),t=e.getStyle();return Object.entries(t.sources).filter((function(e){var r=pN(e,1)[0];return t.layers.filter((function(e){return e&&e.source==r})).reduce((function(e,t){return!(t.layout&&"none"===t.layout.visibility||t.paint&&0===t.paint["icon-opacity"]&&0===t.paint["text-opacity"])||e}),!1)})).map((function(t){return t=pN(t,1)[0],e.getSource(t)}))},this.loadAttributionOnceSourcesLoaded=function(){var e=i.getMapStyleVisibleSources();Promise.all(e.map((function(e){return new Promise((function(t,r){var n;"tiles"in e||"geojson"===(null==e?void 0:e.type)?t(e):((n=e).on("data",(function r(i){"metadata"==i.sourceDataType&&(n.off("data",r),t(e))})),n.on("error",(function e(t){n.off("error",e),r(t)})))})).then((function(e){return{status:"fulfilled",value:e}})).catch((function(e){return{status:"rejected",reason:e}}))}))).then((function(e){i.reloadAttribution()}))},this.reloadAttribution=function(){var e=i.getMapStyleVisibleSources(),t=new Set,r={},n=(e=e.filter((function(e){return"attribution"in e&&e.attribution&&"tiles"in e&&e.tiles instanceof Array&&0<e.tiles.length})).map((function(e){return Rg.parseWithFilter(null!=(e=e.attribution)?e:"",(function(e){return cN.includes(e.tagName)&&Array.from(e.attributes).map((function(e){return hN.includes(e.name)})).reduce((function(e,t){return e&&t}),!0)}),(function(e){var n,o=null;return e instanceof HTMLElement&&dN.applicable(e)&&(o=new dN(e,(function(){return i.renderAttribution()})),t.add(o),void 0!==o.order)&&(e.style.order="".concat(o.order)),o&&e instanceof HTMLElement&&(!((n=o.stringRepresentation)in r)||void 0!==o.order&&void 0!==r[n].order&&o.order<r[n].order||void 0!==o.order&&void 0===r[n].order)&&(r[n]=o),e}),(function(){return document.createElement("span")}))})),new Set(Object.values(r))),o=new Set(fN([],pN(t),!1).filter((function(e){return!n.has(e)}))),a=new Set(fN([],pN(o),!1).map((function(e){return e.getElement()}))),s=(o=(fN([],pN(a),!1).filter((function(e){return null!==e.parentElement})).forEach((function(e){return e.parentElement.removeChild(e)})),i.rules=Object.values(r),e.filter((function(e){return"string"==typeof e||!a.has(e)})).map((function(e){return"string"==typeof e?new Text(e):e}))),document.createElement("span"));0<o.length?o.forEach((function(e){return s.appendChild(e)})):i.getDefaultAttribution().forEach((function(e){return s.appendChild(e)})),i.virtualContext=s,i.copyrightControl.setOptions({copyrightContent:i.renderContext}),i.applyRules(),i.renderAttribution()},this.applyRules=function(e){void 0===e&&(e=null),i.rules.reduce((function(t,r){return r=r.apply(i.map,e),t||r}),!1)&&i.renderAttribution()},this.renderAttribution=function(){var e=function(t){return Array.from("none"!=t.style.display?t.children:[]).map((function(t){return e(t)})).reduce((function(e,t){return fN(fN([],pN(e),!1),pN(t),!1)}),Array.from("none"!=t.style.display?t.childNodes:[]).filter((function(e){return e.nodeType==e.TEXT_NODE})))},t=i.virtualContext.cloneNode(!0),r=e(t);r.forEach((function(e){return e.textContent=fN([],pN(mN),!1).reduce((function(e,t){return e.replace(t,"").trim()}),e.textContent)})),r.reduce((function(e,t){return e.has(t.textContent)?(t.textContent="",t.parentElement&&t.parentElement.removeChild(t)):e.add(t.textContent),e}),new Set),i.renderContext.innerHTML="",Array.from(t.childNodes).forEach((function(e){return i.renderContext.appendChild(e)}))},this.map=e,this.copyrightControl=t,this.options=r}return e.prototype.addToMap=function(){this.map.events.add("stylechanged",this.loadAttributionOnceSourcesLoaded),this.map.events.add("dragend",this.applyRules),this.map.events.add("zoomend",this.applyRules),this.map.events.add("pitchend",this.applyRules)},e.prototype.removeFromMap=function(){this.map.events.remove("stylechanged",this.loadAttributionOnceSourcesLoaded),this.map.events.remove("dragend",this.applyRules),this.map.events.remove("zoomend",this.applyRules),this.map.events.remove("pitchend",this.applyRules)},e.prototype.getDefaultAttribution=function(){return this.copyrightControl.getDefaultAttributions().map((function(e){return(t=document.createElement("a")).textContent=e,t;var t}))},e}(),yN=function(e,t){return(yN=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};function vN(e,t){function r(){this.constructor=e}yN(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var _N=function(){return(_N=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function bN(e,t){var r={};for(i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r}function wN(e,t,r,n){return new(r=r||Promise)((function(i,o){function a(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))}function xN(e,t){var r,n,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a={next:s(0),throw:s(1),return:s(2)};return"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){var l=[a,s];if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&l[0]?n.return:l[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,l[1])).done)return i;switch(n=0,(l=i?[2&l[0],i.value]:l)[0]){case 0:case 1:i=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(i=0<(i=o.trys).length&&i[i.length-1])&&(6===l[0]||2===l[0])){o=0;continue}if(3===l[0]&&(!i||l[1]>i[0]&&l[1]<i[3]))o.label=l[1];else if(6===l[0]&&o.label<i[1])o.label=i[1],i=l;else{if(!(i&&o.label<i[2])){i[2]&&o.ops.pop(),o.trys.pop();continue}o.label=i[2],o.ops.push(l)}}l=t.call(e,o)}catch(s){l=[6,s],n=0}finally{r=i=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}}function CN(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=o.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a}function SN(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(CN(arguments[t]));return e}var EN=function(e,t){return(EN=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};function TN(e,t){function r(){this.constructor=e}EN(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var IN=function(){return(IN=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function kN(e,t,r,n){return new(r=r||Promise)((function(i,o){function a(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))}function AN(e,t){var r,n,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a={next:s(0),throw:s(1),return:s(2)};return"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){var l=[a,s];if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&l[0]?n.return:l[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,l[1])).done)return i;switch(n=0,(l=i?[2&l[0],i.value]:l)[0]){case 0:case 1:i=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(i=0<(i=o.trys).length&&i[i.length-1])&&(6===l[0]||2===l[0])){o=0;continue}if(3===l[0]&&(!i||l[1]>i[0]&&l[1]<i[3]))o.label=l[1];else if(6===l[0]&&o.label<i[1])o.label=i[1],i=l;else{if(!(i&&o.label<i[2])){i[2]&&o.ops.pop(),o.trys.pop();continue}o.label=i[2],o.ops.push(l)}}l=t.call(e,o)}catch(s){l=[6,s],n=0}finally{r=i=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}}function PN(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)n[i]=o[a];return n}var MN,RN,ON,LN,DN,NN,zN,FN,BN,UN,jN,qN,HN,VN,GN,KN,ZN,WN,$N,YN,XN,QN,JN,ez={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",REGIONAL_AUTH_NON_MSI_QUERY_STRING:"allowestsrnonmsi=true",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},tz=[ez.OPENID_SCOPE,ez.PROFILE_SCOPE,ez.OFFLINE_ACCESS_SCOPE],rz=PN(tz,[ez.EMAIL_SCOPE]),nz=(function(e){e.CONTENT_TYPE="Content-Type",e.RETRY_AFTER="Retry-After",e.CCS_HEADER="X-AnchorMailbox",e.WWWAuthenticate="WWW-Authenticate",e.AuthenticationInfo="Authentication-Info",e.X_MS_REQUEST_ID="x-ms-request-id",e.X_MS_HTTP_VERSION="x-ms-httpver"}(MN=MN||{}),function(e){e.ID_TOKEN="idtoken",e.CLIENT_INFO="client.info",e.ADAL_ID_TOKEN="adal.idtoken",e.ERROR="error",e.ERROR_DESC="error.description",e.ACTIVE_ACCOUNT="active-account",e.ACTIVE_ACCOUNT_FILTERS="active-account-filters"}(RN=RN||{}),function(e){e.COMMON="common",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers"}(ON=ON||{}),function(e){e.CLIENT_ID="client_id",e.REDIRECT_URI="redirect_uri",e.RESPONSE_TYPE="response_type",e.RESPONSE_MODE="response_mode",e.GRANT_TYPE="grant_type",e.CLAIMS="claims",e.SCOPE="scope",e.ERROR="error",e.ERROR_DESCRIPTION="error_description",e.ACCESS_TOKEN="access_token",e.ID_TOKEN="id_token",e.REFRESH_TOKEN="refresh_token",e.EXPIRES_IN="expires_in",e.STATE="state",e.NONCE="nonce",e.PROMPT="prompt",e.SESSION_STATE="session_state",e.CLIENT_INFO="client_info",e.CODE="code",e.CODE_CHALLENGE="code_challenge",e.CODE_CHALLENGE_METHOD="code_challenge_method",e.CODE_VERIFIER="code_verifier",e.CLIENT_REQUEST_ID="client-request-id",e.X_CLIENT_SKU="x-client-SKU",e.X_CLIENT_VER="x-client-VER",e.X_CLIENT_OS="x-client-OS",e.X_CLIENT_CPU="x-client-CPU",e.X_CLIENT_CURR_TELEM="x-client-current-telemetry",e.X_CLIENT_LAST_TELEM="x-client-last-telemetry",e.X_MS_LIB_CAPABILITY="x-ms-lib-capability",e.X_APP_NAME="x-app-name",e.X_APP_VER="x-app-ver",e.POST_LOGOUT_URI="post_logout_redirect_uri",e.ID_TOKEN_HINT="id_token_hint",e.DEVICE_CODE="device_code",e.CLIENT_SECRET="client_secret",e.CLIENT_ASSERTION="client_assertion",e.CLIENT_ASSERTION_TYPE="client_assertion_type",e.TOKEN_TYPE="token_type",e.REQ_CNF="req_cnf",e.OBO_ASSERTION="assertion",e.REQUESTED_TOKEN_USE="requested_token_use",e.ON_BEHALF_OF="on_behalf_of",e.FOCI="foci",e.CCS_HEADER="X-AnchorMailbox",e.RETURN_SPA_CODE="return_spa_code",e.NATIVE_BROKER="nativebroker",e.LOGOUT_HINT="logout_hint"}(LN=LN||{}),function(e){e.ACCESS_TOKEN="access_token",e.XMS_CC="xms_cc"}(DN=DN||{}),{LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"}),iz=(function(e){e.ACCOUNT="account",e.SID="sid",e.LOGIN_HINT="login_hint",e.ID_TOKEN="id_token",e.DOMAIN_HINT="domain_hint",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers",e.ACCOUNT_ID="accountIdentifier",e.HOMEACCOUNT_ID="homeAccountIdentifier"}(NN=NN||{}),{PLAIN:"plain",S256:"S256"}),oz=(function(e){e.QUERY="query",e.FRAGMENT="fragment",e.FORM_POST="form_post"}(zN=zN||{}),function(e){e.IMPLICIT_GRANT="implicit",e.AUTHORIZATION_CODE_GRANT="authorization_code",e.CLIENT_CREDENTIALS_GRANT="client_credentials",e.RESOURCE_OWNER_PASSWORD_GRANT="password",e.REFRESH_TOKEN_GRANT="refresh_token",e.DEVICE_CODE_GRANT="device_code",e.JWT_BEARER="urn:ietf:params:oauth:grant-type:jwt-bearer"}(FN=FN||{}),function(e){e.MSSTS_ACCOUNT_TYPE="MSSTS",e.ADFS_ACCOUNT_TYPE="ADFS",e.MSAV1_ACCOUNT_TYPE="MSA",e.GENERIC_ACCOUNT_TYPE="Generic"}(BN=BN||{}),function(e){e.CACHE_KEY_SEPARATOR="-",e.CLIENT_INFO_SEPARATOR="."}(UN=UN||{}),function(e){e.ID_TOKEN="IdToken",e.ACCESS_TOKEN="AccessToken",e.ACCESS_TOKEN_WITH_AUTH_SCHEME="AccessToken_With_AuthScheme",e.REFRESH_TOKEN="RefreshToken"}(jN=jN||{}),function(e){e[e.ADFS=1001]="ADFS",e[e.MSA=1002]="MSA",e[e.MSSTS=1003]="MSSTS",e[e.GENERIC=1004]="GENERIC",e[e.ACCESS_TOKEN=2001]="ACCESS_TOKEN",e[e.REFRESH_TOKEN=2002]="REFRESH_TOKEN",e[e.ID_TOKEN=2003]="ID_TOKEN",e[e.APP_METADATA=3001]="APP_METADATA",e[e.UNDEFINED=9999]="UNDEFINED"}(qN=qN||{}),"appmetadata"),az="1",sz="authority-metadata",lz=86400,cz=(function(e){e.CONFIG="config",e.CACHE="cache",e.NETWORK="network",e.HARDCODED_VALUES="hardcoded_values"}(HN=HN||{}),{SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"}),uz=(function(e){e.BEARER="Bearer",e.POP="pop",e.SSH="ssh-cert"}(VN=VN||{}),{DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"}),hz="invalid_grant",dz="client_mismatch",pz=(function(e){e.username="username",e.password="password"}(GN=GN||{}),function(e){e[e.httpSuccess=200]="httpSuccess",e[e.httpBadRequest=400]="httpBadRequest"}(KN=KN||{}),function(e){e.FAILED_AUTO_DETECTION="1",e.INTERNAL_CACHE="2",e.ENVIRONMENT_VARIABLE="3",e.IMDS="4"}(ZN=ZN||{}),function(e){e.CONFIGURED_MATCHES_DETECTED="1",e.CONFIGURED_NO_AUTO_DETECTION="2",e.CONFIGURED_NOT_DETECTED="3",e.AUTO_DETECTION_REQUESTED_SUCCESSFUL="4",e.AUTO_DETECTION_REQUESTED_FAILED="5"}(WN=WN||{}),function(e){e.NO_CACHE_HIT="0",e.FORCE_REFRESH="1",e.NO_CACHED_ACCESS_TOKEN="2",e.CACHED_ACCESS_TOKEN_EXPIRED="3",e.REFRESH_CACHED_ACCESS_TOKEN="4",e.CLAIMS_REQUESTED_CACHE_SKIPPED="5"}($N=$N||{}),function(e){e.Jwt="JWT",e.Jwk="JWK",e.Pop="pop"}(YN=YN||{}),{unexpectedError:{code:"unexpected_error",desc:"Unexpected error in authentication."},postRequestFailed:{code:"post_request_failed",desc:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."}}),fz=function(e){function t(r,n,i){var o=this;o=e.call(this,n?r+": "+n:r)||this;return Object.setPrototypeOf(o,t.prototype),o.errorCode=r||ez.EMPTY_STRING,o.errorMessage=n||ez.EMPTY_STRING,o.subError=i||ez.EMPTY_STRING,o.name="AuthError",o}return TN(t,e),t.prototype.setCorrelationId=function(e){this.correlationId=e},t.createUnexpectedError=function(e){return new t(pz.unexpectedError.code,pz.unexpectedError.desc+": "+e)},t.createPostRequestFailed=function(e){return new t(pz.postRequestFailed.code,pz.postRequestFailed.desc+": "+e)},t}(Error),mz={createNewGuid:function(){throw fz.createUnexpectedError("Crypto interface - createNewGuid() has not been implemented")},base64Decode:function(){throw fz.createUnexpectedError("Crypto interface - base64Decode() has not been implemented")},base64Encode:function(){throw fz.createUnexpectedError("Crypto interface - base64Encode() has not been implemented")},generatePkceCodes:function(){return kN(this,void 0,void 0,(function(){return AN(this,(function(e){throw fz.createUnexpectedError("Crypto interface - generatePkceCodes() has not been implemented")}))}))},getPublicKeyThumbprint:function(){return kN(this,void 0,void 0,(function(){return AN(this,(function(e){throw fz.createUnexpectedError("Crypto interface - getPublicKeyThumbprint() has not been implemented")}))}))},removeTokenBindingKey:function(){return kN(this,void 0,void 0,(function(){return AN(this,(function(e){throw fz.createUnexpectedError("Crypto interface - removeTokenBindingKey() has not been implemented")}))}))},clearKeystore:function(){return kN(this,void 0,void 0,(function(){return AN(this,(function(e){throw fz.createUnexpectedError("Crypto interface - clearKeystore() has not been implemented")}))}))},signJwt:function(){return kN(this,void 0,void 0,(function(){return AN(this,(function(e){throw fz.createUnexpectedError("Crypto interface - signJwt() has not been implemented")}))}))},hashString:function(){return kN(this,void 0,void 0,(function(){return AN(this,(function(e){throw fz.createUnexpectedError("Crypto interface - hashString() has not been implemented")}))}))}},gz={code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},yz={code:"client_info_empty_error",desc:"The client info was empty. Please review the trace to determine the root cause."},vz={code:"token_parsing_error",desc:"Token cannot be parsed. Please review stack trace to determine root cause."},_z={code:"null_or_empty_token",desc:"The token is null or empty. Please review the trace to determine the root cause."},bz={code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},wz={code:"network_error",desc:"Network request failed. Please check network trace to determine root cause."},xz={code:"openid_config_error",desc:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints."},Cz={code:"hash_not_deserialized",desc:"The hash parameters could not be deserialized. Please review the trace to determine the root cause."},Sz={code:"invalid_state",desc:"State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState()."},Ez={code:"state_mismatch",desc:"State mismatch error. Please check your network. Continued requests may cause cache overflow."},Tz={code:"state_not_found",desc:"State not found"},Iz={code:"nonce_mismatch",desc:"Nonce mismatch error. This may be caused by a race condition in concurrent requests."},kz={code:"nonce_not_found",desc:"nonce not found"},Az={code:"auth_time_not_found",desc:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information."},Pz={code:"max_age_transpired",desc:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication."},Mz={code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account."},Rz={code:"multiple_matching_accounts",desc:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account"},Oz={code:"multiple_matching_appMetadata",desc:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata"},Lz={code:"request_cannot_be_made",desc:"Token request cannot be made without authorization code or refresh token."},Dz={code:"cannot_append_empty_scope",desc:"Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info."},Nz={code:"cannot_remove_empty_scope",desc:"Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info."},zz={code:"cannot_append_scopeset",desc:"Cannot append ScopeSet due to error."},Fz={code:"empty_input_scopeset",desc:"Empty input ScopeSet cannot be processed."},Bz={code:"device_code_polling_cancelled",desc:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true."},Uz={code:"device_code_expired",desc:"Device code is expired."},jz={code:"device_code_unknown_error",desc:"Device code stopped polling for unknown reasons."},qz={code:"no_account_in_silent_request",desc:"Please pass an account object, silent flow is not supported without account information"},Hz={code:"invalid_cache_record",desc:"Cache record object was null or undefined."},Vz={code:"invalid_cache_environment",desc:"Invalid environment when attempting to create cache entry"},Gz={code:"no_account_found",desc:"No account found in cache for given key."},Kz={code:"no cache plugin set on CacheManager",desc:"ICachePlugin needs to be set before using readFromStorage or writeFromStorage"},Zz={code:"no_crypto_object",desc:"No crypto object detected. This is required for the following operation: "},Wz={code:"invalid_cache_type",desc:"Invalid cache type"},$z={code:"unexpected_account_type",desc:"Unexpected account type."},Yz={code:"unexpected_credential_type",desc:"Unexpected credential type."},Xz={code:"invalid_assertion",desc:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515"},Qz={code:"invalid_client_credential",desc:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential"},Jz={code:"token_refresh_required",desc:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired."},eF={code:"user_timeout_reached",desc:"User defined timeout for device code polling reached"},tF={code:"token_claims_cnf_required_for_signedjwt",desc:"Cannot generate a POP jwt if the token_claims are not populated"},rF={code:"authorization_code_missing_from_server_response",desc:"Server response does not contain an authorization code to proceed"},nF={code:"binding_key_not_removed",desc:"Could not remove the credential's binding key from storage."},iF={code:"end_session_endpoint_not_supported",desc:"Provided authority does not support logout."},oF={code:"key_id_missing",desc:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key."},aF={code:"no_network_connectivity",desc:"No network connectivity. Check your internet connection."},sF={code:"user_canceled",desc:"User canceled the flow."},lF=function(e){function t(r,n){return(r=e.call(this,r,n)||this).name="ClientAuthError",Object.setPrototypeOf(r,t.prototype),r}return TN(t,e),t.createClientInfoDecodingError=function(e){return new t(gz.code,gz.desc+" Failed with error: "+e)},t.createClientInfoEmptyError=function(){return new t(yz.code,""+yz.desc)},t.createTokenParsingError=function(e){return new t(vz.code,vz.desc+" Failed with error: "+e)},t.createTokenNullOrEmptyError=function(e){return new t(_z.code,_z.desc+" Raw Token Value: "+e)},t.createEndpointDiscoveryIncompleteError=function(e){return new t(bz.code,bz.desc+" Detail: "+e)},t.createNetworkError=function(e,r){return new t(wz.code,wz.desc+" | Fetch client threw: "+r+" | Attempted to reach: "+e.split("?")[0])},t.createUnableToGetOpenidConfigError=function(e){return new t(xz.code,xz.desc+" Attempted to retrieve endpoints from: "+e)},t.createHashNotDeserializedError=function(e){return new t(Cz.code,Cz.desc+" Given Object: "+e)},t.createInvalidStateError=function(e,r){return new t(Sz.code,Sz.desc+" Invalid State: "+e+", Root Err: "+r)},t.createStateMismatchError=function(){return new t(Ez.code,Ez.desc)},t.createStateNotFoundError=function(e){return new t(Tz.code,Tz.desc+":  "+e)},t.createNonceMismatchError=function(){return new t(Iz.code,Iz.desc)},t.createAuthTimeNotFoundError=function(){return new t(Az.code,Az.desc)},t.createMaxAgeTranspiredError=function(){return new t(Pz.code,Pz.desc)},t.createNonceNotFoundError=function(e){return new t(kz.code,kz.desc+":  "+e)},t.createMultipleMatchingTokensInCacheError=function(){return new t(Mz.code,Mz.desc+".")},t.createMultipleMatchingAccountsInCacheError=function(){return new t(Rz.code,Rz.desc)},t.createMultipleMatchingAppMetadataInCacheError=function(){return new t(Oz.code,Oz.desc)},t.createTokenRequestCannotBeMadeError=function(){return new t(Lz.code,Lz.desc)},t.createAppendEmptyScopeToSetError=function(e){return new t(Dz.code,Dz.desc+" Given Scope: "+e)},t.createRemoveEmptyScopeFromSetError=function(e){return new t(Nz.code,Nz.desc+" Given Scope: "+e)},t.createAppendScopeSetError=function(e){return new t(zz.code,zz.desc+" Detail Error: "+e)},t.createEmptyInputScopeSetError=function(){return new t(Fz.code,""+Fz.desc)},t.createDeviceCodeCancelledError=function(){return new t(Bz.code,""+Bz.desc)},t.createDeviceCodeExpiredError=function(){return new t(Uz.code,""+Uz.desc)},t.createDeviceCodeUnknownError=function(){return new t(jz.code,""+jz.desc)},t.createNoAccountInSilentRequestError=function(){return new t(qz.code,""+qz.desc)},t.createNullOrUndefinedCacheRecord=function(){return new t(Hz.code,Hz.desc)},t.createInvalidCacheEnvironmentError=function(){return new t(Vz.code,Vz.desc)},t.createNoAccountFoundError=function(){return new t(Gz.code,Gz.desc)},t.createCachePluginError=function(){return new t(Kz.code,""+Kz.desc)},t.createNoCryptoObjectError=function(e){return new t(Zz.code,""+Zz.desc+e)},t.createInvalidCacheTypeError=function(){return new t(Wz.code,""+Wz.desc)},t.createUnexpectedAccountTypeError=function(){return new t($z.code,""+$z.desc)},t.createUnexpectedCredentialTypeError=function(){return new t(Yz.code,""+Yz.desc)},t.createInvalidAssertionError=function(){return new t(Xz.code,""+Xz.desc)},t.createInvalidCredentialError=function(){return new t(Qz.code,""+Qz.desc)},t.createRefreshRequiredError=function(){return new t(Jz.code,Jz.desc)},t.createUserTimeoutReachedError=function(){return new t(eF.code,eF.desc)},t.createTokenClaimsRequiredError=function(){return new t(tF.code,tF.desc)},t.createNoAuthCodeInServerResponseError=function(){return new t(rF.code,rF.desc)},t.createBindingKeyNotRemovedError=function(){return new t(nF.code,nF.desc)},t.createLogoutNotSupportedError=function(){return new t(iF.code,iF.desc)},t.createKeyIdMissingError=function(){return new t(oF.code,oF.desc)},t.createNoNetworkConnectivityError=function(){return new t(aF.code,aF.desc)},t.createUserCanceledError=function(){return new t(sF.code,sF.desc)},t}(fz),cF=function(){function e(){}return e.decodeAuthToken=function(t){if(e.isEmpty(t))throw lF.createTokenNullOrEmptyError(t);var r=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(t);if(!r||r.length<4)throw lF.createTokenParsingError("Given token is malformed: "+JSON.stringify(t));return{header:r[1],JWSPayload:r[2],JWSSig:r[3]}},e.isEmpty=function(e){return void 0===e||!e||0===e.length},e.isEmptyObj=function(t){if(t&&!e.isEmpty(t))try{var r=JSON.parse(t);return 0===Object.keys(r).length}catch(t){}return!0},e.startsWith=function(e,t){return 0===e.indexOf(t)},e.endsWith=function(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length},e.queryStringToObject=function(e){function t(e){return decodeURIComponent(e.replace(/\+/g," "))}var r={};return(e=e.split("&")).forEach((function(e){var n;e.trim()&&(n=(e=e.split(/=(.+)/g,2))[0],e=e[1],n)&&e&&(r[t(n)]=t(e))})),r},e.trimArrayEntries=function(e){return e.map((function(e){return e.trim()}))},e.removeEmptyStringsFromArray=function(t){return t.filter((function(t){return!e.isEmpty(t)}))},e.jsonParseHelper=function(e){try{return JSON.parse(e)}catch(e){return null}},e.matchPattern=function(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)},e}(),uF=(function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose",e[e.Trace=4]="Trace"}(XN=XN||{}),function(){function e(t,r,n){this.level=XN.Info,t=t||e.createDefaultLoggerOptions(),this.localCallback=t.loggerCallback||function(){},this.piiLoggingEnabled=t.piiLoggingEnabled||!1,this.level="number"==typeof t.logLevel?t.logLevel:XN.Info,this.correlationId=t.correlationId||ez.EMPTY_STRING,this.packageName=r||ez.EMPTY_STRING,this.packageVersion=n||ez.EMPTY_STRING}return e.createDefaultLoggerOptions=function(){return{loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:XN.Info}},e.prototype.clone=function(t,r,n){return new e({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:n||this.correlationId},t,r)},e.prototype.logMessage=function(e,t){var r;t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii||(r=(new Date).toUTCString(),r=(cF.isEmpty(t.correlationId)?cF.isEmpty(this.correlationId)?"["+r+"]":"["+r+"] : ["+this.correlationId+"]":"["+r+"] : ["+t.correlationId+"]")+" : "+this.packageName+"@"+this.packageVersion+" : "+XN[t.logLevel]+" - "+e,this.executeCallback(t.logLevel,r,t.containsPii||!1))},e.prototype.executeCallback=function(e,t,r){this.localCallback&&this.localCallback(e,t,r)},e.prototype.error=function(e,t){this.logMessage(e,{logLevel:XN.Error,containsPii:!1,correlationId:t||ez.EMPTY_STRING})},e.prototype.errorPii=function(e,t){this.logMessage(e,{logLevel:XN.Error,containsPii:!0,correlationId:t||ez.EMPTY_STRING})},e.prototype.warning=function(e,t){this.logMessage(e,{logLevel:XN.Warning,containsPii:!1,correlationId:t||ez.EMPTY_STRING})},e.prototype.warningPii=function(e,t){this.logMessage(e,{logLevel:XN.Warning,containsPii:!0,correlationId:t||ez.EMPTY_STRING})},e.prototype.info=function(e,t){this.logMessage(e,{logLevel:XN.Info,containsPii:!1,correlationId:t||ez.EMPTY_STRING})},e.prototype.infoPii=function(e,t){this.logMessage(e,{logLevel:XN.Info,containsPii:!0,correlationId:t||ez.EMPTY_STRING})},e.prototype.verbose=function(e,t){this.logMessage(e,{logLevel:XN.Verbose,containsPii:!1,correlationId:t||ez.EMPTY_STRING})},e.prototype.verbosePii=function(e,t){this.logMessage(e,{logLevel:XN.Verbose,containsPii:!0,correlationId:t||ez.EMPTY_STRING})},e.prototype.trace=function(e,t){this.logMessage(e,{logLevel:XN.Trace,containsPii:!1,correlationId:t||ez.EMPTY_STRING})},e.prototype.tracePii=function(e,t){this.logMessage(e,{logLevel:XN.Trace,containsPii:!0,correlationId:t||ez.EMPTY_STRING})},e.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled||!1},e}()),hF="@azure/msal-common",dF="13.3.1",pF=(function(e){e[e.None=0]="None",e.AzurePublic="https://login.microsoftonline.com",e.AzurePpe="https://login.windows-ppe.net",e.AzureChina="https://login.chinacloudapi.cn",e.AzureGermany="https://login.microsoftonline.de",e.AzureUsGovernment="https://login.microsoftonline.us"}(QN=QN||{}),{redirectUriNotSet:{code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},postLogoutUriNotSet:{code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},claimsRequestParsingError:{code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},authorityUriInsecure:{code:"authority_uri_insecure",desc:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},urlParseError:{code:"url_parse_error",desc:"URL could not be parsed into appropriate segments."},urlEmptyError:{code:"empty_url_error",desc:"URL was empty or null."},emptyScopesError:{code:"empty_input_scopes_error",desc:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token."},nonArrayScopesError:{code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},clientIdSingleScopeError:{code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},invalidPrompt:{code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent', 'create', 'none' and 'no_session'.  Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest"},invalidClaimsRequest:{code:"invalid_claims",desc:"Given claims parameter must be a stringified JSON object."},tokenRequestEmptyError:{code:"token_request_empty",desc:"Token request was empty and not found in cache."},logoutRequestEmptyError:{code:"logout_request_empty",desc:"The logout request was null or undefined."},invalidCodeChallengeMethod:{code:"invalid_code_challenge_method",desc:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".'},invalidCodeChallengeParams:{code:"pkce_params_missing",desc:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request"},invalidCloudDiscoveryMetadata:{code:"invalid_cloud_discovery_metadata",desc:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields"},invalidAuthorityMetadata:{code:"invalid_authority_metadata",desc:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields."},untrustedAuthority:{code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter."},invalidAzureCloudInstance:{code:"invalid_azure_cloud_instance",desc:"Invalid AzureCloudInstance provided. Please refer MSAL JS docs: aks.ms/msaljs/azure_cloud_instance for valid values"},missingSshJwk:{code:"missing_ssh_jwk",desc:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme."},missingSshKid:{code:"missing_ssh_kid",desc:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme."},missingNonceAuthenticationHeader:{code:"missing_nonce_authentication_header",desc:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce."},invalidAuthenticationHeader:{code:"invalid_authentication_header",desc:"Invalid authentication header provided"},authorityMismatch:{code:"authority_mismatch",desc:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."}}),fF=function(e){function t(r,n){return(r=e.call(this,r,n)||this).name="ClientConfigurationError",Object.setPrototypeOf(r,t.prototype),r}return TN(t,e),t.createRedirectUriEmptyError=function(){return new t(pF.redirectUriNotSet.code,pF.redirectUriNotSet.desc)},t.createPostLogoutRedirectUriEmptyError=function(){return new t(pF.postLogoutUriNotSet.code,pF.postLogoutUriNotSet.desc)},t.createClaimsRequestParsingError=function(e){return new t(pF.claimsRequestParsingError.code,pF.claimsRequestParsingError.desc+" Given value: "+e)},t.createInsecureAuthorityUriError=function(e){return new t(pF.authorityUriInsecure.code,pF.authorityUriInsecure.desc+" Given URI: "+e)},t.createUrlParseError=function(e){return new t(pF.urlParseError.code,pF.urlParseError.desc+" Given Error: "+e)},t.createUrlEmptyError=function(){return new t(pF.urlEmptyError.code,pF.urlEmptyError.desc)},t.createEmptyScopesArrayError=function(){return new t(pF.emptyScopesError.code,""+pF.emptyScopesError.desc)},t.createClientIdSingleScopeError=function(e){return new t(pF.clientIdSingleScopeError.code,pF.clientIdSingleScopeError.desc+" Given Scopes: "+e)},t.createInvalidPromptError=function(e){return new t(pF.invalidPrompt.code,pF.invalidPrompt.desc+" Given value: "+e)},t.createInvalidClaimsRequestError=function(){return new t(pF.invalidClaimsRequest.code,pF.invalidClaimsRequest.desc)},t.createEmptyLogoutRequestError=function(){return new t(pF.logoutRequestEmptyError.code,pF.logoutRequestEmptyError.desc)},t.createEmptyTokenRequestError=function(){return new t(pF.tokenRequestEmptyError.code,pF.tokenRequestEmptyError.desc)},t.createInvalidCodeChallengeMethodError=function(){return new t(pF.invalidCodeChallengeMethod.code,pF.invalidCodeChallengeMethod.desc)},t.createInvalidCodeChallengeParamsError=function(){return new t(pF.invalidCodeChallengeParams.code,pF.invalidCodeChallengeParams.desc)},t.createInvalidCloudDiscoveryMetadataError=function(){return new t(pF.invalidCloudDiscoveryMetadata.code,pF.invalidCloudDiscoveryMetadata.desc)},t.createInvalidAuthorityMetadataError=function(){return new t(pF.invalidAuthorityMetadata.code,pF.invalidAuthorityMetadata.desc)},t.createUntrustedAuthorityError=function(){return new t(pF.untrustedAuthority.code,pF.untrustedAuthority.desc)},t.createInvalidAzureCloudInstanceError=function(){return new t(pF.invalidAzureCloudInstance.code,pF.invalidAzureCloudInstance.desc)},t.createMissingSshJwkError=function(){return new t(pF.missingSshJwk.code,pF.missingSshJwk.desc)},t.createMissingSshKidError=function(){return new t(pF.missingSshKid.code,pF.missingSshKid.desc)},t.createMissingNonceAuthenticationHeadersError=function(){return new t(pF.missingNonceAuthenticationHeader.code,pF.missingNonceAuthenticationHeader.desc)},t.createInvalidAuthenticationHeaderError=function(e,r){return new t(pF.invalidAuthenticationHeader.code,pF.invalidAuthenticationHeader.desc+". Invalid header: "+e+". Details: "+r)},t.createAuthorityMismatchError=function(){return new t(pF.authorityMismatch.code,pF.authorityMismatch.desc)},t}(lF),mF=function(){function e(e){var t=this;e=(e=e?cF.trimArrayEntries(PN(e)):[])?cF.removeEmptyStringsFromArray(e):[];this.validateInputScopes(e),this.scopes=new Set,e.forEach((function(e){return t.scopes.add(e)}))}return e.fromString=function(t){return new e((t||ez.EMPTY_STRING).split(" "))},e.createSearchScopes=function(t){return(t=new e(t)).containsOnlyOIDCScopes()?t.removeScope(ez.OFFLINE_ACCESS_SCOPE):t.removeOIDCScopes(),t},e.prototype.validateInputScopes=function(e){if(!e||e.length<1)throw fF.createEmptyScopesArrayError()},e.prototype.containsScope=function(t){var r=new e(this.printScopesLowerCase().split(" "));return!cF.isEmpty(t)&&r.scopes.has(t.toLowerCase())},e.prototype.containsScopeSet=function(e){var t=this;return!(!e||e.scopes.size<=0)&&this.scopes.size>=e.scopes.size&&e.asArray().every((function(e){return t.containsScope(e)}))},e.prototype.containsOnlyOIDCScopes=function(){var e=this,t=0;return rz.forEach((function(r){e.containsScope(r)&&(t+=1)})),this.scopes.size===t},e.prototype.appendScope=function(e){cF.isEmpty(e)||this.scopes.add(e.trim())},e.prototype.appendScopes=function(e){var t=this;try{e.forEach((function(e){return t.appendScope(e)}))}catch(e){throw lF.createAppendScopeSetError(e)}},e.prototype.removeScope=function(e){if(cF.isEmpty(e))throw lF.createRemoveEmptyScopeFromSetError(e);this.scopes.delete(e.trim())},e.prototype.removeOIDCScopes=function(){var e=this;rz.forEach((function(t){e.scopes.delete(t)}))},e.prototype.unionScopeSets=function(e){var t;if(e)return t=new Set,e.scopes.forEach((function(e){return t.add(e.toLowerCase())})),this.scopes.forEach((function(e){return t.add(e.toLowerCase())})),t;throw lF.createEmptyInputScopeSetError()},e.prototype.intersectingScopeSets=function(e){if(!e)throw lF.createEmptyInputScopeSetError();e.containsOnlyOIDCScopes()||e.removeOIDCScopes();var t=this.unionScopeSets(e),r=(e=e.getScopeCount(),this.getScopeCount());return t.size<r+e},e.prototype.getScopeCount=function(){return this.scopes.size},e.prototype.asArray=function(){var e=[];return this.scopes.forEach((function(t){return e.push(t)})),e},e.prototype.printScopes=function(){return this.scopes?this.asArray().join(" "):ez.EMPTY_STRING},e.prototype.printScopesLowerCase=function(){return this.printScopes().toLowerCase()},e}();function gF(e,t){if(cF.isEmpty(e))throw lF.createClientInfoEmptyError();try{var r=t.base64Decode(e);return JSON.parse(r)}catch(e){throw lF.createClientInfoDecodingError(e.message)}}function yF(e){if(cF.isEmpty(e))throw lF.createClientInfoDecodingError("Home account ID was empty.");return{uid:(e=e.split(UN.CLIENT_INFO_SEPARATOR,2))[0],utid:e.length<2?ez.EMPTY_STRING:e[1]}}!function(e){e[e.Default=0]="Default",e[e.Adfs=1]="Adfs",e[e.Dsts=2]="Dsts",e[e.Ciam=3]="Ciam"}(JN=JN||{});var vF=function(){function e(){}return e.prototype.generateAccountId=function(){return[this.homeAccountId,this.environment].join(UN.CACHE_KEY_SEPARATOR).toLowerCase()},e.prototype.generateAccountKey=function(){return e.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})},e.prototype.generateType=function(){switch(this.authorityType){case BN.ADFS_ACCOUNT_TYPE:return qN.ADFS;case BN.MSAV1_ACCOUNT_TYPE:return qN.MSA;case BN.MSSTS_ACCOUNT_TYPE:return qN.MSSTS;case BN.GENERIC_ACCOUNT_TYPE:return qN.GENERIC;default:throw lF.createUnexpectedAccountTypeError()}},e.prototype.getAccountInfo=function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,idTokenClaims:this.idTokenClaims,nativeAccountId:this.nativeAccountId}},e.generateAccountCacheKey=function(e){return[e.homeAccountId,e.environment||ez.EMPTY_STRING,e.tenantId||ez.EMPTY_STRING].join(UN.CACHE_KEY_SEPARATOR).toLowerCase()},e.createAccount=function(t,r,n,i,o,a,s,l){var c=new e;if(t=(c.authorityType=BN.MSSTS_ACCOUNT_TYPE,c.clientInfo=t,c.homeAccountId=r,c.nativeAccountId=l,s||i&&i.getPreferredCache()))return c.environment=t,c.realm=(null==(r=null==n?void 0:n.claims)?void 0:r.tid)||ez.EMPTY_STRING,n&&(c.idTokenClaims=n.claims,c.localAccountId=(null==(l=null==n?void 0:n.claims)?void 0:l.oid)||(null==(s=null==n?void 0:n.claims)?void 0:s.sub)||ez.EMPTY_STRING,t=null==(i=null==n?void 0:n.claims)?void 0:i.preferred_username,l=null!=(r=null==n?void 0:n.claims)&&r.emails?n.claims.emails[0]:null,c.username=t||l||ez.EMPTY_STRING,c.name=null==(s=null==n?void 0:n.claims)?void 0:s.name),c.cloudGraphHostName=o,c.msGraphHost=a,c;throw lF.createInvalidCacheEnvironmentError()},e.createGenericAccount=function(t,r,n,i,o,a){var s=new e;if(t=(s.authorityType=n&&n.authorityType===JN.Adfs?BN.ADFS_ACCOUNT_TYPE:BN.GENERIC_ACCOUNT_TYPE,s.homeAccountId=t,s.realm=ez.EMPTY_STRING,a||n&&n.getPreferredCache()))return r&&(s.localAccountId=(null==(a=null==r?void 0:r.claims)?void 0:a.oid)||(null==(n=null==r?void 0:r.claims)?void 0:n.sub)||ez.EMPTY_STRING,s.username=(null==(a=null==r?void 0:r.claims)?void 0:a.upn)||ez.EMPTY_STRING,s.name=(null==(n=null==r?void 0:r.claims)?void 0:n.name)||ez.EMPTY_STRING,s.idTokenClaims=null==r?void 0:r.claims),s.environment=t,s.cloudGraphHostName=i,s.msGraphHost=o,s;throw lF.createInvalidCacheEnvironmentError()},e.generateHomeAccountId=function(e,t,r,n,i){var o=null!=(o=null==i?void 0:i.claims)&&o.sub?i.claims.sub:ez.EMPTY_STRING;if(t!==JN.Adfs&&t!==JN.Dsts){if(e)try{var a=gF(e,n);if(!cF.isEmpty(a.uid)&&!cF.isEmpty(a.utid))return""+a.uid+UN.CLIENT_INFO_SEPARATOR+a.utid}catch(e){}r.verbose("No client info in response")}return o},e.isAccountEntity=function(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType")},e.accountInfoIsEqual=function(e,t,r){var n,i;return!(!e||!t)&&(i=!0,r&&(r=e.idTokenClaims||{},n=t.idTokenClaims||{},i=r.iat===n.iat&&r.nonce===n.nonce),e.homeAccountId===t.homeAccountId)&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&i},e}(),_F=function(){function e(t,r){if(cF.isEmpty(t))throw lF.createTokenNullOrEmptyError(t);this.rawToken=t,this.claims=e.extractTokenClaims(t,r)}return e.extractTokenClaims=function(e,t){e=cF.decodeAuthToken(e);try{var r=e.JWSPayload,n=t.base64Decode(r);return JSON.parse(n)}catch(e){throw lF.createTokenParsingError(e)}},e.checkMaxAge=function(e,t){if(0===t||Date.now()-3e5>e+t)throw lF.createMaxAgeTranspiredError()},e}(),bF=function(){function e(e,t,r){this.clientId=e,this.cryptoImpl=t,this.commonLogger=r.clone(hF,dF)}return e.prototype.getAllAccounts=function(){var e=this,t=this.getAccountKeys();return t.length<1||(t=t.reduce((function(t,r){return(r=e.getAccount(r))&&t.push(r),t}),[])).length<1?[]:t.map((function(t){return e.getAccountInfoFromEntity(t)}))},e.prototype.getAccountInfoFilteredBy=function(e){return 0<(e=this.getAccountsFilteredBy(e)).length?this.getAccountInfoFromEntity(e[0]):null},e.prototype.getAccountInfoFromEntity=function(e){e=e.getAccountInfo();var t=this.getIdToken(e);return t&&(e.idToken=t.secret,e.idTokenClaims=new _F(t.secret,this.cryptoImpl).claims),e},e.prototype.saveCacheRecord=function(e){return kN(this,void 0,void 0,(function(){return AN(this,(function(t){switch(t.label){case 0:if(e)return e.account&&this.setAccount(e.account),e.idToken&&this.setIdTokenCredential(e.idToken),e.accessToken?[4,this.saveAccessToken(e.accessToken)]:[3,2];throw lF.createNullOrUndefinedCacheRecord();case 1:t.sent(),t.label=2;case 2:return e.refreshToken&&this.setRefreshTokenCredential(e.refreshToken),e.appMetadata&&this.setAppMetadata(e.appMetadata),[2]}}))}))},e.prototype.saveAccessToken=function(e){return kN(this,void 0,void 0,(function(){var t,r,n,i,o=this;return AN(this,(function(a){switch(a.label){case 0:return t={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},r=this.getTokenKeys(),n=mF.fromString(e.target),i=[],r.accessToken.forEach((function(e){var r;o.accessTokenKeyMatchesFilter(e,t,!1)&&(r=o.getAccessTokenCredential(e))&&o.credentialMatchesFilter(r,t)&&mF.fromString(r.target).intersectingScopeSets(n)&&i.push(o.removeAccessToken(e))})),[4,Promise.all(i)];case 1:return a.sent(),this.setAccessTokenCredential(e),[2]}}))}))},e.prototype.getAccountsFilteredBy=function(e){var t=this,r=this.getAccountKeys(),n=[];return r.forEach((function(r){!t.isAccountKey(r,e.homeAccountId,e.realm)||!(r=t.getAccount(r))||e.homeAccountId&&!t.matchHomeAccountId(r,e.homeAccountId)||e.localAccountId&&!t.matchLocalAccountId(r,e.localAccountId)||e.username&&!t.matchUsername(r,e.username)||e.environment&&!t.matchEnvironment(r,e.environment)||e.realm&&!t.matchRealm(r,e.realm)||e.nativeAccountId&&!t.matchNativeAccountId(r,e.nativeAccountId)||n.push(r)})),n},e.prototype.isAccountKey=function(e,t,r){return!(e.split(UN.CACHE_KEY_SEPARATOR).length<3||t&&!e.toLowerCase().includes(t.toLowerCase())||r&&!e.toLowerCase().includes(r.toLowerCase()))},e.prototype.isCredentialKey=function(e){if(e.split(UN.CACHE_KEY_SEPARATOR).length<6)return!1;if(-1===(e=e.toLowerCase()).indexOf(jN.ID_TOKEN.toLowerCase())&&-1===e.indexOf(jN.ACCESS_TOKEN.toLowerCase())&&-1===e.indexOf(jN.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())&&-1===e.indexOf(jN.REFRESH_TOKEN.toLowerCase()))return!1;if(-1<e.indexOf(jN.REFRESH_TOKEN.toLowerCase())){var t=""+jN.REFRESH_TOKEN+UN.CACHE_KEY_SEPARATOR+this.clientId+UN.CACHE_KEY_SEPARATOR,r=""+jN.REFRESH_TOKEN+UN.CACHE_KEY_SEPARATOR+az+UN.CACHE_KEY_SEPARATOR;if(-1===e.indexOf(t.toLowerCase())&&-1===e.indexOf(r.toLowerCase()))return!1}else if(-1===e.indexOf(this.clientId.toLowerCase()))return!1;return!0},e.prototype.credentialMatchesFilter=function(e,t){if(t.clientId&&!this.matchClientId(e,t.clientId))return!1;if(t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash))return!1;if("string"==typeof t.homeAccountId&&!this.matchHomeAccountId(e,t.homeAccountId))return!1;if(t.environment&&!this.matchEnvironment(e,t.environment))return!1;if(t.realm&&!this.matchRealm(e,t.realm))return!1;if(t.credentialType&&!this.matchCredentialType(e,t.credentialType))return!1;if(t.familyId&&!this.matchFamilyId(e,t.familyId))return!1;if(t.target&&!this.matchTarget(e,t.target))return!1;if((t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash)return!1;if(e.credentialType===jN.ACCESS_TOKEN_WITH_AUTH_SCHEME){if(t.tokenType&&!this.matchTokenType(e,t.tokenType))return!1;if(t.tokenType===VN.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId))return!1}return!0},e.prototype.getAppMetadataFilteredBy=function(e){return this.getAppMetadataFilteredByInternal(e.environment,e.clientId)},e.prototype.getAppMetadataFilteredByInternal=function(e,t){var r=this,n=this.getKeys(),i={};return n.forEach((function(n){var o;!r.isAppMetadata(n)||!(o=r.getAppMetadata(n))||e&&!r.matchEnvironment(o,e)||t&&!r.matchClientId(o,t)||(i[n]=o)})),i},e.prototype.getAuthorityMetadataByAlias=function(e){var t=this,r=this.getAuthorityMetadataKeys(),n=null;return r.forEach((function(r){t.isAuthorityMetadata(r)&&-1!==r.indexOf(t.clientId)&&(r=t.getAuthorityMetadata(r))&&-1!==r.aliases.indexOf(e)&&(n=r)})),n},e.prototype.removeAllAccounts=function(){return kN(this,void 0,void 0,(function(){var e,t,r=this;return AN(this,(function(n){switch(n.label){case 0:return e=this.getAccountKeys(),t=[],e.forEach((function(e){t.push(r.removeAccount(e))})),[4,Promise.all(t)];case 1:return n.sent(),[2]}}))}))},e.prototype.removeAccount=function(e){return kN(this,void 0,void 0,(function(){var t;return AN(this,(function(r){switch(r.label){case 0:if(t=this.getAccount(e))return[4,this.removeAccountContext(t)];throw lF.createNoAccountFoundError();case 1:return r.sent(),this.removeItem(e),[2]}}))}))},e.prototype.removeAccountContext=function(e){return kN(this,void 0,void 0,(function(){var t,r,n,i=this;return AN(this,(function(o){switch(o.label){case 0:return t=this.getTokenKeys(),r=e.generateAccountId(),n=[],t.idToken.forEach((function(e){0===e.indexOf(r)&&i.removeIdToken(e)})),t.accessToken.forEach((function(e){0===e.indexOf(r)&&n.push(i.removeAccessToken(e))})),t.refreshToken.forEach((function(e){0===e.indexOf(r)&&i.removeRefreshToken(e)})),[4,Promise.all(n)];case 1:return o.sent(),[2]}}))}))},e.prototype.removeAccessToken=function(e){return kN(this,void 0,void 0,(function(){var t;return AN(this,(function(r){switch(r.label){case 0:if(!(t=this.getAccessTokenCredential(e)))return[2];if(t.credentialType.toLowerCase()!==jN.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())return[3,4];if(t.tokenType!==VN.POP)return[3,4];if(!(t=t.keyId))return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.cryptoImpl.removeTokenBindingKey(t)];case 2:return r.sent(),[3,4];case 3:throw r.sent(),lF.createBindingKeyNotRemovedError();case 4:return[2,this.removeItem(e)]}}))}))},e.prototype.removeAppMetadata=function(){var e=this;return this.getKeys().forEach((function(t){e.isAppMetadata(t)&&e.removeItem(t)})),!0},e.prototype.readCacheRecord=function(e,t,r){var n=this.getTokenKeys(),i=this.readAccountFromCache(e),o=this.getIdToken(e,n);t=this.getAccessToken(e,t,n),e=this.getRefreshToken(e,!1,n),n=this.readAppMetadataFromCache(r);return i&&o&&(i.idTokenClaims=new _F(o.secret,this.cryptoImpl).claims),{account:i,idToken:o,accessToken:t,refreshToken:e,appMetadata:n}},e.prototype.readAccountFromCache=function(e){return e=vF.generateAccountCacheKey(e),this.getAccount(e)},e.prototype.getIdToken=function(e,t){var r=this;this.commonLogger.trace("CacheManager - getIdToken called"),e={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:jN.ID_TOKEN,clientId:this.clientId,realm:e.tenantId};return(t=(e=this.getIdTokensByFilter(e,t)).length)<1?(this.commonLogger.info("CacheManager:getIdToken - No token found"),null):1<t?(this.commonLogger.info("CacheManager:getIdToken - Multiple id tokens found, clearing them"),e.forEach((function(e){r.removeIdToken(e.generateCredentialKey())})),null):(this.commonLogger.info("CacheManager:getIdToken - Returning id token"),e[0])},e.prototype.getIdTokensByFilter=function(e,t){var r=this,n=(t=t&&t.idToken||this.getTokenKeys().idToken,[]);return t.forEach((function(t){r.idTokenKeyMatchesFilter(t,IN({clientId:r.clientId},e))&&(t=r.getIdTokenCredential(t))&&r.credentialMatchesFilter(t,e)&&n.push(t)})),n},e.prototype.idTokenKeyMatchesFilter=function(e,t){return e=e.toLowerCase(),!(t.clientId&&-1===e.indexOf(t.clientId.toLowerCase())||t.homeAccountId&&-1===e.indexOf(t.homeAccountId.toLowerCase()))},e.prototype.removeIdToken=function(e){this.removeItem(e)},e.prototype.removeRefreshToken=function(e){this.removeItem(e)},e.prototype.getAccessToken=function(e,t,r){var n=this,i=(this.commonLogger.trace("CacheManager - getAccessToken called"),mF.createSearchScopes(t.scopes)),o=t.authenticationScheme||VN.BEARER,a=o&&o.toLowerCase()!==VN.BEARER.toLowerCase()?jN.ACCESS_TOKEN_WITH_AUTH_SCHEME:jN.ACCESS_TOKEN,s={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:a,clientId:this.clientId,realm:e.tenantId,target:i,tokenType:o,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},l=(a=r&&r.accessToken||this.getTokenKeys().accessToken,[]);return(e=(a.forEach((function(e){n.accessTokenKeyMatchesFilter(e,s,!0)&&(e=n.getAccessTokenCredential(e))&&n.credentialMatchesFilter(e,s)&&l.push(e)})),l.length))<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found"),null):1<e?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them"),l.forEach((function(e){n.removeAccessToken(e.generateCredentialKey())})),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),l[0])},e.prototype.accessTokenKeyMatchesFilter=function(e,t,r){var n=e.toLowerCase();if(t.clientId&&-1===n.indexOf(t.clientId.toLowerCase()))return!1;if(t.homeAccountId&&-1===n.indexOf(t.homeAccountId.toLowerCase()))return!1;if(t.realm&&-1===n.indexOf(t.realm.toLowerCase()))return!1;if(t.requestedClaimsHash&&-1===n.indexOf(t.requestedClaimsHash.toLowerCase()))return!1;if(t.target)for(var i=t.target.asArray(),o=0;o<i.length;o++){if(r&&!n.includes(i[o].toLowerCase()))return!1;if(!r&&n.includes(i[o].toLowerCase()))return!0}return!0},e.prototype.getAccessTokensByFilter=function(e){var t=this,r=this.getTokenKeys(),n=[];return r.accessToken.forEach((function(r){t.accessTokenKeyMatchesFilter(r,e,!0)&&(r=t.getAccessTokenCredential(r))&&t.credentialMatchesFilter(r,e)&&n.push(r)})),n},e.prototype.getRefreshToken=function(e,t,r){var n=this,i=(t=(this.commonLogger.trace("CacheManager - getRefreshToken called"),t?az:void 0),{homeAccountId:e.homeAccountId,environment:e.environment,credentialType:jN.REFRESH_TOKEN,clientId:this.clientId,familyId:t}),o=(e=r&&r.refreshToken||this.getTokenKeys().refreshToken,[]);return e.forEach((function(e){n.refreshTokenKeyMatchesFilter(e,i)&&(e=n.getRefreshTokenCredential(e))&&n.credentialMatchesFilter(e,i)&&o.push(e)})),o.length<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),o[0])},e.prototype.refreshTokenKeyMatchesFilter=function(e,t){return e=e.toLowerCase(),!(t.familyId&&-1===e.indexOf(t.familyId.toLowerCase())||!t.familyId&&t.clientId&&-1===e.indexOf(t.clientId.toLowerCase())||t.homeAccountId&&-1===e.indexOf(t.homeAccountId.toLowerCase()))},e.prototype.readAppMetadataFromCache=function(e){e={environment:e,clientId:this.clientId};var t=this.getAppMetadataFilteredBy(e),r=(e=Object.keys(t).map((function(e){return t[e]}))).length;if(r<1)return null;if(1<r)throw lF.createMultipleMatchingAppMetadataInCacheError();return e[0]},e.prototype.isAppMetadataFOCI=function(e){return!(!(e=this.readAppMetadataFromCache(e))||e.familyId!==az)},e.prototype.matchHomeAccountId=function(e,t){return!("string"!=typeof e.homeAccountId||t!==e.homeAccountId)},e.prototype.matchLocalAccountId=function(e,t){return!("string"!=typeof e.localAccountId||t!==e.localAccountId)},e.prototype.matchUsername=function(e,t){return!("string"!=typeof e.username||t.toLowerCase()!==e.username.toLowerCase())},e.prototype.matchUserAssertionHash=function(e,t){return!(!e.userAssertionHash||t!==e.userAssertionHash)},e.prototype.matchEnvironment=function(e,t){return!!((t=this.getAuthorityMetadataByAlias(t))&&-1<t.aliases.indexOf(e.environment))},e.prototype.matchCredentialType=function(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()},e.prototype.matchClientId=function(e,t){return!(!e.clientId||t!==e.clientId)},e.prototype.matchFamilyId=function(e,t){return!(!e.familyId||t!==e.familyId)},e.prototype.matchRealm=function(e,t){return!(!e.realm||t!==e.realm)},e.prototype.matchNativeAccountId=function(e,t){return!(!e.nativeAccountId||t!==e.nativeAccountId)},e.prototype.matchTarget=function(e,t){return!(e.credentialType!==jN.ACCESS_TOKEN&&e.credentialType!==jN.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target)&&mF.fromString(e.target).containsScopeSet(t)},e.prototype.matchTokenType=function(e,t){return!(!e.tokenType||e.tokenType!==t)},e.prototype.matchKeyId=function(e,t){return!(!e.keyId||e.keyId!==t)},e.prototype.isAppMetadata=function(e){return-1!==e.indexOf(oz)},e.prototype.isAuthorityMetadata=function(e){return-1!==e.indexOf(sz)},e.prototype.generateAuthorityMetadataCacheKey=function(e){return sz+"-"+this.clientId+"-"+e},e.toObject=function(e,t){for(var r in t)e[r]=t[r];return e},e}(),wF=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return TN(t,e),t.prototype.setAccount=function(){throw fz.createUnexpectedError("Storage interface - setAccount() has not been implemented for the cacheStorage interface.")},t.prototype.getAccount=function(){throw fz.createUnexpectedError("Storage interface - getAccount() has not been implemented for the cacheStorage interface.")},t.prototype.setIdTokenCredential=function(){throw fz.createUnexpectedError("Storage interface - setIdTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getIdTokenCredential=function(){throw fz.createUnexpectedError("Storage interface - getIdTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setAccessTokenCredential=function(){throw fz.createUnexpectedError("Storage interface - setAccessTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getAccessTokenCredential=function(){throw fz.createUnexpectedError("Storage interface - getAccessTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setRefreshTokenCredential=function(){throw fz.createUnexpectedError("Storage interface - setRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getRefreshTokenCredential=function(){throw fz.createUnexpectedError("Storage interface - getRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setAppMetadata=function(){throw fz.createUnexpectedError("Storage interface - setAppMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAppMetadata=function(){throw fz.createUnexpectedError("Storage interface - getAppMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.setServerTelemetry=function(){throw fz.createUnexpectedError("Storage interface - setServerTelemetry() has not been implemented for the cacheStorage interface.")},t.prototype.getServerTelemetry=function(){throw fz.createUnexpectedError("Storage interface - getServerTelemetry() has not been implemented for the cacheStorage interface.")},t.prototype.setAuthorityMetadata=function(){throw fz.createUnexpectedError("Storage interface - setAuthorityMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAuthorityMetadata=function(){throw fz.createUnexpectedError("Storage interface - getAuthorityMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAuthorityMetadataKeys=function(){throw fz.createUnexpectedError("Storage interface - getAuthorityMetadataKeys() has not been implemented for the cacheStorage interface.")},t.prototype.setThrottlingCache=function(){throw fz.createUnexpectedError("Storage interface - setThrottlingCache() has not been implemented for the cacheStorage interface.")},t.prototype.getThrottlingCache=function(){throw fz.createUnexpectedError("Storage interface - getThrottlingCache() has not been implemented for the cacheStorage interface.")},t.prototype.removeItem=function(){throw fz.createUnexpectedError("Storage interface - removeItem() has not been implemented for the cacheStorage interface.")},t.prototype.containsKey=function(){throw fz.createUnexpectedError("Storage interface - containsKey() has not been implemented for the cacheStorage interface.")},t.prototype.getKeys=function(){throw fz.createUnexpectedError("Storage interface - getKeys() has not been implemented for the cacheStorage interface.")},t.prototype.getAccountKeys=function(){throw fz.createUnexpectedError("Storage interface - getAccountKeys() has not been implemented for the cacheStorage interface.")},t.prototype.getTokenKeys=function(){throw fz.createUnexpectedError("Storage interface - getTokenKeys() has not been implemented for the cacheStorage interface.")},t.prototype.clear=function(){return kN(this,void 0,void 0,(function(){return AN(this,(function(e){throw fz.createUnexpectedError("Storage interface - clear() has not been implemented for the cacheStorage interface.")}))}))},t.prototype.updateCredentialCacheKey=function(){throw fz.createUnexpectedError("Storage interface - updateCredentialCacheKey() has not been implemented for the cacheStorage interface.")},t}(bF),xF={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1},CF={loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:XN.Info,correlationId:ez.EMPTY_STRING},SF={claimsBasedCachingEnabled:!0},EF={sendGetRequestAsync:function(){return kN(this,void 0,void 0,(function(){return AN(this,(function(e){throw fz.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented")}))}))},sendPostRequestAsync:function(){return kN(this,void 0,void 0,(function(){return AN(this,(function(e){throw fz.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented")}))}))}},TF={sku:ez.SKU,version:dF,cpu:ez.EMPTY_STRING,os:ez.EMPTY_STRING},IF={clientSecret:ez.EMPTY_STRING,clientAssertion:void 0},kF={azureCloudInstance:QN.None,tenant:""+ez.DEFAULT_COMMON_TENANT},AF={application:{appName:"",appVersion:""}};function PF(e){return IN({clientCapabilities:[],azureCloudOptions:kF,skipAuthorityMetadataCache:!1},e)}var MF,RF,OF,LF,DF=function(e){function t(r,n,i){return(r=e.call(this,r,n,i)||this).name="ServerError",Object.setPrototypeOf(r,t.prototype),r}return TN(t,e),t}(fz),NF=function(){function e(){}return e.generateThrottlingStorageKey=function(e){return uz.THROTTLING_PREFIX+"."+JSON.stringify(e)},e.preProcess=function(t,r){r=e.generateThrottlingStorageKey(r);var n,i=t.getThrottlingCache(r);if(i){if(!(i.throttleTime<Date.now()))throw new DF((null==(n=i.errorCodes)?void 0:n.join(" "))||ez.EMPTY_STRING,i.errorMessage,i.subError);t.removeItem(r)}},e.postProcess=function(t,r,n){(e.checkResponseStatus(n)||e.checkResponseForRetryAfter(n))&&(n={throttleTime:e.calculateThrottleTime(parseInt(n.headers[MN.RETRY_AFTER])),error:n.body.error,errorCodes:n.body.error_codes,errorMessage:n.body.error_description,subError:n.body.suberror},t.setThrottlingCache(e.generateThrottlingStorageKey(r),n))},e.checkResponseStatus=function(e){return 429===e.status||500<=e.status&&e.status<600},e.checkResponseForRetryAfter=function(e){return!!e.headers&&e.headers.hasOwnProperty(MN.RETRY_AFTER)&&(e.status<200||300<=e.status)},e.calculateThrottleTime=function(e){e=e<=0?0:e;var t=Date.now()/1e3;return Math.floor(1e3*Math.min(t+(e||uz.DEFAULT_THROTTLE_TIME_SECONDS),t+uz.DEFAULT_MAX_THROTTLE_TIME_SECONDS))},e.removeThrottle=function(e,t,r,n){t={clientId:t,authority:r.authority,scopes:r.scopes,homeAccountIdentifier:n,claims:r.claims,authenticationScheme:r.authenticationScheme,resourceRequestMethod:r.resourceRequestMethod,resourceRequestUri:r.resourceRequestUri,shrClaims:r.shrClaims,sshKid:r.sshKid},n=this.generateThrottlingStorageKey(t),e.removeItem(n)},e}(),zF=function(){function e(e,t){this.networkClient=e,this.cacheManager=t}return e.prototype.sendPostRequest=function(e,t,r){return kN(this,void 0,void 0,(function(){var n,i;return AN(this,(function(o){switch(o.label){case 0:NF.preProcess(this.cacheManager,e),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.networkClient.sendPostRequestAsync(t,r)];case 2:return n=o.sent(),[3,4];case 3:throw(i=o.sent())instanceof fz?i:lF.createNetworkError(t,i);case 4:return NF.postProcess(this.cacheManager,e,n),[2,n]}}))}))},e}(),FF=(function(e){e.HOME_ACCOUNT_ID="home_account_id",e.UPN="UPN"}(MF=MF||{}),function(){function e(){}return e.validateRedirectUri=function(e){if(cF.isEmpty(e))throw fF.createRedirectUriEmptyError()},e.validatePrompt=function(e){var t,r=[];for(t in nz)r.push(nz[t]);if(r.indexOf(e)<0)throw fF.createInvalidPromptError(e)},e.validateClaims=function(e){try{JSON.parse(e)}catch(e){throw fF.createInvalidClaimsRequestError()}},e.validateCodeChallengeParams=function(e,t){if(cF.isEmpty(e)||cF.isEmpty(t))throw fF.createInvalidCodeChallengeParamsError();this.validateCodeChallengeMethod(t)},e.validateCodeChallengeMethod=function(e){if([iz.PLAIN,iz.S256].indexOf(e)<0)throw fF.createInvalidCodeChallengeMethodError()},e.sanitizeEQParams=function(e,t){return e?(t.forEach((function(t,r){e[r]&&delete e[r]})),Object.fromEntries(Object.entries(e).filter((function(e){return""!==e[1]})))):{}},e}()),BF=function(){function e(){this.parameters=new Map}return e.prototype.addResponseTypeCode=function(){this.parameters.set(LN.RESPONSE_TYPE,encodeURIComponent(ez.CODE_RESPONSE_TYPE))},e.prototype.addResponseTypeForTokenAndIdToken=function(){this.parameters.set(LN.RESPONSE_TYPE,encodeURIComponent(ez.TOKEN_RESPONSE_TYPE+" "+ez.ID_TOKEN_RESPONSE_TYPE))},e.prototype.addResponseMode=function(e){this.parameters.set(LN.RESPONSE_MODE,encodeURIComponent(e||zN.QUERY))},e.prototype.addNativeBroker=function(){this.parameters.set(LN.NATIVE_BROKER,encodeURIComponent("1"))},e.prototype.addScopes=function(e,t){t=(t=void 0===t||t)?PN(e||[],tz):e||[],e=new mF(t),this.parameters.set(LN.SCOPE,encodeURIComponent(e.printScopes()))},e.prototype.addClientId=function(e){this.parameters.set(LN.CLIENT_ID,encodeURIComponent(e))},e.prototype.addRedirectUri=function(e){FF.validateRedirectUri(e),this.parameters.set(LN.REDIRECT_URI,encodeURIComponent(e))},e.prototype.addPostLogoutRedirectUri=function(e){FF.validateRedirectUri(e),this.parameters.set(LN.POST_LOGOUT_URI,encodeURIComponent(e))},e.prototype.addIdTokenHint=function(e){this.parameters.set(LN.ID_TOKEN_HINT,encodeURIComponent(e))},e.prototype.addDomainHint=function(e){this.parameters.set(NN.DOMAIN_HINT,encodeURIComponent(e))},e.prototype.addLoginHint=function(e){this.parameters.set(NN.LOGIN_HINT,encodeURIComponent(e))},e.prototype.addCcsUpn=function(e){this.parameters.set(MN.CCS_HEADER,encodeURIComponent("UPN:"+e))},e.prototype.addCcsOid=function(e){this.parameters.set(MN.CCS_HEADER,encodeURIComponent("Oid:"+e.uid+"@"+e.utid))},e.prototype.addSid=function(e){this.parameters.set(NN.SID,encodeURIComponent(e))},e.prototype.addClaims=function(e,t){e=this.addClientCapabilitiesToClaims(e,t),FF.validateClaims(e),this.parameters.set(LN.CLAIMS,encodeURIComponent(e))},e.prototype.addCorrelationId=function(e){this.parameters.set(LN.CLIENT_REQUEST_ID,encodeURIComponent(e))},e.prototype.addLibraryInfo=function(e){this.parameters.set(LN.X_CLIENT_SKU,e.sku),this.parameters.set(LN.X_CLIENT_VER,e.version),e.os&&this.parameters.set(LN.X_CLIENT_OS,e.os),e.cpu&&this.parameters.set(LN.X_CLIENT_CPU,e.cpu)},e.prototype.addApplicationTelemetry=function(e){null!=e&&e.appName&&this.parameters.set(LN.X_APP_NAME,e.appName),null!=e&&e.appVersion&&this.parameters.set(LN.X_APP_VER,e.appVersion)},e.prototype.addPrompt=function(e){FF.validatePrompt(e),this.parameters.set(""+LN.PROMPT,encodeURIComponent(e))},e.prototype.addState=function(e){cF.isEmpty(e)||this.parameters.set(LN.STATE,encodeURIComponent(e))},e.prototype.addNonce=function(e){this.parameters.set(LN.NONCE,encodeURIComponent(e))},e.prototype.addCodeChallengeParams=function(e,t){if(FF.validateCodeChallengeParams(e,t),!e||!t)throw fF.createInvalidCodeChallengeParamsError();this.parameters.set(LN.CODE_CHALLENGE,encodeURIComponent(e)),this.parameters.set(LN.CODE_CHALLENGE_METHOD,encodeURIComponent(t))},e.prototype.addAuthorizationCode=function(e){this.parameters.set(LN.CODE,encodeURIComponent(e))},e.prototype.addDeviceCode=function(e){this.parameters.set(LN.DEVICE_CODE,encodeURIComponent(e))},e.prototype.addRefreshToken=function(e){this.parameters.set(LN.REFRESH_TOKEN,encodeURIComponent(e))},e.prototype.addCodeVerifier=function(e){this.parameters.set(LN.CODE_VERIFIER,encodeURIComponent(e))},e.prototype.addClientSecret=function(e){this.parameters.set(LN.CLIENT_SECRET,encodeURIComponent(e))},e.prototype.addClientAssertion=function(e){cF.isEmpty(e)||this.parameters.set(LN.CLIENT_ASSERTION,encodeURIComponent(e))},e.prototype.addClientAssertionType=function(e){cF.isEmpty(e)||this.parameters.set(LN.CLIENT_ASSERTION_TYPE,encodeURIComponent(e))},e.prototype.addOboAssertion=function(e){this.parameters.set(LN.OBO_ASSERTION,encodeURIComponent(e))},e.prototype.addRequestTokenUse=function(e){this.parameters.set(LN.REQUESTED_TOKEN_USE,encodeURIComponent(e))},e.prototype.addGrantType=function(e){this.parameters.set(LN.GRANT_TYPE,encodeURIComponent(e))},e.prototype.addClientInfo=function(){this.parameters.set("client_info","1")},e.prototype.addExtraQueryParameters=function(e){var t=this,r=FF.sanitizeEQParams(e,this.parameters);Object.keys(r).forEach((function(r){t.parameters.set(r,e[r])}))},e.prototype.addClientCapabilitiesToClaims=function(e,t){var r;if(e)try{r=JSON.parse(e)}catch(e){throw fF.createInvalidClaimsRequestError()}else r={};return t&&0<t.length&&(r.hasOwnProperty(DN.ACCESS_TOKEN)||(r[DN.ACCESS_TOKEN]={}),r[DN.ACCESS_TOKEN][DN.XMS_CC]={values:t}),JSON.stringify(r)},e.prototype.addUsername=function(e){this.parameters.set(GN.username,encodeURIComponent(e))},e.prototype.addPassword=function(e){this.parameters.set(GN.password,encodeURIComponent(e))},e.prototype.addPopToken=function(e){cF.isEmpty(e)||(this.parameters.set(LN.TOKEN_TYPE,VN.POP),this.parameters.set(LN.REQ_CNF,encodeURIComponent(e)))},e.prototype.addSshJwk=function(e){cF.isEmpty(e)||(this.parameters.set(LN.TOKEN_TYPE,VN.SSH),this.parameters.set(LN.REQ_CNF,encodeURIComponent(e)))},e.prototype.addServerTelemetry=function(e){this.parameters.set(LN.X_CLIENT_CURR_TELEM,e.generateCurrentRequestHeaderValue()),this.parameters.set(LN.X_CLIENT_LAST_TELEM,e.generateLastRequestHeaderValue())},e.prototype.addThrottling=function(){this.parameters.set(LN.X_MS_LIB_CAPABILITY,uz.X_MS_LIB_CAPABILITY_VALUE)},e.prototype.addLogoutHint=function(e){this.parameters.set(LN.LOGOUT_HINT,encodeURIComponent(e))},e.prototype.createQueryString=function(){var e=new Array;return this.parameters.forEach((function(t,r){e.push(r+"="+t)})),e.join("&")},e}(),UF=function(){function e(e,t){this.config=function(e){var t=e.authOptions,r=e.systemOptions,n=e.loggerOptions,i=e.cacheOptions,o=e.storageInterface,a=e.networkInterface,s=e.cryptoInterface,l=e.clientCredentials,c=e.libraryInfo,u=e.telemetry,h=e.serverTelemetryManager,d=e.persistencePlugin;return e=e.serializableCache,n=IN(IN({},CF),n),{authOptions:PF(t),systemOptions:IN(IN({},xF),r),loggerOptions:n,cacheOptions:IN(IN({},SF),i),storageInterface:o||new wF(t.clientId,mz,new uF(n)),networkInterface:a||EF,cryptoInterface:s||mz,clientCredentials:l||IF,libraryInfo:IN(IN({},TF),c),telemetry:IN(IN({},AF),u),serverTelemetryManager:h||null,persistencePlugin:d||null,serializableCache:e||null}}(e),this.logger=new uF(this.config.loggerOptions,hF,dF),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new zF(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}return e.prototype.createTokenRequestHeaders=function(e){var t={};if(t[MN.CONTENT_TYPE]=ez.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case MF.HOME_ACCOUNT_ID:try{var r=yF(e.credential);t[MN.CCS_HEADER]="Oid:"+r.uid+"@"+r.utid}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case MF.UPN:t[MN.CCS_HEADER]="UPN: "+e.credential}return t},e.prototype.executePostToTokenEndpoint=function(e,t,r,n){return kN(this,void 0,void 0,(function(){var i;return AN(this,(function(o){switch(o.label){case 0:return[4,this.networkManager.sendPostRequest(n,e,{body:t,headers:r})];case 1:return i=o.sent(),this.config.serverTelemetryManager&&i.status<500&&429!==i.status&&this.config.serverTelemetryManager.clearTelemetryCache(),[2,i]}}))}))},e.prototype.updateAuthority=function(e){if(!e.discoveryComplete())throw lF.createEndpointDiscoveryIncompleteError("Updated authority has not completed endpoint discovery.");this.authority=e},e.prototype.createTokenQueryParameters=function(e){var t=new BF;return e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.createQueryString()},e}(),jF=function(){function e(){}return e.prototype.generateAccountId=function(){return e.generateAccountIdForCacheKey(this.homeAccountId,this.environment)},e.prototype.generateCredentialId=function(){return e.generateCredentialIdForCacheKey(this.credentialType,this.clientId,this.realm,this.familyId)},e.prototype.generateTarget=function(){return e.generateTargetForCacheKey(this.target)},e.prototype.generateCredentialKey=function(){return e.generateCredentialCacheKey(this.homeAccountId,this.environment,this.credentialType,this.clientId,this.realm,this.target,this.familyId,this.tokenType,this.requestedClaimsHash)},e.prototype.generateType=function(){switch(this.credentialType){case jN.ID_TOKEN:return qN.ID_TOKEN;case jN.ACCESS_TOKEN:case jN.ACCESS_TOKEN_WITH_AUTH_SCHEME:return qN.ACCESS_TOKEN;case jN.REFRESH_TOKEN:return qN.REFRESH_TOKEN;default:throw lF.createUnexpectedCredentialTypeError()}},e.generateCredentialCacheKey=function(e,t,r,n,i,o,a,s,l){return[this.generateAccountIdForCacheKey(e,t),this.generateCredentialIdForCacheKey(r,n,i,a),this.generateTargetForCacheKey(o),this.generateClaimsHashForCacheKey(l),this.generateSchemeForCacheKey(s)].join(UN.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateAccountIdForCacheKey=function(e,t){return[e,t].join(UN.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateCredentialIdForCacheKey=function(e,t,r,n){return[e,e===jN.REFRESH_TOKEN&&n||t,r||ez.EMPTY_STRING].join(UN.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateTargetForCacheKey=function(e){return(e||ez.EMPTY_STRING).toLowerCase()},e.generateClaimsHashForCacheKey=function(e){return(e||ez.EMPTY_STRING).toLowerCase()},e.generateSchemeForCacheKey=function(e){return e&&e.toLowerCase()!==VN.BEARER.toLowerCase()?e.toLowerCase():ez.EMPTY_STRING},e}(),qF=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return TN(t,e),t.createIdTokenEntity=function(e,r,n,i,o){var a=new t;return a.credentialType=jN.ID_TOKEN,a.homeAccountId=e,a.environment=r,a.clientId=i,a.secret=n,a.realm=o,a},t.isIdTokenEntity=function(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===jN.ID_TOKEN},t}(jF),HF=function(){function e(){}return e.nowSeconds=function(){return Math.round((new Date).getTime()/1e3)},e.isTokenExpired=function(t,r){return(Number(t)||0)<e.nowSeconds()+r},e.wasClockTurnedBack=function(t){return Number(t)>e.nowSeconds()},e.delay=function(e,t){return new Promise((function(r){return setTimeout((function(){return r(t)}),e)}))},e}(),VF=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return TN(t,e),t.createAccessTokenEntity=function(e,r,n,i,o,a,s,l,c,u,h,d,p,f,m){var g,y=new t;y.homeAccountId=e,y.credentialType=jN.ACCESS_TOKEN,y.secret=n,e=HF.nowSeconds();if(y.cachedAt=e.toString(),y.expiresOn=s.toString(),y.extendedExpiresOn=l.toString(),u&&(y.refreshOn=u.toString()),y.environment=r,y.clientId=i,y.realm=o,y.target=a,y.userAssertionHash=d,y.tokenType=cF.isEmpty(h)?VN.BEARER:h,f&&(y.requestedClaims=f,y.requestedClaimsHash=m),(null==(e=y.tokenType)?void 0:e.toLowerCase())!==VN.BEARER.toLowerCase())switch(y.credentialType=jN.ACCESS_TOKEN_WITH_AUTH_SCHEME,y.tokenType){case VN.POP:var v=_F.extractTokenClaims(n,c);if(null==(g=null==v?void 0:v.cnf)||!g.kid)throw lF.createTokenClaimsRequiredError();y.keyId=v.cnf.kid;break;case VN.SSH:y.keyId=p}return y},t.isAccessTokenEntity=function(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.hasOwnProperty("target")&&(e.credentialType===jN.ACCESS_TOKEN||e.credentialType===jN.ACCESS_TOKEN_WITH_AUTH_SCHEME)},t}(jF),GF=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return TN(t,e),t.createRefreshTokenEntity=function(e,r,n,i,o,a){var s=new t;return s.clientId=i,s.credentialType=jN.REFRESH_TOKEN,s.environment=r,s.homeAccountId=e,s.secret=n,s.userAssertionHash=a,o&&(s.familyId=o),s},t.isRefreshTokenEntity=function(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===jN.REFRESH_TOKEN},t}(jF),KF=["interaction_required","consent_required","login_required"],ZF=["message_only","additional_action","basic_action","user_password_expired","consent_required"],WF={code:"no_tokens_found",desc:"No refresh token found in the cache. Please sign-in."},$F={code:"native_account_unavailable",desc:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API."},YF=function(e){function t(r,n,i,o,a,s,l){return r=e.call(this,r,n,i)||this,Object.setPrototypeOf(r,t.prototype),r.timestamp=o||ez.EMPTY_STRING,r.traceId=a||ez.EMPTY_STRING,r.correlationId=s||ez.EMPTY_STRING,r.claims=l||ez.EMPTY_STRING,r.name="InteractionRequiredAuthError",r}return TN(t,e),t.isInteractionRequiredError=function(e,t,r){e=!!e&&-1<KF.indexOf(e),r=!!r&&-1<ZF.indexOf(r);var n=!!t&&KF.some((function(e){return-1<t.indexOf(e)}));return e||n||r},t.createNoTokensFoundError=function(){return new t(WF.code,WF.desc)},t.createNativeAccountUnavailableError=function(){return new t($F.code,$F.desc)},t}(fz),XF=function(e,t,r,n,i){this.account=e||null,this.idToken=t||null,this.accessToken=r||null,this.refreshToken=n||null,this.appMetadata=i||null},QF=function(){function e(){}return e.setRequestState=function(t,r,n){return t=e.generateLibraryState(t,n),cF.isEmpty(r)?t:""+t+ez.RESOURCE_DELIM+r},e.generateLibraryState=function(e,t){var r;if(e)return r={id:e.createNewGuid()},t&&(r.meta=t),t=JSON.stringify(r),e.base64Encode(t);throw lF.createNoCryptoObjectError("generateLibraryState")},e.parseRequestState=function(e,t){if(!e)throw lF.createNoCryptoObjectError("parseRequestState");if(cF.isEmpty(t))throw lF.createInvalidStateError(t,"Null, undefined or empty state");try{var r=t.split(ez.RESOURCE_DELIM),n=r[0],i=1<r.length?r.slice(1).join(ez.RESOURCE_DELIM):ez.EMPTY_STRING,o=e.base64Decode(n),a=JSON.parse(o);return{userRequestState:cF.isEmpty(i)?ez.EMPTY_STRING:i,libraryState:a}}catch(e){throw lF.createInvalidStateError(t,e)}},e}(),JF=function(){function e(t){if(this._urlString=t,cF.isEmpty(this._urlString))throw fF.createUrlEmptyError();cF.isEmpty(this.getHash())&&(this._urlString=e.canonicalizeUri(t))}return Object.defineProperty(e.prototype,"urlString",{get:function(){return this._urlString},enumerable:!1,configurable:!0}),e.canonicalizeUri=function(e){var t;return e&&(t=e.toLowerCase(),cF.endsWith(t,"?")?t=t.slice(0,-1):cF.endsWith(t,"?/")&&(t=t.slice(0,-2)),cF.endsWith(t,"/")||(t+="/"),t)},e.prototype.validateAsUri=function(){var e;try{e=this.getUrlComponents()}catch(e){throw fF.createUrlParseError(e)}if(!e.HostNameAndPort||!e.PathSegments)throw fF.createUrlParseError("Given url string: "+this.urlString);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw fF.createInsecureAuthorityUriError(this.urlString)},e.appendQueryString=function(e,t){return cF.isEmpty(t)?e:e.indexOf("?")<0?e+"?"+t:e+"&"+t},e.removeHashFromUrl=function(t){return e.canonicalizeUri(t.split("#")[0])},e.prototype.replaceTenantPath=function(t){var r=this.getUrlComponents(),n=r.PathSegments;return!t||0===n.length||n[0]!==ON.COMMON&&n[0]!==ON.ORGANIZATIONS||(n[0]=t),e.constructAuthorityUriFromObject(r)},e.prototype.getHash=function(){return e.parseHash(this.urlString)},e.prototype.getUrlComponents=function(){var e,t=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?");if(t=this.urlString.match(t))return e=(e=(t={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]}).AbsolutePath.split("/")).filter((function(e){return e&&0<e.length})),t.PathSegments=e,!cF.isEmpty(t.QueryString)&&t.QueryString.endsWith("/")&&(t.QueryString=t.QueryString.substring(0,t.QueryString.length-1)),t;throw fF.createUrlParseError("Given url string: "+this.urlString)},e.getDomainFromUrl=function(e){var t=RegExp("^([^:/?#]+://)?([^/?#]*)");if(t=e.match(t))return t[2];throw fF.createUrlParseError("Given url string: "+e)},e.getAbsoluteUrl=function(t,r){return t[0]===ez.FORWARD_SLASH?(r=new e(r).getUrlComponents()).Protocol+"//"+r.HostNameAndPort+t:t},e.parseHash=function(e){var t=e.indexOf("#"),r=e.indexOf("#/");return-1<r?e.substring(r+2):-1<t?e.substring(t+1):ez.EMPTY_STRING},e.parseQueryString=function(e){var t=e.indexOf("?"),r=e.indexOf("/?");return-1<r?e.substring(r+2):-1<t?e.substring(t+1):ez.EMPTY_STRING},e.constructAuthorityUriFromObject=function(t){return new e(t.Protocol+"//"+t.HostNameAndPort+"/"+t.PathSegments.join("/"))},e.getDeserializedHash=function(t){if(cF.isEmpty(t))return{};var r=e.parseHash(t);if(t=cF.queryStringToObject(cF.isEmpty(r)?t:r))return t;throw lF.createHashNotDeserializedError(JSON.stringify(t))},e.getDeserializedQueryString=function(t){if(cF.isEmpty(t))return{};var r=e.parseQueryString(t);if(t=cF.queryStringToObject(cF.isEmpty(r)?t:r))return t;throw lF.createHashNotDeserializedError(JSON.stringify(t))},e.hashContainsKnownProperties=function(t){return!(cF.isEmpty(t)||t.indexOf("=")<0||!((t=e.getDeserializedHash(t)).code||t.error_description||t.error||t.state))},e}(),eB=(function(e){e.AcquireTokenByCode="acquireTokenByCode",e.AcquireTokenByRefreshToken="acquireTokenByRefreshToken",e.AcquireTokenSilent="acquireTokenSilent",e.AcquireTokenSilentAsync="acquireTokenSilentAsync",e.AcquireTokenPopup="acquireTokenPopup",e.CryptoOptsGetPublicKeyThumbprint="cryptoOptsGetPublicKeyThumbprint",e.CryptoOptsSignJwt="cryptoOptsSignJwt",e.SilentCacheClientAcquireToken="silentCacheClientAcquireToken",e.SilentIframeClientAcquireToken="silentIframeClientAcquireToken",e.SilentRefreshClientAcquireToken="silentRefreshClientAcquireToken",e.SsoSilent="ssoSilent",e.StandardInteractionClientGetDiscoveredAuthority="standardInteractionClientGetDiscoveredAuthority",e.FetchAccountIdWithNativeBroker="fetchAccountIdWithNativeBroker",e.NativeInteractionClientAcquireToken="nativeInteractionClientAcquireToken",e.BaseClientCreateTokenRequestHeaders="baseClientCreateTokenRequestHeaders",e.BrokerHandhshake="brokerHandshake",e.AcquireTokenByRefreshTokenInBroker="acquireTokenByRefreshTokenInBroker",e.AcquireTokenByBroker="acquireTokenByBroker",e.RefreshTokenClientExecuteTokenRequest="refreshTokenClientExecuteTokenRequest",e.RefreshTokenClientAcquireToken="refreshTokenClientAcquireToken",e.RefreshTokenClientAcquireTokenWithCachedRefreshToken="refreshTokenClientAcquireTokenWithCachedRefreshToken",e.RefreshTokenClientAcquireTokenByRefreshToken="refreshTokenClientAcquireTokenByRefreshToken",e.RefreshTokenClientCreateTokenRequestBody="refreshTokenClientCreateTokenRequestBody",e.AcquireTokenFromCache="acquireTokenFromCache",e.AcquireTokenBySilentIframe="acquireTokenBySilentIframe",e.InitializeBaseRequest="initializeBaseRequest",e.InitializeSilentRequest="initializeSilentRequest",e.InitializeClientApplication="initializeClientApplication",e.SilentIframeClientTokenHelper="silentIframeClientTokenHelper",e.SilentHandlerInitiateAuthRequest="silentHandlerInitiateAuthRequest",e.SilentHandlerMonitorIframeForHash="silentHandlerMonitorIframeForHash",e.SilentHandlerLoadFrame="silentHandlerLoadFrame",e.StandardInteractionClientCreateAuthCodeClient="standardInteractionClientCreateAuthCodeClient",e.StandardInteractionClientGetClientConfiguration="standardInteractionClientGetClientConfiguration",e.StandardInteractionClientInitializeAuthorizationRequest="standardInteractionClientInitializeAuthorizationRequest",e.StandardInteractionClientInitializeAuthorizationCodeRequest="standardInteractionClientInitializeAuthorizationCodeRequest",e.GetAuthCodeUrl="getAuthCodeUrl",e.HandleCodeResponseFromServer="handleCodeResponseFromServer",e.HandleCodeResponseFromHash="handleCodeResponseFromHash",e.UpdateTokenEndpointAuthority="updateTokenEndpointAuthority",e.AuthClientAcquireToken="authClientAcquireToken",e.AuthClientExecuteTokenRequest="authClientExecuteTokenRequest",e.AuthClientCreateTokenRequestBody="authClientCreateTokenRequestBody",e.AuthClientCreateQueryString="authClientCreateQueryString",e.PopTokenGenerateCnf="popTokenGenerateCnf",e.PopTokenGenerateKid="popTokenGenerateKid",e.HandleServerTokenResponse="handleServerTokenResponse",e.AuthorityFactoryCreateDiscoveredInstance="authorityFactoryCreateDiscoveredInstance",e.AuthorityResolveEndpointsAsync="authorityResolveEndpointsAsync",e.AuthorityGetCloudDiscoveryMetadataFromNetwork="authorityGetCloudDiscoveryMetadataFromNetwork",e.AuthorityUpdateCloudDiscoveryMetadata="authorityUpdateCloudDiscoveryMetadata",e.AuthorityGetEndpointMetadataFromNetwork="authorityGetEndpointMetadataFromNetwork",e.AuthorityUpdateEndpointMetadata="authorityUpdateEndpointMetadata",e.AuthorityUpdateMetadataWithRegionalInformation="authorityUpdateMetadataWithRegionalInformation",e.RegionDiscoveryDetectRegion="regionDiscoveryDetectRegion",e.RegionDiscoveryGetRegionFromIMDS="regionDiscoveryGetRegionFromIMDS",e.RegionDiscoveryGetCurrentVersion="regionDiscoveryGetCurrentVersion",e.AcquireTokenByCodeAsync="acquireTokenByCodeAsync",e.GetEndpointMetadataFromNetwork="getEndpointMetadataFromNetwork",e.GetCloudDiscoveryMetadataFromNetworkMeasurement="getCloudDiscoveryMetadataFromNetworkMeasurement",e.HandleRedirectPromiseMeasurement="handleRedirectPromiseMeasurement",e.UpdateCloudDiscoveryMetadataMeasurement="updateCloudDiscoveryMetadataMeasurement",e.UsernamePasswordClientAcquireToken="usernamePasswordClientAcquireToken",e.NativeMessageHandlerHandshake="nativeMessageHandlerHandshake",e.ClearTokensAndKeysWithClaims="clearTokensAndKeysWithClaims"}(RF=RF||{}),function(e){e[e.NotStarted=0]="NotStarted",e[e.InProgress=1]="InProgress",e[e.Completed=2]="Completed"}(OF=OF||{}),new Set(["accessTokenSize","durationMs","idTokenSize","matsSilentStatus","matsHttpStatus","refreshTokenSize","queuedTimeMs","startTimeMs","status"])),tB=(function(e){e.SW="sw",e.UHW="uhw"}(LF=LF||{}),function(){function e(e,t){this.cryptoUtils=e,this.performanceClient=t}return e.prototype.generateCnf=function(e){var t;return kN(this,void 0,void 0,(function(){var r,n;return AN(this,(function(i){switch(i.label){case 0:return null!=(t=this.performanceClient)&&t.addQueueMeasurement(RF.PopTokenGenerateCnf,e.correlationId),null!=(t=this.performanceClient)&&t.setPreQueueTime(RF.PopTokenGenerateKid,e.correlationId),[4,this.generateKid(e)];case 1:return n=i.sent(),r=this.cryptoUtils.base64Encode(JSON.stringify(n)),n={kid:n.kid,reqCnfString:r},[4,this.cryptoUtils.hashString(r)];case 2:return[2,(n.reqCnfHash=i.sent(),n)]}}))}))},e.prototype.generateKid=function(e){var t;return kN(this,void 0,void 0,(function(){return AN(this,(function(r){switch(r.label){case 0:return null!=(t=this.performanceClient)&&t.addQueueMeasurement(RF.PopTokenGenerateKid,e.correlationId),[4,this.cryptoUtils.getPublicKeyThumbprint(e)];case 1:return[2,{kid:r.sent(),xms_ksl:LF.SW}]}}))}))},e.prototype.signPopToken=function(e,t,r){return kN(this,void 0,void 0,(function(){return AN(this,(function(n){return[2,this.signPayload(e,t,r)]}))}))},e.prototype.signPayload=function(e,t,r,n){return kN(this,void 0,void 0,(function(){var i,o,a,s;return AN(this,(function(l){switch(l.label){case 0:return i=r.resourceRequestMethod,s=r.resourceRequestUri,o=r.shrClaims,a=r.shrNonce,s=null==(s=s?new JF(s):void 0)?void 0:s.getUrlComponents(),[4,this.cryptoUtils.signJwt(IN({at:e,ts:HF.nowSeconds(),m:null==i?void 0:i.toUpperCase(),u:null==s?void 0:s.HostNameAndPort,nonce:a||this.cryptoUtils.createNewGuid(),p:null==s?void 0:s.AbsolutePath,q:null!=s&&s.QueryString?[[],s.QueryString]:void 0,client_claims:o||void 0},n),t,r.correlationId)];case 1:return[2,l.sent()]}}))}))},e}()),rB=function(){function e(){}return e.prototype.generateAppMetadataKey=function(){return e.generateAppMetadataCacheKey(this.environment,this.clientId)},e.generateAppMetadataCacheKey=function(e,t){return[oz,e,t].join(UN.CACHE_KEY_SEPARATOR).toLowerCase()},e.createAppMetadataEntity=function(t,r,n){var i=new e;return i.clientId=t,i.environment=r,n&&(i.familyId=n),i},e.isAppMetadataEntity=function(e,t){return!!t&&0===e.indexOf(oz)&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("environment")},e}(),nB=function(){function e(e,t){this.cache=e,this.hasChanged=t}return Object.defineProperty(e.prototype,"cacheHasChanged",{get:function(){return this.hasChanged},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tokenCache",{get:function(){return this.cache},enumerable:!1,configurable:!0}),e}(),iB=function(){function e(e,t,r,n,i,o,a){this.clientId=e,this.cacheStorage=t,this.cryptoObj=r,this.logger=n,this.serializableCache=i,this.persistencePlugin=o,this.performanceClient=a}return e.prototype.validateServerAuthorizationCodeResponse=function(e,t,r){if(!e.state||!t)throw e.state?lF.createStateNotFoundError("Cached State"):lF.createStateNotFoundError("Server State");if(decodeURIComponent(e.state)!==decodeURIComponent(t))throw lF.createStateMismatchError();if(e.error||e.error_description||e.suberror){if(YF.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new YF(e.error||ez.EMPTY_STRING,e.error_description,e.suberror,e.timestamp||ez.EMPTY_STRING,e.trace_id||ez.EMPTY_STRING,e.correlation_id||ez.EMPTY_STRING,e.claims||ez.EMPTY_STRING);throw new DF(e.error||ez.EMPTY_STRING,e.error_description,e.suberror)}e.client_info&&gF(e.client_info,r)},e.prototype.validateTokenResponse=function(e){if(e.error||e.error_description||e.suberror){if(YF.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new YF(e.error,e.error_description,e.suberror,e.timestamp||ez.EMPTY_STRING,e.trace_id||ez.EMPTY_STRING,e.correlation_id||ez.EMPTY_STRING,e.claims||ez.EMPTY_STRING);var t=e.error_codes+" - ["+e.timestamp+"]: "+e.error_description+" - Correlation ID: "+e.correlation_id+" - Trace ID: "+e.trace_id;throw new DF(e.error,t,e.suberror)}},e.prototype.handleServerTokenResponse=function(t,r,n,i,o,a,s,l,c){var u;return kN(this,void 0,void 0,(function(){var h,d,p,f,m;return AN(this,(function(g){switch(g.label){case 0:if(null!=(u=this.performanceClient)&&u.addQueueMeasurement(RF.HandleServerTokenResponse,t.correlation_id),t.id_token){if(h=new _F(t.id_token||ez.EMPTY_STRING,this.cryptoObj),o&&!cF.isEmpty(o.nonce)&&h.claims.nonce!==o.nonce)throw lF.createNonceMismatchError();if(i.maxAge||0===i.maxAge){if(!(p=h.claims.auth_time))throw lF.createAuthTimeNotFoundError();_F.checkMaxAge(p,i.maxAge)}}this.homeAccountIdentifier=vF.generateHomeAccountId(t.client_info||ez.EMPTY_STRING,r.authorityType,this.logger,this.cryptoObj,h),o&&o.state&&(d=QF.parseRequestState(this.cryptoObj,o.state)),t.key_id=t.key_id||i.sshKid||void 0,p=this.generateCacheRecord(t,r,n,i,h,a,o),g.label=1;case 1:return g.trys.push([1,,5,8]),this.persistencePlugin&&this.serializableCache?(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),f=new nB(this.serializableCache,!0),[4,this.persistencePlugin.beforeCacheAccess(f)]):[3,3];case 2:g.sent(),g.label=3;case 3:return!s||l||!p.account||(m=p.account.generateAccountKey(),this.cacheStorage.getAccount(m))?[4,this.cacheStorage.saveCacheRecord(p)]:(this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),[2,e.generateAuthenticationResult(this.cryptoObj,r,p,!1,i,h,d,void 0,c)]);case 4:return g.sent(),[3,8];case 5:return this.persistencePlugin&&this.serializableCache&&f?(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),[4,this.persistencePlugin.afterCacheAccess(f)]):[3,7];case 6:g.sent(),g.label=7;case 7:return[7];case 8:return[2,e.generateAuthenticationResult(this.cryptoObj,r,p,!1,i,h,d,t,c)]}}))}))},e.prototype.generateCacheRecord=function(e,t,r,n,i,o,a){var s,l,c=t.getPreferredCache();if(cF.isEmpty(c))throw lF.createInvalidCacheEnvironmentError();!cF.isEmpty(e.id_token)&&i&&(s=qF.createIdTokenEntity(this.homeAccountIdentifier,c,e.id_token||ez.EMPTY_STRING,this.clientId,i.claims.tid||ez.EMPTY_STRING),l=this.generateAccountEntity(e,i,t,a));a=null;var u,h,d,p=(cF.isEmpty(e.access_token)||(u=e.scope?mF.fromString(e.scope):new mF(n.scopes||[]),d=(h=r+(("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0))+(("string"==typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0),r=(p=("string"==typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0)&&0<p?r+p:void 0,a=VF.createAccessTokenEntity(this.homeAccountIdentifier,c,e.access_token||ez.EMPTY_STRING,this.clientId,i?i.claims.tid||ez.EMPTY_STRING:t.tenant,u.printScopes(),h,d,this.cryptoObj,r,e.token_type,o,e.key_id,n.claims,n.requestedClaimsHash)),null);cF.isEmpty(e.refresh_token)||(p=GF.createRefreshTokenEntity(this.homeAccountIdentifier,c,e.refresh_token||ez.EMPTY_STRING,this.clientId,e.foci,o)),i=null;return cF.isEmpty(e.foci)||(i=rB.createAppMetadataEntity(this.clientId,c,e.foci)),new XF(l,s,a,p,i)},e.prototype.generateAccountEntity=function(e,t,r,n){var i=r.authorityType,o=n?n.cloud_graph_host_name:ez.EMPTY_STRING;n=n?n.msgraph_host:ez.EMPTY_STRING;if(i===JN.Adfs)return this.logger.verbose("Authority type is ADFS, creating ADFS account"),vF.createGenericAccount(this.homeAccountIdentifier,t,r,o,n);if(cF.isEmpty(e.client_info)&&"AAD"===r.protocolMode)throw lF.createClientInfoEmptyError();return e.client_info?vF.createAccount(e.client_info,this.homeAccountIdentifier,t,r,o,n):vF.createGenericAccount(this.homeAccountIdentifier,t,r,o,n)},e.generateAuthenticationResult=function(e,t,r,n,i,o,a,s,l){var c;return kN(this,void 0,void 0,(function(){var u,h,d,p,f,m,g,y;return AN(this,(function(v){switch(v.label){case 0:if(u=ez.EMPTY_STRING,h=[],d=null,f=ez.EMPTY_STRING,!r.accessToken)return[3,4];if(r.accessToken.tokenType!==VN.POP)return[3,2];if(g=new tB(e),m=r.accessToken,y=m.secret,m=m.keyId)return[4,g.signPopToken(y,m,i)];throw lF.createKeyIdMissingError();case 1:return u=v.sent(),[3,3];case 2:u=r.accessToken.secret,v.label=3;case 3:h=mF.fromString(r.accessToken.target).asArray(),d=new Date(1e3*Number(r.accessToken.expiresOn)),p=new Date(1e3*Number(r.accessToken.extendedExpiresOn)),v.label=4;case 4:return r.appMetadata&&(f=r.appMetadata.familyId===az?az:ez.EMPTY_STRING),g=(null==o?void 0:o.claims.oid)||(null==o?void 0:o.claims.sub)||ez.EMPTY_STRING,y=(null==o?void 0:o.claims.tid)||ez.EMPTY_STRING,null!=s&&s.spa_accountid&&r.account&&(r.account.nativeAccountId=null==s?void 0:s.spa_accountid),[2,{authority:t.canonicalAuthority,uniqueId:g,tenantId:y,scopes:h,account:r.account?r.account.getAccountInfo():null,idToken:o?o.rawToken:ez.EMPTY_STRING,idTokenClaims:o?o.claims:{},accessToken:u,fromCache:n,expiresOn:d,correlationId:i.correlationId,requestId:l||ez.EMPTY_STRING,extExpiresOn:p,familyId:f,tokenType:(null==(c=r.accessToken)?void 0:c.tokenType)||ez.EMPTY_STRING,state:a?a.userRequestState:ez.EMPTY_STRING,cloudGraphHostName:(null==(c=r.account)?void 0:c.cloudGraphHostName)||ez.EMPTY_STRING,msGraphHost:(null==(c=r.account)?void 0:c.msGraphHost)||ez.EMPTY_STRING,code:null==s?void 0:s.spa_code,fromNativeBroker:!1}]}}))}))},e}(),oB=function(e){function t(t,r){return(t=e.call(this,t,r)||this).includeRedirectUri=!0,t}return TN(t,e),t.prototype.getAuthCodeUrl=function(e){var t;return kN(this,void 0,void 0,(function(){var r;return AN(this,(function(n){switch(n.label){case 0:return null!=(t=this.performanceClient)&&t.addQueueMeasurement(RF.GetAuthCodeUrl,e.correlationId),null!=(t=this.performanceClient)&&t.setPreQueueTime(RF.AuthClientCreateQueryString,e.correlationId),[4,this.createAuthCodeUrlQueryString(e)];case 1:return r=n.sent(),[2,JF.appendQueryString(this.authority.authorizationEndpoint,r)]}}))}))},t.prototype.acquireToken=function(e,t){var r,n;return kN(this,void 0,void 0,(function(){var i,o,a,s,l,c=this;return AN(this,(function(u){switch(u.label){case 0:if(e&&e.code)return null!=(r=this.performanceClient)&&r.addQueueMeasurement(RF.AuthClientAcquireToken,e.correlationId),i=null==(r=this.performanceClient)?void 0:r.startMeasurement("AuthCodeClientAcquireToken",e.correlationId),this.logger.info("in acquireToken call in auth-code client"),o=HF.nowSeconds(),null!=(r=this.performanceClient)&&r.setPreQueueTime(RF.AuthClientExecuteTokenRequest,e.correlationId),[4,this.executeTokenRequest(this.authority,e)];throw lF.createTokenRequestCannotBeMadeError();case 1:return a=u.sent(),s=null==(r=a.headers)?void 0:r[MN.X_MS_REQUEST_ID],(l=null==(n=a.headers)?void 0:n[MN.X_MS_HTTP_VERSION])&&null!=i&&i.addStaticFields({httpVerAuthority:l}),(l=new iB(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient)).validateTokenResponse(a.body),null!=(n=this.performanceClient)&&n.setPreQueueTime(RF.HandleServerTokenResponse,e.correlationId),[2,l.handleServerTokenResponse(a.body,this.authority,o,e,t,void 0,void 0,void 0,s).then((function(e){return null!=i&&i.endMeasurement({success:!0}),e})).catch((function(t){throw c.logger.verbose("Error in fetching token in ACC",e.correlationId),null!=i&&i.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),t}))]}}))}))},t.prototype.handleFragmentResponse=function(e,t){var r=new iB(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null);e=new JF(e),e=JF.getDeserializedHash(e.getHash());if(r.validateServerAuthorizationCodeResponse(e,t,this.cryptoUtils),e.code)return IN(IN({},e),{code:e.code});throw lF.createNoAuthCodeInServerResponseError()},t.prototype.getLogoutUri=function(e){if(e)return e=this.createLogoutUrlQueryString(e),JF.appendQueryString(this.authority.endSessionEndpoint,e);throw fF.createEmptyLogoutRequestError()},t.prototype.executeTokenRequest=function(e,t){var r;return kN(this,void 0,void 0,(function(){var n,i,o,a,s;return AN(this,(function(l){switch(l.label){case 0:return null!=(r=this.performanceClient)&&r.addQueueMeasurement(RF.AuthClientExecuteTokenRequest,t.correlationId),null!=(r=this.performanceClient)&&r.setPreQueueTime(RF.AuthClientCreateTokenRequestBody,t.correlationId),n=this.createTokenQueryParameters(t),n=JF.appendQueryString(e.tokenEndpoint,n),[4,this.createTokenRequestBody(t)];case 1:if(i=l.sent(),a=void 0,t.clientInfo)try{o=gF(t.clientInfo,this.cryptoUtils),a={credential:""+o.uid+UN.CLIENT_INFO_SEPARATOR+o.utid,type:MF.HOME_ACCOUNT_ID}}catch(l){this.logger.verbose("Could not parse client info for CCS Header: "+l)}return a=this.createTokenRequestHeaders(a||t.ccsCredential),s={clientId:this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},[2,this.executePostToTokenEndpoint(n,i,a,s)]}}))}))},t.prototype.createTokenRequestBody=function(e){var t;return kN(this,void 0,void 0,(function(){var r,n,i,o,a,s;return AN(this,(function(l){switch(l.label){case 0:return null!=(t=this.performanceClient)&&t.addQueueMeasurement(RF.AuthClientCreateTokenRequestBody,e.correlationId),(r=new BF).addClientId(this.config.authOptions.clientId),this.includeRedirectUri?r.addRedirectUri(e.redirectUri):FF.validateRedirectUri(e.redirectUri),r.addScopes(e.scopes),r.addAuthorizationCode(e.code),r.addLibraryInfo(this.config.libraryInfo),r.addApplicationTelemetry(this.config.telemetry.application),r.addThrottling(),this.serverTelemetryManager&&r.addServerTelemetry(this.serverTelemetryManager),e.codeVerifier&&r.addCodeVerifier(e.codeVerifier),this.config.clientCredentials.clientSecret&&r.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(n=this.config.clientCredentials.clientAssertion,r.addClientAssertion(n.assertion),r.addClientAssertionType(n.assertionType)),r.addGrantType(FN.AUTHORIZATION_CODE_GRANT),r.addClientInfo(),e.authenticationScheme!==VN.POP?[3,2]:(n=new tB(this.cryptoUtils,this.performanceClient),null!=(t=this.performanceClient)&&t.setPreQueueTime(RF.PopTokenGenerateCnf,e.correlationId),[4,n.generateCnf(e)]);case 1:return i=l.sent(),r.addPopToken(i.reqCnfString),[3,3];case 2:if(e.authenticationScheme===VN.SSH){if(!e.sshJwk)throw fF.createMissingSshJwkError();r.addSshJwk(e.sshJwk)}l.label=3;case 3:if(i=e.correlationId||this.config.cryptoInterface.createNewGuid(),r.addCorrelationId(i),(!cF.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&0<this.config.authOptions.clientCapabilities.length)&&r.addClaims(e.claims,this.config.authOptions.clientCapabilities),o=void 0,e.clientInfo)try{a=gF(e.clientInfo,this.cryptoUtils),o={credential:""+a.uid+UN.CLIENT_INFO_SEPARATOR+a.utid,type:MF.HOME_ACCOUNT_ID}}catch(l){this.logger.verbose("Could not parse client info for CCS Header: "+l)}else o=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&o)switch(o.type){case MF.HOME_ACCOUNT_ID:try{a=yF(o.credential),r.addCcsOid(a)}catch(l){this.logger.verbose("Could not parse home account ID for CCS Header: "+l)}break;case MF.UPN:r.addCcsUpn(o.credential)}return e.tokenBodyParameters&&r.addExtraQueryParameters(e.tokenBodyParameters),!e.enableSpaAuthorizationCode||e.tokenBodyParameters&&e.tokenBodyParameters[LN.RETURN_SPA_CODE]||r.addExtraQueryParameters(((s={})[LN.RETURN_SPA_CODE]="1",s)),[2,r.createQueryString()]}}))}))},t.prototype.createAuthCodeUrlQueryString=function(e){var t;return kN(this,void 0,void 0,(function(){var r,n,i,o;return AN(this,(function(a){switch(a.label){case 0:if(null!=(t=this.performanceClient)&&t.addQueueMeasurement(RF.AuthClientCreateQueryString,e.correlationId),(r=new BF).addClientId(this.config.authOptions.clientId),n=PN(e.scopes||[],e.extraScopesToConsent||[]),r.addScopes(n),r.addRedirectUri(e.redirectUri),n=e.correlationId||this.config.cryptoInterface.createNewGuid(),r.addCorrelationId(n),r.addResponseMode(e.responseMode),r.addResponseTypeCode(),r.addLibraryInfo(this.config.libraryInfo),r.addApplicationTelemetry(this.config.telemetry.application),r.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&r.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&r.addPrompt(e.prompt),e.domainHint&&r.addDomainHint(e.domainHint),e.prompt!==nz.SELECT_ACCOUNT)if(e.sid&&e.prompt===nz.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),r.addSid(e.sid);else if(e.account){if(n=this.extractAccountSid(e.account),o=this.extractLoginHint(e.account)){this.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),r.addLoginHint(o);try{i=yF(e.account.homeAccountId),r.addCcsOid(i)}catch(a){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(n&&e.prompt===nz.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),r.addSid(n);try{i=yF(e.account.homeAccountId),r.addCcsOid(i)}catch(a){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),r.addLoginHint(e.loginHint),r.addCcsUpn(e.loginHint);else if(e.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),r.addLoginHint(e.account.username);try{i=yF(e.account.homeAccountId),r.addCcsOid(i)}catch(a){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else e.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),r.addLoginHint(e.loginHint),r.addCcsUpn(e.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return e.nonce&&r.addNonce(e.nonce),e.state&&r.addState(e.state),(!cF.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&0<this.config.authOptions.clientCapabilities.length)&&r.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.extraQueryParameters&&r.addExtraQueryParameters(e.extraQueryParameters),e.nativeBroker?(r.addNativeBroker(),e.authenticationScheme!==VN.POP?[3,2]:[4,new tB(this.cryptoUtils).generateCnf(e)]):[3,2];case 1:o=a.sent(),r.addPopToken(o.reqCnfString),a.label=2;case 2:return[2,r.createQueryString()]}}))}))},t.prototype.createLogoutUrlQueryString=function(e){var t=new BF;return e.postLogoutRedirectUri&&t.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&t.addCorrelationId(e.correlationId),e.idTokenHint&&t.addIdTokenHint(e.idTokenHint),e.state&&t.addState(e.state),e.logoutHint&&t.addLogoutHint(e.logoutHint),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters),t.createQueryString()},t.prototype.extractAccountSid=function(e){return(null==(e=e.idTokenClaims)?void 0:e.sid)||null},t.prototype.extractLoginHint=function(e){return(null==(e=e.idTokenClaims)?void 0:e.login_hint)||null},t}(UF),aB=function(e){function t(t,r){return e.call(this,t,r)||this}return TN(t,e),t.prototype.acquireToken=function(e){var t,r,n;return kN(this,void 0,void 0,(function(){var i,o,a,s,l,c=this;return AN(this,(function(u){switch(u.label){case 0:return null!=(t=this.performanceClient)&&t.addQueueMeasurement(RF.RefreshTokenClientAcquireToken,e.correlationId),i=null==(t=this.performanceClient)?void 0:t.startMeasurement(RF.RefreshTokenClientAcquireToken,e.correlationId),this.logger.verbose("RefreshTokenClientAcquireToken called",e.correlationId),o=HF.nowSeconds(),null!=(t=this.performanceClient)&&t.setPreQueueTime(RF.RefreshTokenClientExecuteTokenRequest,e.correlationId),[4,this.executeTokenRequest(e,this.authority)];case 1:return a=u.sent(),s=null==(t=a.headers)?void 0:t[MN.X_MS_HTTP_VERSION],null!=i&&i.addStaticFields({refreshTokenSize:(null==(r=a.body.refresh_token)?void 0:r.length)||0}),s&&null!=i&&i.addStaticFields({httpVerToken:s}),s=null==(r=a.headers)?void 0:r[MN.X_MS_REQUEST_ID],(l=new iB(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(a.body),null!=(n=this.performanceClient)&&n.setPreQueueTime(RF.HandleServerTokenResponse,e.correlationId),[2,l.handleServerTokenResponse(a.body,this.authority,o,e,void 0,void 0,!0,e.forceCache,s).then((function(e){return null!=i&&i.endMeasurement({success:!0}),e})).catch((function(t){throw c.logger.verbose("Error in fetching refresh token",e.correlationId),null!=i&&i.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),t}))]}}))}))},t.prototype.acquireTokenByRefreshToken=function(e){var t,r;return kN(this,void 0,void 0,(function(){var n,i;return AN(this,(function(o){if(!e)throw fF.createEmptyTokenRequestError();if(null!=(r=this.performanceClient)&&r.addQueueMeasurement(RF.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),!e.account)throw lF.createNoAccountInSilentRequestError();if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return null!=(t=this.performanceClient)&&t.setPreQueueTime(RF.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId),[2,this.acquireTokenWithCachedRefreshToken(e,!0)]}catch(o){if(n=o instanceof YF&&o.errorCode===WF.code,i=o instanceof DF&&o.errorCode===hz&&o.subError===dz,n||i)return null!=(r=this.performanceClient)&&r.setPreQueueTime(RF.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId),[2,this.acquireTokenWithCachedRefreshToken(e,!1)];throw o}return null!=(r=this.performanceClient)&&r.setPreQueueTime(RF.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId),[2,this.acquireTokenWithCachedRefreshToken(e,!1)]}))}))},t.prototype.acquireTokenWithCachedRefreshToken=function(e,t){var r;return kN(this,void 0,void 0,(function(){var n,i;return AN(this,(function(o){if(null!=(r=this.performanceClient)&&r.addQueueMeasurement(RF.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId),n=null==(r=this.performanceClient)?void 0:r.startMeasurement(RF.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId),this.logger.verbose("RefreshTokenClientAcquireTokenWithCachedRefreshToken called",e.correlationId),i=this.cacheManager.getRefreshToken(e.account,t))return null!=n&&n.endMeasurement({success:!0}),i=IN(IN({},e),{refreshToken:i.secret,authenticationScheme:e.authenticationScheme||VN.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:MF.HOME_ACCOUNT_ID}}),null!=(r=this.performanceClient)&&r.setPreQueueTime(RF.RefreshTokenClientAcquireToken,e.correlationId),[2,this.acquireToken(i)];throw null!=n&&n.discardMeasurement(),YF.createNoTokensFoundError()}))}))},t.prototype.executeTokenRequest=function(e,t){var r;return kN(this,void 0,void 0,(function(){var n,i,o,a,s;return AN(this,(function(l){switch(l.label){case 0:return null!=(r=this.performanceClient)&&r.addQueueMeasurement(RF.RefreshTokenClientExecuteTokenRequest,e.correlationId),n=null==(r=this.performanceClient)?void 0:r.startMeasurement(RF.RefreshTokenClientExecuteTokenRequest,e.correlationId),null!=(r=this.performanceClient)&&r.setPreQueueTime(RF.RefreshTokenClientCreateTokenRequestBody,e.correlationId),i=this.createTokenQueryParameters(e),i=JF.appendQueryString(t.tokenEndpoint,i),[4,this.createTokenRequestBody(e)];case 1:return o=l.sent(),a=this.createTokenRequestHeaders(e.ccsCredential),s={clientId:this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid},[2,this.executePostToTokenEndpoint(i,o,a,s).then((function(e){return null!=n&&n.endMeasurement({success:!0}),e})).catch((function(e){throw null!=n&&n.endMeasurement({success:!1}),e}))]}}))}))},t.prototype.createTokenRequestBody=function(e){var t;return kN(this,void 0,void 0,(function(){var r,n,i,o;return AN(this,(function(a){switch(a.label){case 0:return null!=(t=this.performanceClient)&&t.addQueueMeasurement(RF.RefreshTokenClientCreateTokenRequestBody,e.correlationId),i=e.correlationId,r=null==(t=this.performanceClient)?void 0:t.startMeasurement(RF.BaseClientCreateTokenRequestHeaders,i),(n=new BF).addClientId(this.config.authOptions.clientId),n.addScopes(e.scopes),n.addGrantType(FN.REFRESH_TOKEN_GRANT),n.addClientInfo(),n.addLibraryInfo(this.config.libraryInfo),n.addApplicationTelemetry(this.config.telemetry.application),n.addThrottling(),this.serverTelemetryManager&&n.addServerTelemetry(this.serverTelemetryManager),n.addCorrelationId(i),n.addRefreshToken(e.refreshToken),this.config.clientCredentials.clientSecret&&n.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(i=this.config.clientCredentials.clientAssertion,n.addClientAssertion(i.assertion),n.addClientAssertionType(i.assertionType)),e.authenticationScheme!==VN.POP?[3,2]:(i=new tB(this.cryptoUtils,this.performanceClient),null!=(t=this.performanceClient)&&t.setPreQueueTime(RF.PopTokenGenerateCnf,e.correlationId),[4,i.generateCnf(e)]);case 1:return i=a.sent(),n.addPopToken(i.reqCnfString),[3,3];case 2:if(e.authenticationScheme===VN.SSH){if(!e.sshJwk)throw null!=r&&r.endMeasurement({success:!1}),fF.createMissingSshJwkError();n.addSshJwk(e.sshJwk)}a.label=3;case 3:if((!cF.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&0<this.config.authOptions.clientCapabilities.length)&&n.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case MF.HOME_ACCOUNT_ID:try{o=yF(e.ccsCredential.credential),n.addCcsOid(o)}catch(a){this.logger.verbose("Could not parse home account ID for CCS Header: "+a)}break;case MF.UPN:n.addCcsUpn(e.ccsCredential.credential)}return null!=r&&r.endMeasurement({success:!0}),[2,n.createQueryString()]}}))}))},t}(UF),sB=function(e){function t(t,r){return e.call(this,t,r)||this}return TN(t,e),t.prototype.acquireToken=function(e){return kN(this,void 0,void 0,(function(){var t;return AN(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.acquireCachedToken(e)];case 1:return[2,r.sent()];case 2:if((t=r.sent())instanceof lF&&t.errorCode===Jz.code)return[2,new aB(this.config,this.performanceClient).acquireTokenByRefreshToken(e)];throw t;case 3:return[2]}}))}))},t.prototype.acquireCachedToken=function(e){var t,r,n;return kN(this,void 0,void 0,(function(){var i;return AN(this,(function(o){switch(o.label){case 0:if(!e)throw fF.createEmptyTokenRequestError();if(e.forceRefresh)throw null!=(t=this.serverTelemetryManager)&&t.setCacheOutcome($N.FORCE_REFRESH),this.logger.info("SilentFlowClient:acquireCachedToken - Skipping cache because forceRefresh is true."),lF.createRefreshRequiredError();if(!this.config.cacheOptions.claimsBasedCachingEnabled&&!cF.isEmptyObj(e.claims))throw null!=(t=this.serverTelemetryManager)&&t.setCacheOutcome($N.CLAIMS_REQUESTED_CACHE_SKIPPED),this.logger.info("SilentFlowClient:acquireCachedToken - Skipping cache because claims-based caching is disabled and claims were requested."),lF.createRefreshRequiredError();if(!e.account)throw lF.createNoAccountInSilentRequestError();if(i=e.authority||this.authority.getPreferredCache(),!(i=this.cacheManager.readCacheRecord(e.account,e,i)).accessToken)throw null!=(r=this.serverTelemetryManager)&&r.setCacheOutcome($N.NO_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - No access token found in cache for the given properties."),lF.createRefreshRequiredError();if(HF.wasClockTurnedBack(i.accessToken.cachedAt)||HF.isTokenExpired(i.accessToken.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw null!=(r=this.serverTelemetryManager)&&r.setCacheOutcome($N.CACHED_ACCESS_TOKEN_EXPIRED),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token is expired or will expire within "+this.config.systemOptions.tokenRenewalOffsetSeconds+" seconds."),lF.createRefreshRequiredError();if(i.accessToken.refreshOn&&HF.isTokenExpired(i.accessToken.refreshOn,0))throw null!=(n=this.serverTelemetryManager)&&n.setCacheOutcome($N.REFRESH_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'."),lF.createRefreshRequiredError();return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[4,this.generateResultFromCacheRecord(i,e)];case 1:return[2,o.sent()]}}))}))},t.prototype.generateResultFromCacheRecord=function(e,t){return kN(this,void 0,void 0,(function(){var r,n;return AN(this,(function(i){switch(i.label){case 0:if(e.idToken&&(r=new _F(e.idToken.secret,this.config.cryptoInterface)),t.maxAge||0===t.maxAge){if(!(n=null==r?void 0:r.claims.auth_time))throw lF.createAuthTimeNotFoundError();_F.checkMaxAge(n,t.maxAge)}return[4,iB.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,r)];case 1:return[2,i.sent()]}}))}))},t}(UF);function lB(e){return e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("jwks_uri")}var cB,uB={"https://login.microsoftonline.com/common/":{token_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/common/":{token_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/common/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/common/":{token_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/consumers/":{token_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/consumers/":{token_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/consumers/":{token_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/organizations/":{token_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/organizations/":{token_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/organizations/":{token_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"}},hB={"https://login.microsoftonline.com/common/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/common/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/common/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.com/consumers/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/consumers/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/consumers/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.com/organizations/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/organizations/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/organizations/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}},dB=(function(e){e.AAD="AAD",e.OIDC="OIDC"}(cB=cB||{}),function(){function e(){this.expiresAt=HF.nowSeconds()+lz}return e.prototype.updateCloudDiscoveryMetadata=function(e,t){this.aliases=e.aliases,this.preferred_cache=e.preferred_cache,this.preferred_network=e.preferred_network,this.aliasesFromNetwork=t},e.prototype.updateEndpointMetadata=function(e,t){this.authorization_endpoint=e.authorization_endpoint,this.token_endpoint=e.token_endpoint,this.end_session_endpoint=e.end_session_endpoint,this.issuer=e.issuer,this.endpointsFromNetwork=t,this.jwks_uri=e.jwks_uri},e.prototype.updateCanonicalAuthority=function(e){this.canonical_authority=e},e.prototype.resetExpiresAt=function(){this.expiresAt=HF.nowSeconds()+lz},e.prototype.isExpired=function(){return this.expiresAt<=HF.nowSeconds()},e.isAuthorityMetadataEntity=function(e,t){return!!t&&0===e.indexOf(sz)&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt")&&t.hasOwnProperty("jwks_uri")},e}());var pB,fB,mB,gB,yB,vB,_B,bB,wB,xB,CB,SB,EB,TB=function(){function e(e,t,r){this.networkInterface=e,this.performanceClient=t,this.correlationId=r}return e.prototype.detectRegion=function(t,r){var n,i;return kN(this,void 0,void 0,(function(){var o,a,s,l;return AN(this,(function(c){switch(c.label){case 0:if(null!=(n=this.performanceClient)&&n.addQueueMeasurement(RF.RegionDiscoveryDetectRegion,this.correlationId),o=t)return[3,8];a=e.IMDS_OPTIONS,c.label=1;case 1:return c.trys.push([1,6,,7]),null!=(n=this.performanceClient)&&n.setPreQueueTime(RF.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[4,this.getRegionFromIMDS(ez.IMDS_VERSION,a)];case 2:return(s=c.sent()).status===KN.httpSuccess&&(o=s.body,r.region_source=ZN.IMDS),s.status!==KN.httpBadRequest?[3,5]:(null!=(i=this.performanceClient)&&i.setPreQueueTime(RF.RegionDiscoveryGetCurrentVersion,this.correlationId),[4,this.getCurrentVersion(a)]);case 3:return(s=c.sent())?(null!=(i=this.performanceClient)&&i.setPreQueueTime(RF.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[4,this.getRegionFromIMDS(s,a)]):(r.region_source=ZN.FAILED_AUTO_DETECTION,[2,null]);case 4:(l=c.sent()).status===KN.httpSuccess&&(o=l.body,r.region_source=ZN.IMDS),c.label=5;case 5:return[3,7];case 6:return c.sent(),r.region_source=ZN.FAILED_AUTO_DETECTION,[2,null];case 7:return[3,9];case 8:r.region_source=ZN.ENVIRONMENT_VARIABLE,c.label=9;case 9:return o||(r.region_source=ZN.FAILED_AUTO_DETECTION),[2,o||null]}}))}))},e.prototype.getRegionFromIMDS=function(e,t){var r;return kN(this,void 0,void 0,(function(){return AN(this,(function(n){return null!=(r=this.performanceClient)&&r.addQueueMeasurement(RF.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[2,this.networkInterface.sendGetRequestAsync(ez.IMDS_ENDPOINT+"?api-version="+e+"&format=text",t,ez.IMDS_TIMEOUT)]}))}))},e.prototype.getCurrentVersion=function(e){var t;return kN(this,void 0,void 0,(function(){var r;return AN(this,(function(n){switch(n.label){case 0:null!=(t=this.performanceClient)&&t.addQueueMeasurement(RF.RegionDiscoveryGetCurrentVersion,this.correlationId),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(ez.IMDS_ENDPOINT+"?format=json",e)];case 2:return(r=n.sent()).status===KN.httpBadRequest&&r.body&&r.body["newest-versions"]&&0<r.body["newest-versions"].length?[2,r.body["newest-versions"][0]]:[2,null];case 3:return n.sent(),[2,null];case 4:return[2]}}))}))},e.IMDS_OPTIONS={headers:{Metadata:"true"}},e}(),IB=function(){function e(e,t,r,n,i,o,a){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=r,this.authorityOptions=n,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=i,this.performanceClient=o,this.correlationId=a,this.regionDiscovery=new TB(t,this.performanceClient,this.correlationId)}return e.prototype.getAuthorityType=function(e){if(e.HostNameAndPort.endsWith(ez.CIAM_AUTH_URL))return JN.Ciam;if((e=e.PathSegments).length)switch(e[0].toLowerCase()){case ez.ADFS:return JN.Adfs;case ez.DSTS:return JN.Dsts}return JN.Default},Object.defineProperty(e.prototype,"authorityType",{get:function(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"protocolMode",{get:function(){return this.authorityOptions.protocolMode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.authorityOptions},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canonicalAuthority",{get:function(){return this._canonicalAuthority.urlString},set:function(e){this._canonicalAuthority=new JF(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canonicalAuthorityUrlComponents",{get:function(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hostnameAndPort",{get:function(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tenant",{get:function(){return this.canonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"authorizationEndpoint",{get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw lF.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tokenEndpoint",{get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw lF.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"deviceCodeEndpoint",{get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw lF.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"endSessionEndpoint",{get:function(){if(this.discoveryComplete()){if(this.metadata.end_session_endpoint)return this.replacePath(this.metadata.end_session_endpoint);throw lF.createLogoutNotSupportedError()}throw lF.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selfSignedJwtAudience",{get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw lF.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"jwksUri",{get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw lF.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),e.prototype.canReplaceTenant=function(t){return 1===t.PathSegments.length&&!e.reservedTenantDomains.has(t.PathSegments[0])&&this.getAuthorityType(t)===JN.Default&&this.protocolMode===cB.AAD},e.prototype.replaceTenant=function(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)},e.prototype.replacePath=function(e){var t=this,r=e,n=new JF(this.metadata.canonical_authority).getUrlComponents(),i=n.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((function(e,o){var a=i[o];0===o&&t.canReplaceTenant(n)&&a!==(o=new JF(t.metadata.authorization_endpoint).getUrlComponents().PathSegments[0])&&(t.logger.verbose("Replacing tenant domain name "+a+" with id "+o),a=o),e!==a&&(r=r.replace("/"+a+"/","/"+e+"/"))})),this.replaceTenant(r)},Object.defineProperty(e.prototype,"defaultOpenIdConfigurationEndpoint",{get:function(){return this.authorityType===JN.Adfs||this.authorityType===JN.Dsts||this.protocolMode===cB.OIDC?this.canonicalAuthority+".well-known/openid-configuration":this.canonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!1,configurable:!0}),e.prototype.discoveryComplete=function(){return!!this.metadata},e.prototype.resolveEndpointsAsync=function(){var e;return kN(this,void 0,void 0,(function(){var t,r,n;return AN(this,(function(i){switch(i.label){case 0:return null!=(e=this.performanceClient)&&e.addQueueMeasurement(RF.AuthorityResolveEndpointsAsync,this.correlationId),(t=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort))||(t=new dB).updateCanonicalAuthority(this.canonicalAuthority),null!=(e=this.performanceClient)&&e.setPreQueueTime(RF.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId),[4,this.updateCloudDiscoveryMetadata(t)];case 1:return r=i.sent(),this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,t.preferred_network),null!=(e=this.performanceClient)&&e.setPreQueueTime(RF.AuthorityUpdateEndpointMetadata,this.correlationId),[4,this.updateEndpointMetadata(t)];case 2:return n=i.sent(),r!==HN.CACHE&&n!==HN.CACHE&&(t.resetExpiresAt(),t.updateCanonicalAuthority(this.canonicalAuthority)),n=this.cacheManager.generateAuthorityMetadataCacheKey(t.preferred_cache),this.cacheManager.setAuthorityMetadata(n,t),this.metadata=t,[2]}}))}))},e.prototype.updateEndpointMetadata=function(e){var t,r,n;return kN(this,void 0,void 0,(function(){var i,o;return AN(this,(function(a){switch(a.label){case 0:return null!=(t=this.performanceClient)&&t.addQueueMeasurement(RF.AuthorityUpdateEndpointMetadata,this.correlationId),(i=this.getEndpointMetadataFromConfig())?(e.updateEndpointMetadata(i,!1),[2,HN.CONFIG]):this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!e.isExpired()?[2,HN.CACHE]:(null!=(t=this.performanceClient)&&t.setPreQueueTime(RF.AuthorityGetEndpointMetadataFromNetwork,this.correlationId),[4,this.getEndpointMetadataFromNetwork()]);case 1:return(i=a.sent())?null!=(t=this.authorityOptions.azureRegionConfiguration)&&t.azureRegion?(null!=(r=this.performanceClient)&&r.setPreQueueTime(RF.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),[4,this.updateMetadataWithRegionalInformation(i)]):[3,3]:[3,4];case 2:i=a.sent(),a.label=3;case 3:return e.updateEndpointMetadata(i,!0),[2,HN.NETWORK];case 4:return!(o=this.getEndpointMetadataFromHardcodedValues())||this.authorityOptions.skipAuthorityMetadataCache?[3,7]:null!=(r=this.authorityOptions.azureRegionConfiguration)&&r.azureRegion?(null!=(n=this.performanceClient)&&n.setPreQueueTime(RF.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),[4,this.updateMetadataWithRegionalInformation(o)]):[3,6];case 5:o=a.sent(),a.label=6;case 6:return e.updateEndpointMetadata(o,!1),[2,HN.HARDCODED_VALUES];case 7:throw lF.createUnableToGetOpenidConfigError(this.defaultOpenIdConfigurationEndpoint)}}))}))},e.prototype.isAuthoritySameType=function(e){return new JF(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length},e.prototype.getEndpointMetadataFromConfig=function(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(Hj){throw fF.createInvalidAuthorityMetadataError()}return null},e.prototype.getEndpointMetadataFromNetwork=function(){var e;return kN(this,void 0,void 0,(function(){var t,r;return AN(this,(function(n){switch(n.label){case 0:null!=(e=this.performanceClient)&&e.addQueueMeasurement(RF.AuthorityGetEndpointMetadataFromNetwork,this.correlationId),t={},n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(this.defaultOpenIdConfigurationEndpoint,t)];case 2:return[2,lB((r=n.sent()).body)?r.body:null];case 3:return n.sent(),[2,null];case 4:return[2]}}))}))},e.prototype.getEndpointMetadataFromHardcodedValues=function(){return this.canonicalAuthority in uB?uB[this.canonicalAuthority]:null},e.prototype.updateMetadataWithRegionalInformation=function(t){var r;return kN(this,void 0,void 0,(function(){var n;return AN(this,(function(i){switch(i.label){case 0:return null!=(r=this.performanceClient)&&r.addQueueMeasurement(RF.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),(n=null==(r=this.authorityOptions.azureRegionConfiguration)?void 0:r.azureRegion)?n!==ez.AZURE_REGION_AUTO_DISCOVER_FLAG?(this.regionDiscoveryMetadata.region_outcome=WN.CONFIGURED_NO_AUTO_DETECTION,this.regionDiscoveryMetadata.region_used=n,[2,e.replaceWithRegionalInformation(t,n)]):(null!=(r=this.performanceClient)&&r.setPreQueueTime(RF.RegionDiscoveryDetectRegion,this.correlationId),[4,this.regionDiscovery.detectRegion(null==(r=this.authorityOptions.azureRegionConfiguration)?void 0:r.environmentRegion,this.regionDiscoveryMetadata)]):[3,2];case 1:if(n=i.sent())return this.regionDiscoveryMetadata.region_outcome=WN.AUTO_DETECTION_REQUESTED_SUCCESSFUL,this.regionDiscoveryMetadata.region_used=n,[2,e.replaceWithRegionalInformation(t,n)];this.regionDiscoveryMetadata.region_outcome=WN.AUTO_DETECTION_REQUESTED_FAILED,i.label=2;case 2:return[2,t]}}))}))},e.prototype.updateCloudDiscoveryMetadata=function(e){var t;return kN(this,void 0,void 0,(function(){var r,n;return AN(this,(function(i){switch(i.label){case 0:return null!=(t=this.performanceClient)&&t.addQueueMeasurement(RF.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId),this.logger.verbose("Attempting to get cloud discovery metadata in the config"),this.logger.verbosePii("Known Authorities: "+(this.authorityOptions.knownAuthorities||ez.NOT_APPLICABLE)),this.logger.verbosePii("Authority Metadata: "+(this.authorityOptions.authorityMetadata||ez.NOT_APPLICABLE)),this.logger.verbosePii("Canonical Authority: "+(e.canonical_authority||ez.NOT_APPLICABLE)),(r=this.getCloudDiscoveryMetadataFromConfig())?(this.logger.verbose("Found cloud discovery metadata in the config."),e.updateCloudDiscoveryMetadata(r,!1),[2,HN.CONFIG]):(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the cache."),n=e.isExpired(),this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!n?(this.logger.verbose("Found metadata in the cache."),[2,HN.CACHE]):(n&&this.logger.verbose("The metadata entity is expired."),this.logger.verbose("Did not find cloud discovery metadata in the cache... Attempting to get cloud discovery metadata from the network."),null!=(t=this.performanceClient)&&t.setPreQueueTime(RF.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId),[4,this.getCloudDiscoveryMetadataFromNetwork()]));case 1:if(r=i.sent())return this.logger.verbose("cloud discovery metadata was successfully returned from getCloudDiscoveryMetadataFromNetwork()"),e.updateCloudDiscoveryMetadata(r,!0),[2,HN.NETWORK];if(this.logger.verbose("Did not find cloud discovery metadata from the network... Attempting to get cloud discovery metadata from hardcoded values."),(n=this.getCloudDiscoveryMetadataFromHarcodedValues())&&!this.options.skipAuthorityMetadataCache)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),e.updateCloudDiscoveryMetadata(n,!1),[2,HN.HARDCODED_VALUES];throw this.logger.error("Did not find cloud discovery metadata from hardcoded values... Metadata could not be obtained from config, cache, network or hardcoded values. Throwing Untrusted Authority Error."),fF.createUntrustedAuthorityError()}}))}))},e.prototype.getCloudDiscoveryMetadataFromConfig=function(){if(this.authorityType===JN.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),e.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");var t=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),r=e.getCloudDiscoveryMetadataFromNetworkResponse(t.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),r)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),r;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch(t){throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),fF.createInvalidCloudDiscoveryMetadataError()}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),e.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null},e.prototype.getCloudDiscoveryMetadataFromNetwork=function(){var t;return kN(this,void 0,void 0,(function(){var r,n,i,o,a,s;return AN(this,(function(l){switch(l.label){case 0:null!=(t=this.performanceClient)&&t.addQueueMeasurement(RF.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId),r=""+ez.AAD_INSTANCE_DISCOVERY_ENDPT+this.canonicalAuthority+"oauth2/v2.0/authorize",n={},i=null,l.label=1;case 1:return l.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(r,n)];case 2:if(s=l.sent(),a=o=void 0,function(e){return e.hasOwnProperty("tenant_discovery_endpoint")&&e.hasOwnProperty("metadata")}(s.body))o=s.body,a=o.metadata,this.logger.verbosePii("tenant_discovery_endpoint is: "+o.tenant_discovery_endpoint);else{if(!function(e){return e.hasOwnProperty("error")&&e.hasOwnProperty("error_description")}(s.body))return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),[2,null];if(this.logger.warning("A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: "+s.status),(o=s.body).error===ez.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),[2,null];this.logger.warning("The CloudInstanceDiscoveryErrorResponse error is "+o.error),this.logger.warning("The CloudInstanceDiscoveryErrorResponse error description is "+o.error_description),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),a=[]}return this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),i=e.getCloudDiscoveryMetadataFromNetworkResponse(a,this.hostnameAndPort),[3,4];case 3:return(s=l.sent())instanceof fz?this.logger.error("There was a network error while attempting to get the cloud discovery instance metadata.\nError: "+s.errorCode+"\nError Description: "+s.errorMessage):this.logger.error("A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.\nError: "+s.name+"\nError Description: "+s.message),[2,null];case 4:return i||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),i=e.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),[2,i]}}))}))},e.prototype.getCloudDiscoveryMetadataFromHarcodedValues=function(){return this.canonicalAuthority in hB?hB[this.canonicalAuthority]:null},e.prototype.isInKnownAuthorities=function(){var e=this;return 0<this.authorityOptions.knownAuthorities.filter((function(t){return JF.getDomainFromUrl(t).toLowerCase()===e.hostnameAndPort})).length},e.generateAuthority=function(e,t){var r;return t&&t.azureCloudInstance!==QN.None&&(r=t.tenant||ez.DEFAULT_COMMON_TENANT,r=t.azureCloudInstance+"/"+r+"/"),r||e},e.createCloudDiscoveryMetadataFromHost=function(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}},e.getCloudDiscoveryMetadataFromNetworkResponse=function(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(-1<n.aliases.indexOf(t))return n}return null},e.prototype.getPreferredCache=function(){if(this.discoveryComplete())return this.metadata.preferred_cache;throw lF.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},e.prototype.isAlias=function(e){return-1<this.metadata.aliases.indexOf(e)},e.isPublicCloudAuthority=function(e){return 0<=ez.KNOWN_PUBLIC_CLOUDS.indexOf(e)},e.buildRegionalAuthorityString=function(e,t,r){var n=t+"."+(i=((e=new JF(e)).validateAsUri(),e.getUrlComponents())).HostNameAndPort,i=(this.isPublicCloudAuthority(i.HostNameAndPort)&&(n=t+"."+ez.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX),JF.constructAuthorityUriFromObject(IN(IN({},e.getUrlComponents()),{HostNameAndPort:n})).urlString);return r?i+"?"+r:i},e.replaceWithRegionalInformation=function(t,r){return t.authorization_endpoint=e.buildRegionalAuthorityString(t.authorization_endpoint,r),t.token_endpoint=e.buildRegionalAuthorityString(t.token_endpoint,r,ez.REGIONAL_AUTH_NON_MSI_QUERY_STRING),t.end_session_endpoint&&(t.end_session_endpoint=e.buildRegionalAuthorityString(t.end_session_endpoint,r)),t},e.transformCIAMAuthority=function(e){var t=e.endsWith(ez.FORWARD_SLASH)?e:""+e+ez.FORWARD_SLASH;return 0===(e=new JF(e).getUrlComponents()).PathSegments.length&&e.HostNameAndPort.endsWith(ez.CIAM_AUTH_URL)?""+t+e.HostNameAndPort.split(".")[0]+ez.AAD_TENANT_DOMAIN_SUFFIX:t},e.reservedTenantDomains=new Set(["{tenant}","{tenantid}",ON.COMMON,ON.CONSUMERS,ON.ORGANIZATIONS]),e}(),kB=function(){function e(){}return e.createDiscoveredInstance=function(t,r,n,i,o,a,s){return kN(this,void 0,void 0,(function(){var l,c;return AN(this,(function(u){switch(u.label){case 0:null!=a&&a.addQueueMeasurement(RF.AuthorityFactoryCreateDiscoveredInstance,s),l=IB.transformCIAMAuthority(t),l=e.createInstance(l,r,n,i,o,a,s),u.label=1;case 1:return u.trys.push([1,3,,4]),null!=a&&a.setPreQueueTime(RF.AuthorityResolveEndpointsAsync,s),[4,l.resolveEndpointsAsync()];case 2:return u.sent(),[2,l];case 3:throw c=u.sent(),lF.createEndpointDiscoveryIncompleteError(c);case 4:return[2]}}))}))},e.createInstance=function(e,t,r,n,i,o,a){if(cF.isEmpty(e))throw fF.createUrlEmptyError();return new IB(e,t,r,n,i,o,a)},e}(),AB=function(){function e(){this.failedRequests=[],this.errors=[],this.cacheHits=0}return e.isServerTelemetryEntity=function(e,t){e=0===e.indexOf(cz.CACHE_KEY);var r=!0;return t&&(r=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),e&&r},e}(),PB=function(){function e(){}return e.isThrottlingEntity=function(e,t){var r=!1;e&&(r=0===e.indexOf(uz.THROTTLING_PREFIX)),e=!0;return t&&(e=t.hasOwnProperty("throttleTime")),r&&e},e}(),MB={sendGetRequestAsync:function(){return Promise.reject(fz.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented for the Network interface."))},sendPostRequestAsync:function(){return Promise.reject(fz.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented for the Network interface."))}},RB={code:"missing_kid_error",desc:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided."},OB={code:"missing_alg_error",desc:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."},LB=function(e){function t(r,n){return(r=e.call(this,r,n)||this).name="JoseHeaderError",Object.setPrototypeOf(r,t.prototype),r}return TN(t,e),t.createMissingKidError=function(){return new t(RB.code,RB.desc)},t.createMissingAlgError=function(){return new t(OB.code,OB.desc)},t}(fz),DB=function(){function e(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}return e.getShrHeaderString=function(t){if(!t.kid)throw LB.createMissingKidError();if(t.alg)return t=new e({typ:t.typ||YN.Pop,kid:t.kid,alg:t.alg}),JSON.stringify(t);throw LB.createMissingAlgError()},e}(),NB=function(){function e(e,t){this.cacheOutcome=$N.NO_CACHE_HIT,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||ez.EMPTY_STRING,this.wrapperVer=e.wrapperVer||ez.EMPTY_STRING,this.telemetryCacheKey=cz.CACHE_KEY+UN.CACHE_KEY_SEPARATOR+e.clientId}return e.prototype.generateCurrentRequestHeaderValue=function(){var e=""+this.apiId+cz.VALUE_SEPARATOR+this.cacheOutcome,t=[this.wrapperSKU,this.wrapperVer].join(cz.VALUE_SEPARATOR);e=[e,this.getRegionDiscoveryFields()].join(cz.VALUE_SEPARATOR);return[cz.SCHEMA_VERSION,e,t].join(cz.CATEGORY_SEPARATOR)},e.prototype.generateLastRequestHeaderValue=function(){var t=this.getLastRequests(),r=e.maxErrorsToSend(t),n=t.failedRequests.slice(0,2*r).join(cz.VALUE_SEPARATOR),i=t.errors.slice(0,r).join(cz.VALUE_SEPARATOR),o=t.errors.length;r=[o,r<o?cz.OVERFLOW_TRUE:cz.OVERFLOW_FALSE].join(cz.VALUE_SEPARATOR);return[cz.SCHEMA_VERSION,t.cacheHits,n,i,r].join(cz.CATEGORY_SEPARATOR)},e.prototype.cacheFailedRequest=function(e){var t=this.getLastRequests();t.errors.length>=cz.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),cF.isEmpty(e.subError)?cF.isEmpty(e.errorCode)?e&&e.toString()?t.errors.push(e.toString()):t.errors.push(cz.UNKNOWN_ERROR):t.errors.push(e.errorCode):t.errors.push(e.subError),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)},e.prototype.incrementCacheHits=function(){var e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits},e.prototype.getLastRequests=function(){var e=new AB;return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e},e.prototype.clearTelemetryCache=function(){var t,r=this.getLastRequests(),n=e.maxErrorsToSend(r);n===r.errors.length?this.cacheManager.removeItem(this.telemetryCacheKey):((t=new AB).failedRequests=r.failedRequests.slice(2*n),t.errors=r.errors.slice(n),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t))},e.maxErrorsToSend=function(e){for(var t=0,r=0,n=e.errors.length,i=0;i<n;i++){var o=e.failedRequests[2*i]||ez.EMPTY_STRING,a=e.failedRequests[2*i+1]||ez.EMPTY_STRING,s=e.errors[i]||ez.EMPTY_STRING;if(!((r+=o.toString().length+a.toString().length+s.length+3)<cz.MAX_LAST_HEADER_BYTES))break;t+=1}return t},e.prototype.getRegionDiscoveryFields=function(){var e=[];return e.push(this.regionUsed||ez.EMPTY_STRING),e.push(this.regionSource||ez.EMPTY_STRING),e.push(this.regionOutcome||ez.EMPTY_STRING),e.join(",")},e.prototype.updateRegionDiscoveryMetadata=function(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome},e.prototype.setCacheOutcome=function(e){this.cacheOutcome=e},e}(),zB=function(){function e(e,t,r,n,i,o){this.authority=t,this.libraryName=n,this.libraryVersion=i,this.applicationTelemetry=o,this.clientId=e,this.logger=r,this.callbacks=new Map,this.eventsByCorrelationId=new Map,this.queueMeasurements=new Map,this.preQueueTimeByCorrelationId=new Map}return e.prototype.startPerformanceMeasurement=function(e,t){return{}},e.prototype.startPerformanceMeasuremeant=function(e,t){return{}},e.prototype.getIntFields=function(){return eB},e.prototype.getPreQueueTime=function(e,t){var r=this.preQueueTimeByCorrelationId.get(t);if(r){if(r.name===e)return r.time;this.logger.trace("PerformanceClient.getPreQueueTime: no pre-queue time found for "+e+", unable to add queue measurement")}else this.logger.trace("PerformanceClient.getPreQueueTime: no pre-queue times found for correlationId: "+t+", unable to add queue measurement")},e.prototype.calculateQueuedTime=function(e,t){return e<1?(this.logger.trace("PerformanceClient: preQueueTime should be a positive integer and not "+e),0):t<1?(this.logger.trace("PerformanceClient: currentTime should be a positive integer and not "+t),0):t<e?(this.logger.trace("PerformanceClient: currentTime is less than preQueueTime, check how time is being retrieved"),0):t-e},e.prototype.addQueueMeasurement=function(e,t,r,n){if(t){if(0===r)this.logger.trace("PerformanceClient.addQueueMeasurement: queue time provided for "+e+" is "+r);else if(!r)return void this.logger.trace("PerformanceClient.addQueueMeasurement: no queue time provided for "+e);r={eventName:e,queueTime:r,manuallyCompleted:n},(n=this.queueMeasurements.get(t))?(n.push(r),this.queueMeasurements.set(t,n)):(this.logger.trace("PerformanceClient.addQueueMeasurement: adding correlationId "+t+" to queue measurements"),this.queueMeasurements.set(t,[r])),this.preQueueTimeByCorrelationId.delete(t)}else this.logger.trace("PerformanceClient.addQueueMeasurement: correlationId not provided for "+e+", cannot add queue measurement")},e.prototype.startMeasurement=function(e,t){var r=this,n=t||this.generateId(),i=(t||this.logger.info("PerformanceClient: No correlation id provided for "+e+", generating",n),this.logger.trace("PerformanceClient: Performance measurement started for "+e,n),this.startPerformanceMeasuremeant(e,n)),o=(i.startMeasurement(),{eventId:this.generateId(),status:OF.InProgress,authority:this.authority,libraryName:this.libraryName,libraryVersion:this.libraryVersion,clientId:this.clientId,name:e,startTimeMs:Date.now(),correlationId:n,appName:null==(t=this.applicationTelemetry)?void 0:t.appName,appVersion:null==(e=this.applicationTelemetry)?void 0:e.appVersion});return this.cacheEventByCorrelationId(o),{endMeasurement:function(e){return r.endMeasurement(IN(IN({},o),e),i)},discardMeasurement:function(){return r.discardMeasurements(o.correlationId)},addStaticFields:function(e){return r.addStaticFields(e,o.correlationId)},increment:function(e){return r.increment(e,o.correlationId)},measurement:i,event:o}},e.prototype.endMeasurement=function(e,t){var r,n,i,o,a,s=this,l=this.eventsByCorrelationId.get(e.correlationId);return l?(n={totalQueueTime:0,totalQueueCount:0,manuallyCompletedCount:0},(r=e.eventId===l.eventId)?(n=this.getQueueInfo(e.correlationId),this.discardCache(l.correlationId)):null!=(i=l.incompleteSubMeasurements)&&i.delete(e.eventId),null!=t&&t.endMeasurement(),(i=null==t?void 0:t.flushMeasurement())?(this.logger.trace("PerformanceClient: Performance measurement ended for "+e.name+": "+i+" ms",e.correlationId),r?(o=IN(IN({},l),e),a=0,null!=(t=o.incompleteSubMeasurements)&&t.forEach((function(t){s.logger.trace("PerformanceClient: Incomplete submeasurement "+t.name+" found for "+e.name,o.correlationId),a++})),o.incompleteSubMeasurements=void 0,o=IN(IN({},o),{durationMs:Math.round(i),queuedTimeMs:n.totalQueueTime,queuedCount:n.totalQueueCount,queuedManuallyCompletedCount:n.manuallyCompletedCount,status:OF.Completed,incompleteSubsCount:a}),this.truncateIntegralFields(o,this.getIntFields()),this.emitEvents([o],e.correlationId),o):(l[e.name+"DurationMs"]=Math.floor(i),IN({},l))):(this.logger.trace("PerformanceClient: Performance measurement not taken",l.correlationId),null)):(this.logger.trace("PerformanceClient: Measurement not found for "+e.eventId,e.correlationId),null)},e.prototype.addStaticFields=function(e,t){this.logger.trace("PerformanceClient: Updating static fields");var r=this.eventsByCorrelationId.get(t);r?this.eventsByCorrelationId.set(t,IN(IN({},r),e)):this.logger.trace("PerformanceClient: Event not found for",t)},e.prototype.increment=function(e,t){this.logger.trace("PerformanceClient: Updating counters");var r=this.eventsByCorrelationId.get(t);if(r)for(var n in e)r.hasOwnProperty(n)||(r[n]=0),r[n]+=e[n];else this.logger.trace("PerformanceClient: Event not found for",t)},e.prototype.cacheEventByCorrelationId=function(e){var t=this.eventsByCorrelationId.get(e.correlationId);t?(this.logger.trace("PerformanceClient: Performance measurement for "+e.name+" added/updated",e.correlationId),t.incompleteSubMeasurements=t.incompleteSubMeasurements||new Map,t.incompleteSubMeasurements.set(e.eventId,{name:e.name,startTimeMs:e.startTimeMs})):(this.logger.trace("PerformanceClient: Performance measurement for "+e.name+" started",e.correlationId),this.eventsByCorrelationId.set(e.correlationId,IN({},e)))},e.prototype.getQueueInfo=function(e){var t=this.queueMeasurements.get(e),r=(t||this.logger.trace("PerformanceClient: no queue measurements found for for correlationId: "+e),0),n=0,i=0;return null!=t&&t.forEach((function(e){r+=e.queueTime,n++,i+=e.manuallyCompleted?1:0})),{totalQueueTime:r,totalQueueCount:n,manuallyCompletedCount:i}},e.prototype.discardMeasurements=function(e){this.logger.trace("PerformanceClient: Performance measurements discarded",e),this.eventsByCorrelationId.delete(e)},e.prototype.discardCache=function(e){this.discardMeasurements(e),this.logger.trace("PerformanceClient: QueueMeasurements discarded",e),this.queueMeasurements.delete(e),this.logger.trace("PerformanceClient: Pre-queue times discarded",e),this.preQueueTimeByCorrelationId.delete(e)},e.prototype.addPerformanceCallback=function(e){var t=this.generateId();return this.callbacks.set(t,e),this.logger.verbose("PerformanceClient: Performance callback registered with id: "+t),t},e.prototype.removePerformanceCallback=function(e){var t=this.callbacks.delete(e);return t?this.logger.verbose("PerformanceClient: Performance callback "+e+" removed."):this.logger.verbose("PerformanceClient: Performance callback "+e+" not removed."),t},e.prototype.emitEvents=function(e,t){var r=this;this.logger.verbose("PerformanceClient: Emitting performance events",t),this.callbacks.forEach((function(n,i){r.logger.trace("PerformanceClient: Emitting event to callback "+i,t),n.apply(null,[e])}))},e.prototype.truncateIntegralFields=function(e,t){t.forEach((function(t){t in e&&"number"==typeof e[t]&&(e[t]=Math.floor(e[t]))}))},e}(),FB=function(){function e(){}return e.prototype.startMeasurement=function(){},e.prototype.endMeasurement=function(){},e.prototype.flushMeasurement=function(){return null},e}(),BB=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return TN(t,e),t.prototype.generateId=function(){return"callback-id"},t.prototype.startPerformanceMeasuremeant=function(){return new FB},t.prototype.startPerformanceMeasurement=function(){return new FB},t.prototype.calculateQueuedTime=function(e,t){return 0},t.prototype.addQueueMeasurement=function(e,t,r){},t.prototype.setPreQueueTime=function(e,t){},t}(zB),UB={code:"pkce_not_created",desc:"The PKCE code challenge and verifier could not be generated."},jB={code:"crypto_nonexistent",desc:"The crypto object or function is not available."},qB={code:"http_method_not_implemented",desc:"The HTTP method given has not been implemented in this library."},HB={code:"empty_navigate_uri",desc:"Navigation URI is empty. Please check stack trace for more info."},VB={code:"hash_empty_error",desc:"Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. For more visit: aka.ms/msaljs/browser-errors."},GB={code:"no_state_in_hash",desc:"Hash does not contain state. Please verify that the request originated from msal."},KB={code:"hash_does_not_contain_known_properties",desc:"Hash does not contain known properites. Please verify that your redirectUri is not changing the hash. For more visit: aka.ms/msaljs/browser-errors."},ZB={code:"unable_to_parse_state",desc:"Unable to parse state. Please verify that the request originated from msal."},WB={code:"state_interaction_type_mismatch",desc:"Hash contains state but the interaction type does not match the caller."},$B={code:"interaction_in_progress",desc:"Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.  For more visit: aka.ms/msaljs/browser-errors."},YB={code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},XB={code:"empty_window_error",desc:"window.open returned null or undefined window object."},QB={code:"user_cancelled",desc:"User cancelled the flow."},JB={code:"monitor_window_timeout",desc:"Token acquisition in popup failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},eU={code:"monitor_window_timeout",desc:"Token acquisition in iframe failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},tU={code:"redirect_in_iframe",desc:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs."},rU={code:"block_iframe_reload",desc:"Request was blocked inside an iframe because MSAL detected an authentication response. For more visit: aka.ms/msaljs/browser-errors"},nU={code:"block_nested_popups",desc:"Request was blocked inside a popup because MSAL detected it was running in a popup."},iU={code:"iframe_closed_prematurely",desc:"The iframe being monitored was closed prematurely."},oU={code:"silent_logout_unsupported",desc:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead."},aU={code:"no_account_error",desc:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request."},sU={code:"silent_prompt_value_error",desc:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'."},lU={code:"no_token_request_cache_error",desc:"No token request found in cache."},cU={code:"unable_to_parse_token_request_cache_error",desc:"The cached token request could not be parsed."},uU={code:"no_cached_authority_error",desc:"No cached authority found."},hU={code:"auth_request_not_set_error",desc:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler"},dU={code:"invalid_cache_type",desc:"Invalid cache type"},pU={code:"non_browser_environment",desc:"Login and token requests are not supported in non-browser environments."},fU={code:"database_not_open",desc:"Database is not open!"},mU={code:"no_network_connectivity",desc:"No network connectivity. Check your internet connection."},gU={code:"post_request_failed",desc:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'"},yU={code:"get_request_failed",desc:"Network request failed. Please check the network trace to determine root cause."},vU={code:"failed_to_parse_response",desc:"Failed to parse network response. Check network trace."},_U={code:"unable_to_load_token",desc:"Error loading token to cache."},bU={code:"crypto_key_not_found",desc:"Cryptographic Key or Keypair not found in browser storage."},wU={code:"auth_code_required",desc:"An authorization code must be provided (as the `code` property on the request) to this flow."},xU={code:"auth_code_or_nativeAccountId_required",desc:"An authorization code or nativeAccountId must be provided to this flow."},CU={code:"spa_code_and_nativeAccountId_present",desc:"Request cannot contain both spa code and native account id."},SU={code:"database_unavailable",desc:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts."},EU={code:"unable_to_acquire_token_from_native_platform",desc:"Unable to acquire token from native platform. For a list of possible reasons visit aka.ms/msaljs/browser-errors."},TU={code:"native_handshake_timeout",desc:"Timed out while attempting to establish connection to browser extension"},IU={code:"native_extension_not_installed",desc:"Native extension is not installed. If you think this is a mistake call the initialize function."},kU={code:"native_connection_not_established",desc:"Connection to native platform has not been established. Please install a compatible browser extension and run initialize(). For more please visit aka.ms/msaljs/browser-errors."},AU={code:"native_broker_called_before_initialize",desc:"You must call and await the initialize function before attempting to call any other MSAL API when native brokering is enabled. For more please visit aka.ms/msaljs/browser-errors."},PU={code:"native_prompt_not_supported",desc:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow."},MU=function(e){function t(r,n){return r=e.call(this,r,n)||this,Object.setPrototypeOf(r,t.prototype),r.name="BrowserAuthError",r}return vN(t,e),t.createPkceNotGeneratedError=function(e){return new t(UB.code,UB.desc+" Detail:"+e)},t.createCryptoNotAvailableError=function(e){return new t(jB.code,jB.desc+" Detail:"+e)},t.createHttpMethodNotImplementedError=function(e){return new t(qB.code,qB.desc+" Given Method: "+e)},t.createEmptyNavigationUriError=function(){return new t(HB.code,HB.desc)},t.createEmptyHashError=function(e){return new t(VB.code,VB.desc+" Given Url: "+e)},t.createHashDoesNotContainStateError=function(){return new t(GB.code,GB.desc)},t.createHashDoesNotContainKnownPropertiesError=function(){return new t(KB.code,KB.desc)},t.createUnableToParseStateError=function(){return new t(ZB.code,ZB.desc)},t.createStateInteractionTypeMismatchError=function(){return new t(WB.code,WB.desc)},t.createInteractionInProgressError=function(){return new t($B.code,$B.desc)},t.createPopupWindowError=function(e){var r=YB.desc;r=cF.isEmpty(e)?r:r+" Details: "+e;return new t(YB.code,r)},t.createEmptyWindowCreatedError=function(){return new t(XB.code,XB.desc)},t.createUserCancelledError=function(){return new t(QB.code,QB.desc)},t.createMonitorPopupTimeoutError=function(){return new t(JB.code,JB.desc)},t.createMonitorIframeTimeoutError=function(){return new t(eU.code,eU.desc)},t.createRedirectInIframeError=function(e){return new t(tU.code,tU.desc+" (window.parent !== window) => "+e)},t.createBlockReloadInHiddenIframeError=function(){return new t(rU.code,rU.desc)},t.createBlockAcquireTokenInPopupsError=function(){return new t(nU.code,nU.desc)},t.createIframeClosedPrematurelyError=function(){return new t(iU.code,iU.desc)},t.createSilentLogoutUnsupportedError=function(){return new t(oU.code,oU.desc)},t.createNoAccountError=function(){return new t(aU.code,aU.desc)},t.createSilentPromptValueError=function(e){return new t(sU.code,sU.desc+" Given value: "+e)},t.createUnableToParseTokenRequestCacheError=function(){return new t(cU.code,cU.desc)},t.createNoTokenRequestCacheError=function(){return new t(lU.code,lU.desc)},t.createAuthRequestNotSetError=function(){return new t(hU.code,hU.desc)},t.createNoCachedAuthorityError=function(){return new t(uU.code,uU.desc)},t.createInvalidCacheTypeError=function(){return new t(dU.code,""+dU.desc)},t.createNonBrowserEnvironmentError=function(){return new t(pU.code,pU.desc)},t.createDatabaseNotOpenError=function(){return new t(fU.code,fU.desc)},t.createNoNetworkConnectivityError=function(){return new t(mU.code,mU.desc)},t.createPostRequestFailedError=function(e,r){return new t(gU.code,gU.desc+" | Network client threw: "+e+" | Attempted to reach: "+r.split("?")[0])},t.createGetRequestFailedError=function(e,r){return new t(yU.code,yU.desc+" | Network client threw: "+e+" | Attempted to reach: "+r.split("?")[0])},t.createFailedToParseNetworkResponseError=function(e){return new t(vU.code,vU.desc+" | Attempted to reach: "+e.split("?")[0])},t.createUnableToLoadTokenError=function(e){return new t(_U.code,_U.desc+" | "+e)},t.createSigningKeyNotFoundInStorageError=function(e){return new t(bU.code,bU.desc+" | No match found for KeyId: "+e)},t.createAuthCodeRequiredError=function(){return new t(wU.code,wU.desc)},t.createAuthCodeOrNativeAccountIdRequiredError=function(){return new t(xU.code,xU.desc)},t.createSpaCodeAndNativeAccountIdPresentError=function(){return new t(CU.code,CU.desc)},t.createDatabaseUnavailableError=function(){return new t(SU.code,SU.desc)},t.createUnableToAcquireTokenFromNativePlatformError=function(){return new t(EU.code,EU.desc)},t.createNativeHandshakeTimeoutError=function(){return new t(TU.code,TU.desc)},t.createNativeExtensionNotInstalledError=function(){return new t(IU.code,IU.desc)},t.createNativeConnectionNotEstablishedError=function(){return new t(kU.code,kU.desc)},t.createNativeBrokerCalledBeforeInitialize=function(){return new t(AU.code,AU.desc)},t.createNativePromptParameterNotSupportedError=function(){return new t(PU.code,PU.desc)},t}(fz),RU="invalid_grant",OU=483,LU=600,DU="msal",NU=30,zU="msal.js.browser",FU="53ee284d-920a-4b59-9d30-a60315b26836",BU="ppnbnpeolgkicgegkbkbjmhlideopiji",UU="MATS",jU=(function(e){e.HandshakeRequest="Handshake",e.HandshakeResponse="HandshakeResponse",e.GetToken="GetToken",e.Response="Response"}(pB=pB||{}),function(e){e.LocalStorage="localStorage",e.SessionStorage="sessionStorage",e.MemoryStorage="memoryStorage"}(fB=fB||{}),function(e){e.GET="GET",e.POST="POST"}(mB=mB||{}),function(e){e.AUTHORITY="authority",e.ACQUIRE_TOKEN_ACCOUNT="acquireToken.account",e.SESSION_STATE="session.state",e.REQUEST_STATE="request.state",e.NONCE_IDTOKEN="nonce.id_token",e.ORIGIN_URI="request.origin",e.RENEW_STATUS="token.renew.status",e.URL_HASH="urlHash",e.REQUEST_PARAMS="request.params",e.SCOPES="scopes",e.INTERACTION_STATUS_KEY="interaction.status",e.CCS_CREDENTIAL="ccs.credential",e.CORRELATION_ID="request.correlationId",e.NATIVE_REQUEST="request.native",e.REDIRECT_CONTEXT="request.redirect.context"}(gB=gB||{}),function(e){e.ACCOUNT_KEYS="msal.account.keys",e.TOKEN_KEYS="msal.token.keys"}(yB=yB||{}),function(e){e.WRAPPER_SKU="wrapper.sku",e.WRAPPER_VER="wrapper.version"}(vB=vB||{}),function(e){e[e.acquireTokenRedirect=861]="acquireTokenRedirect",e[e.acquireTokenPopup=862]="acquireTokenPopup",e[e.ssoSilent=863]="ssoSilent",e[e.acquireTokenSilent_authCode=864]="acquireTokenSilent_authCode",e[e.handleRedirectPromise=865]="handleRedirectPromise",e[e.acquireTokenByCode=866]="acquireTokenByCode",e[e.acquireTokenSilent_silentFlow=61]="acquireTokenSilent_silentFlow",e[e.logout=961]="logout",e[e.logoutPopup=962]="logoutPopup"}(_B=_B||{}),function(e){e.Redirect="redirect",e.Popup="popup",e.Silent="silent",e.None="none"}(bB=bB||{}),function(e){e.Startup="startup",e.Login="login",e.Logout="logout",e.AcquireToken="acquireToken",e.SsoSilent="ssoSilent",e.HandleRedirect="handleRedirect",e.None="none"}(wB=wB||{}),{scopes:tz}),qU="jwk",HU=(function(e){e.React="@azure/msal-react",e.Angular="@azure/msal-angular"}(xB=xB||{}),"msal.db"),VU=HU+".keys",GU=(function(e){e[e.Default=0]="Default",e[e.AccessToken=1]="AccessToken",e[e.AccessTokenAndRefreshToken=2]="AccessTokenAndRefreshToken",e[e.RefreshToken=3]="RefreshToken",e[e.RefreshTokenAndNetwork=4]="RefreshTokenAndNetwork",e[e.Skip=5]="Skip"}(CB=CB||{}),{redirectUriNotSet:{code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},postLogoutUriNotSet:{code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},storageNotSupportedError:{code:"storage_not_supported",desc:"Given storage configuration option was not supported."},noRedirectCallbacksSet:{code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},invalidCallbackObject:{code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},stubPcaInstanceCalled:{code:"stubbed_public_client_application_called",desc:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors"},inMemRedirectUnavailable:{code:"in_mem_redirect_unavailable",desc:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."},entropyNotProvided:{code:"entropy_not_provided",desc:"The available browser crypto interface requires entropy set via system.cryptoOptions.entropy configuration option."}}),KU=function(e){function t(r,n){return(r=e.call(this,r,n)||this).name="BrowserConfigurationAuthError",Object.setPrototypeOf(r,t.prototype),r}return vN(t,e),t.createRedirectUriEmptyError=function(){return new t(GU.redirectUriNotSet.code,GU.redirectUriNotSet.desc)},t.createPostLogoutRedirectUriEmptyError=function(){return new t(GU.postLogoutUriNotSet.code,GU.postLogoutUriNotSet.desc)},t.createStorageNotSupportedError=function(e){return new t(GU.storageNotSupportedError.code,GU.storageNotSupportedError.desc+" Given Location: "+e)},t.createRedirectCallbacksNotSetError=function(){return new t(GU.noRedirectCallbacksSet.code,GU.noRedirectCallbacksSet.desc)},t.createStubPcaInstanceCalledError=function(){return new t(GU.stubPcaInstanceCalled.code,GU.stubPcaInstanceCalled.desc)},t.createInMemoryRedirectUnavailableError=function(){return new t(GU.inMemRedirectUnavailable.code,GU.inMemRedirectUnavailable.desc)},t.createEntropyNotProvided=function(){return new t(GU.entropyNotProvided.code,GU.entropyNotProvided.desc)},t}(fz),ZU=function(){function e(e){this.validateWindowStorage(e),this.windowStorage=window[e]}return e.prototype.validateWindowStorage=function(e){if(e!==fB.LocalStorage&&e!==fB.SessionStorage)throw KU.createStorageNotSupportedError(e);if(!window[e])throw KU.createStorageNotSupportedError(e)},e.prototype.getItem=function(e){return this.windowStorage.getItem(e)},e.prototype.setItem=function(e,t){this.windowStorage.setItem(e,t)},e.prototype.removeItem=function(e){this.windowStorage.removeItem(e)},e.prototype.getKeys=function(){return Object.keys(this.windowStorage)},e.prototype.containsKey=function(e){return this.windowStorage.hasOwnProperty(e)},e}(),WU=function(){function e(){this.cache=new Map}return e.prototype.getItem=function(e){return this.cache.get(e)||null},e.prototype.setItem=function(e,t){this.cache.set(e,t)},e.prototype.removeItem=function(e){this.cache.delete(e)},e.prototype.getKeys=function(){var e=[];return this.cache.forEach((function(t,r){e.push(r)})),e},e.prototype.containsKey=function(e){return this.cache.has(e)},e.prototype.clear=function(){this.cache.clear()},e}(),$U=function(){function e(){}return e.extractBrowserRequestState=function(e,t){if(cF.isEmpty(t))return null;try{return QF.parseRequestState(e,t).libraryState.meta}catch(e){throw lF.createInvalidStateError(t,e)}},e.parseServerResponseFromHash=function(e){return e?(e=new JF(e),JF.getDeserializedHash(e.getHash())):{}},e}(),YU=function(e){function t(t,r,n,i){return(t=e.call(this,t,n,i)||this).COOKIE_LIFE_MULTIPLIER=864e5,t.cacheConfig=r,t.logger=i,t.internalStorage=new WU,t.browserStorage=t.setupBrowserStorage(t.cacheConfig.cacheLocation),t.temporaryCacheStorage=t.setupTemporaryCacheStorage(t.cacheConfig.temporaryCacheLocation,t.cacheConfig.cacheLocation),r.cacheMigrationEnabled&&(t.migrateCacheEntries(),t.createKeyMaps()),t}return vN(t,e),t.prototype.setupBrowserStorage=function(e){switch(e){case fB.LocalStorage:case fB.SessionStorage:try{return new ZU(e)}catch(e){this.logger.verbose(e);break}}return this.cacheConfig.cacheLocation=fB.MemoryStorage,new WU},t.prototype.setupTemporaryCacheStorage=function(e,t){switch(t){case fB.LocalStorage:case fB.SessionStorage:try{return new ZU(e||fB.SessionStorage)}catch(e){return this.logger.verbose(e),this.internalStorage}case fB.MemoryStorage:default:return this.internalStorage}},t.prototype.migrateCacheEntries=function(){var e=this,t=ez.CACHE_PREFIX+"."+RN.ID_TOKEN,r=ez.CACHE_PREFIX+"."+RN.CLIENT_INFO,n=ez.CACHE_PREFIX+"."+RN.ERROR,i=ez.CACHE_PREFIX+"."+RN.ERROR_DESC,o=[this.browserStorage.getItem(t),this.browserStorage.getItem(r),this.browserStorage.getItem(n),this.browserStorage.getItem(i)];[RN.ID_TOKEN,RN.CLIENT_INFO,RN.ERROR,RN.ERROR_DESC].forEach((function(t,r){return e.migrateCacheEntry(t,o[r])}))},t.prototype.migrateCacheEntry=function(e,t){t&&this.setTemporaryCache(e,t,!0)},t.prototype.createKeyMaps=function(){var e=this,t=(this.logger.trace("BrowserCacheManager - createKeyMaps called."),this.getItem(yB.ACCOUNT_KEYS)),r=this.getItem(yB.TOKEN_KEYS+"."+this.clientId);t&&r?this.logger.verbose("BrowserCacheManager:createKeyMaps - account and token key maps already exist, skipping migration."):this.browserStorage.getKeys().forEach((function(t){var r;if(e.isCredentialKey(t)&&(r=e.getItem(t))){var n,i,o=e.validateAndParseJson(r);if(o&&o.hasOwnProperty("credentialType"))switch(o.credentialType){case jN.ID_TOKEN:if(qF.isIdTokenEntity(o))return e.logger.trace("BrowserCacheManager:createKeyMaps - idToken found, saving key to token key map"),e.logger.tracePii("BrowserCacheManager:createKeyMaps - idToken with key: "+t+" found, saving key to token key map"),i=bF.toObject(new qF,o),i=e.updateCredentialCacheKey(t,i),void e.addTokenKey(i,jN.ID_TOKEN);e.logger.trace("BrowserCacheManager:createKeyMaps - key found matching idToken schema with value containing idToken credentialType field but value failed IdTokenEntity validation, skipping."),e.logger.tracePii("BrowserCacheManager:createKeyMaps - failed idToken validation on key: "+t);break;case jN.ACCESS_TOKEN:case jN.ACCESS_TOKEN_WITH_AUTH_SCHEME:if(VF.isAccessTokenEntity(o))return e.logger.trace("BrowserCacheManager:createKeyMaps - accessToken found, saving key to token key map"),e.logger.tracePii("BrowserCacheManager:createKeyMaps - accessToken with key: "+t+" found, saving key to token key map"),n=bF.toObject(new VF,o),i=e.updateCredentialCacheKey(t,n),void e.addTokenKey(i,jN.ACCESS_TOKEN);e.logger.trace("BrowserCacheManager:createKeyMaps - key found matching accessToken schema with value containing accessToken credentialType field but value failed AccessTokenEntity validation, skipping."),e.logger.tracePii("BrowserCacheManager:createKeyMaps - failed accessToken validation on key: "+t);break;case jN.REFRESH_TOKEN:if(GF.isRefreshTokenEntity(o))return e.logger.trace("BrowserCacheManager:createKeyMaps - refreshToken found, saving key to token key map"),e.logger.tracePii("BrowserCacheManager:createKeyMaps - refreshToken with key: "+t+" found, saving key to token key map"),n=bF.toObject(new GF,o),i=e.updateCredentialCacheKey(t,n),void e.addTokenKey(i,jN.REFRESH_TOKEN);e.logger.trace("BrowserCacheManager:createKeyMaps - key found matching refreshToken schema with value containing refreshToken credentialType field but value failed RefreshTokenEntity validation, skipping."),e.logger.tracePii("BrowserCacheManager:createKeyMaps - failed refreshToken validation on key: "+t)}}e.isAccountKey(t)&&(r=e.getItem(t))&&(r=e.validateAndParseJson(r))&&vF.isAccountEntity(r)&&(e.logger.trace("BrowserCacheManager:createKeyMaps - account found, saving key to account key map"),e.logger.tracePii("BrowserCacheManager:createKeyMaps - account with key: "+t+" found, saving key to account key map"),e.addAccountKeyToMap(t))}))},t.prototype.validateAndParseJson=function(e){try{var t=JSON.parse(e);return t&&"object"==typeof t?t:null}catch(e){return null}},t.prototype.getItem=function(e){return this.browserStorage.getItem(e)},t.prototype.setItem=function(e,t){this.browserStorage.setItem(e,t)},t.prototype.getAccount=function(e){this.logger.trace("BrowserCacheManager.getAccount called");var t=this.getItem(e);return(t=t&&this.validateAndParseJson(t))&&vF.isAccountEntity(t)?bF.toObject(new vF,t):(this.removeAccountKeyFromMap(e),null)},t.prototype.setAccount=function(e){this.logger.trace("BrowserCacheManager.setAccount called");var t=e.generateAccountKey();this.setItem(t,JSON.stringify(e)),this.addAccountKeyToMap(t)},t.prototype.getAccountKeys=function(){this.logger.trace("BrowserCacheManager.getAccountKeys called");var e=this.getItem(yB.ACCOUNT_KEYS);return e?JSON.parse(e):(this.logger.verbose("BrowserCacheManager.getAccountKeys - No account keys found"),[])},t.prototype.addAccountKeyToMap=function(e){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii("BrowserCacheManager.addAccountKeyToMap called with key: "+e);var t=this.getAccountKeys();-1===t.indexOf(e)?(t.push(e),this.setItem(yB.ACCOUNT_KEYS,JSON.stringify(t)),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added")):this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map")},t.prototype.removeAccountKeyFromMap=function(e){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii("BrowserCacheManager.removeAccountKeyFromMap called with key: "+e);var t=this.getAccountKeys();-1<(e=t.indexOf(e))?(t.splice(e,1),this.setItem(yB.ACCOUNT_KEYS,JSON.stringify(t)),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")):this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")},t.prototype.removeAccount=function(t){return wN(this,void 0,void 0,(function(){return xN(this,(function(r){return e.prototype.removeAccount.call(this,t),this.removeAccountKeyFromMap(t),[2]}))}))},t.prototype.removeIdToken=function(t){e.prototype.removeIdToken.call(this,t),this.removeTokenKey(t,jN.ID_TOKEN)},t.prototype.removeAccessToken=function(t){return wN(this,void 0,void 0,(function(){return xN(this,(function(r){return e.prototype.removeAccessToken.call(this,t),this.removeTokenKey(t,jN.ACCESS_TOKEN),[2]}))}))},t.prototype.removeRefreshToken=function(t){e.prototype.removeRefreshToken.call(this,t),this.removeTokenKey(t,jN.REFRESH_TOKEN)},t.prototype.getTokenKeys=function(){this.logger.trace("BrowserCacheManager.getTokenKeys called");var e=this.getItem(yB.TOKEN_KEYS+"."+this.clientId);if(e){if((e=this.validateAndParseJson(e))&&e.hasOwnProperty("idToken")&&e.hasOwnProperty("accessToken")&&e.hasOwnProperty("refreshToken"))return e;this.logger.error("BrowserCacheManager.getTokenKeys - Token keys found but in an unknown format. Returning empty key map.")}else this.logger.verbose("BrowserCacheManager.getTokenKeys - No token keys found");return{idToken:[],accessToken:[],refreshToken:[]}},t.prototype.addTokenKey=function(e,t){this.logger.trace("BrowserCacheManager addTokenKey called");var r=this.getTokenKeys();switch(t){case jN.ID_TOKEN:-1===r.idToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),r.idToken.push(e));break;case jN.ACCESS_TOKEN:-1===r.accessToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - accessToken added to map"),r.accessToken.push(e));break;case jN.REFRESH_TOKEN:-1===r.refreshToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),r.refreshToken.push(e));break;default:this.logger.error("BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: "+t),lF.createUnexpectedCredentialTypeError()}this.setItem(yB.TOKEN_KEYS+"."+this.clientId,JSON.stringify(r))},t.prototype.removeTokenKey=function(e,t){this.logger.trace("BrowserCacheManager removeTokenKey called");var r=this.getTokenKeys();switch(t){case jN.ID_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: "+e+" from map");var n=r.idToken.indexOf(e);-1<n?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),r.idToken.splice(n,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case jN.ACCESS_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: "+e+" from map"),-1<(n=r.accessToken.indexOf(e))?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),r.accessToken.splice(n,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case jN.REFRESH_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: "+e+" from map"),-1<(n=r.refreshToken.indexOf(e))?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),r.refreshToken.splice(n,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:this.logger.error("BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: "+t),lF.createUnexpectedCredentialTypeError()}this.setItem(yB.TOKEN_KEYS+"."+this.clientId,JSON.stringify(r))},t.prototype.getIdTokenCredential=function(e){var t=this.getItem(e);return(t=t&&this.validateAndParseJson(t))&&qF.isIdTokenEntity(t)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),bF.toObject(new qF,t)):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,jN.ID_TOKEN),null)},t.prototype.setIdTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,jN.ID_TOKEN)},t.prototype.getAccessTokenCredential=function(e){var t=this.getItem(e);return(t=t&&this.validateAndParseJson(t))&&VF.isAccessTokenEntity(t)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),bF.toObject(new VF,t)):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,jN.ACCESS_TOKEN),null)},t.prototype.setAccessTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,jN.ACCESS_TOKEN)},t.prototype.getRefreshTokenCredential=function(e){var t=this.getItem(e);return(t=t&&this.validateAndParseJson(t))&&GF.isRefreshTokenEntity(t)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),bF.toObject(new GF,t)):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,jN.REFRESH_TOKEN),null)},t.prototype.setRefreshTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,jN.REFRESH_TOKEN)},t.prototype.getAppMetadata=function(e){var t=this.getItem(e);return(t=t&&this.validateAndParseJson(t))&&rB.isAppMetadataEntity(e,t)?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),bF.toObject(new rB,t)):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null)},t.prototype.setAppMetadata=function(e){this.logger.trace("BrowserCacheManager.setAppMetadata called");var t=e.generateAppMetadataKey();this.setItem(t,JSON.stringify(e))},t.prototype.getServerTelemetry=function(e){var t=this.getItem(e);return(t=t&&this.validateAndParseJson(t))&&AB.isServerTelemetryEntity(e,t)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),bF.toObject(new AB,t)):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)},t.prototype.setServerTelemetry=function(e,t){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(t))},t.prototype.getAuthorityMetadata=function(e){var t=this.internalStorage.getItem(e);return t?(t=this.validateAndParseJson(t))&&dB.isAuthorityMetadataEntity(e,t)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),bF.toObject(new dB,t)):null:(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null)},t.prototype.getAuthorityMetadataKeys=function(){var e=this;return this.internalStorage.getKeys().filter((function(t){return e.isAuthorityMetadata(t)}))},t.prototype.setWrapperMetadata=function(e,t){this.internalStorage.setItem(vB.WRAPPER_SKU,e),this.internalStorage.setItem(vB.WRAPPER_VER,t)},t.prototype.getWrapperMetadata=function(){return[this.internalStorage.getItem(vB.WRAPPER_SKU)||ez.EMPTY_STRING,this.internalStorage.getItem(vB.WRAPPER_VER)||ez.EMPTY_STRING]},t.prototype.setAuthorityMetadata=function(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))},t.prototype.getActiveAccount=function(){var e=this.generateCacheKey(RN.ACTIVE_ACCOUNT_FILTERS);return(e=this.getItem(e))?(e=this.validateAndParseJson(e))?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoByFilter({homeAccountId:e.homeAccountId,localAccountId:e.localAccountId})[0]||null):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters cache schema found, looking for legacy schema"),e=this.generateCacheKey(RN.ACTIVE_ACCOUNT),(e=this.getItem(e))?(e=this.getAccountInfoByFilter({localAccountId:e})[0]||null)?(this.logger.trace("BrowserCacheManager.getActiveAccount: Legacy active account cache schema found"),this.logger.trace("BrowserCacheManager.getActiveAccount: Adding active account filters cache schema"),this.setActiveAccount(e),e):null:(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null))},t.prototype.setActiveAccount=function(e){var t,r=this.generateCacheKey(RN.ACTIVE_ACCOUNT_FILTERS),n=this.generateCacheKey(RN.ACTIVE_ACCOUNT);e?(this.logger.verbose("setActiveAccount: Active account set"),t={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId},this.browserStorage.setItem(r,JSON.stringify(t)),this.browserStorage.setItem(n,e.localAccountId)):(this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(r),this.browserStorage.removeItem(n))},t.prototype.getAccountInfoByFilter=function(e){var t=this.getAllAccounts();return this.logger.trace("BrowserCacheManager.getAccountInfoByFilter: total "+t.length+" accounts found"),t.filter((function(t){return!(e.username&&e.username.toLowerCase()!==t.username.toLowerCase()||e.homeAccountId&&e.homeAccountId!==t.homeAccountId||e.localAccountId&&e.localAccountId!==t.localAccountId||e.tenantId&&e.tenantId!==t.tenantId||e.environment&&e.environment!==t.environment)}))},t.prototype.getAccountInfoByHints=function(e,t){var r=this.getAllAccounts().filter((function(r){var n;return t?(n=r.idTokenClaims&&r.idTokenClaims.sid,t===n):!!e&&e===r.username}));if(1===r.length)return r[0];if(1<r.length)throw lF.createMultipleMatchingAccountsInCacheError();return null},t.prototype.getThrottlingCache=function(e){var t=this.getItem(e);return(t=t&&this.validateAndParseJson(t))&&PB.isThrottlingEntity(e,t)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),bF.toObject(new PB,t)):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)},t.prototype.setThrottlingCache=function(e,t){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(t))},t.prototype.getTemporaryCache=function(e,t){return t=t?this.generateCacheKey(e):e,this.cacheConfig.storeAuthStateInCookie&&(e=this.getItemCookie(t))?(this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),e):(e=this.temporaryCacheStorage.getItem(t))?(this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),e):this.cacheConfig.cacheLocation===fB.LocalStorage&&(e=this.browserStorage.getItem(t))?(this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),e):(this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null)},t.prototype.setTemporaryCache=function(e,t,r){r=r?this.generateCacheKey(e):e,this.temporaryCacheStorage.setItem(r,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.setItemCookie(r,t))},t.prototype.removeItem=function(e){this.browserStorage.removeItem(e),this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.clearItemCookie(e))},t.prototype.containsKey=function(e){return this.browserStorage.containsKey(e)||this.temporaryCacheStorage.containsKey(e)},t.prototype.getKeys=function(){return SN(this.browserStorage.getKeys(),this.temporaryCacheStorage.getKeys())},t.prototype.clear=function(){return wN(this,void 0,void 0,(function(){var e=this;return xN(this,(function(t){switch(t.label){case 0:return[4,this.removeAllAccounts()];case 1:return t.sent(),this.removeAppMetadata(),this.getKeys().forEach((function(t){!e.browserStorage.containsKey(t)&&!e.temporaryCacheStorage.containsKey(t)||-1===t.indexOf(ez.CACHE_PREFIX)&&-1===t.indexOf(e.clientId)||e.removeItem(t)})),this.internalStorage.clear(),[2]}}))}))},t.prototype.clearTokensAndKeysWithClaims=function(){return wN(this,void 0,void 0,(function(){var e,t,r=this;return xN(this,(function(n){switch(n.label){case 0:return this.logger.trace("BrowserCacheManager.clearTokensAndKeysWithClaims called"),e=this.getTokenKeys(),t=[],e.accessToken.forEach((function(e){var n=r.getAccessTokenCredential(e);null!=n&&n.requestedClaimsHash&&e.includes(n.requestedClaimsHash.toLowerCase())&&t.push(r.removeAccessToken(e))})),[4,Promise.all(t)];case 1:return n.sent(),0<t.length&&this.logger.warning(t.length+" access tokens with claims in the cache keys have been removed from the cache."),[2]}}))}))},t.prototype.setItemCookie=function(e,t,r){e=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path=/;SameSite=Lax;",r&&(e+="expires="+this.getCookieExpirationTime(r)+";"),this.cacheConfig.secureCookies&&(e+="Secure;"),document.cookie=e},t.prototype.getItemCookie=function(e){for(var t=encodeURIComponent(e)+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var i=r[n];" "===i.charAt(0);)i=i.substring(1);if(0===i.indexOf(t))return decodeURIComponent(i.substring(t.length,i.length))}return ez.EMPTY_STRING},t.prototype.clearMsalCookies=function(){var e=this,t=ez.CACHE_PREFIX+"."+this.clientId;document.cookie.split(";").forEach((function(r){for(;" "===r.charAt(0);)r=r.substring(1);var n;0===r.indexOf(t)&&(n=r.split("=")[0],e.clearItemCookie(n))}))},t.prototype.clearItemCookie=function(e){this.setItemCookie(e,ez.EMPTY_STRING,-1)},t.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+e*this.COOKIE_LIFE_MULTIPLIER).toUTCString()},t.prototype.getCache=function(){return this.browserStorage},t.prototype.setCache=function(){},t.prototype.generateCacheKey=function(e){return this.validateAndParseJson(e)?JSON.stringify(e):cF.startsWith(e,ez.CACHE_PREFIX)||cF.startsWith(e,RN.ADAL_ID_TOKEN)?e:ez.CACHE_PREFIX+"."+this.clientId+"."+e},t.prototype.generateAuthorityKey=function(e){return e=QF.parseRequestState(this.cryptoImpl,e).libraryState.id,this.generateCacheKey(gB.AUTHORITY+"."+e)},t.prototype.generateNonceKey=function(e){return e=QF.parseRequestState(this.cryptoImpl,e).libraryState.id,this.generateCacheKey(gB.NONCE_IDTOKEN+"."+e)},t.prototype.generateStateKey=function(e){return e=QF.parseRequestState(this.cryptoImpl,e).libraryState.id,this.generateCacheKey(gB.REQUEST_STATE+"."+e)},t.prototype.getCachedAuthority=function(e){e=this.generateStateKey(e);return(e=this.getTemporaryCache(e))?(e=this.generateAuthorityKey(e),this.getTemporaryCache(e)):null},t.prototype.updateCacheEntries=function(e,t,r,n,i){this.logger.trace("BrowserCacheManager.updateCacheEntries called");var o,a=this.generateStateKey(e);this.setTemporaryCache(a,e,!1),a=this.generateNonceKey(e),this.setTemporaryCache(a,t,!1),a=this.generateAuthorityKey(e);this.setTemporaryCache(a,r,!1),i?(o={credential:i.homeAccountId,type:MF.HOME_ACCOUNT_ID},this.setTemporaryCache(gB.CCS_CREDENTIAL,JSON.stringify(o),!0)):cF.isEmpty(n)||(o={credential:n,type:MF.UPN},this.setTemporaryCache(gB.CCS_CREDENTIAL,JSON.stringify(o),!0))},t.prototype.resetRequestCache=function(e){var t=this;this.logger.trace("BrowserCacheManager.resetRequestCache called"),cF.isEmpty(e)||this.getKeys().forEach((function(r){-1!==r.indexOf(e)&&t.removeItem(r)})),e&&(this.removeItem(this.generateStateKey(e)),this.removeItem(this.generateNonceKey(e)),this.removeItem(this.generateAuthorityKey(e))),this.removeItem(this.generateCacheKey(gB.REQUEST_PARAMS)),this.removeItem(this.generateCacheKey(gB.ORIGIN_URI)),this.removeItem(this.generateCacheKey(gB.URL_HASH)),this.removeItem(this.generateCacheKey(gB.CORRELATION_ID)),this.removeItem(this.generateCacheKey(gB.CCS_CREDENTIAL)),this.removeItem(this.generateCacheKey(gB.NATIVE_REQUEST)),this.setInteractionInProgress(!1)},t.prototype.cleanRequestByState=function(e){this.logger.trace("BrowserCacheManager.cleanRequestByState called"),e&&(e=this.generateStateKey(e),e=this.temporaryCacheStorage.getItem(e),this.logger.infoPii("BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: "+e),this.resetRequestCache(e||ez.EMPTY_STRING)),this.clearMsalCookies()},t.prototype.cleanRequestByInteractionType=function(e){var t=this;this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.getKeys().forEach((function(r){var n;-1!==r.indexOf(gB.REQUEST_STATE)&&(r=t.temporaryCacheStorage.getItem(r))&&(n=$U.extractBrowserRequestState(t.cryptoImpl,r))&&n.interactionType===e&&(t.logger.infoPii("BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: "+r),t.resetRequestCache(r))})),this.clearMsalCookies(),this.setInteractionInProgress(!1)},t.prototype.cacheCodeRequest=function(e,t){this.logger.trace("BrowserCacheManager.cacheCodeRequest called"),t=t.base64Encode(JSON.stringify(e)),this.setTemporaryCache(gB.REQUEST_PARAMS,t,!0)},t.prototype.getCachedRequest=function(e,t){this.logger.trace("BrowserCacheManager.getCachedRequest called");var r=this.getTemporaryCache(gB.REQUEST_PARAMS,!0);if(!r)throw MU.createNoTokenRequestCacheError();if(!(t=this.validateAndParseJson(t.base64Decode(r))))throw MU.createUnableToParseTokenRequestCacheError();if(this.removeItem(this.generateCacheKey(gB.REQUEST_PARAMS)),cF.isEmpty(t.authority)){if(r=this.generateAuthorityKey(e),!(e=this.getTemporaryCache(r)))throw MU.createNoCachedAuthorityError();t.authority=e}return t},t.prototype.getCachedNativeRequest=function(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");var e=this.getTemporaryCache(gB.NATIVE_REQUEST,!0);return e?this.validateAndParseJson(e)||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null):(this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null)},t.prototype.isInteractionInProgress=function(e){var t=this.getInteractionInProgress();return e?t===this.clientId:!!t},t.prototype.getInteractionInProgress=function(){var e=ez.CACHE_PREFIX+"."+gB.INTERACTION_STATUS_KEY;return this.getTemporaryCache(e,!1)},t.prototype.setInteractionInProgress=function(e){var t=ez.CACHE_PREFIX+"."+gB.INTERACTION_STATUS_KEY;if(e){if(this.getInteractionInProgress())throw MU.createInteractionInProgressError();this.setTemporaryCache(t,this.clientId,!1)}else this.getInteractionInProgress()===this.clientId&&this.removeItem(t)},t.prototype.getLegacyLoginHint=function(){var e,t=this.getTemporaryCache(RN.ADAL_ID_TOKEN);if(e=((e=(t&&(this.browserStorage.removeItem(RN.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved.")),this.getTemporaryCache(RN.ID_TOKEN,!0)))&&(this.removeItem(this.generateCacheKey(RN.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved")),e||t)){if((t=new _F(e,this.cryptoImpl)).claims&&t.claims.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),t.claims.preferred_username;if(t.claims&&t.claims.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),t.claims.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null},t.prototype.updateCredentialCacheKey=function(e,t){var r=t.generateCredentialKey();if(e!==r){var n=this.getItem(e);if(n)return this.removeItem(e),this.setItem(r,n),this.logger.verbose("Updated an outdated "+t.credentialType+" cache key"),r;this.logger.error("Attempted to update an outdated "+t.credentialType+" cache key but no item matching the outdated key was found in storage")}return e},t.prototype.getRedirectRequestContext=function(){return this.getTemporaryCache(gB.REDIRECT_CONTEXT,!0)},t.prototype.setRedirectRequestContext=function(e){this.setTemporaryCache(gB.REDIRECT_CONTEXT,e,!0)},t}(bF),XU="@azure/msal-browser",QU="2.38.3",JU=function(){function e(){}return e.prototype.sendGetRequestAsync=function(e,t){return wN(this,void 0,void 0,(function(){var r,n,i;return xN(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,fetch(e,{method:mB.GET,headers:this.getFetchHeaders(t)})];case 1:return r=o.sent(),[3,3];case 2:throw n=o.sent(),window.navigator.onLine?MU.createGetRequestFailedError(n,e):MU.createNoNetworkConnectivityError();case 3:return o.trys.push([3,5,,6]),i={headers:this.getHeaderDict(r.headers)},[4,r.json()];case 4:return[2,(i.body=o.sent(),i.status=r.status,i)];case 5:throw o.sent(),MU.createFailedToParseNetworkResponseError(e);case 6:return[2]}}))}))},e.prototype.sendPostRequestAsync=function(e,t){return wN(this,void 0,void 0,(function(){var r,n,i,o;return xN(this,(function(a){switch(a.label){case 0:r=t&&t.body||ez.EMPTY_STRING,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,fetch(e,{method:mB.POST,headers:this.getFetchHeaders(t),body:r})];case 2:return n=a.sent(),[3,4];case 3:throw i=a.sent(),window.navigator.onLine?MU.createPostRequestFailedError(i,e):MU.createNoNetworkConnectivityError();case 4:return a.trys.push([4,6,,7]),o={headers:this.getHeaderDict(n.headers)},[4,n.json()];case 5:return[2,(o.body=a.sent(),o.status=n.status,o)];case 6:throw a.sent(),MU.createFailedToParseNetworkResponseError(e);case 7:return[2]}}))}))},e.prototype.getFetchHeaders=function(e){var t,r=new Headers;return e&&e.headers&&(t=e.headers,Object.keys(t).forEach((function(e){r.append(e,t[e])}))),r},e.prototype.getHeaderDict=function(e){var t={};return e.forEach((function(e,r){t[r]=e})),t},e}(),ej=function(){function e(){}return e.prototype.sendGetRequestAsync=function(e,t){return wN(this,void 0,void 0,(function(){return xN(this,(function(r){return[2,this.sendRequestAsync(e,mB.GET,t)]}))}))},e.prototype.sendPostRequestAsync=function(e,t){return wN(this,void 0,void 0,(function(){return xN(this,(function(r){return[2,this.sendRequestAsync(e,mB.POST,t)]}))}))},e.prototype.sendRequestAsync=function(e,t,r){var n=this;return new Promise((function(i,o){var a=new XMLHttpRequest;if(a.open(t,e,!0),n.setXhrHeaders(a,r),a.onload=function(){(a.status<200||300<=a.status)&&(t===mB.POST?o(MU.createPostRequestFailedError("Failed with status "+a.status,e)):o(MU.createGetRequestFailedError("Failed with status "+a.status,e)));try{var r=JSON.parse(a.responseText),s={headers:n.getHeaderDict(a),body:r,status:a.status};i(s)}catch(r){o(MU.createFailedToParseNetworkResponseError(e))}},a.onerror=function(){window.navigator.onLine?t===mB.POST?o(MU.createPostRequestFailedError("Failed with status "+a.status,e)):o(MU.createGetRequestFailedError("Failed with status "+a.status,e)):o(MU.createNoNetworkConnectivityError())},t===mB.POST&&r&&r.body)a.send(r.body);else{if(t!==mB.GET)throw MU.createHttpMethodNotImplementedError(t);a.send()}}))},e.prototype.setXhrHeaders=function(e,t){var r;t&&t.headers&&(r=t.headers,Object.keys(r).forEach((function(t){e.setRequestHeader(t,r[t])})))},e.prototype.getHeaderDict=function(e){e=e.getAllResponseHeaders().trim().split(/[\r\n]+/);var t={};return e.forEach((function(e){var r=(e=e.split(": ")).shift();e=e.join(": ");r&&e&&(t[r]=e)})),t},e}(),tj=function(){function e(){}return e.clearHash=function(e){e.location.hash=ez.EMPTY_STRING,"function"==typeof e.history.replaceState&&e.history.replaceState(null,ez.EMPTY_STRING,""+e.location.origin+e.location.pathname+e.location.search)},e.replaceHash=function(e){(e=e.split("#")).shift(),window.location.hash=0<e.length?e.join("#"):ez.EMPTY_STRING},e.isInIframe=function(){return window.parent!==window},e.isInPopup=function(){return"undefined"!=typeof window&&!!window.opener&&window.opener!==window&&"string"==typeof window.name&&0===window.name.indexOf(DU+".")},e.getCurrentUri=function(){return window.location.href.split("?")[0].split("#")[0]},e.getHomepage=function(){var e=new JF(window.location.href).getUrlComponents();return e.Protocol+"//"+e.HostNameAndPort+"/"},e.getBrowserNetworkClient=function(){return new(window.fetch&&window.Headers?JU:ej)},e.blockReloadInHiddenIframes=function(){if(JF.hashContainsKnownProperties(window.location.hash)&&e.isInIframe())throw MU.createBlockReloadInHiddenIframeError()},e.blockRedirectInIframe=function(t,r){var n=e.isInIframe();if(t===bB.Redirect&&n&&!r)throw MU.createRedirectInIframeError(n)},e.blockAcquireTokenInPopups=function(){if(e.isInPopup())throw MU.createBlockAcquireTokenInPopupsError()},e.blockNonBrowserEnvironment=function(e){if(!e)throw MU.createNonBrowserEnvironmentError()},e.blockNativeBrokerCalledBeforeInitialized=function(e,t){if(e&&!t)throw MU.createNativeBrokerCalledBeforeInitialize()},e.detectIEOrEdge=function(){var e=(r=window.navigator.userAgent).indexOf("MSIE "),t=r.indexOf("Trident/"),r=r.indexOf("Edge/");return 0<e||0<t||0<r},e}(),rj=function(){function e(e,t,r,n,i,o,a,s,l){this.config=e,this.browserStorage=t,this.browserCrypto=r,this.networkClient=this.config.system.networkClient,this.eventHandler=i,this.navigationClient=o,this.nativeMessageHandler=s,this.correlationId=l||this.browserCrypto.createNewGuid(),this.logger=n.clone(zU,QU,this.correlationId),this.performanceClient=a}return e.prototype.clearCacheOnLogout=function(e){return wN(this,void 0,void 0,(function(){return xN(this,(function(t){switch(t.label){case 0:if(!e)return[3,5];vF.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null)),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.browserStorage.removeAccount(vF.generateAccountCacheKey(e))];case 2:return t.sent(),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request."),[3,4];case 3:return t.sent(),this.logger.error("Account provided in logout request was not found. Local cache unchanged."),[3,4];case 4:return[3,9];case 5:return t.trys.push([5,8,,9]),this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),[4,this.browserStorage.clear()];case 6:return t.sent(),[4,this.browserCrypto.clearKeystore()];case 7:return t.sent(),[3,9];case 8:return t.sent(),this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged."),[3,9];case 9:return[2]}}))}))},e.prototype.initializeBaseRequest=function(e,t){return wN(this,void 0,void 0,(function(){var r,n,i;return xN(this,(function(o){switch(o.label){case 0:return this.performanceClient.addQueueMeasurement(RF.InitializeBaseRequest,e.correlationId),this.logger.verbose("Initializing BaseAuthRequest"),r=e.authority||this.config.auth.authority,t?[4,this.validateRequestAuthority(r,t)]:[3,2];case 1:o.sent(),o.label=2;case 2:if(n=SN(e&&e.scopes||[]),(n=_N(_N({},e),{correlationId:this.correlationId,authority:r,scopes:n})).authenticationScheme){if(n.authenticationScheme===VN.SSH){if(!e.sshJwk)throw fF.createMissingSshJwkError();if(!e.sshKid)throw fF.createMissingSshKidError()}this.logger.verbose('Authentication Scheme set to "'+n.authenticationScheme+'" as configured in Auth request')}else n.authenticationScheme=VN.BEARER,this.logger.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request');return this.config.cache.claimsBasedCachingEnabled&&e.claims&&!cF.isEmptyObj(e.claims)?(i=n,[4,this.browserCrypto.hashString(e.claims)]):[3,4];case 3:i.requestedClaimsHash=o.sent(),o.label=4;case 4:return[2,n]}}))}))},e.prototype.getRedirectUri=function(e){return this.logger.verbose("getRedirectUri called"),e=e||this.config.auth.redirectUri||tj.getCurrentUri(),JF.getAbsoluteUrl(e,tj.getCurrentUri())},e.prototype.validateRequestAuthority=function(e,t){return wN(this,void 0,void 0,(function(){return xN(this,(function(r){switch(r.label){case 0:return[4,this.getDiscoveredAuthority(e)];case 1:if(r.sent().isAlias(t.environment))return[2];throw fF.createAuthorityMismatchError()}}))}))},e.prototype.initializeServerTelemetryManager=function(e,t){return this.logger.verbose("initializeServerTelemetryManager called"),e={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]},new NB(e,this.browserStorage)},e.prototype.getDiscoveredAuthority=function(e){return wN(this,void 0,void 0,(function(){var t;return xN(this,(function(r){switch(r.label){case 0:return this.logger.verbose("getDiscoveredAuthority called"),t={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata},e?(this.logger.verbose("Creating discovered authority with request authority"),[4,kB.createDiscoveredInstance(e,this.config.system.networkClient,this.browserStorage,t,this.logger)]):[3,2];case 1:case 3:return[2,r.sent()];case 2:return this.logger.verbose("Creating discovered authority with configured authority"),[4,kB.createDiscoveredInstance(this.config.auth.authority,this.config.system.networkClient,this.browserStorage,t,this.logger)]}}))}))},e}(),nj=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return vN(t,e),t.prototype.initializeAuthorizationCodeRequest=function(e){return wN(this,void 0,void 0,(function(){var t,r;return xN(this,(function(n){switch(n.label){case 0:return this.performanceClient.addQueueMeasurement(RF.StandardInteractionClientInitializeAuthorizationCodeRequest,e.correlationId),this.logger.verbose("initializeAuthorizationRequest called",e.correlationId),[4,this.browserCrypto.generatePkceCodes()];case 1:return t=n.sent(),r=_N(_N({},e),{redirectUri:e.redirectUri,code:ez.EMPTY_STRING,codeVerifier:t.verifier}),e.codeChallenge=t.challenge,e.codeChallengeMethod=ez.S256_CODE_CHALLENGE_METHOD,[2,r]}}))}))},t.prototype.initializeLogoutRequest=function(e){this.logger.verbose("initializeLogoutRequest called",null==e?void 0:e.correlationId);var t,r=_N({correlationId:this.correlationId||this.browserCrypto.createNewGuid()},e);return e?e.logoutHint?this.logger.verbose("logoutHint has already been set in logoutRequest"):e.account?(t=this.getLogoutHintFromIdTokenClaims(e.account))&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),r.logoutHint=t):this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set"):this.logger.verbose("logoutHint will not be set since no logout request was configured"),e&&null===e.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",r.correlationId):e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",r.correlationId),r.postLogoutRedirectUri=JF.getAbsoluteUrl(e.postLogoutRedirectUri,tj.getCurrentUri())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",r.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",r.correlationId),r.postLogoutRedirectUri=JF.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,tj.getCurrentUri())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",r.correlationId),r.postLogoutRedirectUri=JF.getAbsoluteUrl(tj.getCurrentUri(),tj.getCurrentUri())),r},t.prototype.getLogoutHintFromIdTokenClaims=function(e){if(e=e.idTokenClaims){if(e.login_hint)return e.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null},t.prototype.createAuthCodeClient=function(e,t,r){return wN(this,void 0,void 0,(function(){var n;return xN(this,(function(i){switch(i.label){case 0:return this.performanceClient.addQueueMeasurement(RF.StandardInteractionClientCreateAuthCodeClient,this.correlationId),this.performanceClient.setPreQueueTime(RF.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(e,t,r)];case 1:return n=i.sent(),[2,new oB(n,this.performanceClient)]}}))}))},t.prototype.getClientConfiguration=function(e,t,r){return wN(this,void 0,void 0,(function(){var n,i;return xN(this,(function(o){switch(o.label){case 0:return this.performanceClient.addQueueMeasurement(RF.StandardInteractionClientGetClientConfiguration,this.correlationId),this.logger.verbose("getClientConfiguration called",this.correlationId),this.performanceClient.setPreQueueTime(RF.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),[4,this.getDiscoveredAuthority(t,r)];case 1:return n=o.sent(),i=this.config.system.loggerOptions,[2,{authOptions:{clientId:this.config.auth.clientId,authority:n,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:i.loggerCallback,piiLoggingEnabled:i.piiLoggingEnabled,logLevel:i.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:e,libraryInfo:{sku:zU,version:QU,cpu:ez.EMPTY_STRING,os:ez.EMPTY_STRING},telemetry:this.config.telemetry}]}}))}))},t.prototype.validateAndExtractStateFromHash=function(e,t,r){if(this.logger.verbose("validateAndExtractStateFromHash called",r),!e.state)throw MU.createHashDoesNotContainStateError();var n=$U.extractBrowserRequestState(this.browserCrypto,e.state);if(!n)throw MU.createUnableToParseStateError();if(n.interactionType!==t)throw MU.createStateInteractionTypeMismatchError();return this.logger.verbose("Returning state from hash",r),e.state},t.prototype.getDiscoveredAuthority=function(e,t){var r;return wN(this,void 0,void 0,(function(){var n,i,o;return xN(this,(function(a){switch(a.label){case 0:return this.performanceClient.addQueueMeasurement(RF.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),this.logger.verbose("getDiscoveredAuthority called",this.correlationId),n=null==(r=this.performanceClient)?void 0:r.startMeasurement(RF.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),i={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},o=e||this.config.auth.authority,o=IB.generateAuthority(o,t||this.config.auth.azureCloudOptions),this.logger.verbose("Creating discovered authority with configured authority",this.correlationId),this.performanceClient.setPreQueueTime(RF.AuthorityFactoryCreateDiscoveredInstance,this.correlationId),[4,kB.createDiscoveredInstance(o,this.config.system.networkClient,this.browserStorage,i,this.logger,this.performanceClient,this.correlationId).then((function(e){return n.endMeasurement({success:!0}),e})).catch((function(e){throw n.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e}))];case 1:return[2,a.sent()]}}))}))},t.prototype.initializeAuthorizationRequest=function(e,t){return wN(this,void 0,void 0,(function(){var r,n,i,o,a;return xN(this,(function(s){switch(s.label){case 0:return this.performanceClient.addQueueMeasurement(RF.StandardInteractionClientInitializeAuthorizationRequest,this.correlationId),this.logger.verbose("initializeAuthorizationRequest called",this.correlationId),r=this.getRedirectUri(e.redirectUri),n={interactionType:t},n=QF.setRequestState(this.browserCrypto,e&&e.state||ez.EMPTY_STRING,n),this.performanceClient.setPreQueueTime(RF.InitializeBaseRequest,this.correlationId),o=[{}],[4,this.initializeBaseRequest(e)];case 1:return i=_N.apply(void 0,[_N.apply(void 0,o.concat([s.sent()])),{redirectUri:r,state:n,nonce:e.nonce||this.browserCrypto.createNewGuid(),responseMode:zN.FRAGMENT}]),(a=e.account||this.browserStorage.getActiveAccount())&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii("Setting validated request account: "+a.homeAccountId,this.correlationId),i.account=a),cF.isEmpty(i.loginHint)&&!a&&(a=this.browserStorage.getLegacyLoginHint())&&(i.loginHint=a),[2,i]}}))}))},t}(rj),ij=function(){function e(e,t,r,n,i){this.authModule=e,this.browserStorage=t,this.authCodeRequest=r,this.logger=n,this.performanceClient=i}return e.prototype.handleCodeResponseFromHash=function(e,t,r,n){return wN(this,void 0,void 0,(function(){var i,o;return xN(this,(function(a){if(this.performanceClient.addQueueMeasurement(RF.HandleCodeResponseFromHash,this.authCodeRequest.correlationId),this.logger.verbose("InteractionHandler.handleCodeResponse called"),cF.isEmpty(e))throw MU.createEmptyHashError(e);if(i=this.browserStorage.generateStateKey(t),!(i=this.browserStorage.getTemporaryCache(i)))throw lF.createStateNotFoundError("Cached State");try{o=this.authModule.handleFragmentResponse(e,i)}catch(a){throw a instanceof DF&&a.subError===QB.code?MU.createUserCancelledError():a}return this.performanceClient.setPreQueueTime(RF.HandleCodeResponseFromServer,this.authCodeRequest.correlationId),[2,this.handleCodeResponseFromServer(o,t,r,n)]}))}))},e.prototype.handleCodeResponseFromServer=function(e,t,r,n,i){return void 0===i&&(i=!0),wN(this,void 0,void 0,(function(){var o,a,s;return xN(this,(function(l){switch(l.label){case 0:if(this.performanceClient.addQueueMeasurement(RF.HandleCodeResponseFromServer,this.authCodeRequest.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),o=this.browserStorage.generateStateKey(t),o=this.browserStorage.getTemporaryCache(o))return a=this.browserStorage.generateNonceKey(o),a=this.browserStorage.getTemporaryCache(a),this.authCodeRequest.code=e.code,e.cloud_instance_host_name?(this.performanceClient.setPreQueueTime(RF.UpdateTokenEndpointAuthority,this.authCodeRequest.correlationId),[4,this.updateTokenEndpointAuthority(e.cloud_instance_host_name,r,n)]):[3,2];throw lF.createStateNotFoundError("Cached State");case 1:l.sent(),l.label=2;case 2:return i&&(e.nonce=a||void 0),e.state=o,e.client_info?this.authCodeRequest.clientInfo=e.client_info:(s=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=s),this.performanceClient.setPreQueueTime(RF.AuthClientAcquireToken,this.authCodeRequest.correlationId),[4,this.authModule.acquireToken(this.authCodeRequest,e)];case 3:return s=l.sent(),this.browserStorage.cleanRequestByState(t),[2,s]}}))}))},e.prototype.updateTokenEndpointAuthority=function(e,t,r){return wN(this,void 0,void 0,(function(){var n;return xN(this,(function(i){switch(i.label){case 0:return this.performanceClient.addQueueMeasurement(RF.UpdateTokenEndpointAuthority,this.authCodeRequest.correlationId),n="https://"+e+"/"+t.tenant+"/",[4,kB.createDiscoveredInstance(n,r,this.browserStorage,t.options,this.logger,this.performanceClient,this.authCodeRequest.correlationId)];case 1:return n=i.sent(),this.authModule.updateAuthority(n),[2]}}))}))},e.prototype.checkCcsCredentials=function(){var t=this.browserStorage.getTemporaryCache(gB.CCS_CREDENTIAL,!0);if(t)try{return JSON.parse(t)}catch(e){this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii("Cache credential could not be parsed: "+t)}return null},e}(),oj=function(e){function t(t,r,n,i,o,a){return(t=e.call(this,t,r,n,i,a)||this).browserCrypto=o,t}return vN(t,e),t.prototype.initiateAuthRequest=function(e,t){return wN(this,void 0,void 0,(function(){var r;return xN(this,(function(n){switch(n.label){case 0:return this.logger.verbose("RedirectHandler.initiateAuthRequest called"),cF.isEmpty(e)?[3,7]:(t.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(gB.ORIGIN_URI,t.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(gB.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest,this.browserCrypto),this.logger.infoPii("RedirectHandler.initiateAuthRequest: Navigate to: "+e),r={apiId:_B.acquireTokenRedirect,timeout:t.redirectTimeout,noHistory:!1},"function"!=typeof t.onRedirectNavigate?[3,4]:(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),!1===t.onRedirectNavigate(e)?[3,2]:(this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),[4,t.navigationClient.navigateExternal(e,r)])));case 1:case 5:return n.sent(),[2];case 2:return this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation"),[2];case 3:return[3,6];case 4:return this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),[4,t.navigationClient.navigateExternal(e,r)];case 6:return[3,8];case 7:throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),MU.createEmptyNavigationUriError();case 8:return[2]}}))}))},t.prototype.handleCodeResponseFromHash=function(e,t,r,n){return wN(this,void 0,void 0,(function(){var i,o,a,s;return xN(this,(function(l){switch(l.label){case 0:if(this.logger.verbose("RedirectHandler.handleCodeResponse called"),cF.isEmpty(e))throw MU.createEmptyHashError(e);if(this.browserStorage.setInteractionInProgress(!1),i=this.browserStorage.generateStateKey(t),!(i=this.browserStorage.getTemporaryCache(i)))throw lF.createStateNotFoundError("Cached State");try{o=this.authModule.handleFragmentResponse(e,i)}catch(l){throw l instanceof DF&&l.subError===QB.code?MU.createUserCancelledError():l}return a=this.browserStorage.generateNonceKey(i),a=this.browserStorage.getTemporaryCache(a),this.authCodeRequest.code=o.code,o.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(o.cloud_instance_host_name,r,n)]:[3,2];case 1:l.sent(),l.label=2;case 2:return o.nonce=a||void 0,o.state=i,o.client_info?this.authCodeRequest.clientInfo=o.client_info:(s=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=s),[4,this.authModule.acquireToken(this.authCodeRequest,o)];case 3:return s=l.sent(),this.browserStorage.cleanRequestByState(t),[2,s]}}))}))},t}(ij),aj=(function(e){e.INITIALIZE_START="msal:initializeStart",e.INITIALIZE_END="msal:initializeEnd",e.ACCOUNT_ADDED="msal:accountAdded",e.ACCOUNT_REMOVED="msal:accountRemoved",e.LOGIN_START="msal:loginStart",e.LOGIN_SUCCESS="msal:loginSuccess",e.LOGIN_FAILURE="msal:loginFailure",e.ACQUIRE_TOKEN_START="msal:acquireTokenStart",e.ACQUIRE_TOKEN_SUCCESS="msal:acquireTokenSuccess",e.ACQUIRE_TOKEN_FAILURE="msal:acquireTokenFailure",e.ACQUIRE_TOKEN_NETWORK_START="msal:acquireTokenFromNetworkStart",e.SSO_SILENT_START="msal:ssoSilentStart",e.SSO_SILENT_SUCCESS="msal:ssoSilentSuccess",e.SSO_SILENT_FAILURE="msal:ssoSilentFailure",e.ACQUIRE_TOKEN_BY_CODE_START="msal:acquireTokenByCodeStart",e.ACQUIRE_TOKEN_BY_CODE_SUCCESS="msal:acquireTokenByCodeSuccess",e.ACQUIRE_TOKEN_BY_CODE_FAILURE="msal:acquireTokenByCodeFailure",e.HANDLE_REDIRECT_START="msal:handleRedirectStart",e.HANDLE_REDIRECT_END="msal:handleRedirectEnd",e.POPUP_OPENED="msal:popupOpened",e.LOGOUT_START="msal:logoutStart",e.LOGOUT_SUCCESS="msal:logoutSuccess",e.LOGOUT_FAILURE="msal:logoutFailure",e.LOGOUT_END="msal:logoutEnd",e.RESTORE_FROM_BFCACHE="msal:restoreFromBFCache"}(SB=SB||{}),function(e){e.USER_INTERACTION_REQUIRED="USER_INTERACTION_REQUIRED",e.USER_CANCEL="USER_CANCEL",e.NO_NETWORK="NO_NETWORK",e.TRANSIENT_ERROR="TRANSIENT_ERROR",e.PERSISTENT_ERROR="PERSISTENT_ERROR",e.DISABLED="DISABLED",e.ACCOUNT_UNAVAILABLE="ACCOUNT_UNAVAILABLE"}(EB=EB||{}),{extensionError:{code:"ContentError"},userSwitch:{code:"user_switch",desc:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."},tokensNotFoundInCache:{code:"tokens_not_found_in_internal_memory_cache",desc:"Tokens not cached in MSAL JS internal memory, please make the WAM request"}}),sj=function(e){function t(r,n,i){return r=e.call(this,r,n)||this,Object.setPrototypeOf(r,t.prototype),r.name="NativeAuthError",r.ext=i,r}return vN(t,e),t.prototype.isFatal=function(){return!(!this.ext||!this.ext.status||this.ext.status!==EB.PERSISTENT_ERROR&&this.ext.status!==EB.DISABLED)||this.errorCode===aj.extensionError.code},t.createError=function(e,r,n){if(n&&n.status)switch(n.status){case EB.ACCOUNT_UNAVAILABLE:return YF.createNativeAccountUnavailableError();case EB.USER_INTERACTION_REQUIRED:return new YF(e,r);case EB.USER_CANCEL:return MU.createUserCancelledError();case EB.NO_NETWORK:return MU.createNoNetworkConnectivityError()}return new t(e,r,n)},t.createUserSwitchError=function(){return new t(aj.userSwitch.code,aj.userSwitch.desc)},t.createTokensNotFoundInCacheError=function(){return new t(aj.tokensNotFoundInCache.code,aj.tokensNotFoundInCache.desc)},t}(fz),lj=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return vN(t,e),t.prototype.acquireToken=function(e){return wN(this,void 0,void 0,(function(){var t,r,n,i;return xN(this,(function(o){switch(o.label){case 0:return t=this.performanceClient.startMeasurement(RF.SilentCacheClientAcquireToken,e.correlationId),n=this.initializeServerTelemetryManager(_B.acquireTokenSilent_silentFlow),[4,this.createSilentFlowClient(n,e.authority,e.azureCloudOptions)];case 1:r=o.sent(),this.logger.verbose("Silent auth client created"),o.label=2;case 2:return o.trys.push([2,4,,5]),[4,r.acquireCachedToken(e)];case 3:return n=o.sent(),t.endMeasurement({success:!0,fromCache:!0}),[2,n];case 4:throw(i=o.sent())instanceof MU&&i.errorCode===bU.code&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),t.endMeasurement({errorCode:i instanceof fz&&i.errorCode||void 0,subErrorCode:i instanceof fz&&i.subError||void 0,success:!1}),i;case 5:return[2]}}))}))},t.prototype.logout=function(){return Promise.reject(MU.createSilentLogoutUnsupportedError())},t.prototype.createSilentFlowClient=function(e,t,r){return wN(this,void 0,void 0,(function(){var n;return xN(this,(function(i){switch(i.label){case 0:return this.performanceClient.setPreQueueTime(RF.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(e,t,r)];case 1:return n=i.sent(),[2,new sB(n,this.performanceClient)]}}))}))},t.prototype.initializeSilentRequest=function(e,t){return wN(this,void 0,void 0,(function(){var r;return xN(this,(function(n){switch(n.label){case 0:return this.performanceClient.addQueueMeasurement(RF.InitializeSilentRequest,this.correlationId),this.performanceClient.setPreQueueTime(RF.InitializeBaseRequest,this.correlationId),r=[_N({},e)],[4,this.initializeBaseRequest(e,t)];case 1:return[2,_N.apply(void 0,[_N.apply(void 0,r.concat([n.sent()])),{account:t,forceRefresh:e.forceRefresh||!1}])]}}))}))},t}(nj),cj=function(e){function t(t,r,n,i,o,a,s,l,c,u,h,d){return(r=e.call(this,t,r,n,i,o,a,l,c,d)||this).apiId=s,r.accountId=u,r.nativeMessageHandler=c,r.nativeStorageManager=h,r.silentCacheClient=new lj(t,r.nativeStorageManager,n,i,o,a,l,c,d),r}return vN(t,e),t.prototype.acquireToken=function(e){return wN(this,void 0,void 0,(function(){var t,r,n,i,o;return xN(this,(function(a){switch(a.label){case 0:return this.logger.trace("NativeInteractionClient - acquireToken called."),t=this.performanceClient.startMeasurement(RF.NativeInteractionClientAcquireToken,e.correlationId),r=HF.nowSeconds(),[4,this.initializeNativeRequest(e)];case 1:n=a.sent(),a.label=2;case 2:return a.trys.push([2,4,,5]),[4,this.acquireTokensFromCache(this.accountId,n)];case 3:return i=a.sent(),t.endMeasurement({success:!0,isNativeBroker:!1,fromCache:!0}),[2,i];case 4:return a.sent(),this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call"),[3,5];case 5:return i={method:pB.GetToken,request:n},[4,this.nativeMessageHandler.sendMessage(i)];case 6:return o=a.sent(),o=this.validateNativeResponse(o),[2,this.handleNativeResponse(o,n,r).then((function(e){return t.endMeasurement({success:!0,isNativeBroker:!0,requestId:e.requestId}),e})).catch((function(e){throw t.endMeasurement({success:!1,errorCode:e.errorCode,subErrorCode:e.subError,isNativeBroker:!0}),e}))]}}))}))},t.prototype.createSilentCacheRequest=function(e,t){return{authority:e.authority,correlationId:this.correlationId,scopes:mF.fromString(e.scope).asArray(),account:t,forceRefresh:!1}},t.prototype.acquireTokensFromCache=function(e,t){return wN(this,void 0,void 0,(function(){var r,n;return xN(this,(function(i){switch(i.label){case 0:if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),lF.createNoAccountFoundError();if(!(r=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:e})))throw lF.createNoAccountFoundError();i.label=1;case 1:return i.trys.push([1,3,,4]),n=this.createSilentCacheRequest(t,r),[4,this.silentCacheClient.acquireToken(n)];case 2:return[2,i.sent()];case 3:throw i.sent();case 4:return[2]}}))}))},t.prototype.acquireTokenRedirect=function(e){return wN(this,void 0,void 0,(function(){var t,r,n,i,o;return xN(this,(function(a){switch(a.label){case 0:return this.logger.trace("NativeInteractionClient - acquireTokenRedirect called."),[4,this.initializeNativeRequest(e)];case 1:t=a.sent(),r={method:pB.GetToken,request:t},a.label=2;case 2:return a.trys.push([2,4,,5]),[4,this.nativeMessageHandler.sendMessage(r)];case 3:return n=a.sent(),this.validateNativeResponse(n),[3,5];case 4:if((n=a.sent())instanceof sj&&n.isFatal())throw n;return[3,5];case 5:return this.browserStorage.setTemporaryCache(gB.NATIVE_REQUEST,JSON.stringify(t),!0),i={apiId:_B.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},o=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri),[4,this.navigationClient.navigateExternal(o,i)];case 6:return a.sent(),[2]}}))}))},t.prototype.handleRedirectPromise=function(){return wN(this,void 0,void 0,(function(){var e,t,r,n;return xN(this,(function(i){switch(i.label){case 0:if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(!(e=this.browserStorage.getCachedNativeRequest()))return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),[2,null];t=e.prompt,e=bN(e,["prompt"]),t&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(gB.NATIVE_REQUEST)),t={method:pB.GetToken,request:e},r=HF.nowSeconds(),i.label=1;case 1:return i.trys.push([1,3,,4]),this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker."),[4,this.nativeMessageHandler.sendMessage(t)];case 2:return n=i.sent(),this.validateNativeResponse(n),n=this.handleNativeResponse(n,e,r),this.browserStorage.setInteractionInProgress(!1),[2,n];case 3:throw n=i.sent(),this.browserStorage.setInteractionInProgress(!1),n;case 4:return[2]}}))}))},t.prototype.logout=function(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")},t.prototype.handleNativeResponse=function(e,t,r){return wN(this,void 0,void 0,(function(){var n,i,o,a;return xN(this,(function(s){switch(s.label){case 0:if(this.logger.trace("NativeInteractionClient - handleNativeResponse called."),e.account.id!==t.accountId)throw sj.createUserSwitchError();return[4,this.getDiscoveredAuthority(t.authority)];case 1:return a=s.sent(),o=a.getPreferredCache(),n=this.createIdTokenObj(e),i=this.createHomeAccountIdentifier(e,n),o=this.createAccountEntity(e,i,n,o),[4,this.generateAuthenticationResult(e,t,n,o,a.canonicalAuthority,r)];case 2:return a=s.sent(),this.cacheAccount(o),this.cacheNativeTokens(e,t,i,o,n,a.accessToken,a.tenantId,r),[2,a]}}))}))},t.prototype.createIdTokenObj=function(e){return new _F(e.id_token||ez.EMPTY_STRING,this.browserCrypto)},t.prototype.createHomeAccountIdentifier=function(e,t){return vF.generateHomeAccountId(e.client_info||ez.EMPTY_STRING,JN.Default,this.logger,this.browserCrypto,t)},t.prototype.createAccountEntity=function(e,t,r,n){return vF.createAccount(e.client_info,t,r,void 0,void 0,void 0,n,e.account.id)},t.prototype.generateScopes=function(e,t){return e.scope?mF.fromString(e.scope):mF.fromString(t.scope)},t.prototype.generatePopAccessToken=function(e,t){return wN(this,void 0,void 0,(function(){var r,n;return xN(this,(function(i){switch(i.label){case 0:if(t.tokenType!==VN.POP)return[3,2];if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),[2,e.shr];if(r=new tB(this.browserCrypto),n={resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,shrNonce:t.shrNonce},t.keyId)return[4,r.signPopToken(e.access_token,t.keyId,n)];throw lF.createKeyIdMissingError();case 1:return[2,i.sent()];case 2:return[2,e.access_token]}}))}))},t.prototype.generateAuthenticationResult=function(e,t,r,n,i,o){return wN(this,void 0,void 0,(function(){var a,s,l,c,u,h;return xN(this,(function(d){switch(d.label){case 0:return a=this.addTelemetryFromNativeResponse(e),s=e.scope?mF.fromString(e.scope):mF.fromString(t.scope),c=e.account.properties||{},l=c.UID||r.claims.oid||r.claims.sub||ez.EMPTY_STRING,c=c.TenantId||r.claims.tid||ez.EMPTY_STRING,[4,this.generatePopAccessToken(e,t)];case 1:return u=d.sent(),h=t.tokenType===VN.POP?VN.POP:VN.BEARER,[2,{authority:i,uniqueId:l,tenantId:c,scopes:s.asArray(),account:n.getAccountInfo(),idToken:e.id_token,idTokenClaims:r.claims,accessToken:u,fromCache:!!a&&this.isResponseFromCache(a),expiresOn:new Date(1e3*Number(o+e.expires_in)),tokenType:h,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}]}}))}))},t.prototype.cacheAccount=function(e){var t=this;this.browserStorage.setAccount(e),this.browserStorage.removeAccountContext(e).catch((function(e){t.logger.error("Error occurred while removing account context from browser storage. "+e)}))},t.prototype.cacheNativeTokens=function(e,t,r,n,i,o,a,s){var l=qF.createIdTokenEntity(r,t.authority,e.id_token||ez.EMPTY_STRING,t.clientId,i.claims.tid||ez.EMPTY_STRING);s+=t.tokenType===VN.POP?ez.SHR_NONCE_VALIDITY:("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,e=this.generateScopes(e,t),r=VF.createAccessTokenEntity(r,t.authority,o,t.clientId,i?i.claims.tid||ez.EMPTY_STRING:a,e.printScopes(),s,0,this.browserCrypto),o=new XF(n,l,r);this.nativeStorageManager.saveCacheRecord(o)},t.prototype.addTelemetryFromNativeResponse=function(e){return(e=this.getMATSFromResponse(e))?(this.performanceClient.addStaticFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:e.broker_version,matsAccountJoinOnStart:e.account_join_on_start,matsAccountJoinOnEnd:e.account_join_on_end,matsDeviceJoin:e.device_join,matsPromptBehavior:e.prompt_behavior,matsApiErrorCode:e.api_error_code,matsUiVisible:e.ui_visible,matsSilentCode:e.silent_code,matsSilentBiSubCode:e.silent_bi_sub_code,matsSilentMessage:e.silent_message,matsSilentStatus:e.silent_status,matsHttpStatus:e.http_status,matsHttpEventCount:e.http_event_count},this.correlationId),e):null},t.prototype.validateNativeResponse=function(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw sj.createUnexpectedError("Response missing expected properties.")},t.prototype.getMATSFromResponse=function(e){if(e.properties.MATS)try{return JSON.parse(e.properties.MATS)}catch(e){this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null},t.prototype.isResponseFromCache=function(e){return void 0===e.is_cached?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached},t.prototype.initializeNativeRequest=function(e){return wN(this,void 0,void 0,(function(){var t,r,n,i,o,a=this;return xN(this,(function(s){switch(s.label){case 0:return this.logger.trace("NativeInteractionClient - initializeNativeRequest called"),t=e.authority||this.config.auth.authority,e.account?[4,this.validateRequestAuthority(t,e.account)]:[3,2];case 1:s.sent(),s.label=2;case 2:return(i=new JF(t)).validateAsUri(),o=e.scopes,n=bN(e,["scopes"]),(o=new mF(o||[])).appendScopes(tz),r=function(){switch(a.apiId){case _B.ssoSilent:case _B.acquireTokenSilent_silentFlow:return a.logger.trace("initializeNativeRequest: silent request sets prompt to none"),nz.NONE}if(e.prompt)switch(e.prompt){case nz.NONE:case nz.CONSENT:case nz.LOGIN:return a.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e.prompt;default:throw a.logger.trace("initializeNativeRequest: prompt = "+e.prompt+" is not compatible with native flow"),MU.createNativePromptParameterNotSupportedError()}else a.logger.trace("initializeNativeRequest: prompt was not provided")},n=_N(_N({},n),{accountId:this.accountId,clientId:this.config.auth.clientId,authority:i.urlString,scope:o.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:r(),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:_N(_N(_N({},e.extraQueryParameters),e.tokenQueryParameters),{telemetry:UU}),extendedExpiryToken:!1}),e.authenticationScheme!==VN.POP?[3,4]:(i={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},[4,new tB(this.browserCrypto).generateCnf(i)]);case 3:o=s.sent(),n.reqCnf=o.reqCnfString,n.keyId=o.kid,s.label=4;case 4:return[2,n]}}))}))},t}(rj),uj=function(){function e(e,t,r,n){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=n,this.resolvers=new Map,this.handshakeResolvers=new Map,this.responseId=0,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=r,this.handshakeEvent=r.startMeasurement(RF.NativeMessageHandlerHandshake)}return e.prototype.sendMessage=function(e){return wN(this,void 0,void 0,(function(){var t,r=this;return xN(this,(function(n){return this.logger.trace("NativeMessageHandler - sendMessage called."),t={channel:FU,extensionId:this.extensionId,responseId:this.responseId++,body:e},this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii("NativeMessageHandler - Sending request to browser extension: "+JSON.stringify(t)),this.messageChannel.port1.postMessage(t),[2,new Promise((function(e,n){r.resolvers.set(t.responseId,{resolve:e,reject:n})}))]}))}))},e.createProvider=function(t,r,n){return wN(this,void 0,void 0,(function(){var i,o;return xN(this,(function(a){switch(a.label){case 0:t.trace("NativeMessageHandler - createProvider called."),a.label=1;case 1:return a.trys.push([1,3,,5]),[4,(i=new e(t,r,n,BU)).sendHandshakeRequest()];case 2:return a.sent(),[2,i];case 3:return a.sent(),[4,(o=new e(t,r,n)).sendHandshakeRequest()];case 4:return a.sent(),[2,o];case 5:return[2]}}))}))},e.prototype.sendHandshakeRequest=function(){return wN(this,void 0,void 0,(function(){var e,t=this;return xN(this,(function(r){return this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1),e={channel:FU,extensionId:this.extensionId,responseId:this.responseId++,body:{method:pB.HandshakeRequest}},this.handshakeEvent.addStaticFields({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=function(e){t.onChannelMessage(e)},window.postMessage(e,window.origin,[this.messageChannel.port2]),[2,new Promise((function(r,n){t.handshakeResolvers.set(e.responseId,{resolve:r,reject:n}),t.timeoutId=window.setTimeout((function(){window.removeEventListener("message",t.windowListener,!1),t.messageChannel.port1.close(),t.messageChannel.port2.close(),t.handshakeEvent.endMeasurement({extensionHandshakeTimedOut:!0,success:!1}),n(MU.createNativeHandshakeTimeoutError()),t.handshakeResolvers.delete(e.responseId)}),t.handshakeTimeoutMs)}))]}))}))},e.prototype.onWindowMessage=function(e){this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source!==window||!(e=e.data).channel||e.channel!==FU||e.extensionId&&e.extensionId!==this.extensionId||e.body.method===pB.HandshakeRequest&&(this.logger.verbose(e.extensionId?"Extension with id: "+e.extensionId+" not installed":"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),e=this.handshakeResolvers.get(e.responseId))&&(this.handshakeEvent.endMeasurement({success:!1,extensionInstalled:!1}),e.reject(MU.createNativeExtensionNotInstalledError()))},e.prototype.onChannelMessage=function(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");var t=e.data,r=this.resolvers.get(t.responseId),n=this.handshakeResolvers.get(t.responseId);try{var i=t.body.method;if(i===pB.Response){if(r){var o=t.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii("NativeMessageHandler - Received response from browser extension: "+JSON.stringify(o)),"Success"!==o.status)r.reject(sj.createError(o.code,o.description,o.ext));else{if(!o.result)throw fz.createUnexpectedError("Event does not contain result.");o.result.code&&o.result.description?r.reject(sj.createError(o.result.code,o.result.description,o.result.ext)):r.resolve(o.result)}this.resolvers.delete(t.responseId)}}else i===pB.HandshakeResponse&&n&&(clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose("NativeMessageHandler - Received HandshakeResponse from extension: "+this.extensionId),this.handshakeEvent.endMeasurement({extensionInstalled:!0,success:!0}),n.resolve(),this.handshakeResolvers.delete(t.responseId))}catch(t){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii("Error parsing response from WAM Extension: "+t.toString()),this.logger.errorPii("Unable to parse "+e),r?r.reject(t):n&&n.reject(t)}},e.prototype.getExtensionId=function(){return this.extensionId},e.prototype.getExtensionVersion=function(){return this.extensionVersion},e.isNativeAvailable=function(e,t,r,n){if(t.trace("isNativeAvailable called"),!e.system.allowNativeBroker)return t.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!r)return t.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(n)switch(n){case VN.BEARER:case VN.POP:return t.trace("isNativeAvailable: authenticationScheme is supported, returning true"),!0;default:return t.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0},e}(),hj=function(e){function t(t,r,n,i,o,a,s,l,c,u){return(t=e.call(this,t,r,n,i,o,a,s,c,u)||this).nativeStorage=l,t}return vN(t,e),t.prototype.acquireToken=function(e){return wN(this,void 0,void 0,(function(){var t,r,n,i,o,a,s,l=this;return xN(this,(function(c){switch(c.label){case 0:return this.performanceClient.setPreQueueTime(RF.StandardInteractionClientInitializeAuthorizationRequest,e.correlationId),[4,this.initializeAuthorizationRequest(e,bB.Redirect)];case 1:t=c.sent(),this.browserStorage.updateCacheEntries(t.state,t.nonce,t.authority,t.loginHint||ez.EMPTY_STRING,t.account||null),r=this.initializeServerTelemetryManager(_B.acquireTokenRedirect),n=function(e){e.persisted&&(l.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),l.browserStorage.cleanRequestByState(t.state),l.eventHandler.emitEvent(SB.RESTORE_FROM_BFCACHE,bB.Redirect))},c.label=2;case 2:return c.trys.push([2,7,,8]),this.performanceClient.setPreQueueTime(RF.StandardInteractionClientInitializeAuthorizationCodeRequest,e.correlationId),[4,this.initializeAuthorizationCodeRequest(t)];case 3:return i=c.sent(),this.performanceClient.setPreQueueTime(RF.StandardInteractionClientCreateAuthCodeClient,e.correlationId),[4,this.createAuthCodeClient(r,t.authority,t.azureCloudOptions)];case 4:return a=c.sent(),this.logger.verbose("Auth code client created"),o=new oj(a,this.browserStorage,i,this.logger,this.browserCrypto,this.performanceClient),[4,a.getAuthCodeUrl(_N(_N({},t),{nativeBroker:uj.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme)}))];case 5:return a=c.sent(),s=this.getRedirectStartPage(e.redirectStartPage),this.logger.verbosePii("Redirect start page: "+s),window.addEventListener("pageshow",n),[4,o.initiateAuthRequest(a,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:s,onRedirectNavigate:e.onRedirectNavigate})];case 6:return[2,c.sent()];case 7:throw(s=c.sent())instanceof fz&&s.setCorrelationId(this.correlationId),window.removeEventListener("pageshow",n),r.cacheFailedRequest(s),this.browserStorage.cleanRequestByState(t.state),s;case 8:return[2]}}))}))},t.prototype.handleRedirectPromise=function(e){return wN(this,void 0,void 0,(function(){var t,r,n,i,o,a,s,l,c,u;return xN(this,(function(h){switch(h.label){case 0:t=this.initializeServerTelemetryManager(_B.handleRedirectPromise),h.label=1;case 1:if(h.trys.push([1,10,,11]),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(!(r=this.getRedirectResponseHash(e||window.location.hash)))return this.logger.info("handleRedirectPromise did not detect a response hash as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(bB.Redirect),[2,null];n=void 0;try{i=JF.getDeserializedHash(r),n=this.validateAndExtractStateFromHash(i,bB.Redirect),this.logger.verbose("State extracted from hash")}catch(h){return this.logger.info("handleRedirectPromise was unable to extract state due to: "+h),this.browserStorage.cleanRequestByInteractionType(bB.Redirect),[2,null]}return o=this.browserStorage.getTemporaryCache(gB.ORIGIN_URI,!0)||ez.EMPTY_STRING,a=JF.removeHashFromUrl(o),c=JF.removeHashFromUrl(window.location.href),a===c&&this.config.auth.navigateToLoginRequestUrl?(this.logger.verbose("Current page is loginRequestUrl, handling hash"),[4,this.handleHash(r,n,t)]):[3,3];case 2:return a=h.sent(),-1<o.indexOf("#")&&tj.replaceHash(o),[2,a];case 3:return this.config.auth.navigateToLoginRequestUrl?[3,4]:(this.logger.verbose("NavigateToLoginRequestUrl set to false, handling hash"),[2,this.handleHash(r,n,t)]);case 4:return tj.isInIframe()&&!this.config.system.allowRedirectInIframe?[3,9]:(this.browserStorage.setTemporaryCache(gB.URL_HASH,r,!0),s={apiId:_B.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0},l=!0,o&&"null"!==o?[3,6]:(c=tj.getHomepage(),this.browserStorage.setTemporaryCache(gB.ORIGIN_URI,c,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),[4,this.navigationClient.navigateInternal(c,s)]));case 5:return l=h.sent(),[3,8];case 6:return this.logger.verbose("Navigating to loginRequestUrl: "+o),[4,this.navigationClient.navigateInternal(o,s)];case 7:l=h.sent(),h.label=8;case 8:if(!l)return[2,this.handleHash(r,n,t)];h.label=9;case 9:return[2,null];case 10:throw(u=h.sent())instanceof fz&&u.setCorrelationId(this.correlationId),t.cacheFailedRequest(u),this.browserStorage.cleanRequestByInteractionType(bB.Redirect),u;case 11:return[2]}}))}))},t.prototype.getRedirectResponseHash=function(e){return this.logger.verbose("getRedirectResponseHash called"),JF.hashContainsKnownProperties(e)?(tj.clearHash(window),this.logger.verbose("Hash contains known properties, returning response hash")):(e=this.browserStorage.getTemporaryCache(gB.URL_HASH,!0),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(gB.URL_HASH)),this.logger.verbose("Hash does not contain known properties, returning cached hash")),e},t.prototype.handleHash=function(e,t,r){return wN(this,void 0,void 0,(function(){var n,i,o,a=this;return xN(this,(function(s){switch(s.label){case 0:if(n=this.browserStorage.getCachedRequest(t,this.browserCrypto),this.logger.verbose("handleHash called, retrieved cached request"),(i=JF.getDeserializedHash(e)).accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),this.nativeMessageHandler)return i=new cj(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,_B.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,i.accountId,this.nativeStorage,n.correlationId),o=QF.parseRequestState(this.browserCrypto,t).userRequestState,[2,i.acquireToken(_N(_N({},n),{state:o,prompt:void 0})).finally((function(){a.browserStorage.cleanRequestByState(t)}))];throw MU.createNativeConnectionNotEstablishedError()}if(i=this.browserStorage.getCachedAuthority(t))return this.performanceClient.setPreQueueTime(RF.StandardInteractionClientCreateAuthCodeClient,n.correlationId),[4,this.createAuthCodeClient(r,i)];throw MU.createNoCachedAuthorityError();case 1:return o=s.sent(),this.logger.verbose("Auth code client created"),NF.removeThrottle(this.browserStorage,this.config.auth.clientId,n),[4,new oj(o,this.browserStorage,n,this.logger,this.browserCrypto,this.performanceClient).handleCodeResponseFromHash(e,t,o.authority,this.networkClient)];case 2:return[2,s.sent()]}}))}))},t.prototype.logout=function(e){return wN(this,void 0,void 0,(function(){var t,r,n,i,o;return xN(this,(function(a){switch(a.label){case 0:this.logger.verbose("logoutRedirect called"),t=this.initializeLogoutRequest(e),r=this.initializeServerTelemetryManager(_B.logout),a.label=1;case 1:return a.trys.push([1,10,,11]),this.eventHandler.emitEvent(SB.LOGOUT_START,bB.Redirect,e),[4,this.clearCacheOnLogout(t.account)];case 2:return a.sent(),n={apiId:_B.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},this.performanceClient.setPreQueueTime(RF.StandardInteractionClientCreateAuthCodeClient,t.correlationId),[4,this.createAuthCodeClient(r,e&&e.authority)];case 3:return i=a.sent(),this.logger.verbose("Auth code client created"),i=i.getLogoutUri(t),this.eventHandler.emitEvent(SB.LOGOUT_SUCCESS,bB.Redirect,t),e&&"function"==typeof e.onRedirectNavigate?!1===e.onRedirectNavigate(i)?[3,5]:(this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),[4,this.navigationClient.navigateExternal(i,n)]):[3,7];case 4:return a.sent(),[2];case 5:this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation"),a.label=6;case 6:return[3,9];case 7:return this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),[4,this.navigationClient.navigateExternal(i,n)];case 8:return a.sent(),[2];case 9:return[3,11];case 10:throw(o=a.sent())instanceof fz&&o.setCorrelationId(this.correlationId),r.cacheFailedRequest(o),this.eventHandler.emitEvent(SB.LOGOUT_FAILURE,bB.Redirect,null,o),this.eventHandler.emitEvent(SB.LOGOUT_END,bB.Redirect),o;case 11:return this.eventHandler.emitEvent(SB.LOGOUT_END,bB.Redirect),[2]}}))}))},t.prototype.getRedirectStartPage=function(e){return e=e||window.location.href,JF.getAbsoluteUrl(e,tj.getCurrentUri())},t}(nj),dj=function(e){function t(t,r,n,i,o,a,s,l,c,u){return(t=e.call(this,t,r,n,i,o,a,s,c,u)||this).unloadWindow=t.unloadWindow.bind(t),t.nativeStorage=l,t}return vN(t,e),t.prototype.acquireToken=function(e){try{var t,r=this.generatePopupName(e.scopes||tz,e.authority||this.config.auth.authority),n=e.popupWindowAttributes||{};return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,r,n)):(this.logger.verbose("asyncPopup set to false, opening popup before acquiring token"),t=this.openSizedPopup("about:blank",r,n),this.acquireTokenPopupAsync(e,r,n,t))}catch(e){return Promise.reject(e)}},t.prototype.logout=function(e){try{this.logger.verbose("logoutPopup called");var t,r=this.initializeLogoutRequest(e),n=this.generateLogoutPopupName(r),i=e&&e.authority,o=e&&e.mainWindowRedirectUri,a=(null==e?void 0:e.popupWindowAttributes)||{};return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(r,n,a,i,void 0,o)):(this.logger.verbose("asyncPopup set to false, opening popup"),t=this.openSizedPopup("about:blank",n,a),this.logoutPopupAsync(r,n,a,i,t,o))}catch(e){return Promise.reject(e)}},t.prototype.acquireTokenPopupAsync=function(e,t,r,n){return wN(this,void 0,void 0,(function(){var i,o,a,s,l,c,u,h,d,p,f,m=this;return xN(this,(function(g){switch(g.label){case 0:return this.logger.verbose("acquireTokenPopupAsync called"),i=this.initializeServerTelemetryManager(_B.acquireTokenPopup),this.performanceClient.setPreQueueTime(RF.StandardInteractionClientInitializeAuthorizationRequest,e.correlationId),[4,this.initializeAuthorizationRequest(e,bB.Popup)];case 1:o=g.sent(),this.browserStorage.updateCacheEntries(o.state,o.nonce,o.authority,o.loginHint||ez.EMPTY_STRING,o.account||null),g.label=2;case 2:return g.trys.push([2,8,,9]),this.performanceClient.setPreQueueTime(RF.StandardInteractionClientInitializeAuthorizationCodeRequest,e.correlationId),[4,this.initializeAuthorizationCodeRequest(o)];case 3:return a=g.sent(),this.performanceClient.setPreQueueTime(RF.StandardInteractionClientCreateAuthCodeClient,e.correlationId),[4,this.createAuthCodeClient(i,o.authority,o.azureCloudOptions)];case 4:return s=g.sent(),this.logger.verbose("Auth code client created"),c=uj.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme),l=void 0,c&&(l=this.performanceClient.startMeasurement(RF.FetchAccountIdWithNativeBroker,e.correlationId)),[4,s.getAuthCodeUrl(_N(_N({},o),{nativeBroker:c}))];case 5:return c=g.sent(),u=new ij(s,this.browserStorage,a,this.logger,this.performanceClient),h={popup:n,popupName:t,popupWindowAttributes:r},h=this.initiateAuthRequest(c,h),this.eventHandler.emitEvent(SB.POPUP_OPENED,bB.Popup,{popupWindow:h},null),[4,this.monitorPopupForHash(h)];case 6:if(h=g.sent(),f=JF.getDeserializedHash(h),d=this.validateAndExtractStateFromHash(f,bB.Popup,o.correlationId),NF.removeThrottle(this.browserStorage,this.config.auth.clientId,a),f.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),l&&l.endMeasurement({success:!0,isNativeBroker:!0}),this.nativeMessageHandler)return f=new cj(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,_B.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,f.accountId,this.nativeStorage,o.correlationId),p=QF.parseRequestState(this.browserCrypto,d).userRequestState,[2,f.acquireToken(_N(_N({},o),{state:p,prompt:void 0})).finally((function(){m.browserStorage.cleanRequestByState(d)}))];throw MU.createNativeConnectionNotEstablishedError()}return[4,u.handleCodeResponseFromHash(h,d,s.authority,this.networkClient)];case 7:return[2,g.sent()];case 8:throw f=g.sent(),n&&n.close(),f instanceof fz&&f.setCorrelationId(this.correlationId),i.cacheFailedRequest(f),this.browserStorage.cleanRequestByState(o.state),f;case 9:return[2]}}))}))},t.prototype.logoutPopupAsync=function(e,t,r,n,i,o){return wN(this,void 0,void 0,(function(){var a,s,l;return xN(this,(function(c){switch(c.label){case 0:this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(SB.LOGOUT_START,bB.Popup,e),a=this.initializeServerTelemetryManager(_B.logoutPopup),c.label=1;case 1:return c.trys.push([1,5,,6]),[4,this.clearCacheOnLogout(e.account)];case 2:return c.sent(),this.performanceClient.setPreQueueTime(RF.StandardInteractionClientCreateAuthCodeClient,e.correlationId),[4,this.createAuthCodeClient(a,n)];case 3:return s=c.sent(),this.logger.verbose("Auth code client created"),s=s.getLogoutUri(e),this.eventHandler.emitEvent(SB.LOGOUT_SUCCESS,bB.Popup,e),s=this.openPopup(s,{popupName:t,popupWindowAttributes:r,popup:i}),this.eventHandler.emitEvent(SB.POPUP_OPENED,bB.Popup,{popupWindow:s},null),[4,this.waitForLogoutPopup(s)];case 4:return c.sent(),o?(s={apiId:_B.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},l=JF.getAbsoluteUrl(o,tj.getCurrentUri()),this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii("Redirecting main window to: "+l),this.navigationClient.navigateInternal(l,s)):this.logger.verbose("No main window navigation requested"),[3,6];case 5:throw l=c.sent(),i&&i.close(),l instanceof fz&&l.setCorrelationId(this.correlationId),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(SB.LOGOUT_FAILURE,bB.Popup,null,l),this.eventHandler.emitEvent(SB.LOGOUT_END,bB.Popup),a.cacheFailedRequest(l),l;case 6:return this.eventHandler.emitEvent(SB.LOGOUT_END,bB.Popup),[2]}}))}))},t.prototype.initiateAuthRequest=function(e,t){if(cF.isEmpty(e))throw this.logger.error("Navigate url is empty"),MU.createEmptyNavigationUriError();return this.logger.infoPii("Navigate to: "+e),this.openPopup(e,t)},t.prototype.monitorPopupForHash=function(e){var t=this;return new Promise((function(r,n){var i=t.config.system.windowHashTimeout/t.config.system.pollIntervalMilliseconds,o=0,a=(t.logger.verbose("PopupHandler.monitorPopupForHash - polling started"),setInterval((function(){if(e.closed)t.logger.error("PopupHandler.monitorPopupForHash - window closed"),t.cleanPopup(),clearInterval(a),n(MU.createUserCancelledError());else{var s=ez.EMPTY_STRING,l=ez.EMPTY_STRING;try{s=e.location.href,l=e.location.hash}catch(s){}cF.isEmpty(s)||"about:blank"===s||(t.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),o++,l?(t.logger.verbose("PopupHandler.monitorPopupForHash - found hash in url"),clearInterval(a),t.cleanPopup(e),JF.hashContainsKnownProperties(l)?(t.logger.verbose("PopupHandler.monitorPopupForHash - hash contains known properties, returning."),r(l)):(t.logger.error("PopupHandler.monitorPopupForHash - found hash in url but it does not contain known properties. Check that your router is not changing the hash prematurely."),t.logger.errorPii("PopupHandler.monitorPopupForHash - hash found: "+l),n(MU.createHashDoesNotContainKnownPropertiesError()))):i<o&&(t.logger.error("PopupHandler.monitorPopupForHash - unable to find hash in url, timing out"),clearInterval(a),n(MU.createMonitorPopupTimeoutError())))}}),t.config.system.pollIntervalMilliseconds))}))},t.prototype.waitForLogoutPopup=function(e){var t=this;return new Promise((function(r){t.logger.verbose("PopupHandler.waitForLogoutPopup - polling started");var n=setInterval((function(){e.closed&&(t.logger.error("PopupHandler.waitForLogoutPopup - window closed"),t.cleanPopup(),clearInterval(n),r());var i=ez.EMPTY_STRING;try{i=e.location.href}catch(i){}cF.isEmpty(i)||"about:blank"===i||(t.logger.verbose("PopupHandler.waitForLogoutPopup - popup window is on same origin as caller, closing."),clearInterval(n),t.cleanPopup(e),r())}),t.config.system.pollIntervalMilliseconds)}))},t.prototype.openPopup=function(e,t){try{var r=void 0;if(t.popup?(r=t.popup,this.logger.verbosePii("Navigating popup window to: "+e),r.location.assign(e)):void 0===t.popup&&(this.logger.verbosePii("Opening popup window to: "+e),r=this.openSizedPopup(e,t.popupName,t.popupWindowAttributes)),r)return r.focus&&r.focus(),this.currentWindow=r,window.addEventListener("beforeunload",this.unloadWindow),r;throw MU.createEmptyWindowCreatedError()}catch(e){throw this.logger.error("error opening popup "+e.message),this.browserStorage.setInteractionInProgress(!1),MU.createPopupWindowError(e.toString())}},t.prototype.openSizedPopup=function(e,t,r){var n=window.screenLeft||window.screenX,i=window.screenTop||window.screenY,o=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,a=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,s=null==(s=r.popupSize)?void 0:s.width,l=null==(l=r.popupSize)?void 0:l.height,c=null==(c=r.popupPosition)?void 0:c.top;r=null==(r=r.popupPosition)?void 0:r.left;return(!s||s<0||o<s)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),s=OU),(!l||l<0||a<l)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),l=LU),(!c||c<0||a<c)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),c=Math.max(0,a/2-LU/2+i)),(!r||r<0||o<r)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),r=Math.max(0,o/2-OU/2+n)),window.open(e,t,"width="+s+", height="+l+", top="+c+", left="+r+", scrollbars=yes")},t.prototype.unloadWindow=function(e){this.browserStorage.cleanRequestByInteractionType(bB.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()},t.prototype.cleanPopup=function(e){e&&e.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)},t.prototype.generatePopupName=function(e,t){return DU+"."+this.config.auth.clientId+"."+e.join("-")+"."+t+"."+this.correlationId},t.prototype.generateLogoutPopupName=function(e){return e=e.account&&e.account.homeAccountId,DU+"."+this.config.auth.clientId+"."+e+"."+this.correlationId},t}(nj),pj=function(){function e(){}return e.prototype.navigateInternal=function(t,r){return e.defaultNavigateWindow(t,r)},e.prototype.navigateExternal=function(t,r){return e.defaultNavigateWindow(t,r)},e.defaultNavigateWindow=function(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise((function(e){setTimeout((function(){e(!0)}),t.timeout)}))},e}(),fj=6e3;var mj,gj=function(e){function t(t,r,n,i,o,a){return(t=e.call(this,t,r,n,i,a)||this).navigateFrameWait=o.navigateFrameWait,t.pollIntervalMilliseconds=o.pollIntervalMilliseconds,t}return vN(t,e),t.prototype.initiateAuthRequest=function(e){return wN(this,void 0,void 0,(function(){return xN(this,(function(t){switch(t.label){case 0:if(this.performanceClient.addQueueMeasurement(RF.SilentHandlerInitiateAuthRequest,this.authCodeRequest.correlationId),cF.isEmpty(e))throw this.logger.info("Navigate url is empty"),MU.createEmptyNavigationUriError();return this.navigateFrameWait?(this.performanceClient.setPreQueueTime(RF.SilentHandlerLoadFrame,this.authCodeRequest.correlationId),[4,this.loadFrame(e)]):[3,2];case 1:return[2,t.sent()];case 2:return[2,this.loadFrameSync(e)]}}))}))},t.prototype.monitorIframeForHash=function(e,t){var r=this;return this.performanceClient.addQueueMeasurement(RF.SilentHandlerMonitorIframeForHash,this.authCodeRequest.correlationId),new Promise((function(n,i){t<fj&&r.logger.warning("system.loadFrameTimeout or system.iframeHashTimeout set to lower ("+t+"ms) than the default ("+fj+"ms). This may result in timeouts.");var o=window.performance.now()+t,a=setInterval((function(){if(window.performance.now()>o)r.removeHiddenIframe(e),clearInterval(a),i(MU.createMonitorIframeTimeoutError());else{var t=ez.EMPTY_STRING,s=e.contentWindow;try{t=s?s.location.href:ez.EMPTY_STRING}catch(t){}cF.isEmpty(t)||(t=s?s.location.hash:ez.EMPTY_STRING,JF.hashContainsKnownProperties(t)&&(r.removeHiddenIframe(e),clearInterval(a),n(t)))}}),r.pollIntervalMilliseconds)}))},t.prototype.loadFrame=function(e){var t=this;return this.performanceClient.addQueueMeasurement(RF.SilentHandlerLoadFrame,this.authCodeRequest.correlationId),new Promise((function(r,n){var i=t.createHiddenIframe();setTimeout((function(){i?(i.src=e,r(i)):n("Unable to load iframe")}),t.navigateFrameWait)}))},t.prototype.loadFrameSync=function(e){var t=this.createHiddenIframe();return t.src=e,t},t.prototype.createHiddenIframe=function(){var e=document.createElement("iframe");return e.style.visibility="hidden",e.style.position="absolute",e.style.width=e.style.height="0",e.style.border="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.getElementsByTagName("body")[0].appendChild(e),e},t.prototype.removeHiddenIframe=function(e){document.body===e.parentNode&&document.body.removeChild(e)},t}(ij),yj=function(e){function t(t,r,n,i,o,a,s,l,c,u,h){return(t=e.call(this,t,r,n,i,o,a,l,u,h)||this).apiId=s,t.nativeStorage=c,t}return vN(t,e),t.prototype.acquireToken=function(e){return wN(this,void 0,void 0,(function(){var t,r,n,i;return xN(this,(function(o){switch(o.label){case 0:if(this.performanceClient.addQueueMeasurement(RF.SilentIframeClientAcquireToken,e.correlationId),this.logger.verbose("acquireTokenByIframe called"),t=this.performanceClient.startMeasurement(RF.SilentIframeClientAcquireToken,e.correlationId),cF.isEmpty(e.loginHint)&&cF.isEmpty(e.sid)&&(!e.account||cF.isEmpty(e.account.username))&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request."),e.prompt&&e.prompt!==nz.NONE&&e.prompt!==nz.NO_SESSION)throw t.endMeasurement({success:!1}),MU.createSilentPromptValueError(e.prompt);return this.performanceClient.setPreQueueTime(RF.StandardInteractionClientInitializeAuthorizationRequest,e.correlationId),[4,this.initializeAuthorizationRequest(_N(_N({},e),{prompt:e.prompt||nz.NONE}),bB.Silent)];case 1:r=o.sent(),this.browserStorage.updateCacheEntries(r.state,r.nonce,r.authority,r.loginHint||ez.EMPTY_STRING,r.account||null),n=this.initializeServerTelemetryManager(this.apiId),o.label=2;case 2:return o.trys.push([2,5,,6]),this.performanceClient.setPreQueueTime(RF.StandardInteractionClientCreateAuthCodeClient,e.correlationId),[4,this.createAuthCodeClient(n,r.authority,r.azureCloudOptions)];case 3:return i=o.sent(),this.logger.verbose("Auth code client created"),this.performanceClient.setPreQueueTime(RF.SilentIframeClientTokenHelper,e.correlationId),[4,this.silentTokenHelper(i,r).then((function(e){return t.endMeasurement({success:!0,fromCache:!1,requestId:e.requestId}),e}))];case 4:return[2,o.sent()];case 5:throw(i=o.sent())instanceof fz&&i.setCorrelationId(this.correlationId),n.cacheFailedRequest(i),this.browserStorage.cleanRequestByState(r.state),t.endMeasurement({errorCode:i instanceof fz&&i.errorCode||void 0,subErrorCode:i instanceof fz&&i.subError||void 0,success:!1}),i;case 6:return[2]}}))}))},t.prototype.logout=function(){return Promise.reject(MU.createSilentLogoutUnsupportedError())},t.prototype.silentTokenHelper=function(e,t){return wN(this,void 0,void 0,(function(){var r,n,i,o,a,s,l,c=this;return xN(this,(function(u){switch(u.label){case 0:return this.performanceClient.addQueueMeasurement(RF.SilentIframeClientTokenHelper,t.correlationId),this.performanceClient.setPreQueueTime(RF.StandardInteractionClientInitializeAuthorizationCodeRequest,t.correlationId),[4,this.initializeAuthorizationCodeRequest(t)];case 1:return r=u.sent(),this.performanceClient.setPreQueueTime(RF.GetAuthCodeUrl,t.correlationId),[4,e.getAuthCodeUrl(_N(_N({},t),{nativeBroker:uj.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme)}))];case 2:return i=u.sent(),n=new gj(e,this.browserStorage,r,this.logger,this.config.system,this.performanceClient),this.performanceClient.setPreQueueTime(RF.SilentHandlerInitiateAuthRequest,t.correlationId),[4,n.initiateAuthRequest(i)];case 3:return i=u.sent(),this.performanceClient.setPreQueueTime(RF.SilentHandlerMonitorIframeForHash,t.correlationId),[4,n.monitorIframeForHash(i,this.config.system.iframeHashTimeout)];case 4:if(o=u.sent(),s=JF.getDeserializedHash(o),a=this.validateAndExtractStateFromHash(s,bB.Silent,r.correlationId),s.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),this.nativeMessageHandler)return s=new cj(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,s.accountId,this.browserStorage,this.correlationId),l=QF.parseRequestState(this.browserCrypto,a).userRequestState,[2,s.acquireToken(_N(_N({},t),{state:l,prompt:t.prompt||nz.NONE})).finally((function(){c.browserStorage.cleanRequestByState(a)}))];throw MU.createNativeConnectionNotEstablishedError()}return this.performanceClient.setPreQueueTime(RF.HandleCodeResponseFromHash,t.correlationId),[2,n.handleCodeResponseFromHash(o,a,e.authority,this.networkClient)]}}))}))},t}(nj),vj=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return vN(t,e),t.prototype.acquireToken=function(e){return wN(this,void 0,void 0,(function(){var t,r,n,i,o,a=this;return xN(this,(function(s){switch(s.label){case 0:return this.performanceClient.addQueueMeasurement(RF.SilentRefreshClientAcquireToken,e.correlationId),this.performanceClient.setPreQueueTime(RF.InitializeBaseRequest,e.correlationId),r=[_N({},e)],[4,this.initializeBaseRequest(e,e.account)];case 1:return t=_N.apply(void 0,r.concat([s.sent()])),n=this.performanceClient.startMeasurement(RF.SilentRefreshClientAcquireToken,t.correlationId),i=this.initializeServerTelemetryManager(_B.acquireTokenSilent_silentFlow),[4,this.createRefreshTokenClient(i,t.authority,t.azureCloudOptions)];case 2:return o=s.sent(),this.logger.verbose("Refresh token client created"),this.performanceClient.setPreQueueTime(RF.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),[2,o.acquireTokenByRefreshToken(t).then((function(e){return n.endMeasurement({success:!0,fromCache:e.fromCache,requestId:e.requestId}),e})).catch((function(e){throw e instanceof fz&&e.setCorrelationId(a.correlationId),i.cacheFailedRequest(e),n.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e}))]}}))}))},t.prototype.logout=function(){return Promise.reject(MU.createSilentLogoutUnsupportedError())},t.prototype.createRefreshTokenClient=function(e,t,r){return wN(this,void 0,void 0,(function(){var n;return xN(this,(function(i){switch(i.label){case 0:return this.performanceClient.setPreQueueTime(RF.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(e,t,r)];case 1:return n=i.sent(),[2,new aB(n,this.performanceClient)]}}))}))},t}(nj),_j=function(){function e(e,t){this.eventCallbacks=new Map,this.logger=e,this.browserCrypto=t,this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}return e.prototype.addEventCallback=function(e){var t;return"undefined"!=typeof window?(t=this.browserCrypto.createNewGuid(),this.eventCallbacks.set(t,e),this.logger.verbose("Event callback registered with id: "+t),t):null},e.prototype.removeEventCallback=function(e){this.eventCallbacks.delete(e),this.logger.verbose("Event callback "+e+" removed.")},e.prototype.enableAccountStorageEvents=function(){"undefined"!=typeof window&&(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))},e.prototype.disableAccountStorageEvents=function(){"undefined"!=typeof window&&(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))},e.prototype.emitEvent=function(e,t,r,n){var i,o=this;"undefined"!=typeof window&&(i={eventType:e,interactionType:t||null,payload:r||null,error:n||null,timestamp:Date.now()},this.logger.info("Emitting event: "+e),this.eventCallbacks.forEach((function(t,r){o.logger.verbose("Emitting event to callback "+r+": "+e),t.apply(null,[i])})))},e.prototype.handleAccountCacheChange=function(e){try{var t,r,n=e.newValue||e.oldValue;n&&"object"==typeof(t=JSON.parse(n))&&vF.isAccountEntity(t)&&(r=bF.toObject(new vF,t).getAccountInfo(),!e.oldValue&&e.newValue?(this.logger.info("Account was added to cache in a different window"),this.emitEvent(SB.ACCOUNT_ADDED,void 0,r)):!e.newValue&&e.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.emitEvent(SB.ACCOUNT_REMOVED,void 0,r)))}catch(e){}},e}(),bj=function(){function e(){}return e.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},e}(),wj=function(){function e(e){this.cryptoObj=e}return e.prototype.generateGuid=function(){try{var e=new Uint8Array(16);return this.cryptoObj.getRandomValues(e),e[6]|=64,e[6]&=79,e[8]|=128,e[8]&=191,bj.decimalToHex(e[0])+bj.decimalToHex(e[1])+bj.decimalToHex(e[2])+bj.decimalToHex(e[3])+"-"+bj.decimalToHex(e[4])+bj.decimalToHex(e[5])+"-"+bj.decimalToHex(e[6])+bj.decimalToHex(e[7])+"-"+bj.decimalToHex(e[8])+bj.decimalToHex(e[9])+"-"+bj.decimalToHex(e[10])+bj.decimalToHex(e[11])+bj.decimalToHex(e[12])+bj.decimalToHex(e[13])+bj.decimalToHex(e[14])+bj.decimalToHex(e[15])}catch(e){for(var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r="0123456789abcdef",n=0,i=ez.EMPTY_STRING,o=0;o<36;o++)"-"!==t[o]&&"4"!==t[o]&&(n=16*Math.random()|0),i+="x"===t[o]?r[n]:"y"===t[o]?r[n=3&n|8]:t[o];return i}},e.prototype.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},e}(),xj=function(){function e(){}return e.stringToUtf8Arr=function(e){for(var t,r=0,n=e.length,i=0;i<n;i++)r+=(t=e.charCodeAt(i))<128?1:t<2048?2:t<65536?3:t<2097152?4:t<67108864?5:6;for(var o=new Uint8Array(r),a=0,s=0;a<r;s++)(t=e.charCodeAt(s))<128?o[a++]=t:(t<2048?o[a++]=192+(t>>>6):(t<65536?o[a++]=224+(t>>>12):(t<2097152?o[a++]=240+(t>>>18):(t<67108864?o[a++]=248+(t>>>24):(o[a++]=252+(t>>>30),o[a++]=128+(t>>>24&63)),o[a++]=128+(t>>>18&63)),o[a++]=128+(t>>>12&63)),o[a++]=128+(t>>>6&63)),o[a++]=128+(63&t));return o},e.stringToArrayBuffer=function(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return t},e.utf8ArrToString=function(e){for(var t,r=ez.EMPTY_STRING,n=e.length,i=0;i<n;i++)t=e[i],r+=String.fromCharCode(251<t&&t<254&&i+5<n?1073741824*(t-252)+(e[++i]-128<<24)+(e[++i]-128<<18)+(e[++i]-128<<12)+(e[++i]-128<<6)+e[++i]-128:247<t&&t<252&&i+4<n?(t-248<<24)+(e[++i]-128<<18)+(e[++i]-128<<12)+(e[++i]-128<<6)+e[++i]-128:239<t&&t<248&&i+3<n?(t-240<<18)+(e[++i]-128<<12)+(e[++i]-128<<6)+e[++i]-128:223<t&&t<240&&i+2<n?(t-224<<12)+(e[++i]-128<<6)+e[++i]-128:191<t&&t<224&&i+1<n?(t-192<<6)+e[++i]-128:t);return r},e.getSortedObjectString=function(e){return JSON.stringify(e,Object.keys(e).sort())},e}(),Cj=function(){function e(){}return e.prototype.urlEncode=function(e){return encodeURIComponent(this.encode(e).replace(/=/g,ez.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_"))},e.prototype.urlEncodeArr=function(e){return this.base64EncArr(e).replace(/=/g,ez.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_")},e.prototype.encode=function(e){return e=xj.stringToUtf8Arr(e),this.base64EncArr(e)},e.prototype.base64EncArr=function(e){for(var t,r=(3-e.length%3)%3,n=ez.EMPTY_STRING,i=e.length,o=0,a=0;a<i;a++)o|=e[a]<<(16>>>(t=a%3)&24),2!=t&&e.length-a!=1||(n+=String.fromCharCode(this.uint6ToB64(o>>>18&63),this.uint6ToB64(o>>>12&63),this.uint6ToB64(o>>>6&63),this.uint6ToB64(63&o)),o=0);return 0==r?n:n.substring(0,n.length-r)+(1==r?"=":"==")},e.prototype.uint6ToB64=function(e){return e<26?e+65:e<52?e+71:e<62?e-4:62===e?43:63===e?47:65},e}(),Sj=function(){function e(){}return e.prototype.decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}return e=this.base64DecToArr(t),xj.utf8ArrToString(e)},e.prototype.base64DecToArr=function(e,t){for(var r,n=e.replace(/[^A-Za-z0-9\+\/]/g,ez.EMPTY_STRING),i=n.length,o=t?Math.ceil((3*i+1>>>2)/t)*t:3*i+1>>>2,a=new Uint8Array(o),s=void 0,l=0,c=0,u=0;u<i;u++)if(r=3&u,l|=this.b64ToUint6(n.charCodeAt(u))<<18-6*r,3==r||i-u==1){for(s=0;s<3&&c<o;s++,c++)a[c]=l>>>(16>>>s&24)&255;l=0}return a},e.prototype.b64ToUint6=function(e){return 64<e&&e<91?e-65:96<e&&e<123?e-71:47<e&&e<58?e+4:43===e?62:47===e?63:0},e}(),Ej=function(){function e(e){this.base64Encode=new Cj,this.cryptoObj=e}return e.prototype.generateCodes=function(){return wN(this,void 0,void 0,(function(){var e,t;return xN(this,(function(r){switch(r.label){case 0:return e=this.generateCodeVerifier(),[4,this.generateCodeChallengeFromVerifier(e)];case 1:return t=r.sent(),[2,{verifier:e,challenge:t}]}}))}))},e.prototype.generateCodeVerifier=function(){try{var e=new Uint8Array(32);return this.cryptoObj.getRandomValues(e),this.base64Encode.urlEncodeArr(e)}catch(e){throw MU.createPkceNotGeneratedError(e)}},e.prototype.generateCodeChallengeFromVerifier=function(e){return wN(this,void 0,void 0,(function(){var t;return xN(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.cryptoObj.sha256Digest(e)];case 1:return t=r.sent(),[2,this.base64Encode.urlEncodeArr(new Uint8Array(t))];case 2:throw t=r.sent(),MU.createPkceNotGeneratedError(t);case 3:return[2]}}))}))},e}(),Tj=function(){function e(){}return e.prototype.getRandomValues=function(e){return window.crypto.getRandomValues(e)},e.prototype.generateKey=function(e,t,r){return wN(this,void 0,void 0,(function(){return xN(this,(function(n){return[2,window.crypto.subtle.generateKey(e,t,r)]}))}))},e.prototype.exportKey=function(e){return wN(this,void 0,void 0,(function(){return xN(this,(function(t){return[2,window.crypto.subtle.exportKey(qU,e)]}))}))},e.prototype.importKey=function(e,t,r,n){return wN(this,void 0,void 0,(function(){return xN(this,(function(i){return[2,window.crypto.subtle.importKey(qU,e,t,r,n)]}))}))},e.prototype.sign=function(e,t,r){return wN(this,void 0,void 0,(function(){return xN(this,(function(n){return[2,window.crypto.subtle.sign(e,t,r)]}))}))},e.prototype.digest=function(e,t){return wN(this,void 0,void 0,(function(){return xN(this,(function(r){return[2,window.crypto.subtle.digest(e,t)]}))}))},e}(),Ij=function(){function e(){}return e.prototype.initPrng=function(e){return window.msrCrypto.initPrng(SN(e))},e.prototype.getRandomValues=function(e){return window.msrCrypto.getRandomValues(e)},e.prototype.generateKey=function(e,t,r){return wN(this,void 0,void 0,(function(){return xN(this,(function(n){return[2,window.msrCrypto.subtle.generateKey(e,t,r)]}))}))},e.prototype.exportKey=function(e){return wN(this,void 0,void 0,(function(){return xN(this,(function(t){return[2,window.msrCrypto.subtle.exportKey(qU,e)]}))}))},e.prototype.importKey=function(e,t,r,n){return wN(this,void 0,void 0,(function(){return xN(this,(function(i){return[2,window.msrCrypto.subtle.importKey(qU,e,t,r,n)]}))}))},e.prototype.sign=function(e,t,r){return wN(this,void 0,void 0,(function(){return xN(this,(function(n){return[2,window.msrCrypto.subtle.sign(e,t,r)]}))}))},e.prototype.digest=function(e,t){return wN(this,void 0,void 0,(function(){return xN(this,(function(r){return[2,window.msrCrypto.subtle.digest(e,t)]}))}))},e}(),kj=function(){function e(){}return e.prototype.getRandomValues=function(e){return window.msCrypto.getRandomValues(e)},e.prototype.generateKey=function(e,t,r){return wN(this,void 0,void 0,(function(){return xN(this,(function(n){return[2,new Promise((function(n,i){var o=window.msCrypto.subtle.generateKey(e,t,r);o.addEventListener("complete",(function(e){n(e.target.result)})),o.addEventListener("error",(function(e){i(e)}))}))]}))}))},e.prototype.exportKey=function(e){return wN(this,void 0,void 0,(function(){return xN(this,(function(t){return[2,new Promise((function(t,r){var n=window.msCrypto.subtle.exportKey(qU,e);n.addEventListener("complete",(function(e){var n=e.target.result;n=xj.utf8ArrToString(new Uint8Array(n)).replace(/\r/g,ez.EMPTY_STRING).replace(/\n/g,ez.EMPTY_STRING).replace(/\t/g,ez.EMPTY_STRING).split(" ").join(ez.EMPTY_STRING).replace("\0",ez.EMPTY_STRING);try{t(JSON.parse(n))}catch(e){r(e)}})),n.addEventListener("error",(function(e){r(e)}))}))]}))}))},e.prototype.importKey=function(e,t,r,n){return wN(this,void 0,void 0,(function(){var i,o;return xN(this,(function(a){return i=xj.getSortedObjectString(e),o=xj.stringToArrayBuffer(i),[2,new Promise((function(e,i){var a=window.msCrypto.subtle.importKey(qU,o,t,r,n);a.addEventListener("complete",(function(t){e(t.target.result)})),a.addEventListener("error",(function(e){i(e)}))}))]}))}))},e.prototype.sign=function(e,t,r){return wN(this,void 0,void 0,(function(){return xN(this,(function(n){return[2,new Promise((function(n,i){var o=window.msCrypto.subtle.sign(e,t,r);o.addEventListener("complete",(function(e){n(e.target.result)})),o.addEventListener("error",(function(e){i(e)}))}))]}))}))},e.prototype.digest=function(e,t){return wN(this,void 0,void 0,(function(){return xN(this,(function(r){return[2,new Promise((function(r,n){var i=window.msCrypto.subtle.digest(e,t.buffer);i.addEventListener("complete",(function(e){r(e.target.result)})),i.addEventListener("error",(function(e){n(e)}))}))]}))}))},e}(),Aj="SHA-256",Pj=new Uint8Array([1,0,1]),Mj=function(){function e(e,t){if(this.logger=e,this.cryptoOptions=t,this.hasBrowserCrypto())this.logger.verbose("BrowserCrypto: modern crypto interface available"),this.subtleCrypto=new Tj;else if(this.hasIECrypto())this.logger.verbose("BrowserCrypto: MS crypto interface available"),this.subtleCrypto=new kj;else{if(!this.hasMsrCrypto()||null==(e=this.cryptoOptions)||!e.useMsrCrypto)throw this.hasMsrCrypto()&&this.logger.info("BrowserCrypto: MSR Crypto interface available but system.cryptoOptions.useMsrCrypto not enabled"),this.logger.error("BrowserCrypto: No crypto interfaces available."),MU.createCryptoNotAvailableError("Browser crypto, msCrypto, or msrCrypto interfaces not available.");this.logger.verbose("BrowserCrypto: MSR crypto interface available"),this.subtleCrypto=new Ij}if(this.subtleCrypto.initPrng){if(this.logger.verbose("BrowserCrypto: Interface requires entropy"),null==(t=this.cryptoOptions)||!t.entropy)throw this.logger.error("BrowserCrypto: Interface requires entropy but none provided."),KU.createEntropyNotProvided();this.logger.verbose("BrowserCrypto: Entropy provided"),this.subtleCrypto.initPrng(this.cryptoOptions.entropy)}this.keygenAlgorithmOptions={name:"RSASSA-PKCS1-v1_5",hash:Aj,modulusLength:2048,publicExponent:Pj}}return e.prototype.hasIECrypto=function(){return"msCrypto"in window},e.prototype.hasBrowserCrypto=function(){return"crypto"in window},e.prototype.hasMsrCrypto=function(){return"msrCrypto"in window},e.prototype.sha256Digest=function(e){return wN(this,void 0,void 0,(function(){var t;return xN(this,(function(r){return t=xj.stringToUtf8Arr(e),[2,this.subtleCrypto.digest({name:Aj},t)]}))}))},e.prototype.getRandomValues=function(e){return this.subtleCrypto.getRandomValues(e)},e.prototype.generateKeyPair=function(e,t){return wN(this,void 0,void 0,(function(){return xN(this,(function(r){return[2,this.subtleCrypto.generateKey(this.keygenAlgorithmOptions,e,t)]}))}))},e.prototype.exportJwk=function(e){return wN(this,void 0,void 0,(function(){return xN(this,(function(t){return[2,this.subtleCrypto.exportKey(e)]}))}))},e.prototype.importJwk=function(e,t,r){return wN(this,void 0,void 0,(function(){return xN(this,(function(n){return[2,this.subtleCrypto.importKey(e,this.keygenAlgorithmOptions,t,r)]}))}))},e.prototype.sign=function(e,t){return wN(this,void 0,void 0,(function(){return xN(this,(function(r){return[2,this.subtleCrypto.sign(this.keygenAlgorithmOptions,e,t)]}))}))},e}(),Rj=function(){function e(){this.dbName=HU,this.version=1,this.tableName=VU,this.dbOpen=!1}return e.prototype.open=function(){return wN(this,void 0,void 0,(function(){var e=this;return xN(this,(function(t){return[2,new Promise((function(t,r){var n=window.indexedDB.open(e.dbName,e.version);n.addEventListener("upgradeneeded",(function(t){t.target.result.createObjectStore(e.tableName)})),n.addEventListener("success",(function(r){e.db=r.target.result,e.dbOpen=!0,t()})),n.addEventListener("error",(function(){return r(MU.createDatabaseUnavailableError())}))}))]}))}))},e.prototype.closeConnection=function(){var e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)},e.prototype.validateDbIsOpen=function(){return wN(this,void 0,void 0,(function(){return xN(this,(function(e){switch(e.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:return[2,e.sent()];case 2:return[2]}}))}))},e.prototype.getItem=function(e){return wN(this,void 0,void 0,(function(){var t=this;return xN(this,(function(r){switch(r.label){case 0:return[4,this.validateDbIsOpen()];case 1:return r.sent(),[2,new Promise((function(r,n){if(!t.db)return n(MU.createDatabaseNotOpenError());var i=t.db.transaction([t.tableName],"readonly").objectStore(t.tableName).get(e);i.addEventListener("success",(function(e){t.closeConnection(),r(e.target.result)})),i.addEventListener("error",(function(e){t.closeConnection(),n(e)}))}))]}}))}))},e.prototype.setItem=function(e,t){return wN(this,void 0,void 0,(function(){var r=this;return xN(this,(function(n){switch(n.label){case 0:return[4,this.validateDbIsOpen()];case 1:return n.sent(),[2,new Promise((function(n,i){if(!r.db)return i(MU.createDatabaseNotOpenError());var o=r.db.transaction([r.tableName],"readwrite").objectStore(r.tableName).put(t,e);o.addEventListener("success",(function(){r.closeConnection(),n()})),o.addEventListener("error",(function(e){r.closeConnection(),i(e)}))}))]}}))}))},e.prototype.removeItem=function(e){return wN(this,void 0,void 0,(function(){var t=this;return xN(this,(function(r){switch(r.label){case 0:return[4,this.validateDbIsOpen()];case 1:return r.sent(),[2,new Promise((function(r,n){if(!t.db)return n(MU.createDatabaseNotOpenError());var i=t.db.transaction([t.tableName],"readwrite").objectStore(t.tableName).delete(e);i.addEventListener("success",(function(){t.closeConnection(),r()})),i.addEventListener("error",(function(e){t.closeConnection(),n(e)}))}))]}}))}))},e.prototype.getKeys=function(){return wN(this,void 0,void 0,(function(){var e=this;return xN(this,(function(t){switch(t.label){case 0:return[4,this.validateDbIsOpen()];case 1:return t.sent(),[2,new Promise((function(t,r){if(!e.db)return r(MU.createDatabaseNotOpenError());var n=e.db.transaction([e.tableName],"readonly").objectStore(e.tableName).getAllKeys();n.addEventListener("success",(function(r){e.closeConnection(),t(r.target.result)})),n.addEventListener("error",(function(t){e.closeConnection(),r(t)}))}))]}}))}))},e.prototype.containsKey=function(e){return wN(this,void 0,void 0,(function(){var t=this;return xN(this,(function(r){switch(r.label){case 0:return[4,this.validateDbIsOpen()];case 1:return r.sent(),[2,new Promise((function(r,n){if(!t.db)return n(MU.createDatabaseNotOpenError());var i=t.db.transaction([t.tableName],"readonly").objectStore(t.tableName).count(e);i.addEventListener("success",(function(e){t.closeConnection(),r(1===e.target.result)})),i.addEventListener("error",(function(e){t.closeConnection(),n(e)}))}))]}}))}))},e.prototype.deleteDatabase=function(){return wN(this,void 0,void 0,(function(){return xN(this,(function(e){return this.db&&this.dbOpen&&this.closeConnection(),[2,new Promise((function(e,t){var r=window.indexedDB.deleteDatabase(HU);r.addEventListener("success",(function(){return e(!0)})),r.addEventListener("blocked",(function(){return e(!0)})),r.addEventListener("error",(function(){return t(!1)}))}))]}))}))},e}(),Oj=function(){function e(e,t){this.inMemoryCache=new WU,this.indexedDBCache=new Rj,this.logger=e,this.storeName=t}return e.prototype.handleDatabaseAccessError=function(e){if(!(e instanceof MU&&e.errorCode===SU.code))throw e;this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")},e.prototype.getItem=function(e){return wN(this,void 0,void 0,(function(){var t,r;return xN(this,(function(n){switch(n.label){case 0:if(t=this.inMemoryCache.getItem(e))return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.getItem(e)];case 2:return[2,n.sent()];case 3:return r=n.sent(),this.handleDatabaseAccessError(r),[3,4];case 4:return[2,t]}}))}))},e.prototype.setItem=function(e,t){return wN(this,void 0,void 0,(function(){var r;return xN(this,(function(n){switch(n.label){case 0:this.inMemoryCache.setItem(e,t),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.indexedDBCache.setItem(e,t)];case 2:return n.sent(),[3,4];case 3:return r=n.sent(),this.handleDatabaseAccessError(r),[3,4];case 4:return[2]}}))}))},e.prototype.removeItem=function(e){return wN(this,void 0,void 0,(function(){var t;return xN(this,(function(r){switch(r.label){case 0:this.inMemoryCache.removeItem(e),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.indexedDBCache.removeItem(e)];case 2:return r.sent(),[3,4];case 3:return t=r.sent(),this.handleDatabaseAccessError(t),[3,4];case 4:return[2]}}))}))},e.prototype.getKeys=function(){return wN(this,void 0,void 0,(function(){var e,t;return xN(this,(function(r){switch(r.label){case 0:if(0!==(e=this.inMemoryCache.getKeys()).length)return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),this.logger.verbose("In-memory cache is empty, now querying persistent storage."),[4,this.indexedDBCache.getKeys()];case 2:return[2,r.sent()];case 3:return t=r.sent(),this.handleDatabaseAccessError(t),[3,4];case 4:return[2,e]}}))}))},e.prototype.containsKey=function(e){return wN(this,void 0,void 0,(function(){var t,r;return xN(this,(function(n){switch(n.label){case 0:if(t=this.inMemoryCache.containsKey(e))return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.containsKey(e)];case 2:return[2,n.sent()];case 3:return r=n.sent(),this.handleDatabaseAccessError(r),[3,4];case 4:return[2,t]}}))}))},e.prototype.clearInMemory=function(){this.logger.verbose("Deleting in-memory keystore "+this.storeName),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore "+this.storeName+" deleted")},e.prototype.clearPersistent=function(){return wN(this,void 0,void 0,(function(){var e;return xN(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),this.logger.verbose("Deleting persistent keystore"),[4,this.indexedDBCache.deleteDatabase()];case 1:return(e=t.sent())&&this.logger.verbose("Persistent keystore deleted"),[2,e];case 2:return e=t.sent(),this.handleDatabaseAccessError(e),[2,!1];case 3:return[2]}}))}))},e}(),Lj=(function(e){e.asymmetricKeys="asymmetricKeys",e.symmetricKeys="symmetricKeys"}(mj=mj||{}),function(){function e(e){this.logger=e,this.asymmetricKeys=new Oj(this.logger,mj.asymmetricKeys),this.symmetricKeys=new Oj(this.logger,mj.symmetricKeys)}return e.prototype.clear=function(){return wN(this,void 0,void 0,(function(){var e;return xN(this,(function(t){switch(t.label){case 0:this.asymmetricKeys.clearInMemory(),this.symmetricKeys.clearInMemory(),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.asymmetricKeys.clearPersistent()];case 2:return t.sent(),[2,!0];case 3:return(e=t.sent())instanceof Error?this.logger.error("Clearing keystore failed with error: "+e.message):this.logger.error("Clearing keystore failed with unknown error"),[2,!1];case 4:return[2]}}))}))},e}()),Dj=function(){function e(e,t,r){this.logger=e,this.browserCrypto=new Mj(this.logger,r),this.b64Encode=new Cj,this.b64Decode=new Sj,this.guidGenerator=new wj(this.browserCrypto),this.pkceGenerator=new Ej(this.browserCrypto),this.cache=new Lj(this.logger),this.performanceClient=t}return e.prototype.createNewGuid=function(){return this.guidGenerator.generateGuid()},e.prototype.base64Encode=function(e){return this.b64Encode.encode(e)},e.prototype.base64Decode=function(e){return this.b64Decode.decode(e)},e.prototype.generatePkceCodes=function(){return wN(this,void 0,void 0,(function(){return xN(this,(function(e){return[2,this.pkceGenerator.generateCodes()]}))}))},e.prototype.getPublicKeyThumbprint=function(t){var r;return wN(this,void 0,void 0,(function(){var n,i,o,a,s;return xN(this,(function(l){switch(l.label){case 0:return n=null==(r=this.performanceClient)?void 0:r.startMeasurement(RF.CryptoOptsGetPublicKeyThumbprint,t.correlationId),[4,this.browserCrypto.generateKeyPair(e.EXTRACTABLE,e.POP_KEY_USAGES)];case 1:return i=l.sent(),[4,this.browserCrypto.exportJwk(i.publicKey)];case 2:return a={e:(a=l.sent()).e,kty:a.kty,n:a.n},a=xj.getSortedObjectString(a),[4,this.hashString(a)];case 3:return o=l.sent(),[4,this.browserCrypto.exportJwk(i.privateKey)];case 4:return a=l.sent(),[4,this.browserCrypto.importJwk(a,!1,["sign"])];case 5:return s=l.sent(),[4,this.cache.asymmetricKeys.setItem(o,{privateKey:s,publicKey:i.publicKey,requestMethod:t.resourceRequestMethod,requestUri:t.resourceRequestUri})];case 6:return l.sent(),n&&n.endMeasurement({success:!0}),[2,o]}}))}))},e.prototype.removeTokenBindingKey=function(e){return wN(this,void 0,void 0,(function(){return xN(this,(function(t){switch(t.label){case 0:return[4,this.cache.asymmetricKeys.removeItem(e)];case 1:return t.sent(),[4,this.cache.asymmetricKeys.containsKey(e)];case 2:return[2,!t.sent()]}}))}))},e.prototype.clearKeystore=function(){return wN(this,void 0,void 0,(function(){return xN(this,(function(e){switch(e.label){case 0:return[4,this.cache.clear()];case 1:return[2,e.sent()]}}))}))},e.prototype.signJwt=function(e,t,r){var n;return wN(this,void 0,void 0,(function(){var i,o,a,s,l,c;return xN(this,(function(u){switch(u.label){case 0:return i=null==(n=this.performanceClient)?void 0:n.startMeasurement(RF.CryptoOptsSignJwt,r),[4,this.cache.asymmetricKeys.getItem(t)];case 1:if(o=u.sent())return[4,this.browserCrypto.exportJwk(o.publicKey)];throw MU.createSigningKeyNotFoundInStorageError(t);case 2:return l=u.sent(),a=xj.getSortedObjectString(l),s=this.b64Encode.urlEncode(JSON.stringify({kid:t})),s=DB.getShrHeaderString({kid:s,alg:l.alg}),l=this.b64Encode.urlEncode(s),e.cnf={jwk:JSON.parse(a)},s=this.b64Encode.urlEncode(JSON.stringify(e)),a=l+"."+s,l=xj.stringToArrayBuffer(a),[4,this.browserCrypto.sign(o.privateKey,l)];case 3:return s=u.sent(),l=this.b64Encode.urlEncodeArr(new Uint8Array(s)),c=a+"."+l,i&&i.endMeasurement({success:!0}),[2,c]}}))}))},e.prototype.hashString=function(e){return wN(this,void 0,void 0,(function(){var t;return xN(this,(function(r){switch(r.label){case 0:return[4,this.browserCrypto.sha256Digest(e)];case 1:return t=r.sent(),t=new Uint8Array(t),[2,this.b64Encode.urlEncodeArr(t)]}}))}))},e.POP_KEY_USAGES=["sign","verify"],e.EXTRACTABLE=!0,e}(),Nj=function(){function e(t,r){this.correlationId=r,this.measureName=e.makeMeasureName(t,r),this.startMark=e.makeStartMark(t,r),this.endMark=e.makeEndMark(t,r)}return e.makeMeasureName=function(e,t){return"msal.measure."+e+"."+t},e.makeStartMark=function(e,t){return"msal.start."+e+"."+t},e.makeEndMark=function(e,t){return"msal.end."+e+"."+t},e.supportsBrowserPerformance=function(){return"undefined"!=typeof window&&void 0!==window.performance&&"function"==typeof window.performance.mark&&"function"==typeof window.performance.measure&&"function"==typeof window.performance.clearMarks&&"function"==typeof window.performance.clearMeasures&&"function"==typeof window.performance.getEntriesByName},e.flushMeasurements=function(t,r){if(e.supportsBrowserPerformance())try{r.forEach((function(r){r=e.makeMeasureName(r.name,t),0<window.performance.getEntriesByName(r,"measure").length&&(window.performance.clearMeasures(r),window.performance.clearMarks(e.makeStartMark(r,t)),window.performance.clearMarks(e.makeEndMark(r,t)))}))}catch(r){}},e.prototype.startMeasurement=function(){if(e.supportsBrowserPerformance())try{window.performance.mark(this.startMark)}catch(Hj){}},e.prototype.endMeasurement=function(){if(e.supportsBrowserPerformance())try{window.performance.mark(this.endMark),window.performance.measure(this.measureName,this.startMark,this.endMark)}catch(Hj){}},e.prototype.flushMeasurement=function(){if(e.supportsBrowserPerformance())try{var t,r=window.performance.getEntriesByName(this.measureName,"measure");if(0<r.length)return t=r[0].duration,window.performance.clearMeasures(this.measureName),window.performance.clearMarks(this.startMark),window.performance.clearMarks(this.endMark),t}catch(t){}return null},e}(),zj=function(e){function t(t,r,n,i,o,a,s){return(t=e.call(this,t,r,n,i,o,a)||this).browserCrypto=new Mj(t.logger,s),t.guidGenerator=new wj(t.browserCrypto),t}return vN(t,e),t.prototype.startPerformanceMeasuremeant=function(e,t){return new Nj(e,t)},t.prototype.generateId=function(){return this.guidGenerator.generateGuid()},t.prototype.getPageVisibility=function(){var e;return(null==(e=document.visibilityState)?void 0:e.toString())||null},t.prototype.deleteIncompleteSubMeasurements=function(e){var t=this.eventsByCorrelationId.get(e.event.correlationId),r=t&&t.eventId===e.event.eventId,n=[];r&&null!=t&&t.incompleteSubMeasurements&&t.incompleteSubMeasurements.forEach((function(e){n.push(_N({},e))})),0<n.length&&Nj.flushMeasurements(e.event.correlationId,n)},t.prototype.supportsBrowserPerformanceNow=function(){return"undefined"!=typeof window&&void 0!==window.performance&&"function"==typeof window.performance.now},t.prototype.startMeasurement=function(t,r){var n=this,i=this.getPageVisibility(),o=e.prototype.startMeasurement.call(this,t,r);return _N(_N({},o),{endMeasurement:function(e){return e=o.endMeasurement(_N({startPageVisibility:i,endPageVisibility:n.getPageVisibility()},e)),n.deleteIncompleteSubMeasurements(o),e},discardMeasurement:function(){o.discardMeasurement(),n.deleteIncompleteSubMeasurements(o),o.measurement.flushMeasurement()}})},t.prototype.setPreQueueTime=function(e,t){var r;this.supportsBrowserPerformanceNow()?t?((r=this.preQueueTimeByCorrelationId.get(t))&&(this.logger.trace("BrowserPerformanceClient: Incomplete pre-queue "+r.name+" found",t),this.addQueueMeasurement(r.name,t,void 0,!0)),this.preQueueTimeByCorrelationId.set(t,{name:e,time:window.performance.now()})):this.logger.trace("BrowserPerformanceClient: correlationId for "+e+" not provided, unable to set telemetry queue time"):this.logger.trace("BrowserPerformanceClient: window performance API not available, unable to set telemetry queue time for "+e)},t.prototype.addQueueMeasurement=function(t,r,n,i){if(this.supportsBrowserPerformanceNow())if(r){var o,a=e.prototype.getPreQueueTime.call(this,t,r);if(a)return o=window.performance.now(),n=n||e.prototype.calculateQueuedTime.call(this,a,o),e.prototype.addQueueMeasurement.call(this,t,r,n,i)}else this.logger.trace("BrowserPerformanceClient: correlationId for "+t+" not provided, unable to add queue measurement");else this.logger.trace("BrowserPerformanceClient: window performance API not available, unable to add queue measurement for "+t)},t}(zB),Fj=function(){function e(e,t,r,n){this.isBrowserEnvironment="undefined"!=typeof window,this.config=e,this.storage=t,this.logger=r,this.cryptoObj=n}return e.prototype.loadExternalTokens=function(e,t,r){if(this.logger.info("TokenCache - loadExternalTokens called"),!t.id_token)throw MU.createUnableToLoadTokenError("Please ensure server response includes id token.");var n=new _F(t.id_token,this.cryptoObj);if(e.account)var i=this.loadAccount(n,e.account.environment,void 0,void 0,e.account.homeAccountId),o=new XF(i,this.loadIdToken(n,i.homeAccountId,e.account.environment,e.account.tenantId),this.loadAccessToken(e,t,i.homeAccountId,e.account.environment,e.account.tenantId,r),this.loadRefreshToken(e,t,i.homeAccountId,e.account.environment));else{if(!e.authority)throw MU.createUnableToLoadTokenError("Please provide a request with an account or a request with authority.");var a=IB.generateAuthority(e.authority,e.azureCloudOptions),s={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache};a=new IB(a,this.config.system.networkClient,this.storage,s,this.logger);if(r.clientInfo)this.logger.trace("TokenCache - homeAccountId from options"),i=this.loadAccount(n,a.hostnameAndPort,r.clientInfo,a.authorityType);else{if(!t.client_info)throw MU.createUnableToLoadTokenError("Please provide clientInfo in the response or options.");this.logger.trace("TokenCache - homeAccountId from response"),i=this.loadAccount(n,a.hostnameAndPort,t.client_info,a.authorityType)}o=new XF(i,this.loadIdToken(n,i.homeAccountId,a.hostnameAndPort,a.tenant),this.loadAccessToken(e,t,i.homeAccountId,a.hostnameAndPort,a.tenant,r),this.loadRefreshToken(e,t,i.homeAccountId,a.hostnameAndPort))}return this.generateAuthenticationResult(e,n,o,a)},e.prototype.loadAccount=function(e,t,r,n,i){var o;if(i?o=i:void 0!==n&&r&&(o=vF.generateHomeAccountId(r,n,this.logger,this.cryptoObj,e)),!o)throw MU.createUnableToLoadTokenError("Unexpected missing homeAccountId");if(i=r?vF.createAccount(r,o,e,void 0,void 0,void 0,t):vF.createGenericAccount(o,e,void 0,void 0,void 0,t),this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading account"),this.storage.setAccount(i),i;throw MU.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},e.prototype.loadIdToken=function(e,t,r,n){if(t=qF.createIdTokenEntity(t,r,e.rawToken,this.config.auth.clientId,n),this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading id token"),this.storage.setIdTokenCredential(t),t;throw MU.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},e.prototype.loadAccessToken=function(e,t,r,n,i,o){if(!t.access_token)return this.logger.verbose("TokenCache - No access token provided for caching"),null;if(!t.expires_in)throw MU.createUnableToLoadTokenError("Please ensure server response includes expires_in value.");if(!o.extendedExpiresOn)throw MU.createUnableToLoadTokenError("Please provide an extendedExpiresOn value in the options.");e=new mF(e.scopes).printScopes();var a=o.expiresOn||t.expires_in+(new Date).getTime()/1e3;o=o.extendedExpiresOn,r=VF.createAccessTokenEntity(r,n,t.access_token,this.config.auth.clientId,i,e,a,o,this.cryptoObj);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading access token"),this.storage.setAccessTokenCredential(r),r;throw MU.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},e.prototype.loadRefreshToken=function(e,t,r,n){if(!t.refresh_token)return this.logger.verbose("TokenCache - No refresh token provided for caching"),null;if(r=GF.createRefreshTokenEntity(r,n,t.refresh_token,this.config.auth.clientId),this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading refresh token"),this.storage.setRefreshTokenCredential(r),r;throw MU.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},e.prototype.generateAuthenticationResult=function(e,t,r,n){var i,o=ez.EMPTY_STRING,a=[],s=null,l=(null!=r&&r.accessToken&&(o=r.accessToken.secret,a=mF.fromString(r.accessToken.target).asArray(),s=new Date(1e3*Number(r.accessToken.expiresOn)),i=new Date(1e3*Number(r.accessToken.extendedExpiresOn))),(null==t?void 0:t.claims.oid)||(null==t?void 0:t.claims.sub)||ez.EMPTY_STRING),c=(null==t?void 0:t.claims.tid)||ez.EMPTY_STRING;return{authority:n?n.canonicalAuthority:ez.EMPTY_STRING,uniqueId:l,tenantId:c,scopes:a,account:null!=r&&r.account?r.account.getAccountInfo():null,idToken:t?t.rawToken:ez.EMPTY_STRING,idTokenClaims:t?t.claims:{},accessToken:o,fromCache:!0,expiresOn:s,correlationId:e.correlationId||ez.EMPTY_STRING,requestId:ez.EMPTY_STRING,extExpiresOn:i,familyId:ez.EMPTY_STRING,tokenType:(null==(n=null==r?void 0:r.accessToken)?void 0:n.tokenType)||ez.EMPTY_STRING,state:ez.EMPTY_STRING,cloudGraphHostName:(null==(l=null==r?void 0:r.account)?void 0:l.cloudGraphHostName)||ez.EMPTY_STRING,msGraphHost:(null==(c=null==r?void 0:r.account)?void 0:c.msGraphHost)||ez.EMPTY_STRING,code:void 0,fromNativeBroker:!1}},e}(),Bj=function(e){function t(t){return(t=e.call(this,t)||this).includeRedirectUri=!1,t}return vN(t,e),t}(oB),Uj=function(e){function t(t,r,n,i,o,a,s,l,c,u){return(t=e.call(this,t,r,n,i,o,a,l,c,u)||this).apiId=s,t}return vN(t,e),t.prototype.acquireToken=function(e){return wN(this,void 0,void 0,(function(){var t,r,n,i;return xN(this,(function(o){switch(o.label){case 0:if(this.logger.trace("SilentAuthCodeClient.acquireToken called"),e.code)return this.performanceClient.setPreQueueTime(RF.StandardInteractionClientInitializeAuthorizationRequest,e.correlationId),[4,this.initializeAuthorizationRequest(e,bB.Silent)];throw MU.createAuthCodeRequiredError();case 1:t=o.sent(),this.browserStorage.updateCacheEntries(t.state,t.nonce,t.authority,t.loginHint||ez.EMPTY_STRING,t.account||null),r=this.initializeServerTelemetryManager(this.apiId),o.label=2;case 2:return o.trys.push([2,4,,5]),n=_N(_N({},t),{code:e.code}),this.performanceClient.setPreQueueTime(RF.StandardInteractionClientGetClientConfiguration,e.correlationId),[4,this.getClientConfiguration(r,t.authority)];case 3:return i=o.sent(),i=new Bj(i),this.logger.verbose("Auth code client created"),[2,new gj(i,this.browserStorage,n,this.logger,this.config.system,this.performanceClient).handleCodeResponseFromServer({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},t.state,i.authority,this.networkClient,!1)];case 4:throw(i=o.sent())instanceof fz&&i.setCorrelationId(this.correlationId),r.cacheFailedRequest(i),this.browserStorage.cleanRequestByState(t.state),i;case 5:return[2]}}))}))},t.prototype.logout=function(){return Promise.reject(MU.createSilentLogoutUnsupportedError())},t}(nj),jj=function(){function e(e){this.isBrowserEnvironment="undefined"!=typeof window,this.config=function(e,t){var r=e.auth,n=e.cache,i=e.system,o=(e=e.telemetry,{clientId:ez.EMPTY_STRING,authority:""+ez.DEFAULT_AUTHORITY,knownAuthorities:[],cloudDiscoveryMetadata:ez.EMPTY_STRING,authorityMetadata:ez.EMPTY_STRING,redirectUri:ez.EMPTY_STRING,postLogoutRedirectUri:ez.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:cB.AAD,azureCloudOptions:{azureCloudInstance:QN.None,tenant:ez.EMPTY_STRING},skipAuthorityMetadataCache:!1}),a={cacheLocation:fB.SessionStorage,temporaryCacheLocation:fB.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!(!n||n.cacheLocation!==fB.LocalStorage),claimsBasedCachingEnabled:!0},s={loggerCallback:function(){},logLevel:XN.Info,piiLoggingEnabled:!1};return t=_N(_N({},xF),{loggerOptions:s,networkClient:t?tj.getBrowserNetworkClient():MB,navigationClient:new pj,loadFrameTimeout:0,windowHashTimeout:(null==i?void 0:i.loadFrameTimeout)||6e4,iframeHashTimeout:(null==i?void 0:i.loadFrameTimeout)||fj,navigateFrameWait:t&&tj.detectIEOrEdge()?500:0,redirectNavigationTimeout:3e4,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:(null==i?void 0:i.nativeBrokerHandshakeTimeout)||2e3,pollIntervalMilliseconds:NU,cryptoOptions:{useMsrCrypto:!1,entropy:void 0}}),i=_N(_N({},i),{loggerOptions:(null==i?void 0:i.loggerOptions)||s}),s={application:{appName:ez.EMPTY_STRING,appVersion:ez.EMPTY_STRING}},{auth:_N(_N({},o),r),cache:_N(_N({},a),n),system:_N(_N({},t),i),telemetry:_N(_N({},s),e)}}(e,this.isBrowserEnvironment),this.initialized=!1,this.logger=new uF(this.config.system.loggerOptions,XU,QU),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.isBrowserEnvironment?new zj(this.config.auth.clientId,this.config.auth.authority,this.logger,XU,QU,this.config.telemetry.application,this.config.system.cryptoOptions):new BB(this.config.auth.clientId,this.config.auth.authority,this.logger,XU,QU,this.config.telemetry.application),this.browserCrypto=this.isBrowserEnvironment?new Dj(this.logger,this.performanceClient,this.config.system.cryptoOptions):mz,this.eventHandler=new _j(this.logger,this.browserCrypto),this.browserStorage=this.isBrowserEnvironment?new YU(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger):function(e,t){var r={cacheLocation:fB.MemoryStorage,temporaryCacheLocation:fB.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!0};return new YU(e,r,mz,t)}(this.config.auth.clientId,this.logger),e={cacheLocation:fB.MemoryStorage,temporaryCacheLocation:fB.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!0},this.nativeInternalStorage=new YU(this.config.auth.clientId,e,this.browserCrypto,this.logger),this.tokenCache=new Fj(this.config,this.browserStorage,this.logger,this.browserCrypto),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}return e.prototype.initialize=function(){return wN(this,void 0,void 0,(function(){var e,t,r,n,i;return xN(this,(function(o){switch(o.label){case 0:if(this.logger.trace("initialize called"),this.initialized)return this.logger.info("initialize has already been called, exiting early."),[2];if(e=this.config.system.allowNativeBroker,t=this.performanceClient.startMeasurement(RF.InitializeClientApplication),this.eventHandler.emitEvent(SB.INITIALIZE_START),!e)return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),r=this,[4,uj.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient)];case 2:return r.nativeExtensionProvider=o.sent(),[3,4];case 3:return n=o.sent(),this.logger.verbose(n),[3,4];case 4:return this.config.cache.claimsBasedCachingEnabled?[3,6]:(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),i=this.performanceClient.startMeasurement(RF.ClearTokensAndKeysWithClaims),[4,this.browserStorage.clearTokensAndKeysWithClaims()]);case 5:o.sent(),i.endMeasurement({success:!0}),o.label=6;case 6:return this.initialized=!0,this.eventHandler.emitEvent(SB.INITIALIZE_END),t.endMeasurement({allowNativeBroker:e,success:!0}),[2]}}))}))},e.prototype.handleRedirectPromise=function(e){return wN(this,void 0,void 0,(function(){var t,r,n,i,o,a=this;return xN(this,(function(s){return this.logger.verbose("handleRedirectPromise called"),tj.blockNativeBrokerCalledBeforeInitialized(this.config.system.allowNativeBroker,this.initialized),t=this.getAllAccounts(),this.isBrowserEnvironment?(r=e||ez.EMPTY_STRING,void 0===(n=this.redirectResponse.get(r))?(this.eventHandler.emitEvent(SB.HANDLE_REDIRECT_START,bB.Redirect),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise"),o=this.browserStorage.getCachedNativeRequest(),i=void 0,i=o&&uj.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!e?(this.logger.trace("handleRedirectPromise - acquiring token from native platform"),new cj(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,_B.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,o.accountId,this.nativeInternalStorage,o.correlationId).handleRedirectPromise()):(this.logger.trace("handleRedirectPromise - acquiring token from web flow"),o=this.browserStorage.getTemporaryCache(gB.CORRELATION_ID,!0)||ez.EMPTY_STRING,this.createRedirectClient(o).handleRedirectPromise(e)),n=i.then((function(e){return e&&(t.length<a.getAllAccounts().length?(a.eventHandler.emitEvent(SB.LOGIN_SUCCESS,bB.Redirect,e),a.logger.verbose("handleRedirectResponse returned result, login success")):(a.eventHandler.emitEvent(SB.ACQUIRE_TOKEN_SUCCESS,bB.Redirect,e),a.logger.verbose("handleRedirectResponse returned result, acquire token success"))),a.eventHandler.emitEvent(SB.HANDLE_REDIRECT_END,bB.Redirect),e})).catch((function(e){throw 0<t.length?a.eventHandler.emitEvent(SB.ACQUIRE_TOKEN_FAILURE,bB.Redirect,null,e):a.eventHandler.emitEvent(SB.LOGIN_FAILURE,bB.Redirect,null,e),a.eventHandler.emitEvent(SB.HANDLE_REDIRECT_END,bB.Redirect),e})),this.redirectResponse.set(r,n)):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),[2,n]):(this.logger.verbose("handleRedirectPromise returns null, not browser environment"),[2,null])}))}))},e.prototype.acquireTokenRedirect=function(e){return wN(this,void 0,void 0,(function(){var t,r,n=this;return xN(this,(function(i){return t=this.getRequestCorrelationId(e),this.logger.verbose("acquireTokenRedirect called",t),this.preflightBrowserEnvironmentCheck(bB.Redirect),(r=0<this.getAllAccounts().length)?this.eventHandler.emitEvent(SB.ACQUIRE_TOKEN_START,bB.Redirect,e):this.eventHandler.emitEvent(SB.LOGIN_START,bB.Redirect,e),[2,(this.nativeExtensionProvider&&this.canUseNative(e)?new cj(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,_B.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireTokenRedirect(e).catch((function(t){if(t instanceof sj&&t.isFatal())return n.nativeExtensionProvider=void 0,n.createRedirectClient(e.correlationId).acquireToken(e);if(t instanceof YF)return n.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),n.createRedirectClient(e.correlationId).acquireToken(e);throw n.browserStorage.setInteractionInProgress(!1),t})):this.createRedirectClient(e.correlationId).acquireToken(e)).catch((function(e){throw r?n.eventHandler.emitEvent(SB.ACQUIRE_TOKEN_FAILURE,bB.Redirect,null,e):n.eventHandler.emitEvent(SB.LOGIN_FAILURE,bB.Redirect,null,e),e}))]}))}))},e.prototype.acquireTokenPopup=function(e){var t=this,r=this.getRequestCorrelationId(e),n=this.performanceClient.startMeasurement(RF.AcquireTokenPopup,r);try{this.logger.verbose("acquireTokenPopup called",r),this.preflightBrowserEnvironmentCheck(bB.Popup)}catch(r){return Promise.reject(r)}var i=this.getAllAccounts();return 0<i.length?this.eventHandler.emitEvent(SB.ACQUIRE_TOKEN_START,bB.Popup,e):this.eventHandler.emitEvent(SB.LOGIN_START,bB.Popup,e),(this.canUseNative(e)?this.acquireTokenNative(e,_B.acquireTokenPopup).then((function(e){return t.browserStorage.setInteractionInProgress(!1),n.endMeasurement({success:!0,isNativeBroker:!0,requestId:e.requestId}),e})).catch((function(r){if(r instanceof sj&&r.isFatal())return t.nativeExtensionProvider=void 0,t.createPopupClient(e.correlationId).acquireToken(e);if(r instanceof YF)return t.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),t.createPopupClient(e.correlationId).acquireToken(e);throw t.browserStorage.setInteractionInProgress(!1),r})):this.createPopupClient(e.correlationId).acquireToken(e)).then((function(e){return i.length<t.getAllAccounts().length?t.eventHandler.emitEvent(SB.LOGIN_SUCCESS,bB.Popup,e):t.eventHandler.emitEvent(SB.ACQUIRE_TOKEN_SUCCESS,bB.Popup,e),n.addStaticFields({accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length}),n.endMeasurement({success:!0,requestId:e.requestId}),e})).catch((function(e){return 0<i.length?t.eventHandler.emitEvent(SB.ACQUIRE_TOKEN_FAILURE,bB.Popup,null,e):t.eventHandler.emitEvent(SB.LOGIN_FAILURE,bB.Popup,null,e),n.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),Promise.reject(e)}))},e.prototype.trackPageVisibilityWithMeasurement=function(){var e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))},e.prototype.ssoSilent=function(e){var t;return wN(this,void 0,void 0,(function(){var r,n,i=this;return xN(this,(function(o){return r=this.getRequestCorrelationId(e),n=_N(_N({},e),{prompt:e.prompt,correlationId:r}),this.preflightBrowserEnvironmentCheck(bB.Silent),this.ssoSilentMeasurement=this.performanceClient.startMeasurement(RF.SsoSilent,r),null!=(t=this.ssoSilentMeasurement)&&t.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",r),this.eventHandler.emitEvent(SB.SSO_SILENT_START,bB.Silent,n),[2,(this.canUseNative(n)?this.acquireTokenNative(n,_B.ssoSilent).catch((function(e){if(e instanceof sj&&e.isFatal())return i.nativeExtensionProvider=void 0,i.createSilentIframeClient(n.correlationId).acquireToken(n);throw e})):this.createSilentIframeClient(n.correlationId).acquireToken(n)).then((function(e){var t;return i.eventHandler.emitEvent(SB.SSO_SILENT_SUCCESS,bB.Silent,e),null!=(t=i.ssoSilentMeasurement)&&t.addStaticFields({accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length}),null!=(t=i.ssoSilentMeasurement)&&t.endMeasurement({success:!0,isNativeBroker:e.fromNativeBroker,requestId:e.requestId}),e})).catch((function(e){var t;throw i.eventHandler.emitEvent(SB.SSO_SILENT_FAILURE,bB.Silent,null,e),null!=(t=i.ssoSilentMeasurement)&&t.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e})).finally((function(){document.removeEventListener("visibilitychange",i.trackPageVisibilityWithMeasurement)}))]}))}))},e.prototype.acquireTokenByCode=function(e){return wN(this,void 0,void 0,(function(){var t,r,n,i,o=this;return xN(this,(function(a){t=this.getRequestCorrelationId(e),this.preflightBrowserEnvironmentCheck(bB.Silent),this.logger.trace("acquireTokenByCode called",t),this.eventHandler.emitEvent(SB.ACQUIRE_TOKEN_BY_CODE_START,bB.Silent,e),r=this.performanceClient.startMeasurement(RF.AcquireTokenByCode,e.correlationId);try{if(e.code&&e.nativeAccountId)throw MU.createSpaCodeAndNativeAccountIdPresentError();if(e.code)return n=e.code,(i=this.hybridAuthCodeResponses.get(n))?(this.logger.verbose("Existing acquireTokenByCode request found",e.correlationId),r.discardMeasurement()):(this.logger.verbose("Initiating new acquireTokenByCode request",t),i=this.acquireTokenByCodeAsync(_N(_N({},e),{correlationId:t})).then((function(e){return o.eventHandler.emitEvent(SB.ACQUIRE_TOKEN_BY_CODE_SUCCESS,bB.Silent,e),o.hybridAuthCodeResponses.delete(n),r.addStaticFields({accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length}),r.endMeasurement({success:!0,isNativeBroker:e.fromNativeBroker,requestId:e.requestId}),e})).catch((function(e){throw o.hybridAuthCodeResponses.delete(n),o.eventHandler.emitEvent(SB.ACQUIRE_TOKEN_BY_CODE_FAILURE,bB.Silent,null,e),r.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e})),this.hybridAuthCodeResponses.set(n,i)),[2,i];if(e.nativeAccountId){if(this.canUseNative(e,e.nativeAccountId))return[2,this.acquireTokenNative(e,_B.acquireTokenByCode,e.nativeAccountId).catch((function(e){throw e instanceof sj&&e.isFatal()&&(o.nativeExtensionProvider=void 0),e}))];throw MU.createUnableToAcquireTokenFromNativePlatformError()}throw MU.createAuthCodeOrNativeAccountIdRequiredError()}catch(a){throw this.eventHandler.emitEvent(SB.ACQUIRE_TOKEN_BY_CODE_FAILURE,bB.Silent,null,a),r.endMeasurement({errorCode:a instanceof fz&&a.errorCode||void 0,subErrorCode:a instanceof fz&&a.subError||void 0,success:!1}),a}return[2]}))}))},e.prototype.acquireTokenByCodeAsync=function(e){var t;return wN(this,void 0,void 0,(function(){var r=this;return xN(this,(function(n){switch(n.label){case 0:return this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(RF.AcquireTokenByCodeAsync,e.correlationId),null!=(t=this.acquireTokenByCodeAsyncMeasurement)&&t.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),[4,this.createSilentAuthCodeClient(e.correlationId).acquireToken(e).then((function(e){var t;return null!=(t=r.acquireTokenByCodeAsyncMeasurement)&&t.endMeasurement({success:!0,fromCache:e.fromCache,isNativeBroker:e.fromNativeBroker,requestId:e.requestId}),e})).catch((function(e){var t;throw null!=(t=r.acquireTokenByCodeAsyncMeasurement)&&t.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e})).finally((function(){document.removeEventListener("visibilitychange",r.trackPageVisibilityWithMeasurement)}))];case 1:return[2,n.sent()]}}))}))},e.prototype.acquireTokenFromCache=function(e,t,r){return wN(this,void 0,void 0,(function(){return xN(this,(function(n){switch(this.performanceClient.addQueueMeasurement(RF.AcquireTokenFromCache,t.correlationId),r.cacheLookupPolicy){case CB.Default:case CB.AccessToken:case CB.AccessTokenAndRefreshToken:return[2,e.acquireToken(t)];default:throw lF.createRefreshRequiredError()}return[2]}))}))},e.prototype.acquireTokenByRefreshToken=function(e,t){return wN(this,void 0,void 0,(function(){var r;return xN(this,(function(n){switch(this.performanceClient.addQueueMeasurement(RF.AcquireTokenByRefreshToken,e.correlationId),t.cacheLookupPolicy){case CB.Default:case CB.AccessTokenAndRefreshToken:case CB.RefreshToken:case CB.RefreshTokenAndNetwork:return r=this.createSilentRefreshClient(e.correlationId),this.performanceClient.setPreQueueTime(RF.SilentRefreshClientAcquireToken,e.correlationId),[2,r.acquireToken(e)];default:throw lF.createRefreshRequiredError()}return[2]}))}))},e.prototype.acquireTokenBySilentIframe=function(e){return wN(this,void 0,void 0,(function(){var t;return xN(this,(function(r){return this.performanceClient.addQueueMeasurement(RF.AcquireTokenBySilentIframe,e.correlationId),t=this.createSilentIframeClient(e.correlationId),this.performanceClient.setPreQueueTime(RF.SilentIframeClientAcquireToken,e.correlationId),[2,t.acquireToken(e)]}))}))},e.prototype.logout=function(e){return wN(this,void 0,void 0,(function(){var t;return xN(this,(function(r){return t=this.getRequestCorrelationId(e),this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),[2,this.logoutRedirect(_N({correlationId:t},e))]}))}))},e.prototype.logoutRedirect=function(e){return wN(this,void 0,void 0,(function(){var t;return xN(this,(function(r){return t=this.getRequestCorrelationId(e),this.preflightBrowserEnvironmentCheck(bB.Redirect),[2,this.createRedirectClient(t).logout(e)]}))}))},e.prototype.logoutPopup=function(e){try{var t=this.getRequestCorrelationId(e);return this.preflightBrowserEnvironmentCheck(bB.Popup),this.createPopupClient(t).logout(e)}catch(e){return Promise.reject(e)}},e.prototype.getAllAccounts=function(){return this.logger.verbose("getAllAccounts called"),this.isBrowserEnvironment?this.browserStorage.getAllAccounts():[]},e.prototype.getAccountByUsername=function(e){var t;return this.logger.trace("getAccountByUsername called"),e?(t=this.browserStorage.getAccountInfoFilteredBy({username:e}))?(this.logger.verbose("getAccountByUsername: Account matching username found, returning"),this.logger.verbosePii("getAccountByUsername: Returning signed-in accounts matching username: "+e),t):(this.logger.verbose("getAccountByUsername: No matching account found, returning null"),null):(this.logger.warning("getAccountByUsername: No username provided"),null)},e.prototype.getAccountByHomeId=function(e){var t;return this.logger.trace("getAccountByHomeId called"),e?(t=this.browserStorage.getAccountInfoFilteredBy({homeAccountId:e}))?(this.logger.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),this.logger.verbosePii("getAccountByHomeId: Returning signed-in accounts matching homeAccountId: "+e),t):(this.logger.verbose("getAccountByHomeId: No matching account found, returning null"),null):(this.logger.warning("getAccountByHomeId: No homeAccountId provided"),null)},e.prototype.getAccountByLocalId=function(e){var t;return this.logger.trace("getAccountByLocalId called"),e?(t=this.browserStorage.getAccountInfoFilteredBy({localAccountId:e}))?(this.logger.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),this.logger.verbosePii("getAccountByLocalId: Returning signed-in accounts matching localAccountId: "+e),t):(this.logger.verbose("getAccountByLocalId: No matching account found, returning null"),null):(this.logger.warning("getAccountByLocalId: No localAccountId provided"),null)},e.prototype.setActiveAccount=function(e){this.browserStorage.setActiveAccount(e)},e.prototype.getActiveAccount=function(){return this.browserStorage.getActiveAccount()},e.prototype.preflightBrowserEnvironmentCheck=function(e,t){if(void 0===t&&(t=!0),this.logger.verbose("preflightBrowserEnvironmentCheck started"),tj.blockNonBrowserEnvironment(this.isBrowserEnvironment),tj.blockRedirectInIframe(e,this.config.system.allowRedirectInIframe),tj.blockReloadInHiddenIframes(),tj.blockAcquireTokenInPopups(),tj.blockNativeBrokerCalledBeforeInitialized(this.config.system.allowNativeBroker,this.initialized),e===bB.Redirect&&this.config.cache.cacheLocation===fB.MemoryStorage&&!this.config.cache.storeAuthStateInCookie)throw KU.createInMemoryRedirectUnavailableError();e!==bB.Redirect&&e!==bB.Popup||this.preflightInteractiveRequest(t)},e.prototype.preflightInteractiveRequest=function(e){this.logger.verbose("preflightInteractiveRequest called, validating app environment"),tj.blockReloadInHiddenIframes(),e&&this.browserStorage.setInteractionInProgress(!0)},e.prototype.acquireTokenNative=function(e,t,r){return wN(this,void 0,void 0,(function(){return xN(this,(function(n){if(this.logger.trace("acquireTokenNative called"),this.nativeExtensionProvider)return[2,new cj(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.nativeExtensionProvider,r||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e)];throw MU.createNativeConnectionNotEstablishedError()}))}))},e.prototype.canUseNative=function(e,t){if(this.logger.trace("canUseNative called"),!uj.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case nz.NONE:case nz.CONSENT:case nz.LOGIN:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace("canUseNative: prompt = "+e.prompt+" is not compatible with native flow, returning false"),!1}return!(!t&&!this.getNativeAccountId(e)&&(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),1))},e.prototype.getNativeAccountId=function(e){return(e=e.account||this.browserStorage.getAccountInfoByHints(e.loginHint,e.sid)||this.getActiveAccount())&&e.nativeAccountId||""},e.prototype.createPopupClient=function(e){return new dj(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)},e.prototype.createRedirectClient=function(e){return new hj(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)},e.prototype.createSilentIframeClient=function(e){return new yj(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,_B.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)},e.prototype.createSilentCacheClient=function(e){return new lj(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)},e.prototype.createSilentRefreshClient=function(e){return new vj(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)},e.prototype.createSilentAuthCodeClient=function(e){return new Uj(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,_B.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,e)},e.prototype.addEventCallback=function(e){return this.eventHandler.addEventCallback(e)},e.prototype.removeEventCallback=function(e){this.eventHandler.removeEventCallback(e)},e.prototype.addPerformanceCallback=function(e){return this.performanceClient.addPerformanceCallback(e)},e.prototype.removePerformanceCallback=function(e){return this.performanceClient.removePerformanceCallback(e)},e.prototype.enableAccountStorageEvents=function(){this.eventHandler.enableAccountStorageEvents()},e.prototype.disableAccountStorageEvents=function(){this.eventHandler.disableAccountStorageEvents()},e.prototype.getTokenCache=function(){return this.tokenCache},e.prototype.getLogger=function(){return this.logger},e.prototype.setLogger=function(e){this.logger=e},e.prototype.initializeWrapperLibrary=function(e,t){this.browserStorage.setWrapperMetadata(e,t)},e.prototype.setNavigationClient=function(e){this.navigationClient=e},e.prototype.getConfiguration=function(){return this.config},e.prototype.getRequestCorrelationId=function(e){return null!=e&&e.correlationId?e.correlationId:this.isBrowserEnvironment?this.browserCrypto.createNewGuid():ez.EMPTY_STRING},e}(),qj=function(e){function t(t){return(t=e.call(this,t)||this).astsAsyncMeasurement=void 0,t.activeSilentTokenRequests=new Map,t.trackPageVisibility=t.trackPageVisibility.bind(t),t}return vN(t,e),t.prototype.loginRedirect=function(e){return wN(this,void 0,void 0,(function(){var t;return xN(this,(function(r){return t=this.getRequestCorrelationId(e),this.logger.verbose("loginRedirect called",t),[2,this.acquireTokenRedirect(_N({correlationId:t},e||jU))]}))}))},t.prototype.loginPopup=function(e){var t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup(_N({correlationId:t},e||jU))},t.prototype.acquireTokenSilent=function(e){return wN(this,void 0,void 0,(function(){var t,r,n,i,o,a=this;return xN(this,(function(s){if(t=this.getRequestCorrelationId(e),(r=this.performanceClient.startMeasurement(RF.AcquireTokenSilent,t)).addStaticFields({cacheLookupPolicy:e.cacheLookupPolicy}),this.preflightBrowserEnvironmentCheck(bB.Silent),this.logger.verbose("acquireTokenSilent called",t),o=e.account||this.getActiveAccount())return i={clientId:this.config.auth.clientId,authority:e.authority||ez.EMPTY_STRING,scopes:e.scopes,homeAccountIdentifier:o.homeAccountId,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid},n=JSON.stringify(i),void 0===(i=this.activeSilentTokenRequests.get(n))?(this.logger.verbose("acquireTokenSilent called for the first time, storing active request",t),this.performanceClient.setPreQueueTime(RF.AcquireTokenSilentAsync,t),o=this.acquireTokenSilentAsync(_N(_N({},e),{correlationId:t}),o).then((function(t){return a.activeSilentTokenRequests.delete(n),r.addStaticFields({accessTokenSize:t.accessToken.length,idTokenSize:t.idToken.length}),r.endMeasurement({success:!0,fromCache:t.fromCache,isNativeBroker:t.fromNativeBroker,cacheLookupPolicy:e.cacheLookupPolicy,requestId:t.requestId}),t})).catch((function(e){throw a.activeSilentTokenRequests.delete(n),r.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e})),this.activeSilentTokenRequests.set(n,o),[2,o]):(this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",t),r.discardMeasurement(),[2,i]);throw MU.createNoAccountError()}))}))},t.prototype.trackPageVisibility=function(){this.astsAsyncMeasurement&&(this.logger.info("Perf: Visibility change detected"),this.astsAsyncMeasurement.increment({visibilityChangeCount:1}))},t.prototype.acquireTokenSilentAsync=function(e,t){var r;return wN(this,void 0,void 0,(function(){var n,i,o,a,s=this;return xN(this,(function(l){switch(l.label){case 0:return this.performanceClient.addQueueMeasurement(RF.AcquireTokenSilentAsync,e.correlationId),this.eventHandler.emitEvent(SB.ACQUIRE_TOKEN_START,bB.Silent,e),this.astsAsyncMeasurement=this.performanceClient.startMeasurement(RF.AcquireTokenSilentAsync,e.correlationId),null!=(r=this.astsAsyncMeasurement)&&r.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibility),uj.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme)&&t.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),n=_N(_N({},e),{account:t}),n=this.acquireTokenNative(n,_B.acquireTokenSilent_silentFlow).catch((function(t){return wN(s,void 0,void 0,(function(){return xN(this,(function(r){if(t instanceof sj&&t.isFatal())return this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,[2,this.createSilentIframeClient(e.correlationId).acquireToken(e)];throw t}))}))})),[3,3]):[3,1];case 1:return this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),i=this.createSilentCacheClient(e.correlationId),this.performanceClient.setPreQueueTime(RF.InitializeSilentRequest,e.correlationId),[4,i.initializeSilentRequest(e,t)];case 2:o=l.sent(),a=_N(_N({},e),{cacheLookupPolicy:e.cacheLookupPolicy||CB.Default}),this.performanceClient.setPreQueueTime(RF.AcquireTokenFromCache,o.correlationId),n=this.acquireTokenFromCache(i,o,a).catch((function(t){if(a.cacheLookupPolicy===CB.AccessToken)throw t;return tj.blockReloadInHiddenIframes(),s.eventHandler.emitEvent(SB.ACQUIRE_TOKEN_NETWORK_START,bB.Silent,o),s.performanceClient.setPreQueueTime(RF.AcquireTokenByRefreshToken,o.correlationId),s.acquireTokenByRefreshToken(o,a).catch((function(t){var r=t instanceof DF,n=t instanceof YF,i=t.errorCode===WF.code,l=t.errorCode===RU;if(r&&l&&!n&&a.cacheLookupPolicy!==CB.AccessTokenAndRefreshToken&&a.cacheLookupPolicy!==CB.RefreshToken||a.cacheLookupPolicy===CB.Skip||i)return s.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",e.correlationId),s.performanceClient.setPreQueueTime(RF.AcquireTokenBySilentIframe,o.correlationId),s.acquireTokenBySilentIframe(o);throw t}))})),l.label=3;case 3:return[2,n.then((function(e){var t;return s.eventHandler.emitEvent(SB.ACQUIRE_TOKEN_SUCCESS,bB.Silent,e),null!=(t=s.astsAsyncMeasurement)&&t.endMeasurement({success:!0,fromCache:e.fromCache,isNativeBroker:e.fromNativeBroker,requestId:e.requestId}),e})).catch((function(e){var t;throw s.eventHandler.emitEvent(SB.ACQUIRE_TOKEN_FAILURE,bB.Silent,null,e),null!=(t=s.astsAsyncMeasurement)&&t.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e})).finally((function(){document.removeEventListener("visibilitychange",s.trackPageVisibility)}))]}}))}))},t}(jj);function Hj(e){this.message=e}Hj.prototype=new Error,Hj.prototype.name="InvalidCharacterError";var Vj="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new Hj("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,n,i=0,o=0,a="";n=t.charAt(o++);~n&&(r=i%4?64*r+n:n,i++%4)&&(a+=String.fromCharCode(255&r>>(-2*i&6))))n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n);return a};function Gj(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return decodeURIComponent(Vj(t).replace(/(.)/g,(function(e,t){return"%"+((t=t.charCodeAt(0).toString(16).toUpperCase()).length<2?"0"+t:t)})))}catch(e){return Vj(t)}}function Kj(e){this.message=e}function Zj(e,t){if("string"!=typeof e)throw new Kj("Invalid token specified");t=!0===(t=t||{}).header?0:1;try{return JSON.parse(Gj(e.split(".")[t]))}catch(e){throw new Kj("Invalid token specified: "+e.message)}}Kj.prototype=new Error,Kj.prototype.name="InvalidTokenError";var Wj=function(){function e(t){var r=this,n=(this.fallbackStorage={},this._triggerTokenFetch=function(t){return void 0===t&&(t=!1),new Promise((function(n,i){"function"!=typeof r.options.getToken?i(new Error("Token cannot be ".concat(t?"fetched":"renewed"," because getToken was not set or is not a function."))):r.options.getToken((function(t){try{var o=r._getTokenExpiry(t)-e.constants.tokenRefreshClockSkew;r._storeToken(t),r._setTimeoutTokenFetch(o),n()}catch(t){i(new Error("Invalid token returned by getToken function"))}}),(function(e){i(e)}),r.map)}))},this._setTimeoutTokenFetch=function(e){clearTimeout(r.tokenTimeOutHandle),r.tokenTimeOutHandle=setTimeout(r._triggerTokenFetch,Math.min(1e3*e,2147483647))},t.getServiceOptions());this.options=n.authOptions,this.sessionId=n.sessionId,this.map=t}return e.prototype.initialize=function(){var t=this;return this.initPromise||(this.initPromise=new Promise((function(r,n){if(t.options.authType===lr.subscriptionKey)r();else if(t.options.authType===lr.aad)t.options.authContext=t.options.authContext||e.getDefaultAuthContext(t.options),t.options.authContext.handleRedirectPromise().then((function(){setTimeout((function(){return t._loginAndAcquireTokenForAAD(r,n)}))})).catch((function(e){n(new Error("Error logging in the AAD users: "+e))}));else if(t.options.authType===lr.anonymous)r(t._triggerTokenFetch(!0));else if(t.options.authType===lr.sas){if(t.options.sasToken){var i=-1;try{i=t._getTokenExpiry(t.options.sasToken)}catch(r){return void n(new Error("An invalid sasToken was provided."))}if(i>e.constants.tokenRefreshClockSkew)return t._storeToken(t.options.sasToken),t._setTimeoutTokenFetch(i-e.constants.tokenRefreshClockSkew),void r()}r(t._triggerTokenFetch())}else n(new Error("An invalid authentication type was specified."))}))),this.initPromise},e.prototype.dispose=function(){this.tokenTimeOutHandle&&(clearTimeout(this.tokenTimeOutHandle),this.tokenTimeOutHandle=null)},e.getDefaultAuthContext=function(e){if(!e.aadAppId)throw new Error("No AAD app ID was specified.");if(e.aadTenant)return this.defaultAuthContext||(this.defaultAuthContext=new qj({auth:{authority:"".concat(e.aadInstance||vr).concat(e.aadTenant),clientId:e.aadAppId},cache:{cacheLocation:this.constants.preferredCacheLocation}})),this.defaultAuthContext;throw new Error("No AAD tenant was specified.")},e.prototype._loginAndAcquireTokenForAAD=function(e,t){var r=(null==(r=this.options.authContext)?void 0:r.getAllAccounts())||[];0===r.length?(this.options.authContext.loginRedirect(),e()):(this.options.authContext.setActiveAccount(r[0]),this._acquireTokenForAAD(e,t))},e.prototype._acquireTokenForAAD=function(t,r){var n=this,i={scopes:[zr]};this.options.authContext.acquireTokenSilent(i).then((function(r){n._saveItem(e.constants.storage.tokenKey,r.accessToken);var i={map:n.map,type:e.constants.events.tokenAcquired};n.map.events.invoke(e.constants.events.tokenAcquired,i),clearTimeout(n.tokenTimeOutHandle),i=new Date(r.expiresOn).getTime()-Date.now();n.tokenTimeOutHandle=setTimeout((function(){return n._acquireTokenForAAD()}),i),null!=t&&t()})).catch((function(e){if(e instanceof YF)return n.options.authContext.acquireTokenRedirect(i),null==t?void 0:t();null!=r&&r(e)}))},e.prototype.getAuthType=function(){return this.options.authType},e.prototype.getClientId=function(){return this.options.clientId},e.prototype.getToken=function(){if(this.options.authType===lr.aad)return this._getItem(e.constants.storage.tokenKey);if(this.options.authType!==lr.anonymous&&this.options.authType!==lr.sas)return this.options.authType===lr.subscriptionKey?this.options.subscriptionKey:void 0;var t=this._getItem(e.constants.storage.tokenKey);if(t){var r=this._getTokenExpiry(t);if(r<300&&0<r)this._triggerTokenFetch();else if(r<=0)throw this._saveItem(e.constants.storage.tokenKey,""),new Error(e.constants.errors.tokenExpired)}else this._triggerTokenFetch();return t},e.prototype._getTokenExpiry=function(e){e=Zj(e).exp;var t=this._getCurrentTime();return 0<e-t?e-t:-1},e.prototype._storeToken=function(t){this._saveItem(e.constants.storage.tokenKey,t),t={map:this.map,type:e.constants.events.tokenAcquired},this.map.events.invoke(e.constants.events.tokenAcquired,t)},e.prototype._saveItem=function(e,t){return this._supportsLocalStorage()?localStorage.setItem(e,t):this._supportsSessionStorage()?sessionStorage.setItem(e,t):this.fallbackStorage[e]=t,!0},e.prototype._getItem=function(e){return this._supportsLocalStorage()?localStorage.getItem(e):this._supportsSessionStorage()?sessionStorage.getItem(e):e in this.fallbackStorage?this.fallbackStorage[e]:null},e.prototype._supportsLocalStorage=function(){try{return!!window.localStorage&&(window.localStorage.setItem(e.constants.storage.testStorageKey,"A"),"A"===window.localStorage.getItem(e.constants.storage.testStorageKey)&&(window.localStorage.removeItem(e.constants.storage.testStorageKey),!window.localStorage.getItem(e.constants.storage.testStorageKey)))}catch(Hj){return!1}},e.prototype._supportsSessionStorage=function(){try{return!!window.sessionStorage&&(window.sessionStorage.setItem(e.constants.storage.testStorageKey,"A"),"A"===window.sessionStorage.getItem(e.constants.storage.testStorageKey)&&(window.sessionStorage.removeItem(e.constants.storage.testStorageKey),!window.sessionStorage.getItem(e.constants.storage.testStorageKey)))}catch(Hj){return!1}},e.prototype._getCurrentTime=function(){return Math.round((new Date).getTime()/1e3)},e.prototype.signRequest=function(e){e.headers=e.headers||{},e.headers[Fr]=this.sessionId,e.headers[Dr]=Nr,e.headers[Or]="MapControl/".concat(Yr," (Web)");var t=this.getToken();switch(this.options.authType){case lr.aad:case lr.anonymous:e.headers[Lr]=this.options.clientId,e.headers[br]=wr+t;break;case lr.sas:e.headers[br]=xr+t;break;case lr.subscriptionKey:e.headers["subscription-key"]=t;break;default:throw new Error("An invalid authentication type was specified")}return e},e.constants={preferredCacheLocation:"localStorage",storage:{tokenKey:"access.token.key",testStorageKey:"testStorage"},events:{tokenAcquired:"tokenacquired"},tokenExpiresIn:3599,tokenRefreshClockSkew:300,errors:{tokenExpired:"Token Expired, Try again"}},e}(),$j=window&&window.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Yj=function(){function e(e){for(var t in this.map=e,this.controlContainer=document.createElement("div"),this.controlContainer.classList.add("atlas-control-container"),ti){var r;ti.hasOwnProperty(t)&&((r=document.createElement("div")).classList.add(ti[t]),r.classList.add("subcontrol-container"),this.controlContainer.appendChild(r))}this.map.getMapContainer().appendChild(this.controlContainer),this.controls=new Set}return e.prototype.add=function(e,t){var r,n;if(Array.isArray(e))try{for(var i=$j(e),o=i.next();!o.done;o=i.next()){var a=o.value;this._add(a,t)}}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}else this._add(e,t)},e.prototype.getControls=function(){return Array.from(this.controls)},e.prototype.remove=function(e){var t,r;if(Array.isArray(e))try{for(var n=$j(e),i=n.next();!i.done;i=n.next()){var o=i.value;this._remove(o)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}else this._remove(e)},e.prototype._add=function(e,t){this.controls.add(e);var r=(new si).merge(t);e=e.onAdd(this.map,t);if(!(0<(t=this.controlContainer.getElementsByClassName(r.position)).length))throw new Error("Control position ".concat(r.position," does not exist."));t.item(0).appendChild(e)},e.prototype._remove=function(e){e.onRemove(),this.controls.delete(e)},e}(),Xj=window&&window.__assign||function(){return(Xj=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Qj=function(){function e(e){this.callbacks=new ci,this.map=e}return e.prototype.addCallback=function(e,t,r,n,i){var o,a,s=this;if(n)o=function(e){var t=e.lngLat?new pf(e.lngLat.lng,e.lngLat.lat):void 0,n=e.point?[e.point.x,e.point.y]:void 0,i=e.features?e.features.map((function(e){return new cp(e.geometry,e.properties,e.id)})):[];e={type:e.type,originalEvent:e.originalEvent,position:t,coordinate:n,features:i};r(e)};else switch(e){case"data":case"sourcedata":case"styledata":o=function(n){n=Xj(Xj({dataType:n.dataType},"source"===n.dataType&&Xj(Xj(Xj({isSourceLoaded:n.isSourceLoaded},n.sourceDataType&&{sourceDataType:n.sourceDataType}),{source:s.map.sources.getById(n.sourceId)}),n.tile&&{tile:{id:{x:n.tile.tileID.canonical.x,y:n.tile.tileID.canonical.y,z:n.tile.tileID.canonical.z},size:n.tile.tileSize,state:n.tile.state}})),{map:s.map,type:n.type}),i&&s.map.events._removeListener(e,t,r),r(n)};break;case"error":o=function(n){n={error:n.error,map:s.map,type:n.type},i&&s.map.events._removeListener(e,t,r),r(n)};break;case"touchstart":case"touchend":case"touchmove":case"touchcancel":o=function(n){if(n.originalEvent){if(n.originalEvent===a)return;a=n.originalEvent}var o=n.point?new hp(n.point.x,n.point.y):void 0,l=n.points?n.points.map((function(e){return new hp(e.x,e.y)})):[],c=n.lngLat?new pf(n.lngLat.lng,n.lngLat.lat):void 0,u=n.lngLats?n.lngLats.map((function(e){return new pf(e.lng,e.lat)})):[],h=c?s.map.layers.getRenderedShapes(new dp(c),t?[t]:void 0):[];o={map:s.map,originalEvent:n.originalEvent,pixel:o,pixels:l,position:c,positions:u,shapes:h,layerId:t||void 0,preventDefault:function(){return n.preventDefault()},type:n.type};i&&s.map.events._removeListener(e,t,r),r(o)};break;case"mousedown":case"mouseup":case"mouseover":case"mousemove":case"click":case"dblclick":case"mouseout":case"mouseenter":case"mouseleave":case"contextmenu":o=function(n){if(n.originalEvent){if(n.originalEvent===a)return;a=n.originalEvent}var o=n.lngLat?new pf(n.lngLat.lng,n.lngLat.lat):void 0,l=n.point?new hp(n.point.x,n.point.y):void 0,c=o?s.map.layers.getRenderedShapes(new dp(o),t?[t]:void 0):[];o={map:s.map,originalEvent:n.originalEvent,position:o,pixel:l,preventDefault:function(){return n.preventDefault()},shapes:c,layerId:t||void 0,type:n.type};i&&s.map.events._removeListener(e,t,r),r(o)};break;case"styleimagemissing":o=function(n){i&&s.map.events._removeListener(e,t,r),r(n.id)};break;case"wheel":o=function(n){if(n.originalEvent){if(n.originalEvent===a)return;a=n.originalEvent}var o={map:s.map,originalEvent:n.originalEvent,preventDefault:function(){return n.preventDefault()},type:n.type};i&&s.map.events._removeListener(e,t,r),r(o)};break;case"resize":o=function(n){var o,a={map:s.map,type:n.type};for(o in n)"type"!==o&&"target"!==o&&(a[o]=n[o]);i&&s.map.events._removeListener(e,t,r),r(a)};break;default:o=function(n){var o={map:s.map,type:n.type};n.originalEvent&&(o.originalEvent=n.originalEvent),i&&s.map.events._removeListener(e,t,r),r(o)}}this.callbacks.has(t)||this.callbacks.set(t,new ci),this.callbacks.get(t).has(e)||this.callbacks.get(t).set(e,new Map),this.callbacks.get(t).get(e).set(r,[o,i])},e.prototype.removeCallback=function(e,t,r){this.callbacks.has(t)&&this.callbacks.get(t).has(e)&&this.callbacks.get(t).get(e).has(r)&&this.callbacks.get(t).get(e).delete(r)},e.prototype.getModifiedCallback=function(e,t,r){if(this.callbacks.has(t)&&this.callbacks.get(t).has(e)&&this.callbacks.get(t).get(e).has(r))return this.callbacks.get(t).get(e).get(r)[0]},e.prototype.getLayerCallbacks=function(e){if(this.callbacks.has(e))return this.callbacks.get(e)},e.prototype.getEventCallbacks=function(e,t){if(this.callbacks.has(t)&&(t=this.callbacks.get(t)).has(e))return t.get(e)},e}(),Jj=window&&window.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},eq=window&&window.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=o.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a},tq=["maxzoomchanged","minzoomchanged","mapconfigurationchanged"],rq=function(){function e(e){this.map=e,this.mapCallbackHandler=new Qj(this.map)}return e.prototype.add=function(e,t,r){var n,i;if("function"==typeof t)this._addGlobalListener(e,t,!1,!1);else{t=Array.isArray(t)?t:[t];try{for(var o=Jj(t),a=o.next();!a.done;a=o.next()){var s=a.value;s instanceof Tm&&Tm._isMBoxEvent(e)?this._addLayerListener(e,s,r,!1,!1):s._addEventListener(e,r,!1)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}}},e.prototype.addOnce=function(e,t,r){"function"==typeof t?this._addGlobalListener(e,t,!1,!0):t instanceof Tm&&Tm._isMBoxEvent(e)?this._addLayerListener(e,t,r,!1,!0):t._addEventListener(e,r,!0)},e.prototype._addLegacy=function(e,t,r){"function"==typeof t?this._addGlobalListener(e,t,!0,!1):this._addLayerListener(e,t,r,!0,!1)},e.prototype._addLayerListener=function(e,t,r,n,i){t=t instanceof Tm?t.getId():t;var o,a,s,l,c=this.map.layers.getLayerById(t),u=this.mapCallbackHandler.getModifiedCallback(e,t,r);if(u&&c)try{for(var h=Jj(c._getLayerIds()),d=h.next();!d.done;d=h.next()){var p=d.value;this.map._getMap().off(e,p,u)}}catch(e){o={error:e}}finally{try{d&&!d.done&&(a=h.return)&&a.call(h)}finally{if(o)throw o.error}}if(this.mapCallbackHandler.addCallback(e,t,r,n,i),c){u=this.mapCallbackHandler.getModifiedCallback(e,t,r);try{for(var f=Jj(c._getLayerIds()),m=f.next();!m.done;m=f.next())p=m.value,this.map._getMap().on(e,p,u)}catch(e){s={error:e}}finally{try{m&&!m.done&&(l=f.return)&&l.call(f)}finally{if(s)throw s.error}}}},e.prototype._addGlobalListener=function(e,t,r,n){var i,o,a,s;tq.includes(e)?this.map._addEventListener(e,t,n):(i=this.mapCallbackHandler.getModifiedCallback(e,"",t),this.mapCallbackHandler.addCallback(e,"",t,r,n),o=this.mapCallbackHandler.getModifiedCallback(e,"",t),"load"===e&&this.map._isLoaded()?(a={type:"load",map:this.map},setTimeout((function(){return o(a)}))):"ready"===e?this.map._isReady()&&(s={type:"ready",map:this.map},setTimeout((function(){return o(s)}))):(i&&this.map._getMap().off(e,i),this.map._getMap().on(e,o)))},e.prototype.invoke=function(e,t,r){if(void 0===r)this._invokeListeners(e,"",t);else if(t instanceof Tm&&Tm._isMBoxEvent(e))this._invokeListeners(e,t.getId(),r);else{if(!(t instanceof ui))throw new Error("The invoke target is invalid.");t._invokeEvent(e,r)}},e.prototype._invokeListeners=function(e,t,r){var n=this,i=new ci(this.mapCallbackHandler.getEventCallbacks(e,t));i?i.forEach((function(i,o){(i=eq(i,2))[0],i[1]&&n._removeListener(e,t,o),o(r)})):"error"===e&&console.error("error"in r?r.error:r)},e.prototype.remove=function(e,t,r){var n,i;if("function"==typeof t)this._removeListener(e,"",t);else{t=Array.isArray(t)?t:[t];try{for(var o=Jj(t),a=o.next();!a.done;a=o.next()){var s=a.value;s instanceof Tm&&Tm._isMBoxEvent(e)?this._removeListener(e,s,r):null!=s&&s._removeEventListener(e,r)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}}},e.prototype._removeLegacy=function(e,t,r){"function"==typeof t?this._removeListener(e,"",t):this._removeListener(e,t,r)},e.prototype._removeListener=function(e,t,r){var n,i;if(tq.includes(e))this.map._removeEventListener(e,r);else{t=t instanceof Tm?t.getId():t;var o=this.mapCallbackHandler.getModifiedCallback(e,t,r);if(o)if(t){var a=this.map.layers.getLayerById(t);if(a)try{for(var s=Jj(a._getLayerIds()),l=s.next();!l.done;l=s.next()){var c=l.value;this.map._getMap().off(e,c,o)}}catch(e){n={error:e}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}}else this.map._getMap().off(e,o);this.mapCallbackHandler.removeCallback(e,t,r)}},e.prototype._enableLayerEvents=function(e){var t=this,r=this.mapCallbackHandler.getLayerCallbacks(e.getId());r&&r.forEach((function(r,n){r.forEach((function(r){var i,o,a=eq(r,1)[0];try{for(var s=Jj(e._getLayerIds()),l=s.next();!l.done;l=s.next()){var c=l.value;t.map._getMap().on(n,c,a)}}catch(r){i={error:r}}finally{try{l&&!l.done&&(o=s.return)&&o.call(s)}finally{if(i)throw i.error}}}))}))},e.prototype._disableLayerEvents=function(e){var t=this,r=this.mapCallbackHandler.getLayerCallbacks(e.getId());r&&r.forEach((function(r,n){r.forEach((function(r){var i,o,a=eq(r,1)[0];try{for(var s=Jj(e._getLayerIds()),l=s.next();!l.done;l=s.next()){var c=l.value;t.map._getMap().off(n,c,a)}}catch(r){i={error:r}}finally{try{l&&!l.done&&(o=s.return)&&o.call(s)}finally{if(i)throw i.error}}}))}))},e}(),nq=window&&window.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},iq=function(){function e(e){this.markers=new Set,this.map=e}return e.prototype.add=function(e,t){var r,n;if(Array.isArray(e))try{for(var i=nq(e),o=i.next();!o.done;o=i.next()){var a=o.value;this._addMarker(a,t)}}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}else this._addMarker(e,t)},e.prototype._addMarker=function(e,t){e._addToMap(this.map,t),this.markers.add(e)},e.prototype.getMarkers=function(){return Array.from(this.markers)},e.prototype.remove=function(e){var t,r;if(Array.isArray(e))try{for(var n=nq(e),i=n.next();!i.done;i=n.next()){var o=i.value;this._removeMarker(o)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}else this._removeMarker(e)},e.prototype._removeMarker=function(e){var t=this;e instanceof Gg?(e._removeFromMap(),this.markers.delete(e)):this.markers.forEach((function(r){r._getId()===e&&(r._removeFromMap(),t.markers.delete(r))}))},e.prototype.clear=function(){var e=this;this.markers.forEach((function(t){t._removeFromMap(),e.markers.delete(t)}))},e}(),oq=function(){function e(e){this.userImages=new ci,this.imageLoadTimeout=5e3,this.map=e}return e.prototype.add=function(e,t,r){var n=this;return new Promise((function(i,o){var a,s,l;n.userImages.has(e)?i():t instanceof HTMLImageElement||t instanceof ImageData?(n.map._getMap().addImage(e,t,r),n.userImages.set(e,{image:t,meta:r}),i()):"string"==typeof t&&(void 0,s=/<svg/i.test(t)&&!/^data:/i.test(t)?"data:image/svg+xml;base64,"+window.btoa(t):t,l=!1,n.map._sendRequest(s,"Image").then((function(e){return l?void 0:e.blob()})).then((function(t){var s;!l&&t&&(clearTimeout(a),(s=new Image).onload=function(){n.map._getMap().addImage(e,s,r),n.userImages.set(e,{image:s,meta:r}),i()},s.onerror=s.onabort=function(){o("Failed to load image into HTML element.")},s.src=URL.createObjectURL(t))})).catch((function(){l||(clearTimeout(a),o("Failed to load image into HTML element."))})),a=setTimeout((function(){l=!0,o("Failed to load image within specified timeout: ".concat(n.imageLoadTimeout," ms."))}),n.imageLoadTimeout))}))},e.prototype.clear=function(){var e=this;this.userImages.forEach((function(t,r){e.map._getMap().removeImage(r)})),this.userImages.clear()},e.prototype.getImageIds=function(){var e=[];return this.userImages.forEach((function(t,r){e.push(r)})),e},e.prototype.createFromTemplate=function(e,t,r,n,i){return r=r||"#1A73AA",n=n||"#fff",t=(t=Gn(t,i)).replace(/{color}/g,r).replace(/{secondaryColor}/g,n).replace(/{text}/g,""),this.add(e,t)},e.prototype.hasImage=function(e){return this.userImages.has(e)},e.prototype.remove=function(e){this.map._getMap().removeImage(e),this.userImages.delete(e)},e.prototype._restoreImages=function(){var e=this;this.userImages.forEach((function(t,r){e.map._getMap().hasImage(r)||e.map._getMap().addImage(r,t.image,t.meta)}))},e}(),aq=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),sq=window&&window.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},lq=function(e){function t(t,r){return(r=e.call(this,r)||this).layers=t,r}return aq(t,e),t.prototype.getOptions=function(){return{}},t.prototype.setOptions=function(e){},t.prototype._buildLayers=function(){return this.layers},t.prototype._getLayerIds=function(){return this.layers.map((function(e){return e.id}))},t.prototype._getSourceIds=function(){var e,t,r=new Set;try{for(var n=sq(this.layers),i=n.next();!i.done;i=n.next()){var o=i.value;"source"in o&&"string"==typeof o.source?r.add(o.source):"source"in o&&o.source&&r.add(o.id)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return r},t.prototype._updateLayoutProperty=function(e,t,r,n){var i;lp(t,r)||(i=this.map._getMap(),this.layers.forEach((function(r){i.getLayer(r.id)?i.setLayoutProperty(r.id,e,n||t):console.warn("Could not update layout property ".concat(e," for layer ").concat(r.id," to ").concat(n||t))})))},t}(Tm),cq=window&&window.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},uq=window&&window.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=o.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a},hq=window&&window.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||((n=n||Array.prototype.slice.call(t,0,i))[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},dq=function(){function e(e){this.layerIndex=[],this.userLayers=[],this.map=e}return e.prototype.add=function(e,t){var r,n,i=t instanceof Tm?t.getId():t;if(Array.isArray(e))try{for(var o=cq(e),a=o.next();!a.done;a=o.next()){var s=a.value;this._addLayer(s,i)}}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}else this._addLayer(e,i)},e.prototype._addLayer=function(e,t){if(!(this.map._isReady()||e instanceof lq))throw new Error("The layer '".concat(e.getId(),"' could not be added to the map because ")+"the map is not ready. Please use a ready event listener to guarantee the map is ready before adding a layer to it.");var r,n,i,o;t!==e.getId()&&this.layerIndex.find((function(e){return t===e.getId()}))?this._getMapboxLayerExists(e)?(n=this.layerIndex.findIndex((function(t){return t.getId()===e.getId()})),i=this.userLayers.findIndex((function(t){return t.layer.getId()===e.getId()})),this._removeMapboxLayers(e),this._addMapboxLayers(e,t),(o=this.layerIndex[n])&&this.map.events._disableLayerEvents(o),this.map.events._enableLayerEvents(e),this.layerIndex.splice(n,1),r=this.layerIndex.findIndex((function(e){return e.getId()===t})),this.layerIndex.splice(r,0,e),e instanceof lq||(this.userLayers[i]={layer:e,before:t}),o&&o.onRemove()):(this._addMapboxLayers(e,t),this.map.events._enableLayerEvents(e),r=this.layerIndex.findIndex((function(e){return e.getId()===t})),this.layerIndex.splice(r,0,e),e instanceof lq||this.userLayers.push({layer:e,before:t})):(n=this.layerIndex.findIndex((function(t){return t.getId()===e.getId()})),i=this.userLayers.findIndex((function(t){return t.layer.getId()===e.getId()})),0<=n&&0<=i?(o=this.layerIndex[n],this._removeMapboxLayers(o),this._addMapboxLayers(e,n+1),this.map.events._disableLayerEvents(o),this.map.events._enableLayerEvents(e),(this.layerIndex[n]=e)instanceof lq||(this.userLayers[i]={layer:e,before:void 0}),o.onRemove()):(this._addMapboxLayers(e),this.map.events._enableLayerEvents(e),this.layerIndex.push(e),e instanceof lq||this.userLayers.push({layer:e,before:t}))),e.onAdd(this.map)},e.prototype._addMapboxLayers=function(e,t){var r,n;if(!(e instanceof Tg)||e.getOptions().tileUrl){if(!(e instanceof lq)){e instanceof Km&&(this.map._getMap().addSource(e._getSourceId(),e._buildSource()),this.map.sources.setSourceState(e._getSourceWrapper()));var i=this._getMapboxBefore(t);try{for(var o=cq(e._buildLayers()),a=o.next();!a.done;a=o.next()){var s=a.value;this.map._getMap().addLayer(s,i)}}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}}this.map.events._enableLayerEvents(e)}},e.prototype._removeMapboxLayers=function(e,t){var r,n;if(e instanceof lq&&!t)this.map.events._disableLayerEvents(e);else{try{for(var i=cq(e._getLayerIds()),o=i.next();!o.done;o=i.next()){var a=o.value;this.map._getMap().getLayer(a)&&this.map._getMap().removeLayer(a)}}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}this.map.events._disableLayerEvents(e),e instanceof Km&&this.map._getMap().getSource(e._getSourceId())&&this.map._getMap().removeSource(e._getSourceId())}},e.prototype._getMapboxLayerExists=function(e){var t=this,r=!1;return"string"==typeof e?!!(e=this.layerIndex.find((function(t){return t.getId()===e}))):(e._getLayerIds().forEach((function(e){t.map._getMap().getLayer(e)&&(r=!0)})),r)},e.prototype._getMapboxBefore=function(e){var t,r,n,i;if("string"==typeof e){var o=this.layerIndex.find((function(t){return t.getId()===e}));if(!o)return;try{for(var a=cq(o._getLayerIds()),s=a.next();!s.done;s=a.next()){var l=s.value;if(this.map._getMap().getLayer(l))return l}}catch(r){t={error:r}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}e=this.layerIndex.findIndex((function(t){return t.getId()===e}))+1}for(var c=e;c<this.layerIndex.length;c++)try{n=void 0;for(var u=cq(this.layerIndex[c]._getLayerIds()),h=u.next();!h.done;h=u.next())if(l=h.value,this.map._getMap().getLayer(l))return l}catch(r){n={error:r}}finally{try{h&&!h.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}},e.prototype.clear=function(){for(var e=this.layerIndex.length-1;0<=e;e--){var t=this.layerIndex[e];t&&(this._removeMapboxLayers(t,!0),this.layerIndex.splice(e,1),t.onRemove())}this.userLayers=[]},e.prototype.getLayerById=function(e){var t=this.layerIndex.find((function(t){return t.getId()===e}));if(t)return t},e.prototype.getLayers=function(){return this.layerIndex.slice(0)},e.prototype._getSourceIds=function(){var e,t,r=new Set;try{for(var n=cq(this.layerIndex),i=n.next();!i.done;i=n.next())i.value._getSourceIds().forEach((function(e){return r.add(e)}))}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return r},e.prototype._getUserLayers=function(){return Array.from(this.userLayers)},e.prototype.move=function(e,t){var r=e instanceof Tm?e.getId():e,n=t instanceof Tm?t.getId():t;if(!this.layerIndex.find((function(e){return e.getId()===r})))throw new Error("The layer '".concat(r,"' has not been added to the map and cannot be moved."));t=this.layerIndex.findIndex((function(e){return e.getId()===r})),this._moveMapboxLayers(this.layerIndex[t],n),e=this.layerIndex[t],this.layerIndex.splice(t,1),t=this.layerIndex.findIndex((function(e){return e.getId()===n})),-1<t?this.layerIndex.splice(t,0,e):this.layerIndex.push(e),t=this.userLayers.find((function(e){return e.layer.getId()===r})),t&&(t.before=n)},e.prototype._moveMapboxLayers=function(e,t){var r,n,i=this._getMapboxBefore(t);try{for(var o=cq(e._getLayerIds()),a=o.next();!a.done;a=o.next()){var s=a.value;this.map._getMap().moveLayer(s,i)}}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}},e.prototype.getRenderedShapes=function(e,t,r){var n,i,o,a=this;if(e=e||[-180,-85.0511,180,85.0511],Array.isArray(e)?4===e.length||6===e.length?o=this.map.positionsToPixels([bf.getSouthWest(e),bf.getNorthEast(e)]):2!==e.length&&3!==e.length||(o=this.map.positionsToPixels([e])[0]):o=this.map.positionsToPixels([e.coordinates])[0],t){t=Array.isArray(t)?t:[t];var s=[],l=this;try{for(var c=cq(t),u=c.next();!u.done;u=c.next())!function(e){var t=e instanceof Tm?e.getId():e;if(!(-1<(e=l.layerIndex.findIndex((function(e){return e.getId()===t})))))throw new Error("The layer '".concat(t,"' has not been added to the map ")+"and its rendered features cannot be retrieved.");s.push.apply(s,hq([],uq(l.layerIndex[e]._getLayerIds().filter((function(e){return!!a.map._getMap().getLayer(e)}))),!1))}(u.value)}catch(e){n={error:e}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(n)throw n.error}}}return e=this.map._getMap().queryRenderedFeatures(o,{layers:s,filter:r}),this.map.sources._mapFeaturesToShapes(e)},e.prototype.remove=function(e){var t,r;if(Array.isArray(e))try{for(var n=cq(e),i=n.next();!i.done;i=n.next()){var o=i.value;this._removeLayer(o)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}else this._removeLayer(e)},e.prototype._removeLayer=function(e){var t=e instanceof Tm?e.getId():e,r=this.layerIndex.findIndex((function(e){return e.getId()===t}));if(-1==r)throw new Error("The layer '".concat(t,"' has not been added to the map and cannot be removed."));var n=this.layerIndex[r];this._removeMapboxLayers(n),this.layerIndex.splice(r,1),r=this.userLayers.findIndex((function(e){return e.layer.getId()===t}));-1!=r&&this.userLayers.splice(r,1),e instanceof Km&&this.map.sources.unsetSourceState(e._getSourceId()),n.onRemove()},e}(),pq=window&&window.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},fq=function(){function e(e){var t=this;this._onDrag=function(e){var r,n;"mousemove"===e.type?(r=e.clientX,n=e.clientY):"touchmove"===e.type&&(r=e.touches[0].clientX,n=e.touches[0].clientY),t.draggedPopups.forEach((function(e){e._dragToPixel([r,n])}))},this._onUp=function(){t.map.getMapContainer().removeEventListener("mousemove",t._onDrag),t.map.getMapContainer().removeEventListener("touchmove",t._onDrag),t.map.getMapContainer().removeEventListener("mouseup",t._onUp),t.map.getMapContainer().removeEventListener("touchend",t._onUp),t.draggedPopups.forEach((function(e){t.draggedPopups.delete(e),e._onUp()}))},this.map=e,this.popups=new Set,this.draggedPopups=new Set}return e.prototype.add=function(e){var t,r;e=Array.isArray(e)?e:[e];try{for(var n=pq(e),i=n.next();!i.done;i=n.next()){var o=i.value;this.popups.has(o)||(this.popups.add(o),o.attach(this.map))}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}},e.prototype.clear=function(){var e=this;this.popups.forEach((function(t){e.popups.delete(t),t.remove()}))},e.prototype.remove=function(e){var t,r;e=Array.isArray(e)?e:[e];try{for(var n=pq(e),i=n.next();!i.done;i=n.next()){var o=i.value;this.popups.has(o)&&(this.popups.delete(o),o.remove())}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}},e.prototype.getPopups=function(){return Array.from(this.popups)},e.prototype._getCollectionDiv=function(){var t=this.map.getMapContainer().querySelector(".".concat(e.Css.collection));return t||((t=document.createElement("div")).classList.add(e.Css.collection),t.setAttribute("aria-label","Map Information"),this.map.getMapContainer().appendChild(t)),t},e.prototype._addDraggedPopup=function(e){0===this.draggedPopups.size&&(this.map.getMapContainer().addEventListener("mousemove",this._onDrag),this.map.getMapContainer().addEventListener("touchmove",this._onDrag),this.map.getMapContainer().addEventListener("mouseup",this._onUp),this.map.getMapContainer().addEventListener("touchend",this._onUp)),this.draggedPopups.add(e)},e.Css={collection:"popup-collection-container"},e}(),mq=window&&window.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},gq=function(){function e(e){this.map=e,this.sources=new ci}return e.prototype.add=function(e,t){var r,n;if(void 0===t&&(t=!0),Array.isArray(e))try{for(var i=mq(e),o=i.next();!o.done;o=i.next()){var a=o.value;this._addSource(a,t)}}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}else this._addSource(e,t)},e.prototype.getRenderedShapes=function(e,t,r){return e="string"==typeof e?e:e.getId(),r=this.map._getMap().querySourceFeatures(e,{sourceLayer:r,filter:t}),this.map.sources._mapFeaturesToShapes(r,!0,this.sources.get(e))},e.prototype.getFeatureState=function(e,t,r){return e="string"==typeof e?e:e instanceof yf?e.getId():e.id,t="string"==typeof t?t:t.getId(),this.map._getMap().getFeatureState({id:e,source:t,sourceLayer:r})},e.prototype.removeFeatureState=function(e,t,r,n){e="string"==typeof e?e:e instanceof yf?e.getId():e.id,t="string"==typeof t?t:t.getId(),this.map._getMap().removeFeatureState({id:e,source:t,sourceLayer:r},n)},e.prototype.setFeatureState=function(e,t,r,n){e="string"==typeof e?e:e instanceof yf?e.getId():e.id,t="string"==typeof t?t:t.getId(),this.map._getMap().setFeatureState({id:e,source:t,sourceLayer:n},r)},e.prototype._buildSources=function(){var e={};return this.sources.forEach((function(t){e[t.getId()]=t._buildSource()})),e},e.prototype.clear=function(){var e=this;this.sources.forEach((function(t){e.remove(t)}))},e.prototype.getById=function(e){return this.sources.get(e)},e.prototype.getSources=function(){return Array.from(this.sources.values())},e.prototype.isSourceLoaded=function(e){return e=e instanceof tm?e.getId():e,this.map._getMap().isSourceLoaded(e)},e.prototype.remove=function(e,t){var r,n;if(void 0===t&&(t=!0),Array.isArray(e))try{for(var i=mq(e),o=i.next();!o.done;o=i.next()){var a=o.value;this._removeSource(a,t)}}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}else this._removeSource(e,t)},e.prototype.setSourceState=function(e,t){void 0===t&&(t=!0),this.sources.set(e.getId(),e),e._setMap(this.map,t)},e.prototype.unsetSourceState=function(e){this.sources.has(e)&&(this.sources.get(e)._setMap(null),this.sources.delete(e))},e.prototype._removeSource=function(e,t){if(e=e instanceof tm?e.getId():e,!this.sources.has(e))throw new Error("'".concat(e,"' is not added to the map"));if(this.map._getMap().getSource(e)&&t&&this.map._getMap().removeSource(e),this.map._getMap().getSource(e)&&t)throw new Error("One or more layers have a dependency on the source '".concat(e,"'"));this.unsetSourceState(e)},e.prototype._addSource=function(e,t){if(this.sources.has(e.getId())){if(t)throw new Error("'".concat(e.getId(),"' is already added to the map"));this.unsetSourceState(e.getId())}if(t){if(!this.map._isReady())throw new Error("The source '".concat(e.getId(),"' could not be added to the map because ")+"the map is not ready. Please use a ready event listener to guarantee the map is ready before adding a source to it.");this.map._getMap().addSource(e.getId(),e._buildSource())}this.setSourceState(e)},e.prototype._mapFeaturesToShapes=function(e,t,r){var n,i,o=[];try{for(var a=mq(e),s=a.next();!s.done;s=a.next()){var l=s.value;if((r||"string"==typeof l.source)&&"string"==typeof l.properties[yf._shapeIdPropName]){var c=r||this.sources.get(l.source);if(c instanceof im){var u=c.getShapeById(l.properties[yf._shapeIdPropName]);if(u instanceof yf){o.push(u);continue}}}t||o.push(l)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}return o},e.prototype._syncSources=function(e){var t=this;e?(Object.keys(e).map((function(t){var r,n=e[t];switch(n.type){case"vector":case"raster":case"raster-dem":r=new bg(t,{name:t,tiles:n.tiles,type:n.type,url:n.url,tileSize:"tileSize"in n?n.tileSize:void 0});break;case"canvas":r=new um(t,n);break;case"geojson":var i=new im(t,{maxZoom:n.maxzoom,cluster:n.cluster,clusterRadius:n.clusterRadius,tolerance:n.tolerance,lineMetrics:n.lineMetrics,clusterProperties:n.clusterProperties,buffer:n.buffer,clusterMinPoints:n.clusterMinPoints,generateId:n.generateId,promoteId:n.promoteId,filter:n.filter});"string"!=typeof n.data&&void 0!==n.data&&i._addNoUpdate(n.data),r=i;break;case"image":r=new fm(t,n);break;case"video":r=new gm(t,n);break;default:r=new dm(t,n)}return r})).forEach((function(e){var r=t.sources.get(e.getId()),n=r&&e._isDeepEqual(r);!n&&r&&t.unsetSourceState(r.getId()),t.setSourceState(e,!n)})),Array.from(this.sources.keys()).filter((function(t){return!(t in e)})).forEach((function(e){return t.unsetSourceState(e)}))):console.warn("syncSources called with no style sources which is unexpected.")},e}(),yq=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),vq=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.duration=1e3,t.type="jump",t}return yq(t,e),t}(Ur),_q=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),bq=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bottom=0,t.left=0,t.right=0,t.top=0,t}return _q(t,e),t}(Ur),wq=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),xq=window&&window.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Cq=window&&window.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=o.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a},Sq=window&&window.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||((n=n||Array.prototype.slice.call(t,0,i))[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},Eq=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bounds=[-180,-89,180,90],t.maxBounds=void 0,t.maxZoom=20,t.offset=new hp(0,0),t.padding=new bq,t}return wq(t,e),t.prototype.merge=function(){for(var t,r,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];try{for(var o=xq(n),a=o.next();!a.done;a=o.next()){var s=a.value;s&&"number"==typeof s.padding&&(s.padding={top:s.padding,bottom:s.padding,left:s.padding,right:s.padding})}}catch(r){t={error:r}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return e.prototype.merge.apply(this,Sq([],Cq(n),!1))},t}(Ur),Tq=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Iq=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.zoom=1,t.center=new pf(0,0),t.centerOffset=new hp(0,0),t.bearing=0,t.pitch=0,t.minZoom=1,t.maxZoom=20,t.minPitch=0,t.maxPitch=60,t.maxBounds=void 0,t}return Tq(t,e),t}(Ur),kq=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Aq=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name=void 0,t.before=void 0,t.minZoom=1,t.maxZoom=20,t.overwrite=!1,t.opacity=1,t}return kq(t,e),t}(Ur),Pq=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Mq=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.color="rgba(0,0,0,.5)",t.outlineColor="#000",t.radius=1,t.outlineWidth=5,t.name="default-circles",t}return Pq(t,e),t}(Aq),Rq=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Oq=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.cap="butt",t.join="miter",t.name="default-linestrings",t.color="#000",t.width=1,t}return Rq(t,e),t}(Aq),Lq=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Dq=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.iconSize=1,t.fontSize=14,t.fontColor="#000",t.textFont="SegoeUi-Regular",t.cluster=!0,t.clusterIcon=void 0,t.textOffset=[0,0],t.name="default-pins",t.icon="pin-darkblue",t.title="",t}return Lq(t,e),t}(Aq),Nq=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),zq=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.color="rgba(0,0,0,.5)",t.outlineColor="#000",t.name="default-polygons",t}return Nq(t,e),t}(Aq),Fq=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Bq=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="default-raster",t}return Fq(t,e),t}(Aq),Uq=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),jq=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.anchor="map",t.color="#FFFFFF",t.intensity=.5,t.position=[1.15,210,30],t}return Uq(t,e),t}(Ur),qq=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Hq=window&&window.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Vq=window&&window.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=o.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a},Gq=window&&window.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||((n=n||Array.prototype.slice.call(t,0,i))[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},Kq=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.antialias=void 0,t.autoResize=!0,t.language=Rn(),t.light=new jq,t.preserveDrawingBuffer=!1,t.progressiveLoading=!1,t.progressiveLoadingInitialLayerGroups=["base"],t.renderWorldCopies=!0,t.showBuildingModels=!1,t.showFeedbackLink=!0,t.showLogo=!0,t.showLabels=!0,t.customAttribution=void 0,t.showTileBoundaries=!1,t.style=void 0,t.view=Dn(),t.userRegion=t.view,t.customStyleTransform=void 0,t}return qq(t,e),t.prototype.merge=function(){for(var t,r,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];try{for(var o=Hq(n),a=o.next();!a.done;a=o.next()){var s=a.value;s&&(s.hasOwnProperty("view")?s.userRegion=s.view:s.hasOwnProperty("userRegion")&&(s.view=s.userRegion),"string"==typeof s.language)&&(s.language=Wr.getCode(s.language))}}catch(r){t={error:r}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return e.prototype.merge.apply(this,Gq([],Vq(n),!1))},t}(Ur),Zq=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Wq=window&&window.__assign||function(){return(Wq=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},$q=window&&window.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Yq=window&&window.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=o.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a},Xq=window&&window.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||((n=n||Array.prototype.slice.call(t,0,i))[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},Qq=function(e){return 0==e.length?void 0:e.slice(1).reduce((function(e,t){return function(r,n){return r=e(r,n),Wq(Wq({},r),t(r.url,n))}}),e[0])},Jq=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.authOptions=Sn(),t.disableTelemetry="atlas.azure.us"===Tn(),t["disable-telemetry"]=t.disableTelemetry,t.domain=Tn(),t.staticAssetsDomain=En(),t.styleDefinitionsPath=In(),t.styleDefinitionsVersion=kn(),t.styleAPIVersion=An(),t.mapConfiguration=void 0,t.styleSet=void 0,t.enableAccessibility=!0,t["enable-accessibility"]=t.enableAccessibility,t.enableAccessibilityLocationFallback=!0,t.maxParallelImageRequests=Mn(),t.refreshExpiredTiles=!0,t.subscriptionKey=Ln(),t["subscription-key"]=t.subscriptionKey,t.sessionId=On(),t["session-id"]=t.sessionId,t._transformers=[],t.transformRequest=void 0,t.workerCount=Pn(),t.fadeDuration=300,t.localIdeographFontFamily="sans-serif",t.validateStyle=!1,t}return Zq(t,e),t.prototype.merge=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=this.styleDefinitionsVersion;try{for(var i=$q(t),o=i.next();!o.done;o=i.next()){var a=o.value;a&&(a.authOptions?"string"==typeof a.authOptions.subscriptionKey&&(a.subscriptionKey=a["subscription-key"]=a.authOptions.subscriptionKey):"string"==typeof a.subscriptionKey?(a["subscription-key"]=a.subscriptionKey,a.authOptions={authType:lr.subscriptionKey,subscriptionKey:a.subscriptionKey}):"string"==typeof a["subscription-key"]&&(a.subscriptionKey=a["subscription-key"],a.authOptions={authType:lr.subscriptionKey,subscriptionKey:a["subscription-key"]}),"string"==typeof a.sessionId?a["session-id"]=a.sessionId:"string"==typeof a["session-id"]&&(a.sessionId=a["session-id"]),"boolean"==typeof a.disableTelemetry?a["disable-telemetry"]=a.disableTelemetry:"boolean"==typeof a["disable-telemetry"]&&(a.disableTelemetry=a["disable-telemetry"]),"boolean"==typeof a.enableAccessibility?a["enable-accessibility"]=a.enableAccessibility:"boolean"==typeof a["enable-accessibility"]&&(a.enableAccessibility=a["enable-accessibility"]))}}catch(t){c={error:t}}finally{try{o&&!o.done&&(l=i.return)&&l.call(i)}finally{if(c)throw c.error}}var s=this._transformers,l=t?t.filter((function(e){return void 0!==e})).reduce((function(e,t){return Xq(Xq([],Yq(e),!1),Yq(t._transformers||[]),!1)}),[]):[],c=e.prototype.merge.apply(this,Xq([],Yq(t),!1)),u=(l=(c.authOptions.authType!==lr.subscriptionKey&&(c["subscription-key"]=c.subscriptionKey=void 0),void 0!==c.styleSet&&void 0===c.mapConfiguration&&(c.mapConfiguration=c.styleSet),c.mapConfiguration&&"string"!=typeof c.mapConfiguration&&(c.mapConfiguration=Wq(Wq({},c.mapConfiguration),{defaultConfiguration:c.mapConfiguration.defaultConfiguration||c.mapConfiguration.defaultStyle,configurations:c.mapConfiguration.configurations||c.mapConfiguration.styles})),this._transformers=Xq(Xq([],Yq(s||[]),!1),Yq(l.filter((function(e){return!s.includes(e)}))),!1),this.transformRequest&&!this._transformers.includes(this.transformRequest)&&this._transformers.push(this.transformRequest),new Date(Date.UTC(2023,0))),new Date(this.styleDefinitionsVersion));return(isNaN(u.getTime())||u.getTime()<l.getTime())&&(console.warn("Style definition version ".concat(this.styleDefinitionsVersion," is invalid or deprecated, style definition version is unchanged (").concat(n,")")),this.styleDefinitionsVersion=n),this.transformRequest=Qq(this._transformers),c},t.prototype.addTransformer=function(e){this._transformers||(this._transformers=[]),this._transformers.push(e),this.transformRequest=Qq(this._transformers)},t.prototype.removeTransformer=function(e){this._transformers&&(this._transformers=this._transformers.filter((function(t){return e!==t})),this.transformRequest=Qq(this._transformers))},t._cloneCustomizer=function(e){if("object"==typeof e)return Object.assign({},e)},t}(Ur),eH=function(){function e(){}return e.getLayerGroup=function(e){return"string"!=typeof e&&e.metadata&&e.metadata["microsoft.maps:layerGroup"]?e.metadata["microsoft.maps:layerGroup"]:(e="string"!=typeof e?e.id:e).startsWith("microsoft.")&&4<=(e=e.split(".")).length?e[3]:void 0},e}(),tH=function(){function e(e){var t=this;this.isHijacked=function(){return void 0!==t._hijackedToResolve||void 0!==t._hijackedToReject},this.isResolved=function(){return void 0!==t._hijackedToResolve||void 0!==t._toResolve},this.isRejected=function(){return void 0!==t._hijackedToReject||void 0!==t._toReject},this.resultIfResolved=function(){return t._hijackedToResolve||t._toResolve},this.errorIfRejected=function(){return t._hijackedToReject||t._toReject},this._thenResolver=function(e,r){var n;t._hijackedToResolve?e(t._hijackedToResolve):t._hijackedToReject?r(t._hijackedToReject):(n=t.origin,t.origin.then((function(i){t.isHijacked()||(n!==t.origin?t._thenResolver(e,r):(t._toResolve=i,e(i)))})).catch((function(i){t.isHijacked()||(n!==t.origin?t._thenResolver(e,r):(t._toReject=i,r(i)))})))},this.origin=e,this[Symbol.toStringTag]=this.origin[Symbol.toStringTag]}return e.resolve=function(t){return new e(Promise.resolve(t))},e.reject=function(t){return new e(Promise.reject(t))},e.prototype.then=function(e,t){var r=this;return new Promise((function(e,t){r._resolve=e,r._reject=t,r._thenResolver(e,t)})).then(e,t)},e.prototype.catch=function(e){var t=this;return new Promise((function(e,r){t._resolve=e,t._reject=r,t._thenResolver(e,r)})).catch(e)},e.prototype.finally=function(e){var t=this;return new Promise((function(e,r){t._resolve=e,t._reject=r,t._thenResolver(e,r)})).finally(e)},e.prototype.hijackAndResolve=function(e){this._hijackedToResolve=e,this._resolve&&this._resolve(e)},e.prototype.hijackAndReject=function(e){this._hijackedToReject=e,this._reject&&this._reject(e)},e.prototype.switchWith=function(e){this.origin=e,this._toResolve=void 0,this._toReject=void 0},e}(),rH={road:"Road",satellite:"Satellite",satellite_road_labels:"Hybrid",grayscale_dark:"Grayscale (Dark)",grayscale_light:"Grayscale (Light)",night:"Night",road_shaded_relief:"Terra",blank:"Blank",blank_accessible:"Blank (Accessible)",high_contrast_dark:"High contrast (Dark)",high_contrast_light:"High contrast (Light)"},nH=window&&window.__assign||function(){return(nH=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},iH=window&&window.__awaiter||function(e,t,r,n){return new(r=r||Promise)((function(i,o){function a(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))},oH=window&&window.__generator||function(e,t){var r,n,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a={next:s(0),throw:s(1),return:s(2)};return"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(r)throw new TypeError("Generator is already executing.");for(;o=a&&c[a=0]?0:o;)try{if(r=1,n&&(i=2&c[0]?n.return:c[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,c[1])).done)return i;switch(n=0,(c=i?[2&c[0],i.value]:c)[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=0<(i=o.trys).length&&i[i.length-1])&&(6===c[0]||2===c[0])){o=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3]))o.label=c[1];else if(6===c[0]&&o.label<i[1])o.label=i[1],i=c;else{if(!(i&&o.label<i[2])){i[2]&&o.ops.pop(),o.trys.pop();continue}o.label=i[2],o.ops.push(c)}}c=t.call(e,o)}catch(l){c=[6,l],n=0}finally{r=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}},aH=window&&window.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=o.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a},sH=window&&window.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||((n=n||Array.prototype.slice.call(t,0,i))[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},lH=window&&window.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},cH=function(){function e(e,t){var r=this;this.definitions=function(){return r.initPromise||r.initStyleset()},this.indoorState=void 0,this.preservedPreindoorMapConfiguration=void 0,this._progressiveLoadingState={mapStyle:void 0,pendingVisibilityChange:void 0},this._deferLayerGroupVisibilities=function(e,t){var n,i,o,a,s=t.filter((function(t){return t in e}));0!==s.length&&(n=r.map._getMap(),i=n.getZoom(),o=r.map.getStyle().style,r._progressiveLoadingState.pendingVisibilityChange&&(r.map.events.remove("load",r._progressiveLoadingState.pendingVisibilityChange),r._progressiveLoadingState.pendingVisibilityChange=null),r._progressiveLoadingState.mapStyle=o,(a=Object.entries(e).reduce((function(e,t){var r=(t=aH(t,2))[0],n=(t=t[1],s.includes(r));return sH(sH([],aH(e),!1),aH(t.filter((function(e){if("custom"===e.type)return!1;if(n)if("number"==typeof e.maxzoom&&"number"==typeof e.minzoom){if(i<=e.maxzoom&&i>=e.minzoom)return!1}else if("number"==typeof e.minzoom){if(i>=e.minzoom)return!1}else{if("number"!=typeof e.maxzoom)return!1;if(i<=e.maxzoom)return!1}return"none"!==(null==(e=e.layout)?void 0:e.visibility)}))),!1)}),[])).forEach((function(e){e.layout=e.layout||{},e.layout.visibility="none"})),r._progressiveLoadingState.pendingVisibilityChange=function(){r._progressiveLoadingState.pendingVisibilityChange=null;var e=r.map.getStyle().style;o===e&&(a.forEach((function(e){e.layout.visibility="visible",n.setLayoutProperty(e.id,"visibility","visible")})),null!=(e=r.map.copyrightDelegate))&&e.reloadAttribution()},r.map.events.addOnce("load",r._progressiveLoadingState.pendingVisibilityChange))},this._onStyleData=function(e){r.map.events.invoke("stylechanged",{style:e.name,map:r.map,type:"stylechanged"})},this._lookUp=function(e){var t,n,i=(a=r.definitions()).errorIfRejected(),o=a.resultIfResolved();if(i||!o)return null;var a=o.configurations,s=void 0;try{for(var l=lH(a),c=l.next();!c.done;c=l.next()){var u=c.value;if(u.name===e.style)return u;u.name===o.defaultConfiguration&&(s=s||u)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(t)throw t.error}}return s||a[0]},this._lookUpAsync=function(e){return iH(r,void 0,void 0,(function(){var t;return oH(this,(function(r){switch(r.label){case 0:return[4,this.definitions()];case 1:return[2,(t=r.sent()).configurations.find((function(r){return r.name===(e.style||t.defaultConfiguration)}))||t.configurations.find((function(e){return e.name===t.defaultConfiguration}))||t.configurations[0]]}}))}))},this.map=e,this.serviceOptions=t}return e.prototype.updateIndoorState=function(e,t){var r,n,i=this,o=this.map.styles.getMapConfiguration();o?(this.preservedPreindoorMapConfiguration=o,r=this.map.getStyle().style?"".concat(this.map.getStyle().style,"_indoor").concat("dark"===e?"_dark":"","_tileset_").concat(t):void 0,this.map.styles.setMapConfiguration("defaultIndoor_".concat(t),"microsoft-maps:default"===o?r:void 0)):(n=(null==(o=this.indoorState)?void 0:o.tilesetId)!==t,this.indoorState={tilesetId:t,theme:e},this.initStyleset(),this.definitions().then((function(e){var t=(i.map.getStyle().style||e.defaultConfiguration).replace("_indoor_dark","").replace("_indoor",""),r="".concat(t,"_indoor");t=e.configurations.find((function(e){return e.name.startsWith(r)}));t&&i.map.setStyle({style:t.name},!n)})))},e.prototype.unsetIndoorState=function(){var e=this,t=this.preservedPreindoorMapConfiguration;t?this.map.styles.setMapConfiguration(t):(this.indoorState=void 0,this.initStyleset(),this.definitions().then((function(t){var r=e.map.getStyle().style;r.includes("_indoor")&&r.split("_indoor")[0]?e.map.setStyle({style:r.split("_indoor")[0]}):e.map.setStyle({style:void 0})})))},e.prototype.initStyleset=function(){var e,t=this;return e=this.serviceOptions.mapConfiguration?"string"==typeof this.serviceOptions.mapConfiguration?(e=this.map.authentication?this.map.authentication.initialize():Promise.resolve(),new tH(e.then((function(){return t._request(t.serviceOptions.domain,"".concat(Mr,"/mapconfigurations/metadata/").concat(t.serviceOptions.mapConfiguration),"StyleDefinitions").then((function(e){return nH(nH({},e),{defaultConfiguration:e.defaultConfiguration||e.defaultStyle,configurations:e.configurations||e.styles})}))})))):tH.resolve(this.serviceOptions.mapConfiguration):(e=this.map.authentication?this.map.authentication.initialize():Promise.resolve(),new tH(e.then((function(){return t._request(t.serviceOptions.staticAssetsDomain,"".concat(Pr,"/").concat(Mr),"StyleDefinitions",{version:t.serviceOptions.styleDefinitionsVersion,mcv:Yr.replace(/\./g,"")}).then((function(e){return{version:isNaN(e.version)?0:parseFloat(e.version),defaultConfiguration:e.defaultStyle,configurations:e.styles.filter((function(e){return t.indoorState?"auto"===t.indoorState.theme?e.name.endsWith("dark"===e.theme?"_indoor_dark":"_indoor"):e.name.endsWith("dark"===t.indoorState.theme?"_indoor_dark":"_indoor"):!e.name.includes("indoor")})).map((function(r){return{copyright:r.copyright.join(" "),name:r.name,displayName:function(e){return(e=t.indoorState&&e.includes("_indoor")?e.split("_indoor")[0]:e)in rH?rH[e]:e}(r.name),theme:r.theme,thumbnail:new Vr({domain:t.serviceOptions.staticAssetsDomain,path:r.thumbnail,protocol:"https"}).toString(),url:new Vr({domain:t.serviceOptions.staticAssetsDomain,path:"".concat(Pr,"/").concat(Mr,"/").concat(r.name),queryParams:{styleVersion:void 0!==e.version&&null!==e.version?e.version:t.serviceOptions.styleDefinitionsVersion,mcv:Yr.replace(/\./g,"")},protocol:"https"}).toString()}}))}}))})))),this.initPromise&&this.initPromise.switchWith(e),this.initPromise=e,this.initPromise.then((function(e){return t.map._invokeEvent("mapconfigurationchanged",e)})),this.initPromise},e.prototype.getStyle=function(e){if(!(e=this._lookUp(e)))throw Error("Style definition is not available.");if(e.url)return e.url;if(e.style)return e.style;throw Error("Style definition neither contains URL nor style object.")},e.prototype.deriveNewStyleAndLayerGroups=function(e,t){for(var r,n,i=this.map.getStyle(),o=this.map.getTraffic(),a={},s=0;s<t.layers.length;s++){var l=t.layers[s],c=eH.getLayerGroup(l);c?(a[c]||(a[c]=[]),a[c].push(l),i.showBuildingModels||"fill-extrusion"!==l.type?"fill-extrusion"===l.type&&(l.layout=null!=(r=l.layout)?r:{},l.layout.visibility="visible"):(l.layout=null!=(r=l.layout)?r:{},l.layout.visibility="none"),"none"!==o.flow&&c&&c==="traffic_".concat(o.flow)&&"line"==l.type&&(l.layout=null!=(n=l.layout)?n:{},l.layout.visibility="visible"),"labels"!==c&&"labels_places"!==c&&"labels_indoor"!==c||"symbol"!==l.type||(i.showLabels&&"none"!==(null==(n=l.layout)?void 0:n.visibility)?(l.layout=null!=(c=l.layout)?c:{},l.layout.visibility="visible"):(l.layout=null!=(c=l.layout)?c:{},l.layout.visibility="none"))):a[l.id]=[l]}return[t,a]},e.prototype.injectUserLayersIntoStyle=function(e,t,r){return e?this.map.layers._getUserLayers().reduce((function(n,i){var o,a,s,l;return i.layer instanceof Pg||(o=(null==(a=null==(a=null==r?void 0:r[i.before])?void 0:a[0])?void 0:a.id)||i.before,a=e.layers.find((function(e){return e.id===i.layer.getId()})),-1<(s=t.layers.findIndex((function(e){return e.id===i.layer.getId()})))&&t.layers.splice(s,1),a&&(s=new Set(Array.from(i.layer._getSourceIds()).map((function(t){var r;return!n.sources[t]&&(r=e.sources[t])?{source:r,id:t}:void 0})).filter((function(e){return void 0!==e}))),-1<(l=o?n.layers.findIndex((function(e){return e.id===o})):-1)?n.layers.splice(l,0,a):n.layers.push(a),s.forEach((function(e){var t=e.source;e=e.id;n.sources[e]=t})))),n}),nH({},t)):t},e.prototype.setStyle=function(e,t){var r=this,n=(void 0===t&&(t=!0),this._lookUp(e));if(!n)throw Error("Style definition ".concat(e.style," is not available."));if(!n.url&&!n.style)throw Error("Style definition neither contains URL nor style object.");var i=function(){return r._onStyleData(n)},o=function(){r.map.events.remove("styledata",i),r.map.events.addOnce("styledata",i)},a=e&&e.customStyleTransform?function(t,r){return t=e.customStyleTransform(t,r),o(),t}:function(t,n){var i=nH(nH({},n),{layers:sH([],aH(n.layers),!1),sources:nH({},n.sources)}),a=(i=(n=((a=e.progressiveLoading&&!r.map._isLoaded())&&Array.isArray(null==n?void 0:n.layers)&&((i=nH({},n)).layers=i.layers.map((function(e){var t=nH({},e);return e.layout&&(t.layout=nH({},e.layout)),t}))),aH(r.deriveNewStyleAndLayerGroups(t,i),2)))[0],n=n[1],a&&(a=e.progressiveLoadingInitialLayerGroups,Array.isArray(a))&&0<a.length&&r._deferLayerGroupVisibilities(n,a),r.injectUserLayersIntoStyle(t,i,n));t=Object.entries(n).map((function(e){var t=(e=aH(e,2))[0];e=e[1];return r._buildFundamentalLayerFrom(e,t)})),i=r.map.layers._getUserLayers().reduce((function(e,t){var r=t.before?e.findIndex((function(e){return e.getId()===t.before})):-1;return-1<r?e.splice(r,0,t.layer):e.push(t.layer),e}),t);return r.map.layers.layerIndex=i,r.map.sources._syncSources(a.sources),o(),a};this.map._getMap().setStyle(n.url||n.style,{diff:t,validate:this.serviceOptions.validateStyle,transformStyle:a})},e.prototype.getTheme=function(e){if(e=this._lookUp(e))return e.theme.toLowerCase()},e.prototype.getThemeAsync=function(e){return iH(this,void 0,void 0,(function(){return oH(this,(function(t){switch(t.label){case 0:return[4,this._lookUpAsync(e)];case 1:return[2,t.sent().theme]}}))}))},e.prototype.setMapConfiguration=function(e,t){var r=this;"string"==typeof(this.serviceOptions.mapConfiguration=e)?this.initStyleset():this.initPromise?this.initPromise.hijackAndResolve(e):this.initPromise=tH.resolve(e),this.definitions().then((function(e){var n=e.defaultConfiguration;e.configurations.find((function(e){return e.name===t}))&&(n=t),r.map.setStyle({style:n})}))},e.prototype.getMapConfiguration=function(){return this.serviceOptions.mapConfiguration},e.prototype.setStyleSet=function(e){this.updateIndoorState("indoor_dark"===e?"dark":"light",null)},e.prototype.getStyleSet=function(){return void 0!==this.indoorState?"dark"===this.indoorState.theme?"indoor_dark":"indoor":"base"},e.prototype.clearStyleSet=function(){this.unsetIndoorState()},e.prototype._buildFundamentalLayerFrom=function(e,t){if(e&&0<e.length)return(e=new lq(e,t)).onAdd(this.map),e;throw new Error("Unable to construct fundamental map layer for ID: ".concat(t,"."))},e.prototype._transformStyleRequest=function(e,t){e.includes(Cr)&&(t.url=t.url.replace(Cr,this.serviceOptions.domain)),e.includes(kr)&&(t.url=t.url.replace(kr,Pr)),e.includes(Ar)&&(t.url=t.url.replace(Ar,Mr)),(t.url.toLocaleLowerCase().includes(this.serviceOptions.domain.toLocaleLowerCase())||t.url.toLocaleLowerCase().includes(this.serviceOptions.staticAssetsDomain.toLocaleLowerCase()))&&((e=new URL(t.url)).searchParams.get(_r)||(e.searchParams.set(_r,this.serviceOptions.styleAPIVersion),t.url=e.href),null!=(e=this.map.authentication)&&e.signRequest(t),this._deleteAuthTokenForStaticAssets(t))},e.prototype._request=function(e,t,r,n){var i;return void 0===n&&(n={}),iH(this,void 0,void 0,(function(){var o,a;return oH(this,(function(s){switch(s.label){case 0:return a={url:new Vr({protocol:"https",domain:e,path:t,queryParams:nH(((a={})[_r]=this.serviceOptions.styleAPIVersion,a),n)}).toString()},"function"==typeof this.serviceOptions.transformRequest&&r&&(a=this.serviceOptions.transformRequest(a.url,r)),null!=(i=this.map.authentication)&&i.signRequest(a),this._deleteAuthTokenForStaticAssets(a),o={method:"GET",mode:"cors"},a.credentials&&(o.credentials=a.credentials),a.headers&&(o.headers=a.headers),[4,fetch(a.url,o).then((function(e){if(e.ok)return e.json();throw new Error("HTTP ".concat(e.status,": ").concat(e.statusText," "))}))];case 1:return[2,s.sent()]}}))}))},e.prototype._deleteAuthTokenForStaticAssets=function(e){e.url.startsWith("https://".concat(this.serviceOptions.staticAssetsDomain,"/").concat(Pr))&&(delete e.headers[Lr],delete e.headers[br])},e}(),uH=window&&window.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},hH=function(){function e(e){this.map=e,this.indicators=new Set}return e.prototype.add=function(e){var t,r;e=Array.isArray(e)?e:[e];try{for(var n=uH(e),i=n.next();!i.done;i=n.next()){var o=i.value;this.indicators.has(o)||(this.indicators.add(o),o.attach(this.map))}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}},e.prototype.clear=function(){var e=this;this.indicators.forEach((function(t){e.indicators.delete(t),t.remove()}))},e.prototype.remove=function(e){var t,r;e=Array.isArray(e)?e:[e];try{for(var n=uH(e),i=n.next();!i.done;i=n.next()){var o=i.value;this.indicators.has(o)&&(this.indicators.delete(o),o.remove())}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}},e.prototype.getIndicators=function(){return Array.from(this.indicators)},e.prototype._getCollectionDiv=function(){var t=this.map.getMapContainer().querySelector(".".concat(e.Css.collection));return t||((t=document.createElement("div")).setAttribute("aria-label","map data"),t.setAttribute("role","listbox"),t.classList.add(e.Css.collection),this.map.getMapContainer().appendChild(t)),t},e.Css={collection:"accessible-indicator-collection-container"},e}(),dH=window&&window.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),pH=window&&window.__assign||function(){return(pH=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},fH=window&&window.__awaiter||function(e,t,r,n){return new(r=r||Promise)((function(i,o){function a(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))},mH=window&&window.__generator||function(e,t){var r,n,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a={next:s(0),throw:s(1),return:s(2)};return"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(r)throw new TypeError("Generator is already executing.");for(;o=a&&c[a=0]?0:o;)try{if(r=1,n&&(i=2&c[0]?n.return:c[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,c[1])).done)return i;switch(n=0,(c=i?[2&c[0],i.value]:c)[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=0<(i=o.trys).length&&i[i.length-1])&&(6===c[0]||2===c[0])){o=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3]))o.label=c[1];else if(6===c[0]&&o.label<i[1])o.label=i[1],i=c;else{if(!(i&&o.label<i[2])){i[2]&&o.ops.pop(),o.trys.pop();continue}o.label=i[2],o.ops.push(c)}}c=t.call(e,o)}catch(l){c=[6,l],n=0}finally{r=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}},gH=window&&window.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=o.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a},yH=window&&window.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||((n=n||Array.prototype.slice.call(t,0,i))[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},vH=window&&window.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},_H=function(e){function t(r,n){var i,o,a=e.call(this)||this,s=(a.removed=!1,a.loaded=!1,a.ready=!1,a._resizeCallback=function(){return a.resize()},!0);a._updateGlobalDefaults(n),a.serviceOptions=(new Jq).merge(n),a.styleOptions=(new Kq).merge(n),a.trafficOptions=new ad,a.styles=new cH(a,a.serviceOptions),a.insights=new xD(a.serviceOptions),a.serviceOptions.authOptions.subscriptionKey&&(a.serviceOptions.authOptions.subscriptionKey=encodeURIComponent(a.serviceOptions.authOptions.subscriptionKey)),i=a.serviceOptions.authOptions.clientId||(a.serviceOptions.authOptions.subscriptionKey?a.serviceOptions.authOptions.subscriptionKey.replace(/.(?=.{3,}$)/g,"*"):"invalid-setting"),a.insights&&a.insights.setAuthenticatedUserContext(a.serviceOptions.sessionId,i),arguments[2]&&"ENVIRONMENT"in window&&window.ENVIRONMENT.hmr?(o=arguments[2],a.ready=!0,a.loaded=!0):(i={antialias:a.styleOptions.antialias,attributionControl:!1,container:r,fadeDuration:a.serviceOptions.fadeDuration,localIdeographFontFamily:a.serviceOptions.localIdeographFontFamily,preserveDrawingBuffer:a.styleOptions.preserveDrawingBuffer,refreshExpiredTiles:a.serviceOptions.refreshExpiredTiles,renderWorldCopies:a.styleOptions.renderWorldCopies,trackResize:!1,transformRequest:function(e,t){var r={url:e};return"Tile"===t||"Source"===t?(e.includes(Sr)&&a.insights&&a.insights.trackEvent({name:"TileLoad"}),a._substituteDomainLanguageViewAndSignInRequest(e,r)):"Style"!==t&&"SpriteJSON"!==t&&"SpriteImage"!==t&&"Glyphs"!==t||a.styles._transformStyleRequest(e,r),a.serviceOptions.transformRequest&&Xh(r,a.serviceOptions.transformRequest(r.url,t)),r}},o=new sr.Map(i));try{a.map=o,a.authentication=new Wj(a),a.controls=new Yj(a),a.events=new rq(a),a.imageSprite=new oq(a),a.layers=new dq(a),a.markers=new iq(a),a.sources=new gq(a),a.popups=new fq(a),a.indicators=new hH(a),a.map.getContainer().classList.add(t.Css.container),a.map.getCanvasContainer().classList.add(t.Css.canvasContainer),a.map.getCanvas().classList.add(t.Css.canvas),a._detectHighContrast(),a.copyrightControl=new TD({showFeedbackLink:a.styleOptions.showFeedbackLink,showLogo:a.styleOptions.showLogo,customAttribution:a.styleOptions.customAttribution}),a.controls.add(a.copyrightControl,{position:ti.NonFixed}),a.logoControl=new PD({showLogo:a.styleOptions.showLogo}),a.controls.add(a.logoControl,{position:ti.BottomLeft});var l=a.authentication?a.authentication.initialize():Promise.resolve();if(a.removed)return a;var c=function(){a.loaded=!0,a.map.off("load",c)},u=(a.map.on("load",c),function(){a.ready=!0,a.map.off("styledata",u),a.events.invoke("ready",{map:a,type:"ready"})});a.map.on("styledata",u),a._setAutoResize(a.styleOptions.autoResize),a.map.showTileBoundaries=a.styleOptions.showTileBoundaries,a.localizedStringsPromise=Wr.getStrings(a.styleOptions.language),l.then((function(){return a.styles.definitions()})).then((function(e){if(!a.removed){if(a.authentication&&!a.authentication.getToken())throw new Error("AuthenticationManager finished initializing, but no token is available");a.serviceOptions["enable-accessibility"]&&a.accessibleMapDelegate.addToMap(),a._setStyleComponents(a.styleOptions),a.copyrightDelegate&&a.copyrightDelegate.addToMap()}})).catch((function(e){e=e instanceof Error?e:new Error(e),a.insights.trackException({error:e}),e={map:a,type:"error",error:e},a.events.invoke("error",e)})),a.setCamera(pH(pH({minZoom:1},n),{type:"jump",duration:0})),a.incidentDelegate=new ZD(a),a.flowDelegate=new jD(a),a.accessibleMapDelegate=new UD(a),a.userInteractionDelegate=new QD(a,n),a.userInteractionDelegate.addToMap(),a.copyrightDelegate=new gN(a,a.copyrightControl,a.styleOptions)}catch(r){throw s=!1,a.insights.trackException({error:r instanceof Error?r:new Error(r)}),r}finally{a.insights.trackEvent({name:"MapLoad"},{success:s,supported:rn(),supportedWithPerformance:rn({failIfMajorPerformanceCaveat:!0})}),a.insights.flush()}return a}return dH(t,e),Object.defineProperty(t.prototype,"isDisposed",{get:function(){return this.removed},enumerable:!1,configurable:!0}),t.prototype.getCanvas=function(){return this.map.getCanvas()},t.prototype.getCanvasContainer=function(){return this.map.getCanvasContainer()},t.prototype.getMapContainer=function(){return this.map.getContainer()},t.prototype.getServiceOptions=function(){return Yf(this.serviceOptions,Jq._cloneCustomizer)},t.prototype.setServiceOptions=function(e){this.serviceOptions=(new Jq).merge(this.serviceOptions,e),this.serviceOptions["enable-accessibility"]?this.accessibleMapDelegate.addToMap():this.accessibleMapDelegate.removeFromMap(),e=this.styles.serviceOptions.mapConfiguration!==this.serviceOptions.mapConfiguration||this.styles.serviceOptions.staticAssetsDomain!==this.serviceOptions.staticAssetsDomain||this.styles.serviceOptions.styleDefinitionsVersion!==this.serviceOptions.styleDefinitionsVersion||this.styles.serviceOptions.domain!==this.serviceOptions.domain||this.styles.serviceOptions.styleAPIVersion!==this.serviceOptions.styleAPIVersion,this.styles.serviceOptions=this.serviceOptions,e&&(this.styles.initPromise=null,this.setStyle({}))},t.prototype.addRequestTransformer=function(e){this.serviceOptions.addTransformer(e)},t.prototype.removeRequestTransformer=function(e){this.serviceOptions.removeTransformer(e)},t.prototype.setCamera=function(e,t){if(void 0===t&&(t=!1),"padding"in e||"offset"in e||"bounds"in e){var r,n=(new Eq).merge({maxZoom:this.getCamera().maxZoom},e),i=this._generateSafeBounds(n.bounds),o={padding:n.padding,offset:n.offset,maxZoom:n.maxZoom};if(!(r=this.map.cameraForBounds(i,o)))throw a={message:"The map cannot be fit to the current canvas with the given CameraBoundsOptions.",containerWidth:null==(a=null==(a=this.map)?void 0:a.getContainer())?void 0:a.clientWidth,containerHeight:null==a?void 0:a.clientHeight,safeBounds:i,cameraForBoundsOptions:o},new Error(JSON.stringify(a));"pitch"in e&&(r.pitch=e.pitch),"bearing"in e&&(r.bearing=e.bearing),"minPitch"in e&&this.map.setMinPitch(e.minPitch),"maxPitch"in e&&this.map.setMaxPitch(e.maxPitch),"minZoom"in e&&this.map.setMinZoom(e.minZoom),i=this._generateSafeBounds(n.maxBounds)}else(o=(new Iq).merge(this.getCamera(),e)).centerOffset&&2<=o.centerOffset.length&&(a=o.centerOffset,(n=Qp([o.center],o.zoom))[0][0]+=a[0],n[0][1]+=a[1],o.center=Xp(n,o.zoom)[0]),r={center:o.center,zoom:o.zoom,bearing:o.bearing,pitch:o.pitch,around:void 0},o.minZoom<1&&console.warn("Setting minZoom below 1 may result in an empty map when the zoom level is less than 1."),this.map.setMinZoom(o.minZoom),this.map.setMaxZoom(o.maxZoom),o.minPitch&&this.map.setMinPitch(o.minPitch),o.maxPitch&&this.map.setMaxPitch(o.maxPitch),this._invokeEvent("minzoomchanged",this.map.getMinZoom()),this._invokeEvent("maxzoomchanged",this.map.getMaxZoom()),i=this._generateSafeBounds(o.maxBounds);i?this.map.setMaxBounds(i):this.map.setMaxBounds(null);var a=(new vq).merge(e);n={duration:a.duration,easing:function(e){return e},offset:[0,0],animate:!0},o={fromControl:t};"jump"===a.type?this.map.jumpTo(r,o):"ease"===a.type?this.map.easeTo(pH(pH({},r),n),o):"fly"===a.type&&this.map.flyTo(pH(pH({},r),n),o)},t.prototype.setCameraBounds=function(e){this.setCamera(e)},t.prototype.getCamera=function(){var e=this.map.getBounds().getSouthWest().toArray(),t=this.map.getBounds().getNorthEast().toArray();return{zoom:this.map.getZoom(),center:this.map.getCenter().toArray(),bearing:this.map.getBearing(),pitch:this.map.getPitch(),bounds:new bf(e,t),minZoom:this.map.getMinZoom(),maxZoom:this.map.getMaxZoom()}},t.prototype.setStyle=function(e,t){void 0===t&&(t=!0),delete e.preserveDrawingBuffer,(e=(new Kq).merge(this.styleOptions,e)).autoResize!==this.styleOptions.autoResize&&this._setAutoResize(e.autoResize),e.language!==this.styleOptions.language&&(this.localizedStringsPromise=Wr.getStrings(e.language)),e.renderWorldCopies!==this.styleOptions.renderWorldCopies&&this.map.setRenderWorldCopies(e.renderWorldCopies),e.showFeedbackLink!==this.styleOptions.showFeedbackLink&&this.copyrightControl.setOptions({showFeedbackLink:e.showFeedbackLink}),e.customAttribution!==this.styleOptions.customAttribution&&this.copyrightControl.setOptions({customAttribution:e.customAttribution}),e.showLogo!==this.styleOptions.showLogo&&(this.copyrightControl.setOptions({showLogo:e.showLogo}),this.logoControl.setOptions({showLogo:e.showLogo})),e.showTileBoundaries!==this.styleOptions.showTileBoundaries&&(this.map.showTileBoundaries=e.showTileBoundaries),e.showBuildingModels&&console.warn("showBuildingModels is deprecated."),t=t&&this.styleOptions.language===e.language&&this.styleOptions.view===e.view,this.styleOptions=e,this._setStyleComponents(e,t)},t.prototype.getStyle=function(){return Ru(this.styleOptions)},t.prototype.addIcon=function(e,t){this.imageSprite.add(e,t)},t.prototype.addPins=function(e,t){t=(new Dq).merge(t);var r=this.layers.getLayerById(t.name),n=!1;if(r||(n=!0,r=new yg("".concat(t.name,"-source"),t.name,{source:"".concat(t.name,"-source"),minZoom:t.minZoom,maxZoom:t.maxZoom,iconOptions:{anchor:"center",size:t.iconSize,image:["case",["has","icon"],["get","icon"],t.icon],ignorePlacement:!t.cluster,opacity:t.opacity},textOptions:{anchor:"center",textField:["case",["has","point_count"],["to-string",["get","point_count"]],["has","title"],["to-string",["get","title"]],t.title],font:["case",["has","point_count"],["literal",["StandardFontCondensed-Bold"]],["literal",[t.textFont]]],size:["case",["has","point_count"],20,t.fontSize],ignorePlacement:!t.cluster,opacity:t.opacity,offset:["case",["has","point_count"],["literal",[.5,-.45]],["literal",[t.textOffset[0]/16,t.textOffset[1]/16]]],color:t.fontColor}})),!(r instanceof yg))throw new Error("A layer with name '".concat(t.name,"' already exists but it is not a SymbolLayer.")+"A SymbolLayer should be used for rendering pins.");var i=r.getSource(),o=("string"==typeof i?(a=i,i=this.sources.getById(a)):a=i.getId(),!1);if(i||(o=!0,i=new im(a,{cluster:t.cluster})),!(i instanceof im))throw new Error("The source with name '".concat(a,"' already exists but it is not a DataSource.")+"New data can only be added to a DataSource.");o&&this.sources.add(i),n&&this.layers.add(r,t.before);var a=new wf(e);t.overwrite?i.setShapes(a):i.add(a)},t.prototype.addCircles=function(e,t){t=(new Mq).merge(t);var r=this.layers.getLayerById(t.name),n=!1;if(r||(n=!0,r=new Nm("".concat(t.name,"-source"),t.name,{source:"".concat(t.name,"-source"),minZoom:t.minZoom,maxZoom:t.maxZoom,opacity:t.opacity,radius:["case",["has","radius"],["get","radius"],t.radius],color:["case",["has","color"],["get","color"],t.color],strokeColor:["case",["has","outlineColor"],["get","outlineColor"],t.outlineColor],strokeWidth:["case",["has","outlineWidth"],["get","outlineWidth"],t.outlineWidth]})),!(r instanceof Nm))throw new Error("A layer with name '".concat(t.name,"' already exists but it is not a BubbleLayer.")+"A BubbleLayer should be used for rendering circles.");var i=r.getSource(),o=("string"==typeof i?(a=i,i=this.sources.getById(a)):a=i.getId(),!1);if(i||(o=!0,i=new im(a)),!(i instanceof im))throw new Error("The source with name '".concat(a,"' already exists but it is not a DataSource.")+"New data can only be added to a DataSource.");o&&this.sources.add(i),n&&this.layers.add(r,t.before);var a=new wf(e);t.overwrite?i.setShapes(a):i.add(a)},t.prototype.addLinestrings=function(e,t){t=(new Oq).merge(t);var r=this.layers.getLayerById(t.name),n=!1;if(r||(n=!0,r=new Jm("".concat(t.name,"-source"),t.name,{source:"".concat(t.name,"-source"),minZoom:t.minZoom,maxZoom:t.maxZoom,lineCap:t.cap,lineJoin:t.join,strokeOpacity:t.opacity,strokeColor:["case",["has","color"],["get","color"],t.color],strokeWidth:["case",["has","width"],["get","width"],t.width]})),!(r instanceof Jm))throw new Error("A layer with name '".concat(t.name,"' already exists but it is not a LineLayer.")+"A LineLayer should be used for rendering linestrings.");var i=r.getSource(),o=("string"==typeof i?(a=i,i=this.sources.getById(a)):a=i.getId(),!1);if(i||(o=!0,i=new im(a)),!(i instanceof im))throw new Error("The source with name '".concat(a,"' already exists but it is not a DataSource.")+"New data can only be added to a DataSource.");o&&this.sources.add(i),n&&this.layers.add(r,t.before);var a=new wf(e);t.overwrite?i.setShapes(a):i.add(a)},t.prototype.addPolygons=function(e,t){t=(new zq).merge(t);var r=this.layers.getLayerById(t.name),n=!1;if(r||(n=!0,r=new lg("".concat(t.name,"-source"),t.name,{source:"".concat(t.name,"-source"),minZoom:t.minZoom,maxZoom:t.maxZoom,fillOpacity:t.opacity,fillColor:["case",["has","color"],["get","color"],t.color]})),!(r instanceof lg))throw new Error("A layer with name '".concat(t.name,"' already exists but it is not a PolygonLayer.")+"A PolygonLayer should be used for rendering linestrings.");var i=r.getSource(),o=("string"==typeof i?(a=i,i=this.sources.getById(a)):a=i.getId(),!1);if(i||(o=!0,i=new im(a)),!(i instanceof im))throw new Error("The source with name '".concat(a,"' already exists but it is not a DataSource.")+"New data can only be added to a DataSource.");o&&this.sources.add(i),n&&this.layers.add(r,t.before);var a=new wf(e);t.overwrite?i.setShapes(a):i.add(a)},t.prototype.addRaster=function(e,t){t=(new Bq).merge(t);var r,n=this.layers.getLayerById(t.name);if(!((n=n||new Tg({maxZoom:t.maxZoom,minZoom:t.minZoom,opacity:t.opacity,tileSize:256,tileUrl:"{subdomain}"},t.name))instanceof Tg))throw new Error("A layer with name '".concat(t.name,"' already exists but it is not a TileLayer.")+"A TileLayer should be used for rendering raster images.");if("{subdomain}"!==n.getOptions().tileUrl)throw new Error("A TileLayer with name '".concat(t.name,"' already exists but was configured ")+"for a single tile url [default for new TileLayer(...)].");(r=!t.overwrite&&n.getOptions().subdomains||[]).push.apply(r,yH([],gH(e),!1)),n._setOptionsNoUpdate({subdomains:r}),this.layers.add(n,t.before)},t.prototype.getLayers=function(){return this.layers.getLayers().map((function(e){return e.getId()}))},t.prototype.removeLayers=function(e){var t,r;try{for(var n=vH(e),i=n.next();!i.done;i=n.next()){var o,a=i.value;this.layers.getLayerById(a)&&(this.layers.remove(a),o="".concat(a,"-source"),this.sources.getById(o))&&this.sources.remove(o)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}},t.prototype.addHtml=function(e,t){e.id||(e.id="marker_".concat(dr()));var r=new Gg({htmlContent:e});return this.markers.add(r,t),e.id},t.prototype.removeHtml=function(e){this.markers.remove(e)},t.prototype.addEventListener=function(e,t,r){this.events._addLegacy(e,t,r)},t.prototype.removeEventListener=function(e,t,r){this.events._removeLegacy(e,t,r)},t.prototype.setUserInteraction=function(e){this.userInteractionDelegate.setOptions(e)},t.prototype.getUserInteraction=function(){return this.userInteractionDelegate.getOptions()},t.prototype.addControl=function(e,t){this.controls.add(e,t)},t.prototype.removeControl=function(e){this.controls.remove(e)},t.prototype.setTraffic=function(e){var t=this.trafficOptions.incidents,r=this.trafficOptions.flow;if(this.trafficOptions=(new ad).merge(this.trafficOptions,e),this.controls.getControls().filter((function(e){return e instanceof ud})).forEach((function(e){return e.updateButtonState()})),this.incidentDelegate&&(this.trafficOptions.incidents?t||this.incidentDelegate.addToMap():this.incidentDelegate.removeFromMap()),this.trafficOptions.flow&&"none"!==this.trafficOptions.flow){["absolute","relative-delay"].includes(this.trafficOptions.flow)&&console.warn("The 'absolute' and 'relative-delay' flow options are deprecated. Please use 'relative' instead.");try{this.trafficOptions.flow!==r&&this.flowDelegate.addToMap()}catch(e){throw this.trafficOptions.flow=r,e}}else this.flowDelegate.removeFromMap()},t.prototype.getTraffic=function(){return Ru(this.trafficOptions)},t.prototype.remove=function(){this.dispose()},t.prototype.clear=function(){this.popups.clear(),this.layers.clear(),this.sources.clear(),this.markers.clear(),this.indicators.clear()},t.prototype.dispose=function(){var e;for(this.clear(),this.map.remove(),null!=(e=this.authentication)&&e.dispose(),this.removed=!0,null!=(e=this.resizeObserver)&&e.disconnect(),this.resizeObserver=null;this.getMapContainer().firstChild;){var t=this.getMapContainer().firstChild;this.getMapContainer().removeChild(t)}},t.prototype.resize=function(e,t,r){"number"!=typeof e&&"string"!=typeof e||"number"!=typeof t&&"string"!=typeof t?r=e:(this.getMapContainer().style.height="number"==typeof e?"".concat(e,"px"):e,this.getMapContainer().style.width="number"==typeof t?"".concat(t,"px"):t),e=this.getMapContainer().style.overflow,this.getMapContainer().style.overflow="hidden",this.map.resize(r),this.getMapContainer().style.overflow=e},t.prototype.pixelsToPositions=function(e){var t,r,n=[];try{for(var i=vH(e),o=i.next();!o.done;o=i.next()){var a=o.value,s=this.map.unproject(a);n.push(new pf(s.lng,s.lat))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return n},t.prototype.positionsToPixels=function(e){var t,r,n=[];try{for(var i=vH(e),o=i.next();!o.done;o=i.next()){var a=o.value,s=this.map.project(a);n.push(new hp(s.x,s.y))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return n},t.prototype.areTilesLoaded=function(){return this.map.areTilesLoaded()},t.prototype.stop=function(){this.map.stop()},t.prototype.triggerRepaint=function(){this.map.triggerRepaint()},t.prototype.enableElevation=function(e,t){this.map.setTerrain("string"==typeof e?{source:e,exaggeration:t}:{source:e.getId(),exaggeration:t})},t.prototype.disableElevation=function(){this.map.setTerrain(null)},t.prototype._getMap=function(){return this.map},t.prototype._rebuildStyle=function(e){return void 0===e&&(e=!0),fH(this,void 0,void 0,(function(){return mH(this,(function(t){return this.styles.setStyle(this.styleOptions,e),this.imageSprite._restoreImages(),[2]}))}))},t.prototype._isLoaded=function(){return this.loaded},t.prototype._isReady=function(){return this.ready},t.prototype._getLocalizedStrings=function(){return this.localizedStringsPromise},t.prototype._sendRequest=function(e,t,r){var n;return(n="function"==typeof this.serviceOptions.transformRequest?this.serviceOptions.transformRequest(e,t):n)?fetch(n.url||e,{credentials:n.credentials,headers:pH(pH({},r),n.headers),method:"GET",mode:"cors"}):fetch(e,{headers:r,method:"GET",mode:"cors"})},t.prototype._substituteDomainLanguageViewAndSignInRequest=function(e,t){var r;(e.includes(Sr)||e.includes(Cr))&&(r=new RegExp("[^{]".concat(Sr,"[^}]")),e.match(r)&&(t.url=t.url.replace(Sr,Cr)),Vr.protoRegEx.test(this.serviceOptions.domain)?(r=t.url.indexOf(Cr),t.url=this.serviceOptions.domain+t.url.substring(r+Cr.length)):t.url=t.url.replace(Cr,this.serviceOptions.domain)),(t.url.toLocaleLowerCase().includes(this.serviceOptions.domain.toLocaleLowerCase())||t.url.toLocaleLowerCase().includes(this.serviceOptions.staticAssetsDomain.toLocaleLowerCase()))&&null!=(r=this.authentication)&&r.signRequest(t),e.includes(Ir)&&(t.url=t.url.replace(Ir,this.styleOptions.language)),e.includes(Er)&&(t.url=this.styleOptions.view?t.url.replace(Er,this.styleOptions.view):t.url.replace(Er,"").replace("&".concat(Tr,"="),""))},t.prototype._setAutoResize=function(e){e?(this.resizeObserver||(this.resizeObserver=new ResizeObserver(this._resizeCallback)),this.resizeObserver.observe(this.map.getContainer())):this.resizeObserver&&this.resizeObserver.unobserve(this.map.getContainer())},t.prototype._setStyleComponents=function(e,t){var r=this;void 0===t&&(t=!0),this.removed||this.styles.definitions().then((function(n){var i,o,a=!0;if(r.styleOptions.style)try{for(var s=vH(n.configurations),l=s.next();!l.done;l=s.next()){var c=l.value;if(r.styleOptions.style===c.name){a=!1;break}}}catch(n){i={error:n}}finally{try{l&&!l.done&&(o=s.return)&&o.call(s)}finally{if(i)throw i.error}}a&&(r.styleOptions.style=n.defaultConfiguration),r.styleOptions=e,r._rebuildStyle(t)}))},t.prototype._updateGlobalDefaults=function(e){e&&(e.authOptions&&!Kn()&&Nn(e.authOptions),e.domain&&!Zn()&&zn(e.domain),e.styleDefinitionsPath&&!Wn()&&Fn(e.styleDefinitionsPath),e.workerCount&&!$n()&&Bn(e.workerCount),e.maxParallelImageRequests&&!Yn()&&Un(e.maxParallelImageRequests),!e.subscriptionKey&&!e["subscription-key"]||Kn()||Hn(e.subscriptionKey||e["subscription-key"]),!e.sessionId&&!e["session-id"]||Qn()||qn(e.sessionId||e["session-id"]),e.language&&!Xn()&&jn(e.language),!e.userRegion&&!e.view||Jn()||Vn(e.userRegion||e.view))},t.prototype._generateSafeBounds=function(e){if(e){var t=bf.getSouth(e),r=bf.getWest(e),n=bf.getNorth(e),i=bf.getEast(e);if(!(isFinite(t)&&isFinite(r)&&isFinite(n)&&isFinite(i)))throw new Error("The bounds specified are invalid: [".concat(e,"]"));for(;i<r;)i+=360;return new bf([r,t,i,n])}return e},t.prototype._detectHighContrast=function(){var e,r;switch(Kg.getHighContrastMode()){case"invert":case"light":e=t.Css.hcLight,r="high_contrast_light";break;case"dark":e=t.Css.hcDark,r="high_contrast_dark"}e&&this.map.getContainer().classList.add(e),r&&"road"===this.styleOptions.style&&(this.styleOptions.style=r)},t.Css={canvasContainer:"atlas-map-canvas-container",canvas:"atlas-map-canvas",container:"atlas-map",hcDark:"high-contrast-dark",hcLight:"high-contrast-light"},t}(ui),bH=window&&window.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=o.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a},wH=window&&window.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||((n=n||Array.prototype.slice.call(t,0,i))[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},xH=function(){function e(){this.detectHyperlinks=!0,this.parsePropertyPaths=!0}return e.applyTemplate=function(t,r){var n,i,o,a=this,s=document.createElement("div");return s.classList.add(e.Css.template),t&&("boolean"!=typeof(r=r||{}).singleDescription&&(r.singleDescription=!0),r.sandboxContent="boolean"!=typeof r.sandboxContent||r.sandboxContent,r.title&&"string"==typeof r.content&&(r.content.includes("{title}")||r.content.includes("{name}"))||(t.title?r.title="{title}":t.name&&(r.title="{name}")),"boolean"!=typeof r.detectHyperlinks&&(r.detectHyperlinks=!0),"boolean"!=typeof r.parsePropertyPaths&&(r.parsePropertyPaths=!0),r.textColor&&(s.style.color=r.textColor),r.fillColor&&(s.style.backgroundColor=r.fillColor),r.title&&((o=this._applyStringTemplate(t,r.title,r)).innerText=o.textContent||o.innerText||"",this._appendChild(s,o,e.Css.title)),(n=document.createElement("div")).classList.add(e.Css.content),Array.isArray(r.content)?0<r.content.length&&r.content[0].propertyPath?this._appendChild(n,this._generateContent(t,r.content,r),e.Css.item):r.content.forEach((function(i){a._appendChild(n,a._generateContent(t,i,r),e.Css.item)})):(i=0,o=void(t.description&&Object.keys(t).forEach((function(e){a._ignoreProperty(e,t[e])||i++}))),1===i||r.singleDescription&&t.description||2===i&&t.Snippet?(o=document.createElement("div")).innerHTML=t.description:o=this._generateContent(t,r.content,r),this._appendChild(n,o,e.Css.item)),""!==n.innerHTML)&&(r.sandboxContent?s.appendChild(e._createSandboxedIframe(n,r)):s.appendChild(n)),s},e._createSandboxedIframe=function(t,r){var n=document.createElement("iframe"),i=(t=(n.sandbox.add("allow-popups"),t.innerHTML),!1),o=100,a=550,s=10,l=(document.body.scrollWidth<=340&&(a=300,o=50),t.split(/<(tr|div|br|li|h[0-9]|p>)/)),c=Math.max.apply(Math,wH([],bH(l.map((function(e){return e.replace(/<[a-zA-Z0-9\s=\/]+>/g,"").length}))),!1))-1,u=Math.ceil(3.5*c);u<a&&(a=u,o=c),t.includes("<img")||t.includes("<video")?(i=!0,n.width="550px"):(u=-1<t.indexOf(e.Css.table)?25:20,s+=Math.max(.5*l.length*u,Math.ceil(t.replace(/<[a-zA-Z0-9\s=\/]+>/g,"").length/o)*u)),n.width=a+"px",n.height=i||280<s?"280px":s+"px",c=r.textColor?"color:".concat(r.textColor,";"):"",l=r.fillColor?"background-color:".concat(r.fillColor,";"):"",o='<html><head><title></title><meta charset="utf-8" /><meta http-equiv="x-ua-compatible" content="IE=Edge" />'+'<link rel="stylesheet" href="'.concat(e._cssUrl,'" type="text/css"/>')+"<style>html, body{margin:0;padding:0;".concat(c).concat(l,"}</style></head>")+'<body><div class="'.concat(e.Css.template,'" style="padding:0;width:').concat(a-20,'px">').concat(t,"</div></body></html>");return void 0===n.srcdoc?n.src="data:text/html;charset=utf-8,"+encodeURI(o):n.srcdoc=o,n},e._appendChild=function(e,t,r){t&&(r&&(t.className=(t.className?t.className+" ":"")+r),e.appendChild(t))},e._generateContent=function(e,t,r){return t?Array.isArray(t)?this._generatePropertyInfoTable(e,t,r):this._applyStringTemplate(e,t,r):(t=this._generateDynamicTableHtml(e,null,r))?((e=document.createElement("div")).innerHTML=t,e):null},e._applyStringTemplate=function(e,t,r){if(t){for(var n,i,o=t,a=this._placeholderRx.exec(t);a;)2<=a.length&&(n=this._getPropertyValue(e,a[1],r),o=o.replace(a[0],n)),a=this._placeholderRx.exec(t);if(o)return(o=o.trim()).includes("<")&&(o=o.replace(/[\r\n]+/g,"<br/>")),(i=document.createElement("div")).innerHTML=o,i}return null},e._getPropertyValue=function(e,t,r,n){var i=r.parsePropertyPaths?t.split("/"):[t],o=i.length;if(0<o&&e){var a=i[0],s=e[a];if(r.detectHyperlinks&&"link"===t&&(!n||n.hyperlinkFormat)){var l,c,u,h=[];if(Array.isArray(s)?s.forEach((function(e){e.href?h.push(e):"string"==typeof e&&h.push({href:e})})):s.href&&h.push(s),0<h.length)return n&&n.hyperlinkFormat?l=n.hyperlinkFormat:r&&r.hyperlinkFormat&&(l=r.hyperlinkFormat),c=l&&l.target?l.target:"_blank",u=[],h.forEach((function(e){e.title||l&&l.label||!e.rel||u.push(e.rel," - "),u.push('<a href="',e.href,'" target="',c,'">'),e.title?u.push(e.title):l&&l.label?u.push(l.label):u.push(e.href),u.push("</a>","<br/>")})),u.pop(),u.join("")}if(null!=s){var d=void 0;for(d=1;d<o&&(s=s[i[d]],a=i[d],null!=s);d++);if(d===o&&null!=s){if(e=void 0,(e=void 0!==s.value?s.value:s)instanceof Date)return n&&n.dateFormat?e.toLocaleString(void 0,n.dateFormat):r.dateFormat?e.toLocaleString(void 0,r.dateFormat):e.toISOString();if("object"==typeof e)return(p=this._generateDynamicTableHtml(e,i.slice(1),r))||"";if("number"==typeof e){if(n){if(n.dateFormat)return new Date(e).toLocaleString(void 0,n.dateFormat);if(n.numberFormat)return e.toLocaleString(void 0,n.numberFormat)}else if(/(timestamp|date)/gi.test(a))return new Date(e).toISOString();return e.toLocaleString(void 0,r.numberFormat)}if("string"==typeof e&&""!==e&&!/[\n\r<>\s]/g.test(e)&&(r.detectHyperlinks||n&&n.hyperlinkFormat)){e=e.trim(),t=this._isUrlRx.test(e)||n&&n.hyperlinkFormat;var p,f=this._isImageUrlRx.test(e)&&(t||e.startsWith("data:image")),m=this._emailRx.test(e);if(t||f||m)return t=void 0,p=void(n&&n.hyperlinkFormat?t=n.hyperlinkFormat:r&&r.hyperlinkFormat&&(t=r.hyperlinkFormat)),p=t&&t.target?' target="'.concat(t.target,'"'):' target="_blank"',n="".concat(t&&t.label?t.label:e),t&&t.scheme?e=t.scheme+e:m&&(e="mailto:"+e),r=t&&t.label?' alt="'.concat(t.label,'"'):"",(t&&t.isImage||f)&&(n='<img src="'.concat(e,'" style="max-width:100%"').concat(r,'"/>')),'<a href="'.concat(e,'"').concat(p,">").concat(n,"</a>")}return e.toString()}}}return""},e._generatePropertyInfoTable=function(e,t,r){var n,i;return e&&t&&0<t.length?((n=[]).push('<table class="'.concat((i=this).Css.table,'">')),t.forEach((function(t){var o=i._getPropertyValue(e,t.propertyPath,r,t);t.hideLabel?n.push('<tr><td colspan="2">',o,"</td></tr>"):(t=t.label||t.propertyPath.split("/")[0],n.push("<tr><th>",t,"</th><td>",o,"</td></tr>"))})),n.push("</table>"),(t=document.createElement("div")).innerHTML=n.join(""),t):null},e._generateDynamicTableHtml=function(e,t,r){var n,i,o,a,s=this;return e&&((n=[]).push('<table class="'.concat((i=this).Css.table,'">')),o=t&&0<t.length?t.join("/")+"/":"",a=0,Object.keys(e).forEach((function(t){s._ignoreProperty(t,e[t])||(n.push("<tr><th>",t,"</th><td>",i._getPropertyValue(e,o+t,r),"</td></tr>"),a++)})),0!==a)?(n.push("</table>"),n.join("")):null},e._ignoreProperty=function(e,t){switch(e){case"title":case"name":case"base":case"popupTemplate":case"anchor":case"icon":case"image":case"imageUrl":case"rotation":case"color":case"size":case"offset":case"strokeColor":case"strokeWidth":case"strokeOpacity":case"subType":case"fillColor":case"fillOpacity":case"visibility":case"visible":return!0;default:if(0===e.indexOf("_")||null==t||""===t)return!0}return!1},e._placeholderRx=/\{([a-zA-Z0-9_\/\s]+)\}/gi,e._isUrlRx=/^(http|https|ftp|tel|mailto):\/\//i,e._isImageUrlRx=/(^data:image|.png$|.jpg$|.jpeg$|.gif$|.bmp$|.svg|.tif|.tiff$)/i,e._emailRx=/^[^\.\s@:](?:[^\s@:]*[^\s@:\.])?@[^\.\s@]+(?:\.[^\.\s@]+)*$/,e._cssUrl=new Vr({domain:fr,path:"sdk/javascript/mapcontrol/".concat(Xr.getEndpointVersion(),"/atlas.min.css")}).toString(),e.Css={template:"azure-maps-control-popup-template",title:"azure-maps-control-popup-template-title",content:"azure-maps-control-popup-template-content",item:"azure-maps-control-popup-template-content-item",table:"azure-maps-control-popup-template-table"},e}(),CH=(ei(),Object.freeze({__proto__:null,get AuthenticationType(){return lr},get ControlPosition(){return ti},get ControlStyle(){return ri},HtmlMarker:Gg,Map:_H,Pixel:hp,Popup:jg,PopupTemplate:xH,Shape:yf,_enableRTLTextPlugin:ei,_getAssetDomain:function(){return pr},_getDomain:function(){return Tn()},_hasMaxParallelImageRequests:Yn,_hasSetAuthenticationOptions:Kn,_hasSetDomain:Zn,_hasSetLanguage:Xn,_hasSetSessionId:Qn,_hasSetStyleDefinitionsPath:Wn,_hasSetStyleDefinitionsVersion:function(){return vn},_hasSetView:Jn,_hasWorkerCount:$n,addImageTemplate:function(e,t,r){!r&&ni[e.toLowerCase()]||(ni[e.toLowerCase()]=t)},addProtocol:function(e,t){sr.addProtocol(e,t)},clearPrewarmedResources:function(){sr.clearPrewarmedResources()},control:Zf,data:Af,getAllImageTemplateNames:function(){return Object.keys(ni)},getAuthenticationOptions:Sn,getDomain:Tn,getImageTemplate:Gn,getLanguage:Rn,getMaxParallelImageRequests:Mn,getSessionId:On,getStaticAssetsDomain:En,getStyleAPIVersion:An,getStyleDefinitionsPath:In,getStyleDefinitionsVersion:kn,getSubscriptionKey:Ln,getUserRegion:function(){return on},getVersion:function(){return Xr.getFullVersion()},getView:Dn,getWorkerCount:Pn,internal:hi,isSupported:function(e){var t=!$r.isIE();return t&&rn({failIfMajorPerformanceCaveat:e})&&null!==document.createElement("canvas").getContext("webgl2")},layer:Mg,math:Ff,prewarm:function(){sr.prewarm()},removeProtocol:function(e){sr.removeProtocol(e)},setAuthenticationOptions:Nn,setDomain:zn,setLanguage:jn,setMaxParallelImageRequests:Un,setSessionId:qn,setStyleAPIVersion:function(e){pn=e},setStyleDefinitionsPath:Fn,setStyleDefinitionsVersion:function(e){dn=e,vn=!0},setSubscriptionKey:Hn,setUserRegion:Vn,setView:function(e){on=e,mn=!0},setWorkerCount:Bn,source:Sm}));const SH=t.forwardRef(((e,t)=>{let{className:r,bsPrefix:n,as:i="div",...o}=e;return n=pt(n,"card-body"),(0,st.jsx)(i,{ref:t,className:at()(r,n),...o})}));SH.displayName="CardBody";const EH=SH,TH=t.forwardRef(((e,t)=>{let{className:r,bsPrefix:n,as:i="div",...o}=e;return n=pt(n,"card-footer"),(0,st.jsx)(i,{ref:t,className:at()(r,n),...o})}));TH.displayName="CardFooter";const IH=TH,kH=t.createContext(null);kH.displayName="CardHeaderContext";const AH=kH,PH=t.forwardRef(((e,r)=>{let{bsPrefix:n,className:i,as:o="div",...a}=e;const s=pt(n,"card-header"),l=(0,t.useMemo)((()=>({cardHeaderBsPrefix:s})),[s]);return(0,st.jsx)(AH.Provider,{value:l,children:(0,st.jsx)(o,{ref:r,...a,className:at()(i,s)})})}));PH.displayName="CardHeader";const MH=PH,RH=t.forwardRef(((e,t)=>{let{bsPrefix:r,className:n,variant:i,as:o="img",...a}=e;const s=pt(r,"card-img");return(0,st.jsx)(o,{ref:t,className:at()(i?`${s}-${i}`:s,n),...a})}));RH.displayName="CardImg";const OH=RH,LH=t.forwardRef(((e,t)=>{let{className:r,bsPrefix:n,as:i="div",...o}=e;return n=pt(n,"card-img-overlay"),(0,st.jsx)(i,{ref:t,className:at()(r,n),...o})}));LH.displayName="CardImgOverlay";const DH=LH,NH=t.forwardRef(((e,t)=>{let{className:r,bsPrefix:n,as:i="a",...o}=e;return n=pt(n,"card-link"),(0,st.jsx)(i,{ref:t,className:at()(r,n),...o})}));NH.displayName="CardLink";const zH=NH,FH=e=>t.forwardRef(((t,r)=>(0,st.jsx)("div",{...t,ref:r,className:at()(t.className,e)}))),BH=FH("h6"),UH=t.forwardRef(((e,t)=>{let{className:r,bsPrefix:n,as:i=BH,...o}=e;return n=pt(n,"card-subtitle"),(0,st.jsx)(i,{ref:t,className:at()(r,n),...o})}));UH.displayName="CardSubtitle";const jH=UH,qH=t.forwardRef(((e,t)=>{let{className:r,bsPrefix:n,as:i="p",...o}=e;return n=pt(n,"card-text"),(0,st.jsx)(i,{ref:t,className:at()(r,n),...o})}));qH.displayName="CardText";const HH=qH,VH=FH("h5"),GH=t.forwardRef(((e,t)=>{let{className:r,bsPrefix:n,as:i=VH,...o}=e;return n=pt(n,"card-title"),(0,st.jsx)(i,{ref:t,className:at()(r,n),...o})}));GH.displayName="CardTitle";const KH=GH,ZH=t.forwardRef(((e,t)=>{let{bsPrefix:r,className:n,bg:i,text:o,border:a,body:s=!1,children:l,as:c="div",...u}=e;const h=pt(r,"card");return(0,st.jsx)(c,{ref:t,...u,className:at()(n,h,i&&`bg-${i}`,o&&`text-${o}`,a&&`border-${a}`),children:s?(0,st.jsx)(EH,{children:l}):l})}));ZH.displayName="Card";const WH=Object.assign(ZH,{Img:OH,Title:KH,Subtitle:jH,Body:EH,Link:zH,Text:HH,Header:MH,Footer:IH,ImgOverlay:DH});function $H(){return $H=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$H.apply(null,arguments)}function YH(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.includes(n))continue;r[n]=e[n]}return r}r(740);function XH(e){return"default"+e.charAt(0).toUpperCase()+e.substr(1)}function QH(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}function JH(e,r){return Object.keys(r).reduce((function(n,i){var o,a=n,s=a[XH(i)],l=a[i],c=YH(a,[XH(i),i].map(QH)),u=r[i],h=function(e,r,n){var i=(0,t.useRef)(void 0!==e),o=(0,t.useState)(r),a=o[0],s=o[1],l=void 0!==e,c=i.current;return i.current=l,!l&&c&&a!==r&&s(r),[l?e:a,(0,t.useCallback)((function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];n&&n.apply(void 0,[e].concat(r)),s(e)}),[n])]}(l,s,e[u]),d=h[0],p=h[1];return $H({},c,((o={})[i]=d,o[u]=p,o))}),e)}function eV(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);null!==e&&void 0!==e&&this.setState(e)}function tV(e){this.setState(function(t){var r=this.constructor.getDerivedStateFromProps(e,t);return null!==r&&void 0!==r?r:null}.bind(this))}function rV(e,t){try{var r=this.props,n=this.state;this.props=e,this.state=t,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(r,n)}finally{this.props=r,this.state=n}}eV.__suppressDeprecationWarning=!0,tV.__suppressDeprecationWarning=!0,rV.__suppressDeprecationWarning=!0;const nV=function(e){const r=(0,t.useRef)(e);return(0,t.useEffect)((()=>{r.current=e}),[e]),r};const iV=FH("h4");iV.displayName="DivStyledAsH4";const oV=t.forwardRef(((e,t)=>{let{className:r,bsPrefix:n,as:i=iV,...o}=e;return n=pt(n,"alert-heading"),(0,st.jsx)(i,{ref:t,className:at()(r,n),...o})}));oV.displayName="AlertHeading";const aV=oV;const sV=function(e){const r=(0,t.useRef)(e);return(0,t.useEffect)((()=>{r.current=e}),[e]),r};"undefined"!==typeof r.g&&r.g.navigator&&r.g.navigator.product,new WeakMap;const lV=["onKeyDown"];const cV=t.forwardRef(((e,r)=>{let{onKeyDown:n}=e,i=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}(e,lV);const[o]=Ft(Object.assign({tagName:"a"},i)),a=function(e){const r=sV(e);return(0,t.useCallback)((function(){return r.current&&r.current(...arguments)}),[r])}((e=>{o.onKeyDown(e),null==n||n(e)}));return(s=i.href)&&"#"!==s.trim()&&"button"!==i.role?(0,st.jsx)("a",Object.assign({ref:r},i,{onKeyDown:n})):(0,st.jsx)("a",Object.assign({ref:r},i,o,{onKeyDown:a}));var s}));cV.displayName="Anchor";const uV=cV,hV=t.forwardRef(((e,t)=>{let{className:r,bsPrefix:n,as:i=uV,...o}=e;return n=pt(n,"alert-link"),(0,st.jsx)(i,{ref:t,className:at()(r,n),...o})}));hV.displayName="AlertLink";const dV=hV;function pV(e,t){return pV=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},pV(e,t)}var fV=r(950);const mV=!1,gV=t.createContext(null);var yV="unmounted",vV="exited",_V="entering",bV="entered",wV="exiting",xV=function(e){function r(t,r){var n;n=e.call(this,t,r)||this;var i,o=r&&!r.isMounting?t.enter:t.appear;return n.appearStatus=null,t.in?o?(i=vV,n.appearStatus=_V):i=bV:i=t.unmountOnExit||t.mountOnEnter?yV:vV,n.state={status:i},n.nextCallback=null,n}!function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,pV(e,t)}(r,e),r.getDerivedStateFromProps=function(e,t){return e.in&&t.status===yV?{status:vV}:null};var n=r.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(e){var t=null;if(e!==this.props){var r=this.state.status;this.props.in?r!==_V&&r!==bV&&(t=_V):r!==_V&&r!==bV||(t=wV)}this.updateStatus(!1,t)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var e,t,r,n=this.props.timeout;return e=t=r=n,null!=n&&"number"!==typeof n&&(e=n.exit,t=n.enter,r=void 0!==n.appear?n.appear:t),{exit:e,enter:t,appear:r}},n.updateStatus=function(e,t){if(void 0===e&&(e=!1),null!==t)if(this.cancelNextCallback(),t===_V){if(this.props.unmountOnExit||this.props.mountOnEnter){var r=this.props.nodeRef?this.props.nodeRef.current:fV.findDOMNode(this);r&&function(e){e.scrollTop}(r)}this.performEnter(e)}else this.performExit();else this.props.unmountOnExit&&this.state.status===vV&&this.setState({status:yV})},n.performEnter=function(e){var t=this,r=this.props.enter,n=this.context?this.context.isMounting:e,i=this.props.nodeRef?[n]:[fV.findDOMNode(this),n],o=i[0],a=i[1],s=this.getTimeouts(),l=n?s.appear:s.enter;!e&&!r||mV?this.safeSetState({status:bV},(function(){t.props.onEntered(o)})):(this.props.onEnter(o,a),this.safeSetState({status:_V},(function(){t.props.onEntering(o,a),t.onTransitionEnd(l,(function(){t.safeSetState({status:bV},(function(){t.props.onEntered(o,a)}))}))})))},n.performExit=function(){var e=this,t=this.props.exit,r=this.getTimeouts(),n=this.props.nodeRef?void 0:fV.findDOMNode(this);t&&!mV?(this.props.onExit(n),this.safeSetState({status:wV},(function(){e.props.onExiting(n),e.onTransitionEnd(r.exit,(function(){e.safeSetState({status:vV},(function(){e.props.onExited(n)}))}))}))):this.safeSetState({status:vV},(function(){e.props.onExited(n)}))},n.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},n.setNextCallback=function(e){var t=this,r=!0;return this.nextCallback=function(n){r&&(r=!1,t.nextCallback=null,e(n))},this.nextCallback.cancel=function(){r=!1},this.nextCallback},n.onTransitionEnd=function(e,t){this.setNextCallback(t);var r=this.props.nodeRef?this.props.nodeRef.current:fV.findDOMNode(this),n=null==e&&!this.props.addEndListener;if(r&&!n){if(this.props.addEndListener){var i=this.props.nodeRef?[this.nextCallback]:[r,this.nextCallback],o=i[0],a=i[1];this.props.addEndListener(o,a)}null!=e&&setTimeout(this.nextCallback,e)}else setTimeout(this.nextCallback,0)},n.render=function(){var e=this.state.status;if(e===yV)return null;var r=this.props,n=r.children,i=(r.in,r.mountOnEnter,r.unmountOnExit,r.appear,r.enter,r.exit,r.timeout,r.addEndListener,r.onEnter,r.onEntering,r.onEntered,r.onExit,r.onExiting,r.onExited,r.nodeRef,YH(r,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]));return t.createElement(gV.Provider,{value:null},"function"===typeof n?n(e,i):t.cloneElement(t.Children.only(n),i))},r}(t.Component);function CV(){}xV.contextType=gV,xV.propTypes={},xV.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:CV,onEntering:CV,onEntered:CV,onExit:CV,onExiting:CV,onExited:CV},xV.UNMOUNTED=yV,xV.EXITED=vV,xV.ENTERING=_V,xV.ENTERED=bV,xV.EXITING=wV;const SV=xV;function EV(e){if(!e||"function"===typeof e)return null;const{major:r}=function(){const e=t.version.split(".");return{major:+e[0],minor:+e[1],patch:+e[2]}}();return r>=19?e.props.ref:e.ref}function TV(e){var t=function(e){return e&&e.ownerDocument||document}(e);return t&&t.defaultView||window}var IV=/([A-Z])/g;var kV=/^ms-/;function AV(e){return function(e){return e.replace(IV,"-$1").toLowerCase()}(e).replace(kV,"-ms-")}var PV=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;const MV=function(e,t){var r="",n="";if("string"===typeof t)return e.style.getPropertyValue(AV(t))||function(e,t){return TV(e).getComputedStyle(e,t)}(e).getPropertyValue(AV(t));Object.keys(t).forEach((function(i){var o=t[i];o||0===o?!function(e){return!(!e||!PV.test(e))}(i)?r+=AV(i)+": "+o+";":n+=i+"("+o+") ":e.style.removeProperty(AV(i))})),n&&(r+="transform: "+n+";"),e.style.cssText+=";"+r},RV=!("undefined"===typeof window||!window.document||!window.document.createElement);var OV=!1,LV=!1;try{var DV={get passive(){return OV=!0},get once(){return LV=OV=!0}};RV&&(window.addEventListener("test",DV,DV),window.removeEventListener("test",DV,!0))}catch(Hj){}const NV=function(e,t,r,n){if(n&&"boolean"!==typeof n&&!LV){var i=n.once,o=n.capture,a=r;!LV&&i&&(a=r.__once||function e(n){this.removeEventListener(t,e,o),r.call(this,n)},r.__once=a),e.addEventListener(t,a,OV?n:o)}e.addEventListener(t,r,n)};const zV=function(e,t,r,n){var i=n&&"boolean"!==typeof n?n.capture:n;e.removeEventListener(t,r,i),r.__once&&e.removeEventListener(t,r.__once,i)};const FV=function(e,t,r,n){return NV(e,t,r,n),function(){zV(e,t,r,n)}};function BV(e,t,r){void 0===r&&(r=5);var n=!1,i=setTimeout((function(){n||function(e,t,r,n){if(void 0===r&&(r=!1),void 0===n&&(n=!0),e){var i=document.createEvent("HTMLEvents");i.initEvent(t,r,n),e.dispatchEvent(i)}}(e,"transitionend",!0)}),t+r),o=FV(e,"transitionend",(function(){n=!0}),{once:!0});return function(){clearTimeout(i),o()}}function UV(e,t,r,n){null==r&&(r=function(e){var t=MV(e,"transitionDuration")||"",r=-1===t.indexOf("ms")?1e3:1;return parseFloat(t)*r}(e)||0);var i=BV(e,r,n),o=FV(e,"transitionend",t);return function(){i(),o()}}function jV(e,t){const r=MV(e,t)||"",n=-1===r.indexOf("ms")?1e3:1;return parseFloat(r)*n}function qV(e,t){const r=jV(e,"transitionDuration"),n=jV(e,"transitionDelay"),i=UV(e,(r=>{r.target===e&&(i(),t(r))}),r+n)}const HV=e=>e&&"function"!==typeof e?t=>{e.current=t}:e;const VV=function(e,r){return(0,t.useMemo)((()=>function(e,t){const r=HV(e),n=HV(t);return e=>{r&&r(e),n&&n(e)}}(e,r)),[e,r])};const GV=t.forwardRef(((e,r)=>{let{onEnter:n,onEntering:i,onEntered:o,onExit:a,onExiting:s,onExited:l,addEndListener:c,children:u,childRef:h,...d}=e;const p=(0,t.useRef)(null),f=VV(p,h),m=e=>{var t;f((t=e)&&"setState"in t?fV.findDOMNode(t):null!=t?t:null)},g=e=>t=>{e&&p.current&&e(p.current,t)},y=(0,t.useCallback)(g(n),[n]),v=(0,t.useCallback)(g(i),[i]),_=(0,t.useCallback)(g(o),[o]),b=(0,t.useCallback)(g(a),[a]),w=(0,t.useCallback)(g(s),[s]),x=(0,t.useCallback)(g(l),[l]),C=(0,t.useCallback)(g(c),[c]);return(0,st.jsx)(SV,{ref:r,...d,onEnter:y,onEntered:_,onEntering:v,onExit:b,onExited:x,onExiting:w,addEndListener:C,nodeRef:p,children:"function"===typeof u?(e,t)=>u(e,{...t,ref:m}):t.cloneElement(u,{ref:m})})})),KV=GV,ZV={[_V]:"show",[bV]:"show"},WV=t.forwardRef(((e,r)=>{let{className:n,children:i,transitionClasses:o={},onEnter:a,...s}=e;const l={in:!1,timeout:300,mountOnEnter:!1,unmountOnExit:!1,appear:!1,...s},c=(0,t.useCallback)(((e,t)=>{!function(e){e.offsetHeight}(e),null==a||a(e,t)}),[a]);return(0,st.jsx)(KV,{ref:r,addEndListener:qV,...l,onEnter:c,childRef:EV(i),children:(e,r)=>t.cloneElement(i,{...r,className:at()("fade",n,i.props.className,ZV[e],o[e])})})}));WV.displayName="Fade";const $V=WV,YV={"aria-label":Mt().string,onClick:Mt().func,variant:Mt().oneOf(["white"])},XV=t.forwardRef(((e,t)=>{let{className:r,variant:n,"aria-label":i="Close",...o}=e;return(0,st.jsx)("button",{ref:t,type:"button",className:at()("btn-close",n&&`btn-close-${n}`,r),"aria-label":i,...o})}));XV.displayName="CloseButton",XV.propTypes=YV;const QV=XV,JV=t.forwardRef(((e,r)=>{const{bsPrefix:n,show:i=!0,closeLabel:o="Close alert",closeVariant:a,className:s,children:l,variant:c="primary",onClose:u,dismissible:h,transition:d=$V,...p}=JH(e,{show:"onClose"}),f=pt(n,"alert"),m=function(e){const r=nV(e);return(0,t.useCallback)((function(){return r.current&&r.current(...arguments)}),[r])}((e=>{u&&u(!1,e)})),g=!0===d?$V:d,y=(0,st.jsxs)("div",{role:"alert",...g?void 0:p,ref:r,className:at()(s,f,c&&`${f}-${c}`,h&&`${f}-dismissible`),children:[h&&(0,st.jsx)(QV,{onClick:m,"aria-label":o,variant:a}),l]});return g?(0,st.jsx)(g,{unmountOnExit:!0,...p,ref:void 0,in:i,children:y}):i?y:null}));JV.displayName="Alert";const eG=Object.assign(JV,{Link:dV,Heading:aV}),tG=t.forwardRef(((e,t)=>{let{bsPrefix:r,className:n,as:i="div",...o}=e;const a=pt(r,"row"),s=ft(),l=mt(),c=`${a}-cols`,u=[];return s.forEach((e=>{const t=o[e];let r;delete o[e],null!=t&&"object"===typeof t?({cols:r}=t):r=t;const n=e!==l?`-${e}`:"";null!=r&&u.push(`${c}${n}-${r}`)})),(0,st.jsx)(i,{ref:t,...o,className:at()(n,a,...u)})}));tG.displayName="Row";const rG=tG,nG=e=>{let{risks:t}=e;return t&&0!==t.length?(0,st.jsxs)(WH,{id:"Card",children:[(0,st.jsx)(WH.Header,{children:"Avisos"}),(0,st.jsx)(WH.Body,{children:(0,st.jsx)(eG,{variant:"warning",children:t.map(((e,t)=>(0,st.jsxs)(rG,{children:[(0,st.jsx)(WH.Img,{src:r(700)(`./${e.icon}`),id:"icon",className:"col-3"}),(0,st.jsx)(WH.Text,{className:"col",children:e.message})]},t)))})})]}):(0,st.jsxs)(WH,{id:"Card",children:[(0,st.jsx)(WH.Header,{children:"Avisos"}),(0,st.jsx)(WH.Body,{children:(0,st.jsxs)(eG,{variant:"success",children:[(0,st.jsx)("p",{children:"Boa not\xedcia! Nenhum risco identificado para esta praia."}),(0,st.jsx)("p",{children:"Aproveite seu dia com tranquilidade! \ud83c\udfd6\ufe0f"})]})})]})};function iG(e){let{animation:t,bg:r,bsPrefix:n,size:i,...o}=e;n=pt(n,"placeholder");const[{className:a,...s}]=vt(o);return{...s,className:at()(a,t?`${n}-${t}`:n,i&&`${n}-${i}`,r&&`bg-${r}`)}}const oG=t.forwardRef(((e,t)=>{const r=iG(e);return(0,st.jsx)(jt,{...r,ref:t,disabled:!0,tabIndex:-1})}));oG.displayName="PlaceholderButton";const aG=oG,sG=t.forwardRef(((e,t)=>{let{as:r="span",...n}=e;const i=iG(n);return(0,st.jsx)(r,{...i,ref:t})}));sG.displayName="Placeholder";const lG=Object.assign(sG,{Button:aG}),cG=r=>{let{coord:n,Listrisks:i}=r;const[o,a]=(0,t.useState)(!0);return(0,t.useEffect)((()=>{let t=null;return(async()=>{if(n)try{const r=n;t=new CH.Map("mapContainer",{center:r,zoom:15,view:"Auto",authOptions:{authType:"subscriptionKey",subscriptionKey:"4txBvRsNUWNCM8EFEEhub4vJBGrBXARQnlMnRy7DYhXWnKZDtONXJQQJ99ALACYeBjFB99tCAAAgAZMP1MtN"}}),t.events.add("ready",(()=>{const n=new CH.source.DataSource("myDataSource");t.sources.add(n),n.add(new CH.data.Feature(new CH.data.Point(r)));const o=new CH.HtmlMarker({position:r,draggable:!1});t.markers.add(o),t.events.add("click",o,(()=>{const r=document.createElement("div");(0,e.H)(r).render((0,st.jsx)(nG,{risks:i}));new CH.Popup({position:o.getOptions().position,content:r,pixelOffset:[0,-30]}).open(t)})),n.add(new CH.data.Feature(new CH.data.Point(r),{subType:"Circle",radius:200})),t.layers.add(new CH.layer.PolygonLayer(n,null,{fillColor:"rgba(247, 23, 53, 0.5)",strokeColor:"rgba(247, 23, 53, 1)",strokeWidth:2})),a(!1)}))}catch(r){console.error("Erro ao inicializar o mapa:",r),a(!1)}})(),()=>{t&&t.dispose()}}),[n]),n?(0,st.jsxs)(yt,{children:[(0,st.jsx)("div",{id:"mapContainer",style:{width:"100%",height:"631px"}}),o&&(0,st.jsx)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}})]}):(0,st.jsxs)(yt,{children:[(0,st.jsx)(lG,{as:"p",animation:"glow",children:(0,st.jsx)(lG,{xs:12})}),(0,st.jsx)(lG,{as:"p",animation:"wave",children:(0,st.jsx)(lG,{xs:12})})]})};const uG={1:r.p+"static/media/1.9abac4b0500e309b346737f755e40939.svg",2:r.p+"static/media/2.2e92f9eb6fae744a5aba7dad1755c58b.svg",3:r.p+"static/media/3.2e92f9eb6fae744a5aba7dad1755c58b.svg",4:r.p+"static/media/4.2e92f9eb6fae744a5aba7dad1755c58b.svg",5:r.p+"static/media/5.8e2b7f59f939fea383b57e2e8f57acd8.svg",6:r.p+"static/media/6.2e92f9eb6fae744a5aba7dad1755c58b.svg",7:r.p+"static/media/7.74865ae969701e0d48010470e805879d.svg",8:r.p+"static/media/8.74865ae969701e0d48010470e805879d.svg",12:r.p+"static/media/12.e6d1c28a2a1cdb69ba03045eca9a32d9.svg",14:r.p+"static/media/14.1b0c3d0bb2cc149172fcafe904c94a83.svg",16:r.p+"static/media/16.9268f92252e3bfc0038954447e517550.svg",17:r.p+"static/media/17.9268f92252e3bfc0038954447e517550.svg",18:r.p+"static/media/18.e6d1c28a2a1cdb69ba03045eca9a32d9.svg"},hG=e=>{let{features:t}=e;const r=t.day.iconCode;return(0,st.jsx)(yt,{children:(0,st.jsxs)(rG,{children:[(0,st.jsx)(bt,{xs:3,lg:4,children:(0,st.jsx)(WH.Img,{src:uG[r]})}),(0,st.jsxs)(bt,{children:[(0,st.jsx)(WH.Text,{children:t.day.longPhrase}),(0,st.jsxs)(WH.Text,{children:["Cobertura de nuvem: ",t.day.cloudCover," % "]}),(0,st.jsxs)(WH.Text,{children:["Horas de chuva: ",Math.ceil(t.day.hoursOfRain)]}),(0,st.jsxs)(WH.Text,{children:["Horas de sol: ",Math.ceil(t.hoursOfSun)]}),(0,st.jsxs)(WH.Text,{children:["Probabilidade de chuva: ",t.day.rainProbability,"%"]})]})]})})};const dG=r.p+"static/media/airQuality.43c23bee03c495f95843c2d84c848cf2.svg",pG="QualityAir_ColumnSecond__yabIh",fG=e=>{let{airQuality:t}=e;return(0,st.jsx)(yt,{children:(0,st.jsxs)(rG,{children:[(0,st.jsx)(bt,{xs:3,lg:4,children:(0,st.jsx)(WH.Img,{src:dG})}),(0,st.jsxs)(bt,{className:pG,children:[(0,st.jsxs)(WH.Text,{children:["Qualidade do Ar - ",t.category]}),(0,st.jsx)(WH.Text,{})]})]})})};const mG=r.p+"static/media/Temperature.db438a7ce7f5fbb2e21ba0e018cc6e53.svg",gG="Temperature_ColumnSecond__g6qIS",yG=e=>{let{temperatures:t}=e;return(0,st.jsx)(yt,{children:(0,st.jsxs)(rG,{children:[(0,st.jsx)(bt,{xs:3,lg:4,children:(0,st.jsx)(WH.Img,{src:mG})}),(0,st.jsxs)(bt,{className:gG,children:[(0,st.jsx)(rG,{children:(0,st.jsxs)(WH.Text,{children:["M\xe1xima ",Math.floor(t.maximum.value)," \xb0",t.maximum.unit]})}),(0,st.jsx)(rG,{children:(0,st.jsxs)(WH.Text,{children:["M\xednima ",Math.floor(t.minimum.value)," \xb0",t.minimum.unit]})})]})]})})};const vG=r.p+"static/media/UvIcon.fa5b24de8029805a23cf7e3539e79421.svg",_G="UV_ColumnSecond__haSH7",bG=e=>{let{uvindex:t}=e;return(0,st.jsx)(yt,{children:(0,st.jsxs)(rG,{children:[(0,st.jsx)(bt,{xs:3,lg:4,children:(0,st.jsx)(OH,{src:vG})}),(0,st.jsx)(bt,{className:_G,children:(0,st.jsxs)(WH.Text,{children:["Indice UV - ",t.category]})})]})})};const wG=r.p+"static/media/WindIcon.a46900e75d237c04ffef22aeb905134e.svg",xG="Wind_ColumnSecond__AELWw",CG=e=>{let{wind:t}=e;return(0,st.jsx)(yt,{children:(0,st.jsxs)(rG,{children:[(0,st.jsx)(bt,{xs:3,lg:4,children:(0,st.jsx)(WH.Img,{src:wG})}),(0,st.jsx)(bt,{className:xG,children:(0,st.jsxs)(WH.Text,{children:["Ventos de ",t.speed.value," ",t.speed.unit]})})]})})},SG=e=>{let{target:t,data:r}=e;return(0,st.jsx)(yt,{id:"containerWeather",children:r?(0,st.jsxs)(WH,{children:[(0,st.jsxs)(WH.Header,{children:["Previs\xe3o do dia - ",t," - ",new Date(r.forecasts[0].date).toLocaleDateString()]}),r.forecasts.map(((e,t)=>(0,st.jsxs)(WH.Body,{children:[(0,st.jsx)(hG,{features:e}),(0,st.jsx)(yG,{temperatures:e.temperature}),(0,st.jsx)(CG,{wind:e.day.wind}),(0,st.jsx)(fG,{airQuality:e.airAndPollen[0]}),(0,st.jsx)(bG,{uvindex:e.airAndPollen[e.airAndPollen.length-1]})]},t)))]}):(0,st.jsxs)(yt,{children:[(0,st.jsx)(lG,{as:"p",animation:"glow",children:(0,st.jsx)(lG,{xs:12})}),(0,st.jsx)(lG,{as:"p",animation:"wave",children:(0,st.jsx)(lG,{xs:12})})]})})},EG=t.forwardRef(((e,r)=>{let{bsPrefix:n,className:i,htmlFor:o,...a}=e;const{controlId:s}=(0,t.useContext)(wt);return n=pt(n,"form-check-label"),(0,st.jsx)("label",{...a,ref:r,htmlFor:o||s,className:at()(i,n)})}));EG.displayName="FormCheckLabel";const TG=EG;const IG=t.forwardRef(((e,r)=>{let{id:n,bsPrefix:i,bsSwitchPrefix:o,inline:a=!1,reverse:s=!1,disabled:l=!1,isValid:c=!1,isInvalid:u=!1,feedbackTooltip:h=!1,feedback:d,feedbackType:p,className:f,style:m,title:g="",type:y="checkbox",label:v,children:_,as:b="input",...w}=e;i=pt(i,"form-check"),o=pt(o,"form-switch");const{controlId:x}=(0,t.useContext)(wt),C=(0,t.useMemo)((()=>({controlId:n||x})),[x,n]),S=!_&&null!=v&&!1!==v||function(e,r){return t.Children.toArray(e).some((e=>t.isValidElement(e)&&e.type===r))}(_,TG),E=(0,st.jsx)(Ct,{...w,type:"switch"===y?"checkbox":y,ref:r,isValid:c,isInvalid:u,disabled:l,as:b});return(0,st.jsx)(wt.Provider,{value:C,children:(0,st.jsx)("div",{style:m,className:at()(f,S&&i,a&&`${i}-inline`,s&&`${i}-reverse`,"switch"===y&&o),children:_||(0,st.jsxs)(st.Fragment,{children:[E,S&&(0,st.jsx)(TG,{title:g,children:v}),d&&(0,st.jsx)(Lt,{type:p,tooltip:h,children:d})]})})})}));IG.displayName="FormCheck";const kG=Object.assign(IG,{Input:Ct,Label:TG}),AG=t.forwardRef(((e,t)=>{let{className:r,bsPrefix:n,as:i="div",...o}=e;return n=pt(n,"form-floating"),(0,st.jsx)(i,{ref:t,className:at()(r,n),...o})}));AG.displayName="FormFloating";const PG=AG,MG=t.forwardRef(((e,r)=>{let{controlId:n,as:i="div",...o}=e;const a=(0,t.useMemo)((()=>({controlId:n})),[n]);return(0,st.jsx)(wt.Provider,{value:a,children:(0,st.jsx)(i,{...o,ref:r})})}));MG.displayName="FormGroup";const RG=MG,OG=t.forwardRef(((e,r)=>{let{as:n="label",bsPrefix:i,column:o=!1,visuallyHidden:a=!1,className:s,htmlFor:l,...c}=e;const{controlId:u}=(0,t.useContext)(wt);i=pt(i,"form-label");let h="col-form-label";"string"===typeof o&&(h=`${h} ${h}-${o}`);const d=at()(s,i,a&&"visually-hidden",o&&h);return l=l||u,o?(0,st.jsx)(bt,{ref:r,as:"label",className:d,htmlFor:l,...c}):(0,st.jsx)(n,{ref:r,className:d,htmlFor:l,...c})}));OG.displayName="FormLabel";const LG=OG,DG=t.forwardRef(((e,r)=>{let{bsPrefix:n,className:i,id:o,...a}=e;const{controlId:s}=(0,t.useContext)(wt);return n=pt(n,"form-range"),(0,st.jsx)("input",{...a,type:"range",ref:r,className:at()(i,n),id:o||s})}));DG.displayName="FormRange";const NG=DG,zG=t.forwardRef(((e,r)=>{let{bsPrefix:n,size:i,htmlSize:o,className:a,isValid:s=!1,isInvalid:l=!1,id:c,...u}=e;const{controlId:h}=(0,t.useContext)(wt);return n=pt(n,"form-select"),(0,st.jsx)("select",{...u,size:o,ref:r,className:at()(a,n,i&&`${n}-${i}`,s&&"is-valid",l&&"is-invalid"),id:c||h})}));zG.displayName="FormSelect";const FG=zG,BG=t.forwardRef(((e,t)=>{let{bsPrefix:r,className:n,as:i="small",muted:o,...a}=e;return r=pt(r,"form-text"),(0,st.jsx)(i,{...a,ref:t,className:at()(n,r,o&&"text-muted")})}));BG.displayName="FormText";const UG=BG,jG=t.forwardRef(((e,t)=>(0,st.jsx)(kG,{...e,ref:t,type:"switch"})));jG.displayName="Switch";const qG=Object.assign(jG,{Input:kG.Input,Label:kG.Label}),HG=t.forwardRef(((e,t)=>{let{bsPrefix:r,className:n,children:i,controlId:o,label:a,...s}=e;return r=pt(r,"form-floating"),(0,st.jsxs)(RG,{ref:t,className:at()(n,r),controlId:o,...s,children:[i,(0,st.jsx)("label",{htmlFor:o,children:a})]})}));HG.displayName="FloatingLabel";const VG=HG,GG={_ref:Mt().any,validated:Mt().bool,as:Mt().elementType},KG=t.forwardRef(((e,t)=>{let{className:r,validated:n,as:i="form",...o}=e;return(0,st.jsx)(i,{...o,ref:t,className:at()(r,n&&"was-validated")})}));KG.displayName="Form",KG.propTypes=GG;const ZG=Object.assign(KG,{Group:RG,Control:Nt,Floating:PG,Check:kG,Switch:qG,Label:LG,Text:UG,Range:NG,Select:FG,FloatingLabel:VG}),WG=e=>{let{onSearch:r}=e;const[n,i]=(0,t.useState)("");return(0,st.jsx)(yt,{children:(0,st.jsx)(bt,{className:"justify-content-md-center",children:(0,st.jsxs)(At,{id:"inputGroup",children:[(0,st.jsx)(ZG.Control,{type:"text",id:"inputCustom","aria-describedby":"TextHelpBlock",size:"md",placeholder:"Para onde vamos?",value:n,name:"praia",onChange:e=>i(e.target.value)}),(0,st.jsx)(jt,{onClick:()=>{n.trim()?(r(n),i("")):alert("Por favor, digite o nome de uma praia.")},id:"buttonCustom",children:(0,st.jsx)(Wt,{className:"search-icon",id:"iconCustom"})})]})})})},$G={"Praia do Pina":{risks:[{icon:"shark.svg",message:"Risco de ataques de Tubar\xe3o."},{icon:"jellyfish.svg",message:"Risco de acidentes com \xc1guas-vivas."}]},"Praia de Piedade":{risks:[{icon:"hermit-crab.svg",message:"Risco de acidentes com Caranguejos."},{icon:"shark.svg",message:"Risco de ataques de Tubar\xe3o."},{icon:"jellyfish.svg",message:"Risco de acidentes com \xc1guas-vivas."}]},"Praia maria farinha":{risks:[{icon:"jellyfish.svg",message:"Risco de acidentes com \xc1guas-vivas."}]},"Praia dos Milagres":{risks:[{icon:"jellyfish.svg",message:"Risco de acidentes com \xc1guas-vivas."}]}},YG=()=>{var e;const r=$(),n=Q(),[i,o]=(0,t.useState)(null),[a,s]=(0,t.useState)([]);(0,t.useEffect)((()=>{if(r.state){o(r.state);const e=r.state.target.split(",")[0].trim();l(e)}}),[r.state]);const l=e=>{const t=$G[e];s(t?t.risks:[])};return(0,st.jsx)(yt,{children:(0,st.jsxs)(bt,{children:[(0,st.jsx)(rG,{id:"RowFirst",children:(0,st.jsx)(WG,{onSearch:async e=>{try{const t=await Ht(e),r=t.properties.address.formattedAddress,i={target:r,geocodeData:t,weatherData:await Vt(e)};o(i),l(r.split(",")[0].trim()),n("/mapa",{state:i,replace:!0})}catch(t){console.error("Erro na nova busca",t),alert("Erro ao buscar dados. Tente novamente.")}}})}),(0,st.jsxs)(rG,{children:[(0,st.jsx)(bt,{lg:8,xs:12,children:(0,st.jsx)(cG,{coord:null===i||void 0===i||null===(e=i.geocodeData.geometry)||void 0===e?void 0:e.coordinates,Listrisks:a})}),(0,st.jsx)(bt,{children:(0,st.jsx)(SG,{target:null===i||void 0===i?void 0:i.target,data:null===i||void 0===i?void 0:i.weatherData})})]})]})})},XG=()=>(0,st.jsxs)(me,{children:[(0,st.jsx)(pe,{path:"/",element:(0,st.jsx)($t,{})}),(0,st.jsx)(pe,{path:"/mapa",element:(0,st.jsx)(YG,{})}),(0,st.jsx)(pe,{path:"/sobre-nos",element:(0,st.jsx)(Xt,{})}),(0,st.jsx)(pe,{path:"/contato",element:(0,st.jsx)(rr,{})}),(0,st.jsx)(pe,{path:"/login",element:(0,st.jsx)(Qt,{})}),(0,st.jsx)(pe,{path:"/cadastro",element:(0,st.jsx)(tr,{})})]});const QG=function(){return(0,st.jsx)(st.Fragment,{children:(0,st.jsxs)($e,{children:[(0,st.jsx)(er,{}),(0,st.jsx)(XG,{})]})})};(0,e.H)(document.getElementById("root")).render((0,st.jsx)(t.StrictMode,{children:(0,st.jsx)(QG,{})}))})()})();
//# sourceMappingURL=main.d66ca67b.js.map